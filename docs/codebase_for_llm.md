# Bilancio Codebase Documentation

Generated: 2026-01-12 20:54:33 UTC | Branch: main | Commit: 79a7eee3

This document contains the complete codebase structure and content for LLM ingestion.

---

## Project Structure

```
/home/runner/work/bilancio/bilancio
├── .env.example
├── .github
│   └── workflows
│       ├── claude-code-review.yml
│       ├── claude.yml
│       └── update-codebase-for-llm.yml
├── .gitignore
├── AGENTS.md
├── CLAUDE.md
├── README.md
├── dashboards
│   ├── expel_ring_analysis_dashboard
│   │   ├── README.md
│   │   └── streamlit_app.py
│   ├── expel_sweep_dashboard
│   │   ├── README.md
│   │   └── streamlit_app.py
│   └── monotonicity_demo
│       ├── README.md
│       └── streamlit_app.py
├── data
│   └── experiments
│       └── dealer_comparison_100
│           ├── aggregate
│           │   ├── comparison.csv
│           │   └── summary.json
│           ├── control
│           │   ├── registry
│           │   │   └── experiments.csv
│           │   └── runs
│           │       ├── comparison_control_00b2d850311d
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_014e02fedeb9
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_03292067dca1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_05986b07a124
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_05e783597b85
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_074a1548f2ff
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_08a4e4ea30cf
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_0d19bb16bb8f
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_0d276acabdfb
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_138e331be562
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_1aecc9a82759
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_1beab3011713
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_1d0bc3ae93de
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_2200913e947b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_2461e109d0f3
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_25f92c567460
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_271c0dfee480
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_2737a75d51c6
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_27539ff7d75a
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_2c74ba56d226
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_2fccd651a294
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_33a34a1f28fb
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_33f2f34c73d6
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_34cac33513d0
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_3a75d45e2233
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_3c4aa0ccab0c
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_3dc6c8f88bc8
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_3e1b32ced3f9
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_3ffdf6fcb3dd
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_41b006f34ae9
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_428c3c8f4646
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_480dddbe92da
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_4a64f1d23ce5
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_4d32322c5c06
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_52f4cb3fd249
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_530c5267a3ce
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_53d3b4f29008
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_5602fdbd90d2
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_5cc7a1671c76
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_5cf001732102
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_5e9b14530545
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_5f5f18ee7fa1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_613aff3b5b01
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_629b93b2cfc1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_62b7e19fd45d
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_63047cf76ca3
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_644d0197f4c1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6b991b772042
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6c54ea0a80ee
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6d0225dcd490
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6d36721cc611
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6dcb4dc7767e
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6e8f867bc083
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_6f42f6b761b3
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_70bd807ba80b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_712f1ab47251
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_71b414e8f582
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_731d1bdd9c99
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_768f56337fe1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_77bfa1a09732
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_7a1624351c10
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_7d88c8d04e9f
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_81bca5d020fa
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_83b861ac6859
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_85b7333e7337
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_8763d46f6ae2
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_8a0c7d323f03
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_8d325a9f61c5
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_91d9eb743d90
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_97005d580e18
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_979676994cc4
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_97c93b17d369
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_998e60d262e8
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_9b700748f458
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_9d3769143cd9
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_9f2c9c14422b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_a299422adf6d
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_a3791eefad79
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_a5d65425dbe7
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_a970ce60f78b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_af53b296a838
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_b56c32a44ba6
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_b8470b33c023
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_bad7b8ec3774
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_bb648d7a89b5
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_bd3fb044178b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_be382fecb9d3
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_befe58afaff2
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_c1ec93ac5b36
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_c8a7e2f32d0e
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_cab813e5cafc
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_cce59ac7fb7e
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_cfaff51bb13b
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_d0d83af3a164
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_d357788ce354
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_d624d23824c1
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_d6981c93a0c6
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_dc90008f7397
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_dc96c48c3a57
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_dd55f90d52b4
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_dd74d58793b0
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e03277375557
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e0d596eec10a
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e12996a74514
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e19b021e5813
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e2b521456178
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e35a8c5ff3a2
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e4ed881046db
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e685927fc523
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e8dbeca02963
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_e9667d886731
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_ea51f065338a
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_ebd291890c05
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_eea84c337e64
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_ef0d61c75c23
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f0ac6007c26a
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f2160464022c
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f368d2f82ebd
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f384e2126685
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f4d89abf6807
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f7ce336592a6
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_f840e2e85d17
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_fb445af1f9ec
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       ├── comparison_control_fca405d9f97f
│           │       │   ├── out
│           │       │   │   ├── balances.csv
│           │       │   │   ├── events.jsonl
│           │       │   │   ├── metrics.csv
│           │       │   │   ├── metrics.json
│           │       │   │   ├── metrics_ds.csv
│           │       │   │   └── metrics_intraday.csv
│           │       │   └── scenario.yaml
│           │       └── comparison_control_fcb15c1401ea
│           │           ├── out
│           │           │   ├── balances.csv
│           │           │   ├── events.jsonl
│           │           │   ├── metrics.csv
│           │           │   ├── metrics.json
│           │           │   ├── metrics_ds.csv
│           │           │   └── metrics_intraday.csv
│           │           └── scenario.yaml
│           └── treatment
│               ├── registry
│               │   └── experiments.csv
│               └── runs
│                   ├── comparison_treatment_0221521f3c84
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_043d2269a900
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_0445e7812d8f
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_04e05f0e5d82
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_09c356b1d3fb
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_0c1bc858a556
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_0c77cc1e97a2
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_0ed70903af75
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_10b750e8f395
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_12093181682a
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_128104b200e6
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_14ee6fed8366
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_18e0a3ead849
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_1bcb63d283c2
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_1e0e55d5c799
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_1ed7c86919e2
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_1f6e7c3a3d09
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_231287e64d19
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_29ad0a15349a
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_2cb9f06d5830
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_2e09431fc427
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_2e9b60a6ccc1
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_2f868b12d320
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3051ebb4ac4c
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_32d1a84a69db
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_32e539ccfcb4
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_340b6081023e
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3427ef888708
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3765bceeb64c
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_39749c8f7d24
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3dc00c10801c
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3e206837bfda
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3ec4bb1d92f3
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_3f79acb940ad
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_40ddc73c2ef7
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_430071c5bb50
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_439c626c5777
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4420e603e5e3
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_45405ed32473
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_461a06db4228
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_475a95625fbe
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4823362235c8
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4a10cef3ba23
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4cb55f3ac7c0
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4dbecd20782f
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_4f3f0b58b3c6
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_501a21b46572
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_5046c846f5d9
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_5210553ac1fb
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_56be77b3c572
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_5b89c942e76a
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_5c6b9b737a32
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_609bfc6e3c1b
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_60e7c8d235e8
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_62cfcc1405f1
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6315f4734668
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_644cb179d77d
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6bd980725f3d
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6ca197637ea0
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6d10bc8ed7ce
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6eedbba24a7a
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_6f87b0b28299
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_70b2ca38dfbf
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_70fffdc04dfa
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_726d7c2f9a2b
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_7353894f9279
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_775970de9153
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_7b2d999f1611
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_7e283b34d895
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_80e2d1f9a5ef
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_87c290481bab
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_88d890fa7a79
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_892fa8a31f86
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_8bbe69e9d9e8
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_9011e0984c57
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_908b22699236
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_977d7f36893e
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_9b212114639e
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_9c864bf0a6f7
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_9e62db0a14cd
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_a1c7006249d4
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_a206b4295cf7
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_a40948d7d74a
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_a519822abb36
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_a9ddc3ff0627
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_ad0a046fb520
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_ad64b38fd5da
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b31c95d54218
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b461591c8d04
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b552532a5cd6
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b6162e055ba9
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b910444c6b83
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b9502137c023
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_b9cf426ce81d
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_baf3b053542b
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_c1942f1c74a0
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_c2e85f98c5a2
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_c4d4f3dab290
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_c5d327a05dde
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_cf525cf0b4c0
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_d0743471d6f8
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_d4dff37851b4
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_d79e793baaff
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_d82bd4524670
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_db14d85ae27b
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_ddea94061805
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_de64f478efd4
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_df1cb7eac845
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_e25281813aab
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_e4b8b725ba48
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_e67a9856c416
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_eeb5efc91d67
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f09140e19658
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f2c315bfb342
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f391c4c150d0
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f3d1937c6892
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f4fdff12f698
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f502c9a95d96
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_f6276c59f04b
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_fb197ddf6081
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_fbb81d756d68
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_fd267597467f
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_fd6075bfc7c9
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   ├── comparison_treatment_fd7761dbf234
│                   │   ├── out
│                   │   │   ├── balances.csv
│                   │   │   ├── events.jsonl
│                   │   │   ├── metrics.csv
│                   │   │   ├── metrics.json
│                   │   │   ├── metrics_ds.csv
│                   │   │   └── metrics_intraday.csv
│                   │   └── scenario.yaml
│                   └── comparison_treatment_fd8a3c948396
│                       ├── out
│                       │   ├── balances.csv
│                       │   ├── events.jsonl
│                       │   ├── metrics.csv
│                       │   ├── metrics.json
│                       │   ├── metrics_ds.csv
│                       │   └── metrics_intraday.csv
│                       └── scenario.yaml
├── docs
│   ├── 015_expel_sweep_agent_report.md
│   ├── 018_dealer_integration_fixes.md
│   ├── Kalecki_debt_simulation.pdf
│   ├── Monetary Theory Chapter 5.pdf
│   ├── Money modeling software.pdf
│   ├── SP239 Kalecki on Credit and Debt extended.pdf
│   ├── analysis
│   │   └── 016_dealer_comparison_analysis.md
│   ├── archive
│   │   └── TODO_2025.md
│   ├── codebase_for_llm.md
│   ├── dealer_ring
│   │   ├── Instructions_for_simulation.pdf
│   │   ├── Instructions_on_instrumentation_improvement.pdf
│   │   ├── New_Kalecki_ring_with_dealers.pdf
│   │   ├── conversations
│   │   │   ├── 20251110.txt
│   │   │   ├── 20251114.txt
│   │   │   ├── 20251118.txt
│   │   │   ├── 20251127.txt
│   │   │   ├── 20251201.txt
│   │   │   ├── 20251204.txt
│   │   │   └── 20251205.txt
│   │   ├── dealer_examples.pdf
│   │   ├── dealer_implementation_readiness.pdf
│   │   ├── dealer_specification.pdf
│   │   └── stojanovic_et_al_2025_liquidity_internal_debt_dealer_simulation.pdf
│   ├── exercises_scenarios.md
│   ├── guides
│   │   └── kalecki_ring_sweep.md
│   ├── plans
│   │   ├── 000_setup.md
│   │   ├── 001_domain_system.md
│   │   ├── 003_cash_and_nonfin_exchange.md
│   │   ├── 004_banking.md
│   │   ├── 005_reserves_settlement_clearing_scheduler.md
│   │   ├── 006_analytics.md
│   │   ├── 007_deliverable.md
│   │   ├── 008_simulation.md
│   │   ├── 009_cli.md
│   │   ├── 010_ui_refactor.md
│   │   ├── 011_tbs.md
│   │   ├── 012_scheduled_actions_and_aliases.md
│   │   ├── 013_default_handling_modalities.md
│   │   ├── 014_kalecki_experiments.md
│   │   ├── 015_kalecki_experiments_analysis.md
│   │   ├── 016_dealer_kalecki_integration.md
│   │   ├── 016_dealer_ring_implementation.md
│   │   ├── 017_dealer_ring_html_report.md
│   │   ├── 018_dealer_comparison_experiments.md
│   │   ├── 019_dealer_metrics.md
│   │   ├── 020_dealer_mid_tracking_metrics.md
│   │   ├── 021_balanced_dealer_comparison.md
│   │   ├── 022_enhanced_instrumentation.md
│   │   ├── 023_default_aware_instrumentation.md
│   │   ├── 024_dealer_simulation_redesign.md
│   │   ├── 029_job_system.md
│   │   ├── 031_cloud_storage.md
│   │   └── Kalecki_debt_simulation (1).pdf
│   ├── prompts
│   │   ├── 015_expel_sweep_agent_prompt.md
│   │   └── scenario_translator_agent.md
│   ├── refactor_2026
│   │   ├── 025_phase1_cleanup.md
│   │   ├── 026_phase4_abstractions.md
│   │   ├── 027_executor_separation.md
│   │   ├── 028_cloud_executor.md
│   │   └── codebase_analysis.md
│   └── version_1_0_exercises.pdf
├── examples
│   ├── dealer_ring
│   │   ├── README.md
│   │   ├── VERIFICATION_PROMPT.md
│   │   ├── assemble_examples.py
│   │   ├── example10_trader_rebucket.py
│   │   ├── example11_partial_recovery.py
│   │   ├── example12_capacity_crossing.py
│   │   ├── example13_event_loop.py
│   │   ├── example14_ticket_transfer.py
│   │   ├── example1_migrating_claim.py
│   │   ├── example2_cross_bucket.py
│   │   ├── example3_clip_toggle.py
│   │   ├── example4_vbt_layoff.py
│   │   ├── example5_dealer_earns.py
│   │   ├── example6_bid_passthrough.py
│   │   ├── example7_no_interior_clipping.py
│   │   ├── example8_guard_low_M.py
│   │   ├── example9_partial_recovery.py
│   │   ├── out
│   │   │   └── .gitignore
│   │   ├── reports
│   │   │   ├── example10_report.html
│   │   │   ├── example11_report.html
│   │   │   ├── example12_report.html
│   │   │   ├── example13_report.html
│   │   │   ├── example14_report.html
│   │   │   ├── example1_report.html
│   │   │   ├── example2_report.html
│   │   │   ├── example3_report.html
│   │   │   ├── example4_report.html
│   │   │   ├── example5_report.html
│   │   │   ├── example6_report.html
│   │   │   ├── example7_report.html
│   │   │   ├── example8_report.html
│   │   │   └── example9_report.html
│   │   ├── verify_example1_prompt.md
│   │   └── worked_examples.txt
│   ├── exercise_scenarios
│   │   ├── html
│   │   │   ├── all.html
│   │   │   ├── ex1_cash_for_goods.html
│   │   │   ├── ex2_two_firms_cash_purchase.html
│   │   │   ├── ex3_iou_assignment.html
│   │   │   ├── ex4_generic_claim_transfer.html
│   │   │   ├── ex5_deferred_exchange.html
│   │   │   ├── ex6_goods_now_cash_later.html
│   │   │   └── ex7_cash_now_goods_later.html
│   │   └── yaml
│   │       ├── ex1_cash_for_goods.yaml
│   │       ├── ex2_two_firms_cash_purchase.yaml
│   │       ├── ex3_iou_assignment.yaml
│   │       ├── ex4_generic_claim_transfer.yaml
│   │       ├── ex5_deferred_exchange.yaml
│   │       ├── ex6_goods_now_cash_later.yaml
│   │       └── ex7_cash_now_goods_later.yaml
│   ├── kalecki
│   │   ├── kalecki_ring_baseline.yaml
│   │   └── ring_sweep_config.yaml
│   └── scenarios
│       ├── default_handling_demo.yaml
│       ├── firm_delivery.yaml
│       ├── interbank_netting.yaml
│       ├── intraday_netting.yaml
│       ├── kalecki_with_dealer.yaml
│       ├── payment_demo.yaml
│       ├── rich_simulation.yaml
│       ├── sasa_scenario.yaml
│       ├── simple_bank.yaml
│       ├── simple_dealer.yaml
│       └── two_banks_interbank.yaml
├── notebooks
│   └── demo
│       ├── balance_sheet_display.ipynb
│       └── pdf_example_with_firms.ipynb
├── out
│   ├── events.jsonl
│   ├── experiments
│   │   ├── 20250925_163435_ring
│   │   │   ├── aggregate
│   │   │   │   ├── dashboard.html
│   │   │   │   ├── day_metrics.pkl
│   │   │   │   └── day_metrics_enriched.pkl
│   │   │   └── runs
│   │   │       ├── grid_02b68e2015c0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_051c40d40d73
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_05a06d6e9346
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_05e68dfa1a95
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0ce62e0e5bba
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0d9fd1cbfe49
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0e79b3aabd93
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0f7938d2bf61
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0f9c0fff7c7c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_10d30f7e5db9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1242a0c2a915
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_12cfa42c0164
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_138329d0f12d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_15c05a9a63f8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_187838a23577
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_188cb83f1ff0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1c0d52ec7bcb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1f502489eb08
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_214aa6c5143b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_27c4d7652a5d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_28711d3b5714
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2b1a79d2203a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_323bcdd24e71
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_344b4e32d70b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_352ad433243f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_364bbdf29fd2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_39eb17e00ca9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3f18c791e3f8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3f5afb2621a8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4209452b154d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_43395f197a68
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_439324d6625a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_456230bd4e87
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_45cfaeab7b4d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_473968822dda
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4774a3945a07
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_493c44aea6a9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4b7a15e41a1e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4cfe5c8bbe8f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4ec2b5632c08
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_53686a7d4fee
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_539acca28e56
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5a912c864cf7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5b8b7342c40d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5bc94ddbc6df
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5cad321c36b9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5dc0a958e676
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5e9b9fedd5c0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5eeb773c700d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6607b285541f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6c675eb9bbd7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6de6cd1769aa
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6e4bf94123fc
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6f39b611cf02
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6f858c15f761
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7045c667a5c0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_72de297264d9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_765cc1052c91
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_765eadcf6739
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_76644b186698
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7764bf014711
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7b809b454997
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7c814155e0ae
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7de8c8cd810a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7f1e53c036a0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7fd60952bb8e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_80cd436597f5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_80dfd261b3d8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_80e880f2554e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_81f55875ba26
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8276c4bb791a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_83bf285214b5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_855cba95cf46
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_87dc6ef05ac7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8a39cdcfe35d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8c62323919c4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8d0458ac29a5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8fc166da5fba
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_90877b9a412d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_92021718effe
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_927129fbda77
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_940d2057d650
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9a422b64fbc6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9bf40c827697
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9d63edab4599
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9f8883b6f34a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a529344243ba
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b5186cb7dcc4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b56e187c0050
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b5acf1815022
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b5fba0901ce5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_baca375aaa7b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bb3f74548bc0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bbef6124105d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_be2764324886
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_be3ac6816d2e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_be47d099fe6b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c16d70635bff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c70f691a93c8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c881b8248059
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c9b434c1ec85
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_cef25e7ff9ea
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d119c054658e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d5671d3e5c21
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d59b61804b1d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d7a8197c09e9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_da7b526e3f0e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dc322d838fbd
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dd9a327f1817
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_df46a35e5cf7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dfb38334772c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e2eb7d511d5d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e355eb415965
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e5551c54e460
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ec97ab575de3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ed17a28943be
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ed8abee127a9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ef5a42b3edf9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_efd7eab67be2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f03969802ada
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f258c737c1de
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f4b06b83c87b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f7ff19dcaa47
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f8d722f1abcd
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       └── grid_fa7f2dc06d51
│   │   │           ├── out
│   │   │           │   ├── events.jsonl
│   │   │           │   └── metrics.html
│   │   │           ├── run.html
│   │   │           └── scenario.yaml
│   │   ├── balanced_comparison_20251204
│   │   │   ├── active
│   │   │   │   ├── registry
│   │   │   │   │   └── experiments.csv
│   │   │   │   └── runs
│   │   │   │       ├── balanced_active_02c88e1857cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_037adc3ee4c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_04de37e11a83
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_04de6d1f6935
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_06c69e22a6b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0dd41fe97ae3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_10d17f08c852
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_13237b307fd2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_142bf8e6b7e9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_148896c26a3c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_170b80ce197d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1da19eb2527a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1eba1d9d1e34
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1ecf4e9cb784
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1f78d87a8229
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_22538ee0ee4d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_231dbdcedb79
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_239389ff7064
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23a37e7ee0cd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23aaf4485908
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_24f03a5e9140
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_25ed03ba1989
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_27ac1ce0098e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_27d729205e63
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3000453cbf3e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_30a22c72c803
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3688dd94e8e4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_38d81c71bcdc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3ae7df94cf35
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d6909a035b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4145cf85afd6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_45369a863583
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4612404b38c6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4765a8727d91
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49296980bbbc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49448ff73df0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a910940bfd2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4bbc15b2d174
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4c8bcf81b134
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4fcbe4bc70c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_51097d747727
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5283907f2a5a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_52a2ad2f9879
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_55642c07b691
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_55921daf3f34
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5755d49c5cd7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_59b162022a73
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5bbf050ed017
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5c9af8213dec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5d70482149a2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5e25ec4ab005
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_601e41dd9e96
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6194aaddeffe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6318fefd3623
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6488f9fe0446
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6563afaf9b00
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65bef47820a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6ada67c63d7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c6d33c42674
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d5406ab3e0a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_733bfdba8466
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_74648e3a1540
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7595c27d07ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_79a7dc155566
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_79ecd3d2690d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7a323bea2e3d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d21671aa830
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7e8844b259dc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_80b3858afbe7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8730c29e0d9b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8918032d6c07
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8ac28e080724
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b3b33acddfc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b4168c9044c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b84240d28ee
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8c57419ff8f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8dee4383eb89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_913112bf22f6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_94e1a1fdd2e2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9755916b5e1b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97b33259abf3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_98ea51fcfb0b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9a5b1bbc5a97
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9bdfba3508f1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a08c49f4b090
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a2259120f82e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a2ea62bea3c2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a333af8704a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a41ef73fe95d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a5a143d52c07
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a65d6e6913cf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9db82e1c42a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ae62554251fa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af6a514d46d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b14c68f0b740
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b2c9bcdde538
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b37abddb8aac
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b62ddbc70133
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b78ad8efed64
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b7edc2942b78
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bafaf8902f57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bbaca8bc36a1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bd884be95dd6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_be7563f82e93
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c18da76a2690
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c1dc6e819e3a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c76253f6cf40
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c7ed8daccf2d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c84f8813c655
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c9b899f6c168
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd70be947c22
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cfd244ecf43f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d416d756cc27
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d702c78fa284
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dc3534fc7dc3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dc9931803547
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e2b6e1b2eb8e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e453f4ed2e87
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e58722b848f1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e904b3165f47
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e90dce24f6f2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f3506f6ee10e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f3eed2ea8170
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f4e871978df3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   └── metrics_intraday.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       └── balanced_active_f5f899ed91a8
│   │   │   │           ├── out
│   │   │   │           │   ├── balances.csv
│   │   │   │           │   ├── dealer_metrics.json
│   │   │   │           │   ├── events.jsonl
│   │   │   │           │   ├── metrics.csv
│   │   │   │           │   ├── metrics.html
│   │   │   │           │   ├── metrics.json
│   │   │   │           │   ├── metrics_ds.csv
│   │   │   │           │   └── metrics_intraday.csv
│   │   │   │           ├── run.html
│   │   │   │           └── scenario.yaml
│   │   │   ├── aggregate
│   │   │   │   ├── comparison.csv
│   │   │   │   └── summary.json
│   │   │   └── passive
│   │   │       ├── registry
│   │   │       │   └── experiments.csv
│   │   │       └── runs
│   │   │           ├── balanced_passive_0269e1fbdcfa
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02bd946c5ec9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02fe62109321
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_03fe53aa22e2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_050c6a7ae2a1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0600293fd545
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_07074ec93ad6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_076eeaa04769
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0a399133febb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0aea60dbccd5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0daf73488ea2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0dbc44cf2620
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0f6d515d5114
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_124ecb564714
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_13414ea47afa
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_140c074a2a6a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_155ff9cf829d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1576489ec286
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_15bca739bb41
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1dd6c3568e46
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e840b0c5c72
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_20f23fd6905b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2b2fea552424
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2c6570672add
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ddfabd1972b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2e6a4832a1f1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2fc7fcb5d1fd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3364ba956ccf
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_35cd9433ad01
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_35ebb48fc1e8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_377f175ef15d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_39d8b644d37d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3b6af00bfbdf
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3be4254cbd09
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3fea68a02144
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_400bf5f34182
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4081427577be
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_417c6b28143d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_41b69da05d4d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_41dbba6cd171
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4243d63542fe
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_46eebd57acc1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4a14890ca3f7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4a5cb171c265
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4befc82327aa
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_50ea623c4e1a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_50fd91ba7663
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_536b6cc06e94
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5529643eb0b9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5790b7dd5909
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_60b2ccaa903d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_647f09f283c1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_64f48f1253d5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_65213f4179df
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_69107e960e90
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6a6fa7c7fc13
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6b74bd9d9a6f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c3a87b81618
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_723d281a874e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_72dc19de6277
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_789357bfad12
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7951351b7e0e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d429fa22001
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7f32adfb8468
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_80cf28162f58
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_85e168a17acc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_86632c781ad7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_87437839f29f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_877c9b39394e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8d03edc68902
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8de078e6b69d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8e2a221d1a2f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8e7356f1e7dc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f57011cb41f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_916eafbb0b9a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9206682f715f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9567b065b83f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_97090d7d9958
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_976d0121c065
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9bfb57f60772
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a01c5ef1bff4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a7178cbef97e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a85516e9a902
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a863441c80a0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a879c13e9e0f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b4785d0baa0e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b5581bf8e187
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b6dcfbdc630f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b933dab8a407
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ba43b1a13ba1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bd0784d85c25
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bdabc2e91ebc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_be616cf2801b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_be716fc6d676
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_befe5060484f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c0d52385d3ee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c34011e54007
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c9ca469c8c93
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cb1af9d60669
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd3860e5e79c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ce01a8457932
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d177152b455e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d2f9bb3b1ca4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d321a6978470
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d532b1e884b6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d7f0f7908e71
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_da3016346bae
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dc816d6b34a5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e42de72bc596
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e443c585a3e1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e73b8140026c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e8e432a7b639
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e9fc74d82a28
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eda3d02efa67
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ee4131f40983
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eec791239d46
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ef73bdbe54cc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f0f1ebd4ccd1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f2ffffd6897e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f534434de6ae
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f56daf5359ee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fa4d041f1110
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fae7936607ee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fe667ddb4b1a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           └── balanced_passive_fe94bbf8a58b
│   │   │               ├── out
│   │   │               │   ├── balances.csv
│   │   │               │   ├── events.jsonl
│   │   │               │   ├── metrics.csv
│   │   │               │   ├── metrics.html
│   │   │               │   ├── metrics.json
│   │   │               │   ├── metrics_ds.csv
│   │   │               │   └── metrics_intraday.csv
│   │   │               ├── run.html
│   │   │               └── scenario.yaml
│   │   ├── detailed_instrumentation_sweep
│   │   │   ├── active
│   │   │   │   ├── registry
│   │   │   │   │   └── experiments.csv
│   │   │   │   └── runs
│   │   │   │       ├── balanced_active_009c0b29a96e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_00ff61471ce8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_01a753c2ff50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_01d5986b8c4d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_020c21402a28
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_02770137011e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_02f1e132fb59
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_035014b6f0b4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_037d2862aa57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_038e5c07f347
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_04dec00761a6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_050426926ad0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_050ad40da9a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_051a1a1ffa13
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_052cc89e6323
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_05be59cee39a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_062aa8d72fc1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_06592c9fa351
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_065e5d08bf50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_06684b7d3b24
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_06f6c7bc5995
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_073c354e30c6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_074f9adc9a15
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0780c12df6f6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_07b2207b1745
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_07e60c3764c0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_088c04779e6f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0891a5e39e54
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_092d01d82c54
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0a14e312f62e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0aaff1a73646
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0ab96bafaff2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0af215e45bf3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b1386e94e51
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b1d19f000d9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b5d9973390d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b62a5ca8827
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b764f814a6c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0b8ac7dc909a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0bddbf719a68
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0c29466c14a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0c42b6b6e2b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0c50fedbe19a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d1ed1a6afc5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d2c0a20360a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d7d0c00ee89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0e87ed5b25b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0efd36f94e52
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0f463382545e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0fd1b89163d7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_10d162e6eef6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_111b8a35af1e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_11b9392c1dc2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_11d521c3fe3d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_11f8f704c18f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_124676c9f836
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_124c915e5a69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_12fec638c3b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_137389fe0b89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1453edf2e05e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_14aa711196d1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1567e8a5c8cf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_16f9fda4fd9d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_17109bd206c9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1803b5543cbe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_189623b97ee8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19922c026683
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19a164aa6512
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19e837d7dc27
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19efea9a26bd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19f8b4a55267
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1a27a9d5f2ed
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1abcb4e00a8b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1ad2302d1b8d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1b6bac6c3763
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1bc0ebfb33c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1c0666cb071b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1c1ecaa711b3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1c27ee519c27
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1d8fea831325
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1df33a23825e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1e21751db0a7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1ef078dd4531
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1f375311f4ec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1f47a7b3fbaa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1f7d36a4defe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1fa6b48e9ba3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_20799ffc0af1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_20d4f1599f76
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_20db3ed1b0f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_215f7d943acd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21810630cfed
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21a16412f835
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21a7b26c62c5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2223ae52c113
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_22723bd63cfa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2291a97f49f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23fc5f3af386
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_242b301d29d8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_248d30f6b2b4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2559ec205716
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_255ca86d7d7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_25fe1e3eb544
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2619810cc56f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_269c3b0edafc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_26bde501edce
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2729506d10a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_278c94dfc16b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2847dcdd89d2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_28f80fb40acb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2a21f2dcffb9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2ac5136d61a1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2accb5c7250c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2b03f8802104
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2ba798965e24
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2beec38532b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2c17917e80c8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2cadcc872ef7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2d07d4547ab4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2d4666d7a4b4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2d49af5a0d9b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2daada90dddc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2dc9c383deb5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2de0b43a2264
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2eb602411470
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2ed19b042237
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2f1267a595d1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2fbd6bd4e4ed
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2ffb7cebab69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_300f111c7d72
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_30851e3df956
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_30bc10ae6c2f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_30da43c4543c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3175695c48a1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_31dae9d3e929
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_31e8cad3b119
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_332e176f9400
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_34bff1a54311
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_355b5a957fff
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_355c59d4dc25
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_356f0aede5fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_359825571f1f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_35e6a99c3ea5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_36d0a0afeb3c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_37814a99c444
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_37c6eaa821f0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_37f39bf6776f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3829a7a05bfd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_38b0be7e582d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_38c16e45d40b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_38fb795f6787
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_39278aa33557
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_395eea9099ae
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_39924b883284
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3ae8ecf2dc4e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3b73bcb1b196
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3c0f1e525c78
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3c5c842bcc17
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3c7a1232c894
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3cdf1179eb22
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d6ac4537dc4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3de97741c608
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3e0d27b727a4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3e1041666aad
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3e4ad37c727d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3edaf89e707c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3f45ceddc534
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3f77a3bc31aa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3fbb5d07bbe3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_40a2695c4a64
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4134a5e35c69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4140b0bc7f57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_41803e93f627
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_41eaa77c0e0c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_41ec547917aa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_420462119f30
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4236fef49b3d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_42a4bef65d9c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4306b443e4d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4437612d204c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_46877618aa7a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4809d2e10348
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_48f11bd344b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49230a18dec9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49445522bf21
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4952c439bc52
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49db9a65cee7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a73dd8cd2fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4aa59dee687b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4aba985e3a3f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4b92b00a9ba0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4c3ff58106eb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4c4387d8a348
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4cea1e8c5ad8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4d5b56bcbd37
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4d860bde1b20
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4f3e556be89d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4fceb08851f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4ff263ff7fea
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_50288441cdd9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_50a91efda302
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_51593fd8c9e6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_515d854620c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_520c3c713476
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5232e71472a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_525c5d9f458c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5386b23a492e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_53b13374b556
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_53cbb5842adb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_53d2cbb58bf6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_542b8ab84782
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_545a16a1150b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_54bcc5a642e7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_54cf8ddec468
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5515e1f7fe43
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5563a6f87c88
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_55ac9eafd194
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5658862c4e50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5723861c2950
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_57282f7f2a23
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_578f4bffa16c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_580141a84276
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_580dbaf74b12
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_582983288fde
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5844ed242c39
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_587023f39aac
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_58c25a0c951a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_58e46b3ecf9f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5909c9620eb7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_59527a69f2f8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_598f359ddbf4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5a3cbe80dbcf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5afdb1fc83d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5b2bdc5b4e3c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5b5819ee8538
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5b62973e9218
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5bc838313543
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5befcb846c44
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5c07f2d93501
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5c372b055b64
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5d56c93d3874
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5da601867f68
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5e36ea6d5dd9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5e9332a4a02a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5eb865866325
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5ed7b31d17b9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5ee10acac628
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5f609fa50d1f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5f9eb2d90195
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5ff275fb060e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_60447704abd1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_607d54f6629d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_60ac044c5234
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6137c6b5d7b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6149e0c9f92d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_61958256c145
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_624cb2842244
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_625ab07d750d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_628ab3228737
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_62b5e3886e8a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_631f69e5084c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_63aaa63becf0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_64022e067fde
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_649e337e5a50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65021de370d9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65292e383d3b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65a1590ca409
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65af5c372be7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6631dae289ba
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6694acf6567c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_66d288fb413c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_66ee75a118a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_676e11dda19b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_67eddf15a01d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_67ef0ab83f66
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6818b45c1476
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6825284323c4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_68a3a92ce4fb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_68e6e415da80
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_691f3642a3e0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_693978ae2541
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6963c6134049
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6966ca0dbd78
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6a2e88522e6b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6acdcf618a54
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6af4a35fe0eb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6affc90f8216
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6be08849dd69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c7d4db4cd6a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6cff369ebf49
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d72b2259673
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6e2c0ed209a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6e7f7e6d4701
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6fc1df25bb05
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7038af36db61
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_70b19306b3a5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7184340a8e47
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_71e5572486d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7238e3a2d1c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_72d2bf267c4c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_72da06666db5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_742a6ad4a8b3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_744d4f8ecd8a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_74c5cc92b917
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_74c8a7c54aa7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_750ee5e5d846
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_751ba9ed60f2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_75854eaf14c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_75eb8fd507af
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_761dd3c89335
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7683aab6ab63
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_76be7cbf76e0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_76d429d8654a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_76fd504673c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_77260cc825f2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_775dc9513212
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7773b4fef920
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_77e955149f86
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_77eda258b429
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_789bcb2cd33a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_78b6206ab7c0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_78c8302458e3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_78e0266395c8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_78e2e2d52592
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7a1d46c941db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7a3ac5e2e33b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ae346cf94c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7b7fd69b9869
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7bbb12d2b1db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7bdd19000138
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7bf50f063792
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7c443aa28f58
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d4119931468
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7db68a13d9f3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7e194ec15440
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ebf44990c42
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7fb6734f69f0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ffb420f73af
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_80e7c49cc998
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_810571d8b6b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_81f65a329869
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_81fe3eb12c04
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_820dbd92b055
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_82c638c29d42
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83339ddd1523
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83862836cca5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83afe3296b4e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_84042dd775d2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_84dfeb0e915a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_863d500f9949
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86426055374a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8660053ec7b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86bdf70948db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86d660712087
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86f58231c0f3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_873d422f52f5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_890720d49bf4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_89b209c35e62
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_89c178bd4d5c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8a8a4bf47f1f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8afbd39b0fcd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b656df51766
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8bb7e4af36bf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8be66d2b0403
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8c3e16c4de89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8c563914cc9d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8c8f745feaf1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8cb706757fa0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8cd33b590f41
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8d5f16ccec26
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8d6a5d2b60ef
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8d6f6430348a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8d9c4f3a8f29
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8e02f77387f1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8f413a447433
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8fd7fe8dacd9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8fec696d9800
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_902794fb60ad
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_90c3992d1731
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_90ec5271f59d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_914ec3c90338
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_91b27551f631
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_91df2eef7550
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_922bb79e494a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_92b8a544f2ef
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_933c490de429
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_94319e2dab91
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_94ede69aea14
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9635a206f96d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_96b7b2038248
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97717402bcdd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9901c770c7f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99122f4db16c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99992ed3b894
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99a1b47b4c67
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99ea33902ece
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99f9f6ec8232
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9a06e9ec56c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9a7cdf49a19e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9b12837e0efd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9cd72c6f271e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d27254ad817
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d4645c49e7e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9dfb59e66cd0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9e7132e9130f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9f7aa9c98170
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9fda9e30dde6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a0fd575064eb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a1d20997e440
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a22c27f864d4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a25bda154156
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a2d76090d3a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a30796246d1b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a3b05506a83d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a3b53dcd7894
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a401ddc43f02
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a45ef3254a52
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a4b3a2f34b9c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a4b861bf9d1d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a55d2e8899f5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a653867c8644
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a6ef4c38b971
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a73f4d9cda61
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a8775a2147e8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a8d2f193e6bc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a8e15ec75622
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9255822ef1a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9d08448bed8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9ff491b08d6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aad98b62d6ea
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aaf90b3988ed
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ab769c1f2819
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aba5a9383251
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_abe479a53379
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac04fa8fa610
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac2021f906db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac23b38b3df7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac48b319d18a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac563c287ccf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_acaa7d973f24
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_acfabada22c9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_acfc53c3a692
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ad1702ceaecb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ade5e260a178
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ae56251c4605
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aebcaf26d260
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af18c90d70e1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_afde2108bc42
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_afebba4e95d4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b011bf38b541
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b02d9b328a63
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b1153f215c93
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b15fa4219c2a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b21aa523b1c4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b2408e9bf02e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b288fa159885
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b2bd2442ccd6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b320cc63c965
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b3db8f161f5f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b47ae0212505
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b483f54ab1f0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b4e97b992fc5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b50231bdaede
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b536e1254b00
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b58eedeed006
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b5bba89e72c9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b5d4e2ec48d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b64c73cfd328
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b6584da35516
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b6590886ed85
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b67312a9d4a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b67ed249ca9f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b74f5af4bac5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b7910c83a2b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b86e73279d51
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b8f37ea87e69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b930a307d19d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b9582abf0b27
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b965955064c2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b985db58c45d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b989bfa78007
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b9a18f2d8d05
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b9b755bd0c77
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ba1f66591ba3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bac800d53fa2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bae7d2f2ff83
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_baf6dca145dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bb06bb6967e9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bbbdad9b5883
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bc1d085ea66c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bc8cca40d4fc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bcbec778722b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bd87b63c0fbe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bd8a9204c57f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bd9aa6341fdb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bddc73ad8389
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_be60a049457a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bec176208ce5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bf51fe047ca4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bff69f7e15cd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c07e274187f2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c129cdb919ba
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c146b693984a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c29fa5fa4459
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c34142bdc704
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c365f3db463f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c41d3711cb68
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c523638f9c37
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c576c4066702
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c5d948ecbb19
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c7dc5cd4f008
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c808ba55edea
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c8567d488865
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c8fe4c061352
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c96492b7d8fa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c9ce378328ee
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ca971feb72b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cb05d4f23212
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cbf9c7d66fe0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cc3615136095
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ccb5f42c67f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd063c7299ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd5ce5d68d7b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd9645f57319
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cde51a55da0f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ce4253b4ae6f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ce60ef31a372
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cf6cabbf5672
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d153e9b786d5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d1ce02ab9722
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d2bb43c47458
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d2fdd79a4c0f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d3558815bc31
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d359cf60802b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d37a7f3c0d56
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d3b3c3bba9dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d3bb475ecee1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d431bd9a6f67
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d47583dfc99b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d48f1c20b318
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d49ba57574e5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d4ae6c1b46bc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d4c98df8c267
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d4dee9b6baab
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d4f7ad6f5aa7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d53ffc24b302
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d701bf75f907
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d9ae4b9150a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_da0d0bdfd594
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_da4a88882a90
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_da9652bf6c71
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_db586bda50ba
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dc2fb7f19d88
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dc353881a035
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dd3764af82fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dd9253b25060
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ddfc8d88519d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_de16aaa574d5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_de61fc77528e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dedb93accfcc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_df317913ad22
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_df39d816a480
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_df93cb0e525a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e05771f94acb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e1411f3b3902
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e17a123c5a68
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e1b16bcc9c1c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e2b9f2b1661e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e30efcc2b536
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e33d279f07ff
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e4552af08b00
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e53e3aa37de8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e53e8ae89598
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e5453e6889ef
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e609f2b34c54
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e7530a83c4db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e7e3b8a570d7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e8456684d0ad
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e8ad4dd06b71
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e8c91f9366c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e8cac0643e2c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e923ddd15e4c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e9fc39d9c4d3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ea5544d35d8a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eaefbcb2c3b5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eb286e4f6611
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eb8da3029ca5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_edbfc6a1f487
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ef03e15219d4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ef3d324ed0ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f07ada99103b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f097077f3250
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f0f92d7aa17d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f1a661b47520
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f1c4be50b4cb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f1e72d28fb90
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f1fd4292435e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f21d82265f4c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f322dde06506
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f39ffd6153ec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f4091599c7a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f49828849490
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f4b05a3ce708
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f57c431ab15b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f61de863aa6e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f6ab447ef8be
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f6d9f090be28
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f723acaaf1a5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f808572b73ec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f865f9aedb8d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f8acc03eec2f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f8afbf80a299
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_faaf7229814f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fab181191cf5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fac8427d9478
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fb250a67e3db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fc7c464db282
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe05fce920c9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   └── system_state_timeseries.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe296c3142d6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe5078800150
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe7299281260
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe8f99ef7f57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── repayment_events.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fee4e9f962f1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ff3d599ef335
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── balances.csv
│   │   │   │       │   │   ├── dealer_metrics.json
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   ├── inventory_timeseries.csv
│   │   │   │       │   │   ├── metrics.csv
│   │   │   │       │   │   ├── metrics.html
│   │   │   │       │   │   ├── metrics.json
│   │   │   │       │   │   ├── metrics_ds.csv
│   │   │   │       │   │   ├── metrics_intraday.csv
│   │   │   │       │   │   ├── system_state_timeseries.csv
│   │   │   │       │   │   └── trades.csv
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       └── balanced_active_ff7a9fd9e314
│   │   │   │           ├── out
│   │   │   │           │   ├── balances.csv
│   │   │   │           │   ├── dealer_metrics.json
│   │   │   │           │   ├── events.jsonl
│   │   │   │           │   ├── inventory_timeseries.csv
│   │   │   │           │   ├── metrics.csv
│   │   │   │           │   ├── metrics.html
│   │   │   │           │   ├── metrics.json
│   │   │   │           │   ├── metrics_ds.csv
│   │   │   │           │   ├── metrics_intraday.csv
│   │   │   │           │   ├── repayment_events.csv
│   │   │   │           │   ├── system_state_timeseries.csv
│   │   │   │           │   └── trades.csv
│   │   │   │           ├── run.html
│   │   │   │           └── scenario.yaml
│   │   │   ├── aggregate
│   │   │   │   ├── comparison.csv
│   │   │   │   ├── dealer_usage_by_run.csv
│   │   │   │   ├── strategy_outcomes_by_run.csv
│   │   │   │   ├── strategy_outcomes_overall.csv
│   │   │   │   └── summary.json
│   │   │   └── passive
│   │   │       ├── registry
│   │   │       │   └── experiments.csv
│   │   │       └── runs
│   │   │           ├── balanced_passive_0036f41958e4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_00f62e27b8ff
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0105e872c147
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0149bdd178f9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_015acbe0261c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01630ed0bdf3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01baa96f8bdd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01cd1d841f20
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01e34732e8b1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_022fc10aee0c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0284d38e23c4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02a355c5a77b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02f0dcfdbb5d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_033b796f515a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_033f64667512
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_039318b83e96
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_03f36826320a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_04108d82cfea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_046603dcc5d1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_049dc155450c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_04e3e50d95ca
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_05024359fac1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_054ef808628c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_05946c3824e2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_062e04b0425e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0663d736a45e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_06a43f82deab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_06a6825a4d9e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_072be78c66c9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0754c019a4c7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0761d276a7e5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_07831a326084
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_08ab500aa517
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_08bf975a1163
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0a7ebedb8b34
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0a84438b31ef
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0b1f5fdaf3e0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0b4c1a8a387d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0b4e1964ae64
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0bf5698aa559
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0c14c8a07483
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0cd10a529045
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0d2a2bbc6f6a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0e5271ebf1b8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0e7abda66c8e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0eb5e9a81e94
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0ecbcb59d02a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0ed093499d8a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0f13f7c63b0f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0f4f4a3544f1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0fa7f0b9dc22
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0facbdb174f6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0fc04cd9fe9d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0fd22beccf26
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1044e353410d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_119a246b782a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_11af5dc6a91a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_12a9a98fb3e2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_12f6bd0853ca
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_132af4ecf51e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_13e3ec069200
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_13e523ab7e44
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_143fdc69e044
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1481cd246321
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_152f45643b3e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1579c06b4dd5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_15e7a7e6f9c1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_176f0507f292
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1797efcce325
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_17ae33111150
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_180e9a067323
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_182305b7bfa3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_18c6616be540
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_18db1a817f9b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_19987e10d881
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a4255a36e9a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a70805ed2df
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ab1abdf4ae8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1abd9117f105
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1bc18978d807
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1bcf259b4f7d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1bff3b4109d6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1c337514a87b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1cac5fa6824a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ceebcff26f7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1db10e16e805
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1de6e4bc47cc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e7b163faa3e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1eae32cb7fa9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ebfe2623de2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ec805b8665c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ecb61b4d944
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1f1032975136
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_205123c1cfc9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_206bfad80f75
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_211b5e22b753
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_214de446b65d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_215651f7e084
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_217a4fcb14ab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_218668e078c7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_22275d9283c3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_223ee60da2a6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_22887cdc2bec
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_22ec05fefe08
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_22f68c6602c8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_24444bbfe670
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_247391948f4d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_247827591495
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_24f3e4d6a58c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_254696c8ef25
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_25738c692284
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_25ba0c7884fe
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_25dd5a2e6ae3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_26c6253eeec5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_26e4c7efdac7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2837341ba8cc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2898ab6b4ce5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_28e1aa6a65ec
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2921c19c5bbf
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2a224ed7b85e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2a714a4d2f50
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ab7a9ccaa53
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ac28b872a3d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ad31c37b351
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2aef2ceee82d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2b853fd3ba6f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2b8b82682b08
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2c73afe1bbb8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2cb605b931ac
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2d53c91b7814
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2e607553ee29
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2f146c4e375f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2f6ab18bd63b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2fb6fb8528a9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3078a2c825d3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3186189c9586
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_33984859abe5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_33f043f41392
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_34851c37ed4f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_34a0d564d192
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3507c9aa065e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3548c81d62a5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_358185f8ecc2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_35950897ae11
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_36166ce55742
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_363464aaceb5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_36e75a000aa3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_36fa3e53c65b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_373e888cd20b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_37bc4d772119
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_38622be750dc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_389cd58c943a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_394aa7b3a419
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_39583423da24
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_39c3bf001507
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_39ce6d49dc98
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_39fa639984e6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3c79ac9b1032
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3c92cf60fa2f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3d58212bf529
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3d66598c9d2a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3db60830e81c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3dea519ab6fb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3dfe0f495554
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e0a14cd5dd4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e4238ecb82c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e520509078d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3eda45c6ded6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3f04b740e6bf
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3f6997b51cd0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_410b8b954184
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4166a5793b22
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_41ecd801f67b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4239387bb004
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4240df5b87b3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_44107f3402e3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4572e9c2ac0c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45a8f5bbab7c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45b33fc4e8da
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45c436d6b48c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_46028ff0b6f0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_462f66eabcb3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_465efa9fe7f4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_46b763118f9e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_47ccc3421d8a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_482ecc75aef1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_484c5fbbd9b6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4900c8edf6f1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_499439a242c0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_49a5a46b038b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_49c5f4dfbedb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4b262c536c4f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4bec93291f99
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4c320e1adf10
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4ce3bfa87bd0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4d2321b862be
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4d3234196691
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4e533b1366d4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4e59404e65e4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4e9bcbaf28de
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4ea71df71b2d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4ed0906bd6fd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4f45e8ec0e64
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_50236b41e3da
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_506e5392983f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_50ea1b9f1157
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_513dd2417ed1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_51932e5f9270
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_52110b6c2e0f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_52d2c2cbfb4e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5417a51706fe
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5507ac39b15c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5567de300b5b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_55e74d59b90e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_56ce89724ef5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_56ed593d0a78
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5708c644dbec
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_576779d7fd69
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5819811aa1ec
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_58d562a9168f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_59058ee082ea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5bb2000a6f5f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5bd2c4eb0b33
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5bed3693e453
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5c179b57a536
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5ca2a5abf456
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5d418798f4c9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5d4747853aa7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5dcf846eacfb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5ec2c0624896
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5ec404ae4b09
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5f071fdef9d7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5f083e32fc4a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5f1c2c6f0509
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5f3210512b6f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5ff3c3f091cd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_601daf049f94
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6023d2582acb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_609f6d0e2644
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_60a5bff38eab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6175a376a698
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_624be91ba407
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_627b53817736
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_628c3c89d309
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6293e6326346
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6384bcd7946a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_63d7434c2f33
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_647849370428
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_64ca77daeb37
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_652087b4e030
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_665e2dcabd3a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_66c5a9539e97
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_66d465ab4f4b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_67bdcff43a25
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_680dd19abbf5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_68514a7fc82d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_689d477651a0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_68eef70cdd84
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_69cec3777bdc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_69e4b3719717
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6a0654f0d2dc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6a38742eb285
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6a4e74f2a011
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6aab6b1003bb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6af47ad08879
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6b1f8519bdea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6b621f44be1f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6bba0f7ac361
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c1974de0840
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c40d4c5026e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c55988b7f6a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c882f5708d9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6cc2c47c8ef5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6cd04cc78985
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6cd7480be9e9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6d2f3706e7cc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6dfe77d4ce08
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6e0297047b9b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_700307b485d3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_70d122ee31eb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_71646ab0ab79
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_71975cab1ba2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_723618c40047
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_72abd0247433
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_734b426a51eb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_73662a38b410
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_73997136d30d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_73b2c99e9961
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_740452400e43
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7459860f6356
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_746632e33470
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_74c650b80848
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_75974f008977
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_75b6d4532903
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_75c018ce7a81
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_761cf788633f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_763bfc658f43
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_765c1ac33f5d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_76adb312f4de
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_771957d14081
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_78782f7a9ae1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_78b6856fa594
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_78b81bdc4ec8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_78e367e57718
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_78ea8a3d5b04
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_792286ea635b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7a692221c9bb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7b8b12bd7bab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7c6cb7cc5082
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7c71b25cf763
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7c809943ca0a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7c91a16c1f2c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7caac3b0407f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d2d2ab0c8a2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d775c42c83e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7e5ab60c14c7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7ebb07b1e8ee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7ec76dc2e380
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7ed0fdd7bba3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7f090c9a856c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7f234f28354b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7f3d4ad2d8f6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_801114d6b3b6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8051d56c24f7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_80af5acd0957
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_810b9e7a0937
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8179c4602a03
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8191fbcbf560
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_81b23ade895d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8281da193959
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_82fa491d67a5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_83622a372d24
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_83c1bc1d536c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_83eb81560d5c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8461693acbf6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_84b0b27ae8a3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_84ca2e77f091
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_854a67787de9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_85a93fd4919e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8631a30a80bd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8652fac7ca05
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_86b0c15e71cb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_86bd07c65acb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_86ffbca198e8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_871fcc9c2d2f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_879534cd4022
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_899b62dfe698
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a1c72d55a53
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a30f77865df
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a39ca5798c7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8b1e02690c8e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8b3f1fdc2535
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8be502e979b6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8c0a0b617d1a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8cb2f1c4454d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8d2ed0bce136
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8d98b13f47a1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8dc0df3d3a8e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8de945da629b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8df0035b488f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8e0aeee0cacb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8e30dec5dd77
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f54e755aab2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f8823bc6375
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f897775bf48
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f8d140e8aee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8fc42ac84a88
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8ffc32223b0f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_901019084e8d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_908863469d3d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_90895041852d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_911c5402842d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_917a6fd69fc8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_91d648ed89fd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9221aa906d9a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9271f5c00533
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9276ac9f7ee2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_939c9113d0de
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_93a549bf4fd8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_945918bafb03
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_94b7760a192e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_953c2ca58231
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9549bd9b3e01
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_95627d30d76e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_958da1f6e79a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_95cf83d7e0d1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9606f0f108c8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9654c63327e5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_96ef31d83760
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_97554461c014
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9784b09a9fc6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_98575c603aa6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_98d91a9e4fea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_99335f7bf132
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9a06146f1187
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9a8c54dbc25e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9b493948e5e1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ba8d5c4285e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9bfd2951c58a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9c144e8163a1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9c1ed049fb30
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9c3385a59f72
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9cb6cd6b9e15
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ce50d523481
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9e243fbed346
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9e8505bdf9e9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ed49a582d85
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f4ab378dd0e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f69a36de612
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f872e9bfcb3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9fb1dac2e95c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a0848c76cdfd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a0d83e5eddfa
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a107158e05b7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a10b0b2b0ffb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a154e3836579
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a1c29e8cb4d0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a2c17975bd21
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a2c6d0081710
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a307c2bdce98
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a308009dc3ab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a3199fb56de1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a402d9e94d89
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a441f8d3c28a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a46bea5ff0a2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a4f9169df9f2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a4fedef43aa2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a52aa367d784
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a54400ebf91a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a6c4bca6916e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a76e62856bea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a81c76fe9ab7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a86126d5ef49
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a880ba6d4d8c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a89a68bc025b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a9130d29fc40
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_aa99c1df09b6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ab015df4d4fd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ac13ca7b7d6f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ac64b0c18837
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ac9989a5616c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ad105dadc781
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ad252d82bf53
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_adbc18c333dc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_adc642936b7d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_aedb2a81be37
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_afc1fd9b3d4e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b0ff5d7be96a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b18d9f443291
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b1a82f0cc25a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b1e34210dc3d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b30722d64c83
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b337980c24b1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b3571de84a5d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b365ff728fdd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b3db5ad926e2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b50d4b685561
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b57b77ca1ffe
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b60e1742c91d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b633b2279604
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b6cd9bf7ed23
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b73a239fe2c0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b7afe70ed0e8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b84c10402b93
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b8f0101d9fab
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b93486cb0f67
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b9cab960a665
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ba6d0bb3db5b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bac7dfac17d3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb2efbdfbd1f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb4d0fae15b3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb5f911bf9e5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb98b75e78f4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bbbfb31a5a9c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bbd156d2949d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bbf3f9cd70b3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bbfcf70ec8b4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bc27bb6f76dd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bc45a4a7c254
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bc4eaee1c8ae
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bd9b09efb81c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_be14a1cff0f1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_beb327c71426
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bf87d61408e7
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bfbe39bfc8ec
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bff00b32c601
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c02e3ed58f81
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c03f76af7a5b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c085c50bfd47
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c0ccd4706aa2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c123c36d9b41
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c1a5ec92ddde
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c24ec27cbeac
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c2f5873bbba6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c2f96f2f6220
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c31d6fe728b9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c4f1ec81f7dc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c4fad9099679
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c510bcb8e91d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c52d6c4aa0f4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c5851d839749
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c59742bf8464
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c5b455bffc9a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c693e9ac6ea9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c741a642c7b0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c81b19a0d839
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c877734a14b2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c8a023e7c071
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c8c845f1eb64
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c98dc8cda78e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ca9140753bc1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cad0bc04f5b8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cb0dd3a5362d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cb303b778c7b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cc0e76a620a4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cc5ae8d40a74
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cc72aabccc65
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ccd68d27c570
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ccf1cc61065b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd1f7290fbf8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd23c9b65db2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd42790a234d
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd5cde70ee54
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd6edf17cc79
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd760d3a5877
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd95698a15f1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cdac0fe2d88f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ce81e16e4b9b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cf243b1989bc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cf746c5868fc
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cf9aa285bc9f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d02203f8b3e1
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d0c728bccd8a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d2402f80b4a9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d2b8e784573a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d32c242c3490
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d33910ddf3b4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d384bf688dd3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d46979e5f27f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d61ed96b0475
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d8015006bc17
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d82016f215f3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d842c6e3309e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d89abde0cd49
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d94fb0cd0f4b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d994b150d7e9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d9a6607db45b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_da72a6363013
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_db3c3cfa10df
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_db4a4011e515
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_db77ca289343
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dc2d5853cbd3
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dd703679369e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dd9f105fcdd8
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ddbbd0ce2ec0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_de53588eef2a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_de6a00bbd023
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_de9a99a186d2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_df4d3c74f474
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dfc880a9fa84
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dfeb796bd66f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e1c4ecd15337
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e21f8b1e7071
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e231cb054da0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e2b5c0b11085
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e2c538196c80
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e2cb78d98c02
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e33b3ab3e334
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e3c73e48fa05
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e4efd93bbd85
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e597d9bbeef5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e736c223affd
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e75e0e3b1028
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e76ce9c9c910
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e7814b97b87a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e799579cc801
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e7f9535079f6
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e88bdc9b9221
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ea75a8a18e71
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ea761d143344
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ea795f3c30fa
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ea8572200d20
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eab0b675e939
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eab5cd83c5ed
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eae7af8c6e3e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eb139ade7b05
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eb3ee39a964c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ebc8c6abe7f0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ec3b28358c43
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ec956188bbf2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eccb781c6658
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ece2aeb20948
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ed8ea3b3c708
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eda7ae986bca
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_edad300e96db
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ee759ccfdaea
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eeb8a7e37727
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eedc0685bf2b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f03bf34e91eb
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f13de689b3a2
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f18ed36343e9
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f212978ca07f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f23086dd1967
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f378bb9fc87c
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f4817f208aee
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f4aae799566a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f6899215fd3b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f6b40d7ce895
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f73602316324
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f791d6b661df
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f828f8fcc30b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f882a62a263b
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f9027eef6f03
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f923c829b85e
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f98ccbe30b64
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fb44d54bce1a
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fb589c9252e0
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fbadc6415f75
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fbbe4389e0b4
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fbf483242990
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fc56caf6ac0f
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fd63fb221f47
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fdb14baddbf5
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fe1346f61121
│   │   │           │   ├── out
│   │   │           │   │   ├── balances.csv
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   ├── metrics.csv
│   │   │           │   │   ├── metrics.html
│   │   │           │   │   ├── metrics.json
│   │   │           │   │   ├── metrics_ds.csv
│   │   │           │   │   └── metrics_intraday.csv
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           └── balanced_passive_fe8391bf37dc
│   │   │               ├── out
│   │   │               │   ├── balances.csv
│   │   │               │   ├── events.jsonl
│   │   │               │   ├── metrics.csv
│   │   │               │   ├── metrics.html
│   │   │               │   ├── metrics.json
│   │   │               │   ├── metrics_ds.csv
│   │   │               │   └── metrics_intraday.csv
│   │   │               ├── run.html
│   │   │               └── scenario.yaml
│   │   ├── expel_ring_sweep
│   │   │   ├── aggregate
│   │   │   │   ├── dashboard.html
│   │   │   │   ├── day_metrics.pkl
│   │   │   │   └── day_metrics_enriched.pkl
│   │   │   └── runs
│   │   │       ├── grid_006d41348aec
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_042589d16799
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_050c86b68635
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_051704f2e859
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0537e3310286
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_05f09fda3729
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0b54ff3bec96
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0cb226424791
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0e944bafe1a9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0f03d3bdc6c1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0fc483729f40
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_12af65493eff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_160f8f62879f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_19b97e7ad3cf
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1b0ea01668f7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1e47dd35d1bb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_23e60e153628
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_24e20fc157bb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2748db4bd801
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_27ae5b249da8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2aefd62b25da
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_30df28a10963
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_32629c607417
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_35766a24b362
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_35c7cb4e8e69
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3803b7e396ea
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3d4174fde5c6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3ffeff12bbbe
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_410e22148ec1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_428559365e4a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4786832d21dd
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4d571b6eb6bd
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4f2ad700fc0c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_514adf52a6ec
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_53aeaa37ffff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_54ffdf053a37
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_550091f08123
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5530efbac4e0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_56daf694bb61
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5b8e3e2455a0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5ce2c4a97d3e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5fcd180a5b61
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_602ba57cc959
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_61875012b451
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6228a1712695
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_644395de8238
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_660892dae0cd
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_66cd1328aaa3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6b21a646b017
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6b24da8274c2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6b4b4ba8e67e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6e070ede6e52
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_701152452743
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7097d49bce4f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_740fc433c5f6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_753b752540e4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_75f4135017a2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_798f39bbf8c7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_79f3bb44a77c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7b33d960dea1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7cb81b8b4a2a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7ede287eda4a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_805270cdb8ac
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_80eae6b1170b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8154380ebc73
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_86645f247c6a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_86b10a806356
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_86cb1909d962
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8aa30a7ec4ff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8f98e30bec16
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8f9e70b6f64c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_91912fcb2aa5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_93bcfad8aa3c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_940b0446f126
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_960109748030
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a53fbda38a7e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a6d5878ab3ec
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a7e773a659eb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a82e6c4efb4d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a9f4a770f506
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_aa85832d6eea
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ad64105bb027
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ae1e63b5e4ac
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ae33b1898498
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_af3c32442e69
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b08bd74fb517
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b2b7a9a8d184
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b31830206c54
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b33ceb3a0650
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b50115813401
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b8cf5a4b522a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bff07f9ec223
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c005953cacad
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c25b833dc292
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c294fec46eec
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c3f0a92d4408
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c413020d3597
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_c7d9c103bdce
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_cc0dcad677b1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ccf386fc637b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_cd90abfa57b7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d057539adbb6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d07f6244325e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d85d0565c63f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d8a0ac2ab31e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d8d791586e6e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d9a8f05bde19
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_daaf161cbd43
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dd967009cc04
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_de1ba34ca385
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_df2217276f6c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e05ff9d7b0a6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_eb5b86349948
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_efd13dbdaf2c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f0259cc19595
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f1f504139a0b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f2b48f7dc492
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f2d8c2870241
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f2f65b5acafa
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f41b64e0d149
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f56c164e8cae
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f56ead5480de
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f77db6e718a8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f9c955df9fc0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       └── grid_ffc291593855
│   │   │           ├── out
│   │   │           │   ├── events.jsonl
│   │   │           │   └── metrics.html
│   │   │           ├── run.html
│   │   │           └── scenario.yaml
│   │   ├── expel_ring_sweep_clean
│   │   │   ├── aggregate
│   │   │   │   ├── dashboard.html
│   │   │   │   └── results.csv
│   │   │   └── runs
│   │   │       ├── grid_00410d2b687b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_006b6c41a7fa
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_018a1c5f7ea8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_066e8da4a0b0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_08014e390505
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0a7a3622e9c3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0c313392f468
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0d17d7a9a4e5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_0e1d86cd9956
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_102d8cc14db1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_11150d093732
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_129917105170
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_12dbcd40a481
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_19374760cc4c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1b39d3f4cf3a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1b7133707e7a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1bee699cb4b4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_1c3be46b2abb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_22d8d3c750fc
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_237e1b876441
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_257b27ad2ed9
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2773edb4c87a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_290221ea7f17
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2c55012117f7
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2d721910430b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2e660a3e24c8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2ef4d880c083
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2ef805654d89
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_2fc9765993af
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_30c5c655e605
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3a9c6d936a84
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3b7508820cb8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3c37a33fdd9e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3e87ece71250
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_3fc877063beb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4045a599d04e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_40888e2857ed
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_40a364ee32c4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4470b615c48d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4556e4562a16
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_45e9311f90df
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4732b91411bf
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4c59468dc273
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_4ec5160a68f3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5008acc18675
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_533f006db4f5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_55548165511f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_55f3370ef1ff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_583a52e45214
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5ed837a695df
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5f13847558fb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_5fbbc9e12f24
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_600907e4aa39
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_62c9a2849ccf
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_639428fd0367
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_645c8f81bf3e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_64ea298613b0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6c4988b036ff
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6cf591bffa18
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6f551e36bf3b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_6f9cfc3ec55a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_707a1112069e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_71765b3c7a86
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7210a81cd059
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_75b83d0bac6e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_7617b8693185
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_76c3c3310257
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_77d82f0fd29b
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_783bcc642f4e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_815778229979
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8256fa7be6cc
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_83253d47d089
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8347e92db7b0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_84df6d3bcff2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8725e4a9df8f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_886974c4496c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_89758a91aeca
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8a0527088dd1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8e36cc8eba0e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8e84d73425a6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_8edbcfb238b3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_90ff3c320bb2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_93343d23bdfe
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9912027d194a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9d2972753ad2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9dfbd45c84a5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_9e0a6b8fbea6
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a435478513eb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_a7082650482e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_aaa44fbf2f1a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_acba38a4f05c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b00b769ae017
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b23ed08b65bb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b277f3d2cd7e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b6c1c8d4bd2f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_b87a4bdeb0c8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bc2b877c8df4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bf58caa231b5
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_bfa2b8fa0a2d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_cf6b11810764
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d192d529f1eb
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d441c7884bfe
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d472eeac89e2
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d5af1b10d79d
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_d9e67822d110
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_db1e4b21ace8
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dcda64803aa1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_dce370742800
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e373aed4f35f
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_e64b299a3d1e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_eb4771dc8aa4
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_eb80468d978a
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_ef2b57d3ffd3
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_efa113f36474
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f23678c41ca1
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f264dcf7edba
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f265ade9b6be
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f57a67a6746e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f5d1e86d6c2c
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f674ba5c04ed
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_f77310adb9f0
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_faecc01af6aa
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_fb296d8db56e
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       ├── grid_fb48bc998728
│   │   │       │   ├── out
│   │   │       │   │   ├── events.jsonl
│   │   │       │   │   └── metrics.html
│   │   │       │   ├── run.html
│   │   │       │   └── scenario.yaml
│   │   │       └── grid_fdbdc24e39b9
│   │   │           ├── out
│   │   │           │   ├── events.jsonl
│   │   │           │   └── metrics.html
│   │   │           ├── run.html
│   │   │           └── scenario.yaml
│   │   ├── plan023_sweep_20251208
│   │   │   ├── active
│   │   │   │   └── runs
│   │   │   │       ├── balanced_active_01bcdbaff53e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_029a6407b47b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_03b04e6053f1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_049137ad1564
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_04be49f25aa4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_04f976ae2774
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0574b3f139e2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_058a2cfc9c22
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_06d0e2eaa7e7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_072f344efb14
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_07544a19e9a1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_07a61ab9abc7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_08d462a6bd8b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_09c93a21df78
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0a26c1dfe103
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0a399453aa2d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0a4e3eef6f4f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0aa2e8ef63b7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0ad17316fb62
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0afc08037825
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0c28b7facd48
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0c8af724fde4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0cb9d742a687
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d33ef77f43a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d7e7d017965
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0d9db2eef42f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0db2bf1253d9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0de21dcc9f19
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0ea8a8dee003
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0eaa24918798
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_0ff9bb266122
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_106d5d7fa173
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_10b1115b990f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1132376c68b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1149e9a293d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_119f1d131a41
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_11a163a52f2b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_12ec9a490230
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_138046ca06f5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_14c3860e6ccd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1522149a00fa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_153b5f2c537a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_15a033b37e8c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_15c6be4c282e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_166c81136995
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_16c027bc37b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_17016beef26c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1785dc6acd68
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_185e38a78b5a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_18beb14e6dfb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1939de9f90c4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_19a6bc80dea4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1a3f44d436ee
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1ad4dd3dbf59
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1b8475270159
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1bf129819462
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1c131b9c2309
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1c8d262472a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_1fb2c220fa2e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2027d678a8a6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_209cec27581a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21147ebc65a4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2132df2bc6dc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2141bb29cf32
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21b918a8d636
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_21d384d4b002
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_228e523b2c50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_232aefff4806
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_233ba0e1763b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23426d383d7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23a96ecd39a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23bfd8574324
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23d0e79b8f72
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_23eca9e427d8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_254ee0d5de58
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_25ae6555423f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_25d2cf9e9ee2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_26a6f416034c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_26b9a3689d38
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_26dc6fd22f3e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_272594dc71c6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_27e973f6f645
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_27f2472d3f3b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_27f8d66ebc67
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_282877bda9cb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_28691b9f0e7b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_286be0cf015c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_293c9104a548
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2948a0d48547
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_297cd8a63e9c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_29d6b00be78e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_29d8afcfd4c5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2a42402095cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2a922a73bb55
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2b284f5c319c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2b3b8d0a4a66
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2c09e005503a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2c337bc73acb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2c8b815dbdad
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2cfad8eb92e0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2db43a37a956
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2dd9fbdf9830
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2e17f82f78f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2e4705213ec7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2e5a3bec5e6c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2e742bd1d282
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2ef4b7de1093
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2f0db0274d4b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2f2d6efc20dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2f3091c76976
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_2f5607417de7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_313066401427
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_313ca7a501f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_323160019ebd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_32b34dc21047
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_32ff7884570d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_334b3a98b17e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_33ac03661c09
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_33d58d7f9630
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3448860fa33b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_34abfc857d0e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_34dda91ffe36
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_34eea7c346a6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_357713702635
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_35b8add343ec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_362c0c1973bf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_363f5a54f384
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_36d045c74362
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_37666a626433
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3784c0f4e846
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3815b89edfb6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_382c1bb6a4c0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3861de21e2b1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_388a1bab9887
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_38d852aafff2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3904cfe13971
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_39469b7f2bfe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3996b96d672d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_39c06cac7aa2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_39fc0bdeebd2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3afe1890a88f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3b0552e18d0b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3b419d87c7dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3bc37749c1c0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3bd220b5f5f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3c9df6fed53f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d12009f5b75
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d37af9c8d69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d3c31ab43c8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d7e09920795
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3d9fd300c9dc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3ec4e70b5520
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3f112ed1c003
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_3fff1e73d047
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_402364c3f1a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_410cfe7ef29f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4149a4091975
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_43410f41f735
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_43df92ba1a43
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_442eaae7be8c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_444161c2568e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_446b507b8e32
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_44a0b646336a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4502d3c2a8b9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4591892d4df7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_459f54014b1e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_46f8485745a2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4711d4d6e8bd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_479b52a04c08
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_47df0d5b8490
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_48015304a8ad
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_483c81bcb418
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4896ddcfdde5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49563c802a46
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_495b5b7c7b01
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49ab2938456e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49b25cd7f997
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_49f82993a4ac
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a07a99ac235
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a2d0377d17c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a31b1a90194
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a32c592641a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4a8ec3997ddb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4b3c66968ebd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4b48e0bb8da6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4bd0e3b95a26
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4c7e1bbc0b70
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4dd1fe450f08
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4e47a3afd2a4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4ed1e8122220
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4f70e6b7dc26
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4fcefa739cf1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4ff1e9b74f92
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_4ff385b1c8b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_50643b308179
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_50fe89bd5893
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_51146c02f524
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5128702bb7cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_524b1e4741a6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_527419c1f9ba
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_52a8deb886cd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5302a6b4a161
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_544e860ad3e0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_544eb0617142
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_54535d0f3c12
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_54d69771c899
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_568a8ed711af
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_57f4a940bf1d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5846c2530f4e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_584d23be3835
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5879f75fc8d9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_58e73f739e1e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5af01499582a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5b13fdf4ac70
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5bdf94bbfca7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5c957c8288a6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5d028bc5185a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5e2d27c21285
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5eaf77c8f4ac
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5f138b261778
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5fbfb18a7f3d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_5fc52674d993
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_600f02cbed80
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_60122ebc3230
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_601f97f2c9ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_602c8ac4408d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_605157517a33
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6068270138c9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_608308e06a65
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_616317ebfba2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_617d15b3b6d4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_619768e07fc7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_619a3ba64276
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_62c666fa205e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_62eaa311518d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_62f8238a60fe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6320937451f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_636b4c28f8ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_64238347cddb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65309a45d41a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_655716adfe95
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_65b6d0403c02
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_66f501887bb8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_67458dcd4046
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_67fea621bbc3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_680c2c5c4a14
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_683e9f2c9c7a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_68954c3534dc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_68a0fdefd347
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_692b257a8f57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_698304480a33
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_69a435770bf5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_69b47016b297
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6a38e57b2a50
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6a60b7a346fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6ad41730247e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6b18de9032de
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c3419293827
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c55618d5818
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c6c4de4b221
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6c99b2db3618
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d0efb6acfc8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d2f715162eb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d37f0bd9dd1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6d4a88f1c436
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6e0948fa6b9b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6e8b8aef802d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6eaba7464add
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6f675f23d030
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_6ff59943d40f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_702b6ed8ff40
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_706c81ff11a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_70c0b88ccba4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_71098cff6f0a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_713327d6334c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7201284af609
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_728a7a209655
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_72ed24407ed4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_732b075f7e46
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7331328afc77
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_736ebf9ef2c8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_73f61ac52d88
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_74cfcbbf78c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_74ef586c3417
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_75fdd8499c25
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_75ff99206c97
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_774260a652a5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_77733a96faa1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_786f5014c7d0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_79d987836579
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_79f06127c0c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7a36640a8f72
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7a79768cf785
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7aa278e9146e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ac47e37f203
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7b1d6640efd1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7b68fcc8fecd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ba9059fcfd1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7c1aae5c94a2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7c4a44fe6f1a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7cca5b3a80e0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d1a62d94c37
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d524c60e743
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d593154f70a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7d91df51e045
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7dbc7697c658
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ddb039722ef
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7e661603abcf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7ec256b4ef88
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7f0f25fc444d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7f30e92bf40f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7f866ff40814
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7f8fa2e5029e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7fb05d9fe7a9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7fd172fc96b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_7fd2299290c0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_80cf2277f466
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_815126ddaad0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_81ac7da48957
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_81f71d13c911
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_829030339a61
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_82f053c900a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83085c6cf5cb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83180d680066
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_835f719aeb6f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_83ed95eb83f0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8420d9b49257
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8432c78c63f6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_84e498f62eef
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8559161e2955
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_859b1d02bb2c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_85fcd54ce687
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_860f14e848e1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_867bb3f4e6bb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86a0220fba98
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_86dbd4309d7a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_873152eecb37
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_883b52beed95
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8898f20f2ddc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_88f3b905f602
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_890e4cdf8813
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8940a5acc14a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_89524a22f1ff
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_89e93dd7ec5b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8a5aa8a6ffa7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8a70708461fe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8af4a7cfc902
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b76c2cd3399
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b96efe499a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8b97836f0e97
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8bdc354857bb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8c0016950ce3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8da7b40bf5fe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8dc0d27860d4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8dc1c786a4e6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8e3cdf858923
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8eda74156194
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8f88620c45fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8f94fed89a8c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_8fa0f03ef7e2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_902afeedb9f5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_90660ce13b58
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9118c587a3b0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_912f62e550f7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_916ef4ae334c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_918afc6c43d2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_926e7458ec7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_92c54b0d2c57
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9352f82dd55a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9365d8a12529
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_939bf3f2c889
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_93ebd8119b5e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_943eabee114a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_94797e101a76
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_95f07c1c1380
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_96205949cb32
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9627f695c7cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_96b07e03b3bf
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_96c4094569d1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97270195465d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97275b760915
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97832e90e97c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_97ac1a5ea18e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9834d2d4d939
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_989cf4796c26
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_98bd1c018b9f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_994c46598df0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99a7c6b3b3a8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_99f32c9baab3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9a3824ea7c1b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9abab0e49674
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9b10e575f559
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9b93d270eb32
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9bd0e46969b5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9c313b20d9dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9cea155619b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d01308939ca
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d11ae990090
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d42d2379c61
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d676aefee8f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9d7bbb2593e8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9f0218261cd7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9f59d5748ad8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9fc360ff9761
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_9fea3c967e76
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a01e769e8815
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a05d92c07397
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a0b47d747868
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a0d013c24aae
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a12192b463c1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a161d3f7de61
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a16b0d2ba07c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a16fea527943
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a257d9d324a2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a2cdf8ed23b8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a5ca3902bc80
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a5e72df20f69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a614a6e2ab55
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a643c52f4792
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a6f3750d4000
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a76b1b3f6d41
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a7b65165eff2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a7bf6b3e3f69
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a7e282a9b974
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a8308b364568
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a91b27a30e91
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a97788d1b0f5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9849b93e82f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a98798c62863
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_a9f50e270b3d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aa22b8f1405e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aa5f4ebebb1f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ab43712116b6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ab4f2f80fed3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_abe135938b38
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ac0bb928a686
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_acb8ca325e73
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ad29f99539f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ad6ddfe40b1b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ad8239f49610
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aefb9b6c9f4d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af17060f5dc2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af3b97d13b79
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af7d32ca941a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_af8663857a21
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_afeab3c0ad58
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_aff583da14aa
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b166aa886510
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b188d5e91147
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b18c5a273ba7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b1d85268eb7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b1ebd57b453c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b2bd1cf96fd8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b347aa4f1714
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b4dad6417b38
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b5073e72c810
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b539ed2b0cdb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b5a859052b05
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b63c66b73b5c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b65423251778
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b6952baefe71
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b78be3982600
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b7fa87d97213
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b85a6c5dfe46
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b86191f3a062
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b89fefeef3c8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b8b9039369bc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b8e70e432a43
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b96f1a911877
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_b9b239c1f67c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bc1d3542dd9c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bc3ab76f0080
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bdb35edf54f4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_be4d22e2f1fd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bf81a5a47967
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_bfb4ed672b20
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c005329edae3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c0401aff5ad1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c04dcb43015e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c06ad84c8211
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c1910bf10cdc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c1af9b13ea7c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c2285c796306
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c23256444b5f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c37a30284d99
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c3a4128783f6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c3a8e4e4c9c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c46834bbe94f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c5e714d5aa89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c619107e43f9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c64ac15f6223
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c69c973ca870
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c6def7c1c179
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c6e356d6cc7c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c7b694b86159
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c8ddb8744e6a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c926201dc988
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c94b253b51e9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_c9e8a7190e52
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cb4030437091
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cb5c161c7d5f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cb661e6b2725
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cc7ee77ffc1f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ccd061608fbe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd2777aae08e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cd29e736d841
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cda938cf9225
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cea4c9290fa1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ced09037defe
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cef6a454c6f0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cf27d0091211
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_cfa135a3a0db
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d01878da6b8b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d1d424dd9017
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d1f3a2b04581
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d22d1c81a7b5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d244d52c23a3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d2835f44c1eb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d2ba3e7932de
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d2de2b87c95a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d36d861b9051
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d3cd7ed0942c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d4203eb897cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d50901755596
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d5e0588294b4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d5edf9fc81e6
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d633cd45ef8a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d673c3d9f9cd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d67efd221121
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d68a53b53234
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d6aa1204c059
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d74f626147cc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d750615af8d9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d759762a17d1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d827c057ca20
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d907837bb1ae
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d99f04062690
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_d9a9f282f71c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dc1b39099a4d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dd9c3d931087
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_de0d015bc257
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_de1c030a6208
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_de638c5bbd7c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dedd7fcda513
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_df45f7db5413
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_df6ef7128056
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_dfb307ffba66
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e014b11a3eff
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e03a74844e59
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e04ed25eb77e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e140d25a955d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e18232a578ab
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e1879c803e7d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e19b185f1ff1
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e1b090265265
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e1e213833919
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e2deffaa5377
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e39a809706c3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e3c1006d2724
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e3e4e43f8f89
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e3ff178caeb0
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e427bd30d511
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e49b1ccf36be
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e51af9df5a02
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e5c3793dd034
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e5f66530593d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e6821c0ceab4
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e704b691aec9
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e750f23c5761
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e7951afe5eae
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e8965e649bb3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e972e184d266
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e999e25ec582
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_e9d5eba7df29
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eb2453423dda
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ebb6d946eb42
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ec61ec345dba
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ecb01f90a8dd
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_edbb9da01adc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ee08c62ffcf8
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_ee27f74444d3
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eedad280eeb5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_eef6b7f598ec
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_efacb720f54d
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_efd4ac19050b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_efe0b90dd17b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f0b2aed1ee76
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f0bcee2d13d2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f0d0d3f74132
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f0fbb60bf732
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f12efe26f85a
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f13fb8f91fcb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f280789d62ee
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f2e010b62d6f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f32804a67cf2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f341bb1aa78c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f43b6f86f21e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f47198a83693
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f4fbaaadd0dc
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f53492bc0d3e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f5aa40da2b8b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f5ff172ba9bb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f60fed3ccc5c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f66d40c39c99
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f675984bd698
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f67bd3952c6f
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f6d876619f3e
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f79e9b6b63a5
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f8b45dda7494
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f8d0343c7f46
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f8d698abe2ce
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f93d6913ff76
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f94e25c668e2
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f96288cacc39
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f9cc63d8ed93
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_f9f7063cafa7
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fa1f5e9f1075
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fb0fa2ec9beb
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fbbe9cfb9b0c
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fbe36399e336
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fc59c980e699
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fd30e0fcc3df
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fd84a78b2e3b
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       ├── balanced_active_fe6cdab1a332
│   │   │   │       │   ├── out
│   │   │   │       │   │   ├── events.jsonl
│   │   │   │       │   │   └── metrics.html
│   │   │   │       │   ├── run.html
│   │   │   │       │   └── scenario.yaml
│   │   │   │       └── balanced_active_ffb483a66a21
│   │   │   │           ├── out
│   │   │   │           │   ├── events.jsonl
│   │   │   │           │   └── metrics.html
│   │   │   │           ├── run.html
│   │   │   │           └── scenario.yaml
│   │   │   ├── aggregate
│   │   │   │   ├── comparison.csv
│   │   │   │   ├── dealer_usage_by_run.csv
│   │   │   │   ├── strategy_outcomes_by_run.csv
│   │   │   │   └── strategy_outcomes_overall.csv
│   │   │   └── passive
│   │   │       └── runs
│   │   │           ├── balanced_passive_002e47d74710
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01995670dd1d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_01d31044e44f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_028c6fc6ebd0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02ad9aa0b2a9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02b9a45adbd0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_02fae9db1c36
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_035346391acc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0460f5967851
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_04ed9226960c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_04fd54ae870d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_05eb09a090ff
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_062b7df4ada1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_06307ae42147
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_063b1c4f4748
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0681be5eccf5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_068a18c38243
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_074c5b644549
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_07e23a1c86bf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_08635536df3f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0888ba6a83ec
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_08e5c778dc11
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_08e6a25168b7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_09793b8c5f87
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_09ed733e3fbb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0b4c6130092d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0b7cbd285542
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0c38281cae60
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0c942d4871dc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0d7905953096
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0ddc082adb0b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0de04e4e80f5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0df390816790
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_0f8f893ec3e1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_10885f04f2bc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_120ae6d54d30
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_132b1bf52f13
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_139c40a8c8f8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_149781875326
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_149b760fa1c0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_14f6ee4ec8a1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1521965af076
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_15aebecbe60f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_16403aefda71
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_164b56a5f570
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_16999970da00
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_16d515817577
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_170a2b5798f6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1733a94ba145
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_173ab000a343
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1751a477f859
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_175ece5e0550
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_184e65aa440b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_188b43cd520c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_189e6938fcb2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_18ff1a5af076
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1946d22ceaa7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_197027d6f9bf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_199ee84582a2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_19c092fff12f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_19ff565a5b83
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a0b78b2cfc9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a1f2eab1fe8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a4d8aba25fa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1a9f16311ef2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1adca1543792
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1aeb3cea3232
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1b8a52b0acda
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1b8fc30178d2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ba90c77bc00
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1bd95d5a2f7e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1bf9efaed19f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1d23b77b764c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1d81b176df0f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e107f45ac6c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e6376280f9f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e738141cfe8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1e7fda3e0e18
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1ecff0129119
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_1f174a1f4db7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_204d63dbe52a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_20d86f23fd75
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_21514970a8b1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_217e01fc8c38
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_21d253c3a204
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_225fff2fc8d8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_227b35b4be90
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_230245349425
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_25190ee4d654
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_25862c7bdd77
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_26b624890c0a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_26cd56c36650
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_27e7d07eb0d4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_280288740a7a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_283fefc4629d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_28ce87db6427
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2944c18d9369
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_29cdacc68f30
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2bc42c08818b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2bd2547285ab
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2c6dec737579
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2c997351e2d8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ca8f488a3b7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2d36be8b9946
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2edb235b4d21
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2ef564b252c5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_2fdf540c6909
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3023c1669b05
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3039e33ab762
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_31120d15394e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_31b795564d95
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_31c974f5d889
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_31dcb6d9d930
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_324e11e07e6b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3271933c8ed4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_327c66cce727
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3291c7dfed0b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_330a0fc115c0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_33ad99ea98c4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_33dd96b2997e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_33faf9157288
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3522af727209
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_353ff1294693
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3610e7449e44
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3613b8561b50
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_364c1cb3fbba
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_37444b2cd03c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_375b4e79bb06
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_378f167e5afb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_37e00b71ea80
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3846b6b7671b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_385d89d9a38c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_38fdbf47f249
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3923fdf61b24
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3a06a5b68780
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3ae5916b2e9e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3b6854fdaaa4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3b89501dac3f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3bffbe031c84
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3c4b36e34f15
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3d237ec3e149
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3d2a5e2baabc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e5271f22c51
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e6e98a02be2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3e7213654744
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3eaf64861d02
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3ecb4b039d8e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_3fdbd87bba53
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_406d4875fdb8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4105f9ffe052
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_417f1e2578ac
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_420981cad02c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_427db0ee18c0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_42b0f114fba3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4324a47d5c52
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_434ea04f2b5e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4430ea45da36
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4482cbdc425c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4548eb4762e3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45511e26dd25
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45cbf41a9bc8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_45f98b1d8623
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4666a706f551
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4694f99441c4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_46954d46b5ae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_477ff7895dc9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_47b54cc81813
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4839739224c3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_484a2fa92695
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4891711742e5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_48950b9dbebd
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4895d6612c61
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4948a738a9dd
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_49836588502b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4a55bbd2c69c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4a738833672c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4b9d10e19b42
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4bcf66f243c2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4c7801502bc0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4c7956512772
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4d7092623938
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4d7cd1e385ae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4daeb4a76357
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4dc772ce351c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4dde66e2f495
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_4eb143bcc8e9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5137a5779b27
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_519c019dc3a4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_52289c498990
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5246e0c666b8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_525471ad1a33
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_52e5078f898b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_52e5e819098f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_546472d83ec2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_556d26e0fe44
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_55d40fe92854
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_55d6cd8772c1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_55da70d9d852
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_582fb30b8c56
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5842c16b7057
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_584e0f00405a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_58b537294faf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_58c2bf8214fc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_58c4c8157774
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5948f790953f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_59c016b34315
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_59f97ea5e2d4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5a12417cb8af
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5a65e01e0070
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5abe4f0c5bc4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5b93c23727a5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5c350b6ba588
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5c92089fed2c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5d1a3386a5f6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5d62a82e56f2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5dd91100e968
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5e98848c0a9f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_5fb76f9589ab
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6072267060bf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_60796e8106ac
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_60b4f7df5e95
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_616004f91ea4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_61b95a1753d8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_62ae8db19fbb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_62c156f0c64f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6306f4b72c5c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_633786c685cb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_636e6c168d36
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_63d9a178bf5e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_64c5ab2e78d3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_64dcdab4a1ab
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_64f9ac66b3c7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_65598c29e72d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_65ec37577f0d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6605e3dfa022
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6703f968e315
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_678c57f8ffdf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_67d81c32caed
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_683382892736
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_69112dc2dfd6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_699d21fd7474
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6a33dbbbdd1c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6aa1f154c86c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6b77a60da183
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6bcbc482eca0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c35cd6bbc14
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6c70e6fc13bd
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6cf4ee8e18df
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6d03aa2db73f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6d3af32dd678
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6d5eaa466633
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6de3b960ee5b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6e3f20457c2a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6ec16bee02da
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6ed4bfdb6017
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6efbcf16675e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6f6b5dd4bd8f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6f86a9b0e5a1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6fcfc9f3e597
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_6ff117d32f43
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_701c1e318e06
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_70acb7223401
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_70b078d38ffd
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_71265df46bff
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_713d7cf039d6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7276cc09b02f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_72a9788769a0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_72e781d73c00
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7315d7536fa4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7378ca3f7be0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_738055cda457
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_742e0628bd49
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_743abdaea1d5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_74499f1523d6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7449fc690319
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_75337d650416
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_76d25cc1ae49
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_770de51ba500
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7731c8f3c524
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7746fe395080
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_77d018eaffa7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_784534737027
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_785330ccc14e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_786536c07f85
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_79e2cdab8b7c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7a71c35c6064
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7b1f29b27edb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7b27adec98b0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7b32b31eaf66
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7bbe0b4b1b5f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7bff7e22c154
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7c3d1e842905
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7ca09181f390
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7cef89f43dd1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d0376b24d67
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d4038062662
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d47230ba9d0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7d9adcd6bd60
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7e426ab9c149
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_7f32145d6692
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_80610f66d856
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_817299c603f8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_819e38ec7a4f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_81df330b6bd7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_825dc3c972d8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_831bf2cf2ea2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_83fcea8038bc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_840e42d7c2e2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_84446da93692
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8474dfddf8f0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_849e2a069dc3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_84d07bbf67b5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_85d1abe09ec5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_86e2c5e4b6fc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8707e3fcc82f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_870a4fa75956
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_872a13ee4369
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_87592e7ebd6e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_87a1ff3ed959
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_87c7e3560c10
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8855e356f92f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_88e85c2e1f48
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_898171d1eaea
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a86d3b28b23
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a8a0eacf69a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a907d1f3b9b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8a9e083acb00
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8b8370529095
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8bdd56e28f4d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8c7b1953a2b4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8d67646708a2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8da0a06df7a1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8e021617a882
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8ed092de3d92
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8eef0b55be52
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f650aa0944c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8f8100b2e3ae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_8fc186bd3a55
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_90406dee6730
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_909525fe964a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9095ad7a63d3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_90b4a1f501aa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_90ffd91bdced
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_91612cb180f7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_91952c9fbda1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_91ce465025e9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_91f3f8aa7d6d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9214caebfdfb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_92a379a60d0b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9337378b7e4e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_936b6c52ed77
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_93e756e7ce8c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9415ae62972f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_94d5ef2402e6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_955370d97c13
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_956cb0326580
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_96428fe9de92
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_96565567745a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_979b208fa30e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_985825ee3039
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9864fe2ca67a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_986fae4ced89
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_988867565e98
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_988b86ab2ced
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_98bb26e79fb0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_98e8168a536a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_99295a5d4e68
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_996a93d0e6df
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_99f6c5778794
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9a27f093f6aa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9a9bcfcb91b8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9abda58920d3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ad188f1114f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9b07da6ff1e2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9b0a0bba2b8b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9b62e6613de0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9c2f3c707480
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9d50ac61d9fa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9d561adb4073
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9da502a70468
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9db2a9273612
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9e1274106f5e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9e5a55ef8085
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9e8f360c3b33
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ea33a886266
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ec42878edb5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ed58a777829
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f17de548b2a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f24a03959a3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f2c78bcc8fa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f6e4f6ddc73
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9f936d18646c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ff153ff6e4a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_9ffdf8d20976
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a0e413be21a4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a12f8b94fd16
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a26a1b898935
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a26cfa68a7bb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a28903aa0d19
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a2df14b09be1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a334ab736be6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a3ca3ddf1d3c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a402f29a35b4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a47d6ecee708
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a4803e0945e3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a48d92dbb069
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a4c94d012c12
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a5291a6cace8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a56575555668
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a66eaf8d1442
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a7870c83ea1e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a7aa7d405a3c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a81206e4f214
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a86da74ad836
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a8a09a7ca238
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a8bc5c4728e4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a905714e2707
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a91ee24098a2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_a98ec32e89a0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_aaaf61e50ec7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ab3dc6399708
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_abb8fccdbe4e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ac35d624b3be
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ac666c55ccd6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_acbfb43cd23a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ad87fce74552
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_adc48cf20691
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_add71778fdee
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_addceb5051f1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ae264e795f63
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ae7fd57f17f3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b00fe79c72e6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b16f27278c22
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b25d27c93756
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b2cb5a79d00c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b38221081731
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b3aa1af1ac7b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b3ceda397e07
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b486edf37106
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b49a833914b5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b54eb59d9c12
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b590d91e644f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b5a353c7c3fc
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b5b77144522b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b64e5e29af77
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b66e082d8c27
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b6b04218e29b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b75776b1a3f3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b80d1692db83
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b8d69d72c98d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b8e4c3034372
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b93e5a75d9d9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b93eb6ee5ee7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_b992bae9e737
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ba4b8245f42b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bac73d0cb3fe
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bad6f2f4bd9f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb181993a1fb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb217596d621
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb36cfaa28ca
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb4577592fba
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bb90e84f8b45
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bce9287a9b25
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bde51efb2d0e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_be1f67e7ac47
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_be774f707362
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_beaac8e615b1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bee088a78440
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bef6cca2a28c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bf5bce0adf2b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bf625ed1615e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_bfe66328a20e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c13fce9918a1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c1fe122cc169
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c221be82f8bb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c27e289f7774
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c2931c06cbf5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c2c5903758cb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c34aa5d9e178
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c3e1e06e4155
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c4ca5167b070
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c4fef2c9c66d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c53d94d836a6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c5682010bbe4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c59a228084a8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c5a9a3e9db9f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c6a3a3268b19
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c6cad82ffc45
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c6ddae135787
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c6fc27053587
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c723089fcfbe
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c803a18873e8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c827263a3824
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c83b5648d192
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c8a8a4240df3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c9032ce553e1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c90b4175f39a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c90b81403673
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c92b0472e109
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c947df21ff7b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c968e534992d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c9b193ae0011
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_c9fc92665dae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ca5df75056c0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ca82e756943b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cb0697d0bece
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cb3e5c015881
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cbd20ba16ec8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cbd23910be6e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cd9a40ac867c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cdbf163efb55
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cdcb1cfd668e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cddb8e9879a7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ce22a89c657b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cead242fb2ad
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ceee630b5232
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_cf8cc2fe14d8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d0b55b5f4cf3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d0f18df1dff6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d1080805dd37
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d18dbecc058f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d1933ba0f0df
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d2159ddeefe0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d26d7ffd1b0c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d274275d65e5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d3360dba268a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d35c0b70c861
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d3b7e3d0973a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d4414536d383
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d4b3b1937920
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d4b556f353c8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d4e74d7eb13c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d51b3c03ed3a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d5c7a73e7eb0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d7413c324dee
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d7d5fb52acb3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d8cc341bf6a2
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d8f4e1213799
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d98e2694a34f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d9972a7d3f34
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_d9b161d0900f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_db787f0bdaa8
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dc0b3badef59
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dc62bd7f8a2a
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dca824bbf2bd
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dd37c293c180
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_dda3b97ad8d4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_de111ed845aa
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_de21d0295edb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_defa6f0d5e83
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_df2585429553
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_df5c6aa3af4b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_df6b76fb9925
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e062111f0e81
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e0815f2ddfab
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e0aebc408e88
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e115cc4480d5
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e12468556e31
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e17f83097ccf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e224b9f5fceb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e2560877cfbe
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e2e438fab032
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e32889b943d3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e41c78f4e673
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e42e152f6d24
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e5136a183677
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e590b5aa73d0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e59a79b1026f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e749f0d6fcae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e80757044aa3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e833f2cea693
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e87cdd872688
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e9149e6add17
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e930ccfc289d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e9561145f2f1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e9c3666eaf11
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_e9f5f5bdb106
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eac75c206f7b
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ead5f017e562
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eb3c32d1f3f7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eb6be7428481
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eb9c41f90999
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ee0ace73b403
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eed0cdbdbae9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_eee9807b818f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_ef8d7005eaa4
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_efa23eeb90a7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f059d9068147
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f0706710a664
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f129f9bbfdef
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f1a1d1e0d0b1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f25346cc4189
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f28df42649e6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f29a988386c9
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f2adc5dbbdd0
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f2b32714b210
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f364b0984c50
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f3877fc01cc7
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f40d7c8afa91
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f4931a0db278
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f4d87ba11b9e
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f6b5e4731c97
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f72989265edf
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f748573f28a1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f7d2b5b875b1
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f7db2accbc79
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f7e2f7ded8e6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f82f60b13fd6
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f8a5724e4582
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f8a7b8aee1ed
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f8fccc7f55cb
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_f914cb2afd0c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fa62a6e6e09f
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fb55d98f1e85
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fb882e532b62
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fba1094788ce
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fc212eb64bf3
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fd15bec69dbe
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fd5eb288576d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fd86029c4b3c
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fe36ebe17820
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fe5eb04fdd9d
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fe74a44762ae
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           ├── balanced_passive_fee2c77db709
│   │   │           │   ├── out
│   │   │           │   │   ├── events.jsonl
│   │   │           │   │   └── metrics.html
│   │   │           │   ├── run.html
│   │   │           │   └── scenario.yaml
│   │   │           └── balanced_passive_ffbca323e9d5
│   │   │               ├── out
│   │   │               │   ├── events.jsonl
│   │   │               │   └── metrics.html
│   │   │               ├── run.html
│   │   │               └── scenario.yaml
│   │   └── plan024_sweep
│   │       └── aggregate
│   │           ├── comparison.csv
│   │           ├── summary.json
│   │           └── sweep_summary.txt
│   ├── interbank_events.jsonl
│   ├── kalecki_ring_baseline_events.jsonl
│   └── kalecki_ring_baseline_metrics.html
├── pyproject.toml
├── scripts
│   ├── generate_codebase_markdown.py
│   └── run_plan024_sweep.py
├── src
│   └── bilancio
│       ├── __init__.py
│       ├── analysis
│       │   ├── __init__.py
│       │   ├── balances.py
│       │   ├── dealer_usage_summary.py
│       │   ├── loaders.py
│       │   ├── metrics.py
│       │   ├── metrics_computer.py
│       │   ├── report.py
│       │   ├── strategy_outcomes.py
│       │   ├── visualization
│       │   │   ├── __init__.py
│       │   │   ├── balances.py
│       │   │   ├── common.py
│       │   │   ├── events.py
│       │   │   └── phases.py
│       │   └── visualization_phases.py
│       ├── cloud
│       │   ├── __init__.py
│       │   ├── config.py
│       │   └── modal_app.py
│       ├── config
│       │   ├── __init__.py
│       │   ├── apply.py
│       │   ├── loaders.py
│       │   └── models.py
│       ├── core
│       │   ├── __init__.py
│       │   ├── atomic.py
│       │   ├── atomic_tx.py
│       │   ├── errors.py
│       │   ├── ids.py
│       │   ├── invariants.py
│       │   └── time.py
│       ├── dealer
│       │   ├── __init__.py
│       │   ├── assertions.py
│       │   ├── bridge.py
│       │   ├── events.py
│       │   ├── kernel.py
│       │   ├── metrics.py
│       │   ├── models.py
│       │   ├── report.py
│       │   ├── simulation.py
│       │   └── trading.py
│       ├── domain
│       │   ├── __init__.py
│       │   ├── agent.py
│       │   ├── agents
│       │   │   ├── __init__.py
│       │   │   ├── bank.py
│       │   │   ├── central_bank.py
│       │   │   ├── dealer.py
│       │   │   ├── firm.py
│       │   │   ├── household.py
│       │   │   ├── treasury.py
│       │   │   └── vbt.py
│       │   ├── goods.py
│       │   ├── instruments
│       │   │   ├── __init__.py
│       │   │   ├── base.py
│       │   │   ├── contract.py
│       │   │   ├── credit.py
│       │   │   ├── delivery.py
│       │   │   ├── means_of_payment.py
│       │   │   └── policy.py
│       │   └── policy.py
│       ├── engines
│       │   ├── __init__.py
│       │   ├── clearing.py
│       │   ├── dealer_integration.py
│       │   ├── settlement.py
│       │   ├── simulation.py
│       │   ├── system.py
│       │   └── valuation.py
│       ├── experiments
│       │   ├── __init__.py
│       │   ├── balanced_comparison.py
│       │   ├── comparison.py
│       │   ├── ring.py
│       │   └── sampling
│       │       ├── __init__.py
│       │       ├── frontier.py
│       │       ├── grid.py
│       │       └── lhs.py
│       ├── export
│       │   ├── __init__.py
│       │   └── writers.py
│       ├── jobs
│       │   ├── __init__.py
│       │   ├── job_id.py
│       │   ├── manager.py
│       │   ├── models.py
│       │   └── supabase_store.py
│       ├── ops
│       │   ├── __init__.py
│       │   ├── aliases.py
│       │   ├── banking.py
│       │   ├── cashflows.py
│       │   ├── primitives.py
│       │   └── primitives_stock.py
│       ├── runners
│       │   ├── __init__.py
│       │   ├── cloud_executor.py
│       │   ├── local_executor.py
│       │   ├── models.py
│       │   └── protocols.py
│       ├── scenarios
│       │   ├── __init__.py
│       │   └── ring_explorer.py
│       ├── storage
│       │   ├── __init__.py
│       │   ├── artifact_loaders.py
│       │   ├── file_store.py
│       │   ├── modal_artifact_loader.py
│       │   ├── models.py
│       │   ├── protocols.py
│       │   ├── supabase_client.py
│       │   └── supabase_registry.py
│       └── ui
│           ├── __init__.py
│           ├── assets
│           │   └── export.css
│           ├── cli
│           │   ├── __init__.py
│           │   ├── jobs.py
│           │   ├── run.py
│           │   ├── sweep.py
│           │   ├── utils.py
│           │   └── volume.py
│           ├── display.py
│           ├── html_export.py
│           ├── render
│           │   ├── __init__.py
│           │   ├── formatters.py
│           │   ├── models.py
│           │   └── rich_builders.py
│           ├── run.py
│           ├── settings.py
│           └── wizard.py
├── supabase
│   ├── .temp
│   │   ├── cli-latest
│   │   ├── gotrue-version
│   │   ├── pooler-url
│   │   ├── postgres-version
│   │   ├── project-ref
│   │   ├── rest-version
│   │   ├── storage-migration
│   │   └── storage-version
│   └── migrations
│       └── 20260112_initial_schema.sql
└── tests
    ├── analysis
    │   ├── __init__.py
    │   ├── test_balances.py
    │   ├── test_metrics_computer.py
    │   ├── test_report_aggregate.py
    │   ├── test_t_account_builder.py
    │   └── test_visualization.py
    ├── cloud
    │   ├── __init__.py
    │   ├── test_cloud_executor.py
    │   └── test_modal_artifact_loader.py
    ├── config
    │   ├── test_apply.py
    │   ├── test_loaders.py
    │   ├── test_models.py
    │   ├── test_scheduled_alias_validation.py
    │   └── test_transfer_claim_model.py
    ├── dealer
    │   ├── __init__.py
    │   ├── test_examples.py
    │   ├── test_kernel.py
    │   ├── test_metrics.py
    │   ├── test_report.py
    │   └── test_simulation.py
    ├── engines
    │   ├── test_dealer_subsystem.py
    │   ├── test_default_handling.py
    │   └── test_phase_b1_scheduling.py
    ├── experiments
    │   ├── __init__.py
    │   └── test_sweep_runners.py
    ├── integration
    │   ├── test_banking_ops.py
    │   ├── test_clearing_phase_c.py
    │   ├── test_day_simulation.py
    │   ├── test_dealer_integration.py
    │   └── test_settlement_phase_b.py
    ├── ops
    │   └── test_alias_helpers.py
    ├── runners
    │   ├── __init__.py
    │   ├── test_local_executor.py
    │   ├── test_models.py
    │   └── test_protocols.py
    ├── scenarios
    │   └── test_ring_explorer.py
    ├── storage
    │   ├── __init__.py
    │   ├── test_artifact_loaders.py
    │   ├── test_file_store.py
    │   └── test_models.py
    ├── test_smoke.py
    ├── ui
    │   ├── test_cli.py
    │   ├── test_cli_html_export.py
    │   ├── test_cli_integration.py
    │   ├── test_html_export.py
    │   ├── test_render_builders.py
    │   └── test_render_formatters.py
    └── unit
        ├── test_balances.py
        ├── test_domain_system.py
        ├── test_jobs.py
        ├── test_reserves.py
        └── test_settle_obligation.py

6864 directories, 25047 files

```

---

## Git Commit History

Complete git history from oldest to newest:

- **57c76ece** (2025-08-09) by vladgheorghe
  Initial project setup
  - Created project structure with core modules
  - Set up core data types (time, atomic values, errors)
  - Implemented domain models (agents, contracts, policies)
  - Added operations and engine stubs
  - Configured development environment with pyproject.toml
  - Added comprehensive smoke tests
  - Set up .gitignore and README
  🤖 Generated with Claude Code
  Co-Authored-By: Claude <noreply@anthropic.com>

- **e1deb025** (2025-08-09) by vladgheorghe
  Implement Domain & System foundations for bilancio
  - Add ID generation system with ULID-like identifiers
  - Implement typed instrument classes: Cash, BankDeposit, ReserveDeposit, Payable, Deliverable
  - Create typed agent classes: Household, Bank, Treasury, CentralBank
  - Build PolicyEngine with default monetary regime rules
  - Implement System gateway with registries, validation, and invariant checking
  - Add comprehensive smoke tests verifying core functionality
  All contracts use double-entry structure with asset_holder and liability_issuer,
  supporting both financial and non-financial instruments.
  🤖 Generated with Claude Code
  Co-Authored-By: Claude <noreply@anthropic.com>

- **2c4a2900** (2025-08-09) by vladgheorghe
  feat(cash,deliverables): mint/retire/transfer cash, create/transfer deliverables, split/merge primitives, CB cash invariant
  - Extended Deliverable to support divisibility and SKU attributes
  - Added cb_cash_outstanding counter to system state
  - Created atomic transaction context manager for rollback on errors
  - Implemented fungibility helpers (fungible_key, is_divisible)
  - Created split/merge/consume primitives for instruments
  - Added cash operations: mint_cash, retire_cash, transfer_cash
  - Added deliverable operations: create_deliverable, transfer_deliverable
  - Implemented CB cash outstanding invariant check
  - Added comprehensive tests for all new functionality
  - Tests cover: mint/retire roundtrip, cash transfers with split/merge, divisible/indivisible deliverables, error cases
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **74908ad2** (2025-08-09) by vladgheorghe
  feat(banking): implement deposit, withdraw, and client payment operations
  - Add deposit_cash: moves cash from customer to bank, creates bank deposit
  - Add withdraw_cash: debits deposit, moves cash from bank to customer
  - Add client_payment: transfers between deposits, with optional cash fallback
  - Add deposit query helpers (deposit_ids, total_deposit) to System
  - Add coalesce_deposits to merge multiple deposits into one
  - Add no-negative-balances invariant check
  - Log ClientPayment events for cross-bank flows (for future clearing)
  - Comprehensive tests covering all operations and edge cases
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **7d5f19cf** (2025-08-09) by vladgheorghe
  refactor(agent): remove protocol duplication, keep dataclass Agent as single base
  - Removed confusing Agent protocol file (domain/agents/agent.py)
  - All concrete agents already use the dataclass from domain/agent.py
  - Fixed contract.py import to use the dataclass Agent
  - Updated smoke test to reflect single Agent base class
  - All 25 tests passing with 93% coverage
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **08263f3b** (2025-08-09) by vladgheorghe
  feat(reserves): implement reserves, settlement, clearing, and scheduler
  Implement comprehensive reserves infrastructure and day/phase mechanics:
  Reserves Infrastructure:
  - Add cb_reserves_outstanding counter to State
  - Implement reserve operations: mint, transfer, convert reserves<->cash
  - Add reserve invariant checks
  - Support splitting/merging/coalescing of reserve instruments
  Settlement Engine (Phase B):
  - Policy-driven payment method selection (deposits, cash, reserves)
  - All-or-nothing settlement with atomic transactions
  - DefaultError raised when debtor has insufficient funds
  - Proper handling of same-bank vs cross-bank payments
  Clearing Engine (Phase C):
  - Compute intraday nets from ClientPayment events
  - Settle nets with reserves or create overnight payables
  - Lexical ordering for deterministic bank pair processing
  - Graceful handling of insufficient reserves
  Day/Phase Scheduler:
  - Three-phase daily cycle: A (noop), B (settle), C (clear)
  - Automatic day counter increment
  - Integration with settlement and clearing engines
  Testing:
  - 11 comprehensive unit tests for reserves
  - 5 settlement phase B integration tests
  - 3 clearing phase C integration tests
  - 4 end-to-end day simulation tests
  - All 48 tests passing with 92% coverage
  Code Quality:
  - Fix linting issues and improve code formatting
  - Update imports to use modern Python type hints
  - Add proper error handling and validation
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **411d80bf** (2025-08-10) by vladgheorghe
  feat(analysis): add per-agent balance sheets and system trial balance
  - Add AgentBalance and TrialBalance dataclasses for structured balance reporting
  - Implement agent_balance() for individual agent financial position analysis
  - Implement system_trial_balance() for system-wide double-entry verification
  - Add as_rows() for tabular output format suitable for reporting
  - Add assert_no_duplicate_refs() invariant to prevent duplicate contract IDs
  - Wire new invariant into System.assert_invariants() for automatic checking
  - Add comprehensive tests covering all balance analysis functionality
  - 100% test coverage on new analysis module, 93% overall coverage
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **d54919e5** (2025-08-10) by Vlad Gheorghe
  Add Claude Code GitHub Workflow (#2)
  * "Claude PR Assistant workflow"
  * "Claude Code Review workflow"

- **dc51e639** (2025-08-15) by Vlad Gheorghe
  feat: add settle_obligation method to extinguish bilateral obligations (#1)
  * feat: add settle_obligation method to extinguish bilateral obligations
  - Add settle_obligation() method to System class to cancel matched asset-liability pairs
  - Method removes obligation from both holder's assets and issuer's liabilities
  - Useful for settling promises after delivery (e.g., goods delivered, services rendered)
  - Includes comprehensive test coverage for various scenarios
  - Atomic operation with proper rollback on failure
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * docs: add uv run instruction to CLAUDE.md
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **0ffe321e** (2025-08-15) by vladgheorghe
  feat: add balance sheet visualization and improvements
  - Add visualization module with display functions for balance sheets
  - Port display_agent_balance_table and display_multiple_agent_balances from money-modeling
  - Add AgentKind enum for type-safe agent creation
  - Add add_agents() method to System for batch agent addition
  - Add rich library for beautiful terminal output
  - Create demo notebook showing visualization capabilities
  - Update CLAUDE.md with testing and notebook guidelines
  Note: Issue #3 created for mixing monetary values with quantities in balance sheets
  🤖 Generated with Claude Code
  Co-Authored-By: Claude <noreply@anthropic.com>

- **ee3136aa** (2025-08-15) by Vlad Gheorghe
  Fix balance sheets mixing monetary values with physical quantities (#3) (#4)
  * feat: add monetary valuation to deliverables (fixes #3)
  - Add unit_price field to Deliverable class for monetary valuation
  - Add valued_amount property to calculate monetary value (quantity × price)
  - Update create_deliverable() to accept optional unit_price parameter
  - Add update_deliverable_price() method to update prices dynamically
  - Extend balance calculations to track non-financial asset values
  - Update visualization to show quantity in brackets and value in amount column
  - Fix split() operation to preserve unit_price during transfers
  - Add comprehensive tests for deliverable valuation
  - Update demo notebook to showcase the new feature
  This fixes the issue of mixing monetary values with physical quantities
  on balance sheets. Now deliverables can have proper monetary valuation
  while maintaining quantity tracking, and only valued items are included
  in monetary totals.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: rewrite balance sheet demo notebook with proper agent initialization
  * refactor: make unit_price required for all deliverables
  - Changed unit_price from optional to required parameter (defaults to Decimal('0'))
  - Removed support for unvalued deliverables (None unit_price)
  - Updated all balance calculations to always expect values
  - Fixed visualization to always show monetary amounts
  - Updated all tests to provide unit_price
  - Updated demo notebook to reflect required pricing
  This ensures balance sheets always maintain proper monetary accounting,
  never mixing physical quantities with monetary values.
  * fix: display deliverable liabilities with monetary values in balance sheets
  - Fixed visualization functions to properly display deliverable liabilities
  - Both assets and liabilities now show quantities in brackets and monetary values
  - Added proper handling of non-financial liabilities in balance calculations
  - Updated both rich and simple format displays
  - Added separate totals for valued liabilities when present
  - All balance sheets now consistently show monetary values, never raw quantities
  This completes the implementation of GitHub issue #3 - balance sheets no longer
  mix monetary values with physical quantities.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: address PR review feedback
  - Include SKU and unit_price in fungible_key for deliverables to prevent incorrect merging
  - Fix type annotation (any -> Any) in balances.py
  - Add comprehensive tests for deliverable merge behavior
  This ensures deliverables with different SKUs or prices cannot be incorrectly merged,
  while maintaining backwards compatibility for financial instruments.
  🤖 Generated with Claude Code
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **f8653f7a** (2025-08-15) by vladgheorghe
  feat: add due_day field to Deliverable instruments for temporal obligations
  Implements issue #5 - adds temporal component to deliverable instruments to match V1.0 specification.
  Changes:
  - Add optional due_day field to Deliverable class
  - Update settlement engine to handle deliverables with due dates
  - Add settle_due_deliverables function to process deliverable obligations
  - Update System.create_deliverable to accept due_day parameter
  - Add comprehensive tests for time-bound deliverable obligations
  This enables the implementation of the V1.0 example from the specification which includes temporal deliverable obligations like "Claim to receive 10 Machines from Agent 3 at t1".
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **d3d72c66** (2025-08-15) by vladgheorghe
  fix: address PR review feedback for deliverable due dates
  Fixes based on code review:
  - Removed duplicate _deliver_goods function definition
  - Added validation for due_day field (must be non-negative if provided)
  - Enhanced docstring for due_day field with detailed explanation
  - Added tests for deliverables without due_day and validation
  All 87 tests passing with improved coverage.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **e08eb780** (2025-08-15) by Vlad Gheorghe
  Add due_day field to Deliverable instruments for temporal obligations (#6)
  * feat: add due_day field to Deliverable instruments for temporal obligations
  Implements issue #5 - adds temporal component to deliverable instruments to match V1.0 specification.
  Changes:
  - Add optional due_day field to Deliverable class
  - Update settlement engine to handle deliverables with due dates
  - Add settle_due_deliverables function to process deliverable obligations
  - Update System.create_deliverable to accept due_day parameter
  - Add comprehensive tests for time-bound deliverable obligations
  This enables the implementation of the V1.0 example from the specification which includes temporal deliverable obligations like "Claim to receive 10 Machines from Agent 3 at t1".
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: address PR review feedback for deliverable due dates
  Fixes based on code review:
  - Removed duplicate _deliver_goods function definition
  - Added validation for due_day field (must be non-negative if provided)
  - Enhanced docstring for due_day field with detailed explanation
  - Added tests for deliverables without due_day and validation
  All 87 tests passing with improved coverage.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **e1feb574** (2025-08-15) by vladgheorghe
  Merge remote-tracking branch 'origin/main' into feature/deliverables-due-date

- **aee3bdb5** (2025-08-15) by vladgheorghe
  feat: add Firm agent type and complete V1.0 example simulation
  - Create Firm agent class for business entities (manufacturers, traders, etc.)
  - Add Firms to policy with cash settlement capability
  - Create comprehensive notebook demonstrating PDF example with automatic settlements
  - Verify deliverable settlement properly transfers physical goods
  - Successfully replicate Money Modeling Software V1.0 temporal transformation
  This completes the core V1.0 requirements:
  ✓ Deliverables with due_day field (from previous commits)
  ✓ Automatic settlement of both financial and non-financial obligations
  ✓ Proper transfer of underlying goods during settlement
  ✓ Support for generic business entities via Firm type
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **68db838d** (2025-08-16) by vladgheorghe
  docs: add Jupyter notebook command to CLAUDE.md

- **58a51038** (2025-08-16) by Vlad Gheorghe
  refactor: separate inventory (StockLot) from delivery obligations (DeliveryObligation) (#7)
  BREAKING CHANGE: Complete refactor of non-financial instruments to fix conceptual conflation
  ## Changes
  ### New Domain Model
  - Added StockLot class for inventory (non-financial, no counterparty)
  - Added DeliveryObligation class for bilateral delivery promises
  - Extended Agent with stock_ids field for owned inventory
  - Extended State with stocks registry for all stock lots
  ### System API Changes
  - Inventory operations: create_stock, split_stock, merge_stock, transfer_stock
  - Obligation operations: create_delivery_obligation, cancel_delivery_obligation
  - Removed old methods: create_deliverable, transfer_deliverable
  ### Settlement Engine
  - Updated to handle delivery obligations using FIFO stock allocation
  - Fixed nested atomic transaction issue with internal helper methods
  - Deterministic settlement with proper stock transfer and obligation cancellation
  ### Analysis & Reporting
  - Separated inventory_by_sku from delivery obligations in balances
  - Added total_inventory_value field to balance classes
  - Updated visualization to show inventory and obligations separately
  ### Benefits
  - Eliminates conceptual bug (inventory was masquerading as bilateral contract)
  - Simplifies settlement (no magic reconstruction, just move goods)
  - Clarifies reporting (inventory vs promises are separated)
  - Matches design goals for time-based execution and clean extinguishment
  ### Tests
  - All 87 tests passing
  - Updated test suite to use new API
  - Fixed balance assertions for separated inventory/obligations
  Implements plan from docs/plans/007_deliverable.md
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-authored-by: Claude <noreply@anthropic.com>

- **04a5ebfc** (2025-08-18) by vladgheorghe
  fix: separate quantity from monetary values in balance sheet display
  - Fixed visualization to never confuse quantities with monetary amounts
  - Non-financial items now show quantities in brackets (e.g. 'machines [10 units]')
  - Monetary values always appear in Amount columns, never quantities
  - Added comprehensive event display functions to visualization module
  - display_events() shows all events with proper formatting and icons
  - display_events_for_day() shows events for specific simulation days
  - Updated notebook to use new event display functions from module
  - Fixed run_day() to settle obligations on the correct day (next_day not current_day)
  - Added CLAUDE.md instructions for notebook testing and balance sheet display
  🤖 Generated with Claude Code
  Co-Authored-By: Claude <noreply@anthropic.com>

- **d559cbb8** (2025-08-18) by vladgheorghe
  fix: improve codebase markdown generator exclusions
  - Exclude .conductor, .uv, .DS_Store and other build/cache directories from tree output
  - Add comprehensive list of directories to ignore (IDE configs, Python caches, virtual envs)
  - Clean up tree output to show only relevant source code and documentation files
  - Reduces noise in generated markdown documentation
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **03efa39e** (2025-08-18) by vladgheorghe
  feat: add complete git history to codebase markdown generator
  - Add get_git_history() function to extract full commit history
  - Include commit hash, date, author, subject and body for each commit
  - Display history chronologically from oldest to newest
  - Helps LLMs understand project evolution and context
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **d0c1f3a3** (2025-08-18) by Vlad Gheorghe
  feat: implement simulation improvements from plan 008 (#8)
  * feat: implement simulation improvements from plan 008
  - Add setup phase to System with context manager
  - Fix run_day() to settle current_day instead of next_day
  - Update visualization to remove day offset labeling
  - Add run_until_stable() runner function
  - Update notebooks to use new setup phase and literal due days
  Key improvements:
  1. Setup phase clearly separates initial conditions from simulation
  2. Literal day semantics: due_day=1 means day 1 (not day 2)
  3. run_until_stable() enables automated simulation runs
  4. Event displays now show correct day numbers without offsets
  All tests pass. Notebooks updated and verified working.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: clarify notebook output and properly implement run_until_stable
  - Fixed confusing day progression in notebook output
  - Now clearly shows when advancing days and settling obligations
  - Actually implemented run_until_stable demonstration (not just a comment)
  - Each section now properly explains the day progression
  - Tested and verified all events display correctly
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **4accab4a** (2025-08-18) by vladgheorghe
  chore: update project configuration
  - Add temp/ folder to .gitignore for temporary test files
  - Update CLAUDE.md with instructions for reviewing subagent code
  - Add note about storing temp files in gitignored folder
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **658cf533** (2025-08-18) by vladgheorghe
  docs: update codebase markdown documentation
  - Regenerate codebase_for_llm.md with latest code structure
  - Add scripts/codebase_for_llm.md generator script
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **84348990** (2025-08-18) by Vlad Gheorghe
  feat: implement CLI for Bilancio simulations (#10)
  * feat: implement CLI for Bilancio simulations
  - Add configuration layer with YAML support for scenario definitions
  - Create CLI with run, validate, and new commands
  - Implement export functionality for balances (CSV) and events (JSONL)
  - Add example scenarios (simple_bank, two_banks_interbank, firm_delivery)
  - Include comprehensive tests for config and UI layers
  - Fix display_events to properly handle setup phase
  - Support policy overrides and all major operations via YAML
  The CLI allows domain experts to:
  - Define scenarios in simple YAML format
  - Run simulations step-by-step or until stable
  - Validate configurations before running
  - Export results for analysis
  - Create new scenarios with wizard
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * docs: add scenario translator agent prompt
  Create comprehensive prompt for AI agents to translate financial
  scenarios from natural language to valid Bilancio YAML configs.
  Includes understanding process, validation steps, and user instructions.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: update tests to use pydantic aliases correctly
  - Fix CreateDeliveryObligation and CreatePayable tests to use 'from'/'to' aliases
  - Fix test_apply to check for liability_issuer_id instead of debtor_id
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: address PR review feedback (priorities 1-3)
  Priority 1: Fix decimal parsing security vulnerability
  - Use try/except with Decimal constructor for safer parsing
  - Check for finite values to prevent infinity/nan issues
  - Handle all decimal exceptions properly
  Priority 2: Address precision loss in financial calculations
  - Document that amounts are expected in minor units
  - Improve JSON serialization to preserve decimal precision
  - Use string representation for non-integer decimals in JSON
  Priority 3: Implement template functionality for wizard
  - Support using existing YAML files as templates
  - Support predefined complexity levels (simple/standard/complex)
  - Handle non-interactive mode gracefully
  - Allow modification of loaded templates
  All tests passing ✅
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **effcb9aa** (2025-08-18) by vladgheorghe
  feat: improve CLI event display formatting and visual hierarchy
  - Add clear visual hierarchy with phase headers and indented events
  - Show all three phases (A, B, C) consistently even when empty
  - Add agent IDs to balance sheet headers for clarity (e.g., "Consumer A [H1]")
  - Format all event types with appropriate emojis and descriptions
  - Fix setup phase event formatting (ReservesMinted, CashDeposited, etc.)
  - Add "Day ended" marker after Phase C
  - Improve stock split display with shortened IDs for readability
  - Clarify phase descriptions: Phase A (Day begins), Phase B (Settlement), Phase C (Intraday netting)
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **caafcd53** (2025-08-18) by vladgheorghe
  feat: add interbank netting example and improve event formatting
  - Create interbank_netting.yaml example showing Phase C netting
  - Add formatting for ClientPayment, InterbankCleared, ReservesTransferred events
  - Document that Phase C is specifically for interbank settlement netting

- **d4989288** (2025-08-18) by vladgheorghe
  fix: correct balance sheet display timing in CLI simulation
  The balance sheets were showing incorrect values because run_until_stable()
  was executing all simulation days first, then displaying summaries afterwards.
  This meant all balance sheets showed the final state rather than the state
  at each specific day.
  Changed run_until_stable_mode() to:
  - Run simulation day-by-day instead of all at once
  - Display each day's balance sheet immediately after that day completes
  - Pass correct day number (0-based) to show_day_summary() for event filtering
  This ensures balance sheets accurately reflect the system state at the end
  of each simulated day.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **dccdd46a** (2025-08-18) by vladgheorghe
  docs: update codebase markdown with balance sheet timing fix
  Regenerated codebase_for_llm.md to include the latest changes:
  - Fixed balance sheet display timing in CLI simulation
  - Balance sheets now show correct state at end of each day
  - Events properly displayed with correct day associations
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **83697fcf** (2025-08-21) by Vlad Gheorghe
  feat: HTML export improvements and rich simulation scenario (#11)
  * feat: add PDF export functionality for CLI output
  - Added --pdf flag to bilancio run command
  - Exports simulation output with colors and formatting preserved
  - Generates both HTML and PDF (using Chrome if available)
  - Maintains same visual style as terminal output including:
    - Color-coded balance sheets
    - Formatted events with emojis
    - Side-by-side agent balance display
  - Added weasyprint and pygments dependencies
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * refactor: change from PDF to HTML export for CLI output
  - Changed --pdf flag to --html flag
  - Renamed pdf_export.py to html_export.py
  - Removed PDF conversion logic and weasyprint dependency
  - Fixed event display to show actual event kinds instead of "Unknown"
  - HTML output preserves all colors, formatting, and emojis
  - Simpler implementation without system dependencies
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: improve HTML export event display clarity
  - Removed confusing nested day headers in event display
  - Day 0 now shows only setup phase events
  - Each day shows events that actually happened during that day
  - Events grouped by phase (Setup, A, B, C) without re-grouping by day
  - Phase headers only shown when there are actual events
  - Skip phase marker events in display to reduce clutter
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: show complete initial setup in HTML export including payables
  - Added display of initial actions from YAML configuration
  - Now shows create_payable actions that explain WHY payments happen
  - Separated Initial Actions from Setup Events for clarity
  - Shows initial balances after setup
  - Users can now see the complete story:
    - Initial payables created (H1 owes H2 $1000 due Day 1)
    - Then the settlement of those payables on Day 1
  This makes the simulation flow much clearer by showing the setup
  that creates the obligations that drive the later transactions.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: show correct initial balances and agent list in HTML export
  - Capture initial balance snapshots right after setup (before simulation)
  - Display agent list at the beginning showing all participants
  - Initial balances now show correct values (B1: $20,000, B2: $15,000)
  - Fixed issue where balances showed post-transaction state instead of initial state
  - Added icons for different agent types (🏛️ central bank, 🏦 bank, 👤 household, 🏢 firm)
  The HTML now properly shows:
  1. All agents in the simulation
  2. Initial actions including payables
  3. Correct initial balance sheets after setup
  4. Then the progression through simulation days
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: correct day labeling misalignment in CLI and HTML output
  Previously, events from day N were shown under "Day N+1" header due to
  mixing 1-based day counters with 0-based event days. This caused:
  - Day 1 to appear empty with no events
  - Payables due on Day 1 to show under Day 2
  - Event summaries showing "Unknown" instead of actual event types
  Changes:
  - Use consistent 0-based day numbers for both labels and event filtering
  - Skip day 0 in simulation loops (already shown as "Day 0 After Setup")
  - Fix event summary to use 'kind' field instead of missing 'type' field
  - Ensure HTML export respects actual event days
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: improve HTML export display and add rich simulation scenario
  Major improvements to HTML export formatting and balance sheet display:
  Display improvements:
  - Show full agent balance sheets after each day's events (not just trial balance)
  - Fix stock split event rendering with proper field names and shortened IDs
  - Improve initial action display for create_stock and create_delivery_obligation
  - Fix event categorization - settlement events now correctly appear in Phase B
  - Add proper formatting for all event types (CashTransferred, StockTransferred, etc.)
  - Fix Phase A to only show "Day begins" without spurious events
  Rich simulation scenario:
  - Comprehensive demo with stocks, payables, intra-bank and inter-bank payments
  - Shows stock movements between firms and households
  - Demonstrates both same-bank and cross-bank payment flows
  - Includes dividend payments and multi-day settlement patterns
  - Configured to display 6 key agents' balance sheets throughout
  The HTML export now provides a complete view of how the financial system
  evolves day by day, with full visibility into balance sheet changes.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * chore: reorganize docs and clean up test HTML files
  - Move codebase_for_llm.md to docs/ folder
  - Add UI refactor plan document
  - Remove temporary HTML test files
  - Update codebase markdown generator script
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: implement unified UI rendering pipeline with HTML export
  Major refactoring of the UI/rendering system following plan 010_ui_refactor.md:
  ## New Features
  - Created unified rendering pipeline for both terminal and HTML output
  - Added new ui/render package with models, formatters, and Rich builders
  - Integrated HTML export directly into CLI using Console(record=True)
  - Added centralized UI settings module for configuration
  ## Breaking Changes
  - Removed deprecated Deliverable instrument and legacy settlement paths
  - Removed html_export.py module (replaced with console.export_html())
  - Canonicalized event handling to always use 'kind' field (removed 'type' fallback)
  ## Implementation Details
  ### New Package Structure (src/bilancio/ui/render/)
  - models.py: View models for balance sheets, events, and day summaries
  - formatters.py: Event formatter registry with specific formatters for all event types
  - rich_builders.py: Pure functions that return Rich renderables
  - settings.py: Centralized UI configuration
  ### Refactored Components
  - visualization.py: Added renderable-returning functions alongside existing ones
  - display.py: Created renderable versions of display functions
  - run.py: Uses Console(record=True) for unified rendering and HTML export
  - settlement.py: Removed deliverable settlement, kept only DeliveryObligation
  ### Removed Legacy Code
  - Deleted domain/instruments/nonfinancial.py (Deliverable class)
  - Removed 577 lines of complex HTML generation in html_export.py
  - Removed deliverable tests and references throughout codebase
  ## Benefits
  - Single rendering pipeline for terminal and HTML (no duplication)
  - Simplified codebase with better maintainability
  - Consistent output formatting across all display modes
  - Rich's optimized HTML export with proper styling
  ## Testing
  - Added comprehensive tests for formatters and builders
  - Tested with existing scenarios - all working correctly
  - HTML export generates properly formatted output
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: properly format events in HTML export using formatters
  - Fixed event display to use the formatter registry instead of raw dict output
  - Events now show with proper icons, titles, and formatted details
  - Updated _build_events_detailed_renderables to use registry.format()
  - HTML output now matches terminal display quality
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: display agent list and PayableCreated events in HTML export
  - Fix show_scenario_header_renderable to handle list of AgentSpec objects
  - Add PayableCreated event logging in config/apply.py
  - Display complete agent list at top of terminal and HTML output
  - Ensure all events including PayableCreated are properly formatted
  - Update CLAUDE.md with HTML verification instructions
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: add detailed payment event logging for settlement transparency
  - Log IntraBankPayment events for same-bank transfers
  - Keep ClientPayment for inter-bank transfers (renamed to 'Inter-Bank Payment')
  - Log CashPayment events when cash is used as fallback
  - Add formatters for all payment event types with clear icons
  - Now shows HOW payables are settled, not just that they were settled
  This provides full transparency into payment mechanisms during settlement phase.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: add payment_demo scenario and clean up test files
  - Add payment_demo.yaml - simple scenario for teaching payment mechanisms
  - Demonstrates intra-bank, inter-bank, and cash payments clearly
  - Easy to follow by hand while showing complete payment/clearing cycle
  - Remove temporary test files
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * docs: add TODO notes and agent documentation
  - Add TODO.md with note about deposits created via loans
  - Add AGENTS.md documenting agent types and capabilities
  - Add sasa_scenario.yaml example scenario
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * docs: add Monetary Theory Chapter 5 PDF reference
  Add PDF document for Chapter 5 of Monetary Theory course material
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat: add custom slash command for generating codebase markdown
  - Created /generate-codebase command in .claude/commands/
  - Command runs the codebase markdown generation script
  - Opens the project folder in Finder after generation
  - Reports statistics about the generated file
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * fix: address critical PR review feedback and fix all failing tests
  - Remove duplicate CashTransferred formatter registration (critical bug)
  - Remove duplicate return statement in run.py (dead code)
  - Fix all test failures:
    - Update HTML export test to use MONOKAI constant instead of string
    - Fix scenario creation test to use correct --from option
    - Update formatter tests to match actual output format
    - Fix builder tests by removing invalid model fields
    - Correct EventView field names in tests
  All 120 tests now passing.
  🤖 Generated with [Claude Code](https://claude.ai/code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **018ceb77** (2025-08-24) by Vlad Gheorghe
  UI: T-accounts, event tables, and pretty HTML export (#12)
  * UI 011_tbs: add event table view; detailed T-account renderer; CLI/config support for --show table and --t-account; stacked multi-agent T-accounts; light HTML export; heavy-lined tables with zebra striping; improved event mappings; width tweaks for readability.
  * Events table: exclude PhaseA/B/C marker rows; render three separate tables per phase (A/B/C) for day views; improve titles and zebra striping.
  * Event rendering: phase-separated tables; Setup table for day 0; chronological order preserved; improved table styling; stacked T-accounts.
  * HTML export: semantic report (agents table, convergence reason, zebra tables); per-day T-accounts with counterparties; phase-separated events; unified export path; convergence detection fix.

- **11823a65** (2025-08-24) by Vlad Gheorghe
  fix: follow-ups for PR #12 (safe numeric conversions, maturity parsing helper, CSS extraction, tests) (#13)

- **8ac98b9c** (2025-09-02) by vladgheorghe
  Scenarios: add exercise scenarios 1–2 and run via day-1 obligations
  - ex1_cash_for_goods.yaml: switch to delivery obligation + payable due day 1
  - ex2_two_firms_cash_purchase.yaml: modeled via day-1 obligations
  - Kept setup to endow assets only; settlement occurs in simulation
  - Validated and produced HTML reports under temp/
  Note: Scenarios 3–4 need claim assignment + scheduled actions (not yet supported).

- **89ca7621** (2025-09-04) by Vlad Gheorghe
  feat(sim): scheduled actions (B1), alias support, claim transfer + exercises 1–7 (#14)
  * Plan: Mid-simulation actions via Phase B split (B1 scheduled, B2 settlement), aliases, and explicit claim transfer
  - Keep Phase A reserved; execute scheduled actions at start of Phase B
  - Add alias support on create-* actions for contracts (mint_cash, mint_reserves, create_payable, create_delivery_obligation)
  - Add transfer_claim action referencing by alias or id (both allowed if consistent)
  - Schedule actions by day; render HTML with separate Phase B1/B2 tables
  - No code changes yet — planning document only (plans/scheduled_actions_and_aliases.md)
  * Move plan to docs/plans with numbering: 012_scheduled_actions_and_aliases.md
  * feat(sim): scheduled actions (Phase B1) + alias support + claim transfer\n\n- models: add alias to create_*; add TransferClaim; add ScheduledAction + scheduled_actions on scenario\n- system: state aliases + scheduled_actions_by_day; create_delivery_obligation/mint_* accept alias and log it; run_day executes B1 then B2\n- apply: wire aliases, pass alias into system APIs, implement transfer_claim reassignment\n- html export: add ID/Alias column to events and T-accounts; split Phase B into B1/B2 tables\n- ui/run: stage scheduled_actions and carry id_or_alias to HTML rows\n\nscenarios:\n- ex1/ex2 already added; ex3 updated to day1 assignment + day2 settlement (aliases shown); ex4 generic claim transfer with consideration\n\nnote: step-mode DayReport None issue still present (not addressed)
  * ui: show aliases on cancel/settle events + ID fallback
  - engines/system: include alias + contract_id on DeliveryObligationCancelled
  - engines/settlement: include alias + contract_id on DeliveryObligationSettled and PayableSettled
  - html_export: ID/Alias column considers obligation_id and pid as fallbacks
  scenarios: add Ex6 and Ex7 YAMLs
  * chore(examples): organize exercise scenarios 1–7 into subfolders and regenerate HTML reports\n\n- Move YAMLs to examples/exercise_scenarios/yaml/\n- Export HTMLs to examples/exercise_scenarios/html/ for ex1–ex7
  * chore(examples): regenerate HTML reports for ex2–ex7 in examples/exercise_scenarios/html/
  * fix: address PR feedback (critical+moderate)
  - models: move model_validator import to module scope
  - apply: order-independent transfer_claim validation with clear errors
  - ops/aliases: add helpers for alias/id lookup; use in settlement/system
  - ui/run: preflight validate scheduled alias references; refactor row dict builder
  - html_export: ID/Alias fallback includes obligation_id & pid
  No functional changes to scenarios; validated ex7 run.
  * chore(examples): re-render HTML reports for ex1–ex7
  * fix(ui/run): step-mode HTML export bug\n\nMove _row_dict helper out of inner block and ensure day_rows assignments execute within the agent loop. This fixes unreachable code causing empty T-account rows in step-mode exports.
  * test: add coverage for TransferClaim, schedule alias validation, B1 execution, and alias helpers

- **e09cfe56** (2025-09-05) by vladgheorghe
  Consolidated ex. HTMLs

- **20318846** (2025-09-05) by vladgheorghe
  docs: update scenario translator prompt for scheduled actions, aliases, transfer_claim, and CLI usage

- **814cb8ab** (2025-09-05) by vladgheorghe
  feat(docs): add timestamp/branch/commit to codebase_for_llm and CI auto-update workflow

- **90f18f4a** (2025-09-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **2341fc71** (2025-09-25) by Vlad Gheorghe
  Add expel-agent default handling flow (#15)
  * Plan: Mid-simulation actions via Phase B split (B1 scheduled, B2 settlement), aliases, and explicit claim transfer
  - Keep Phase A reserved; execute scheduled actions at start of Phase B
  - Add alias support on create-* actions for contracts (mint_cash, mint_reserves, create_payable, create_delivery_obligation)
  - Add transfer_claim action referencing by alias or id (both allowed if consistent)
  - Schedule actions by day; render HTML with separate Phase B1/B2 tables
  - No code changes yet — planning document only (plans/scheduled_actions_and_aliases.md)
  * Move plan to docs/plans with numbering: 012_scheduled_actions_and_aliases.md
  * feat(sim): scheduled actions (Phase B1) + alias support + claim transfer\n\n- models: add alias to create_*; add TransferClaim; add ScheduledAction + scheduled_actions on scenario\n- system: state aliases + scheduled_actions_by_day; create_delivery_obligation/mint_* accept alias and log it; run_day executes B1 then B2\n- apply: wire aliases, pass alias into system APIs, implement transfer_claim reassignment\n- html export: add ID/Alias column to events and T-accounts; split Phase B into B1/B2 tables\n- ui/run: stage scheduled_actions and carry id_or_alias to HTML rows\n\nscenarios:\n- ex1/ex2 already added; ex3 updated to day1 assignment + day2 settlement (aliases shown); ex4 generic claim transfer with consideration\n\nnote: step-mode DayReport None issue still present (not addressed)
  * ui: show aliases on cancel/settle events + ID fallback
  - engines/system: include alias + contract_id on DeliveryObligationCancelled
  - engines/settlement: include alias + contract_id on DeliveryObligationSettled and PayableSettled
  - html_export: ID/Alias column considers obligation_id and pid as fallbacks
  scenarios: add Ex6 and Ex7 YAMLs
  * chore(examples): organize exercise scenarios 1–7 into subfolders and regenerate HTML reports\n\n- Move YAMLs to examples/exercise_scenarios/yaml/\n- Export HTMLs to examples/exercise_scenarios/html/ for ex1–ex7
  * chore(examples): regenerate HTML reports for ex2–ex7 in examples/exercise_scenarios/html/
  * fix: address PR feedback (critical+moderate)
  - models: move model_validator import to module scope
  - apply: order-independent transfer_claim validation with clear errors
  - ops/aliases: add helpers for alias/id lookup; use in settlement/system
  - ui/run: preflight validate scheduled alias references; refactor row dict builder
  - html_export: ID/Alias fallback includes obligation_id & pid
  No functional changes to scenarios; validated ex7 run.
  * chore(examples): re-render HTML reports for ex1–ex7
  * fix(ui/run): step-mode HTML export bug\n\nMove _row_dict helper out of inner block and ensure day_rows assignments execute within the agent loop. This fixes unreachable code causing empty T-account rows in step-mode exports.
  * test: add coverage for TransferClaim, schedule alias validation, B1 execution, and alias helpers
  * Update codebase_for_llm snapshot
  * Handle default cleanup and reporting
  * chore(docs): update codebase_for_llm.md
  ---------
  Co-authored-by: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>

- **a6af7ef2** (2025-09-25) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **b164af70** (2025-09-25) by Vlad Gheorghe
  feature/013 kalecki metrics (#16)
  * feat(analysis): Kalecki metrics + analyze CLI + HTML report\n\n- Add loaders for events JSONL and balances CSV\n- Implement metrics: S_t, Mbar_t, alpha, phi/delta, M^peak (RTGS replay), velocity, HHI+, DS shares, liquidity gap\n- Add reporting: CSV/JSON outputs and self-contained HTML analytics report\n- Wire new  subcommand into CLI with --html option\n\nNotes:\n- Kept calculate_npv/calculate_irr placeholders intact for existing tests\n- Skips microstructure gain (LSM vs RTGS) per plan 013
  * docs: README usage for analyze CLI + add Kalecki ring baseline scenario YAML
  * chore(docs): update codebase_for_llm.md
  * docs: sync codebase_for_llm with main
  * chore(docs): update codebase_for_llm.md
  * ci: restrict codebase doc updates to main
  ---------
  Co-authored-by: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>

- **f1d56f4a** (2025-09-25) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **3cc9d695** (2025-09-25) by vladgheorghe
  Metric grid implementation & first sweep

- **f92829f4** (2025-09-25) by vladgheorghe
  Add Kalecki ring sweep findings

- **c658929d** (2025-09-26) by vladgheorghe
  Ring findings and metrics

- **79dfc7f8** (2025-09-26) by vladgheorghe
  Update ring findings

- **7f8f3f15** (2025-09-26) by vladgheorghe
  Ring findings

- **9a63d09a** (2025-09-26) by vladgheorghe
  Sweep report

- **4a4601da** (2025-09-26) by vladgheorghe
  Add expel-agent sweep report and dashboard

- **70aa4a9c** (2025-09-29) by vladgheorghe
  Add expel-agent sweep assets and default handling option

- **0d3d1f39** (2025-10-10) by Vlad Gheorghe
  Implement Kalecki Ring Parameter Sweep Experiments (#17)
  * Metric grid implementation & first sweep
  * Add Kalecki ring sweep findings
  * Ring findings and metrics
  * Update ring findings
  * Ring findings
  * Sweep report
  * Add expel-agent sweep report and dashboard
  * Add expel-agent sweep assets and default handling option

- **ee1bf4e4** (2025-10-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **764857ec** (2025-10-10) by vladgheorghe
  Clean up experiment outputs and reorganize dashboards
  - Remove old expel_sweep_dashboard, add new expel_ring_analysis_dashboard
  - Delete temporary experiment output files
  - Update ring sweep guide documentation
  - Add ring sweep example config
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **dd8b94fe** (2025-10-10) by vladgheorghe
  Merge feature/014-kalecki-experiments into main
  Merge the Kalecki ring parameter sweep implementation from the feature branch.
  Resolved conflicts in:
  - docs/guides/kalecki_ring_sweep.md (added YAML config documentation)
  - src/bilancio/experiments/ring.py (added config classes and loader)
  - src/bilancio/ui/cli.py (added config file support)
  All conflicts resolved by accepting feature branch additions.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **c6cb61fc** (2025-10-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **67796549** (2025-10-24) by vladgheorghe
  Add monotonicity control to ring sweeps and tooling

- **d0bd5db5** (2025-10-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **f68c1990** (2025-10-24) by vladgheorghe
  Track expel ring sweep aggregate outputs

- **ffb59452** (2025-10-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **2cd65b8e** (2025-10-24) by vladgheorghe
  Expand ring sweep horizon and refresh results

- **8fe4980f** (2025-10-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **fddff5ab** (2025-11-24) by vladgheorghe
  Add dealer ring documentation from feature branch
  Import docs/dealer_ring folder from feature/dealer-ring-module branch containing:
  - Implementation notes and specifications
  - Design conversations and examples
  - Three detailed PDF documents on dealer system
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **3ae98fe5** (2025-11-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **be83b122** (2025-11-24) by vladgheorghe
  Remove IMPLEMENTATION_NOTES.md from dealer_ring docs
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **0e038b12** (2025-11-24) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **78116cd3** (2025-11-25) by Vlad Gheorghe
  feat(dealer): Complete dealer ring implementation with worked examples (#18)
  * Add dealer ring implementation plan
  * Add dealer module core: models, kernel, assertions
  Phase 1 implementation of the dealer ring module:
  - models.py: Data models for dealer simulation
    - Ticket: Tradable debt instrument with face value and maturity
    - BucketConfig: Maturity bucket configuration (short/mid/long)
    - DealerState: Per-bucket dealer market-making state
    - VBTState: Value-based trader state with loss-based anchor updates
    - TraderState: Ring trader state with single-issuer constraint
  - kernel.py: L1 dealer pricing kernel per specification Section 8
    - Capacity computation: K* = floor(V/M), X* = S*K*
    - Layoff probability: λ = S/(X* + S)
    - Inside width: I = λ*O
    - Inventory-sensitive midline: p(x) = M - O/(X*+2S)*(x - X*/2)
    - Clipped quotes: a_c(x) = min(A, a(x)), b_c(x) = max(B, b(x))
    - Guard regime: M <= M_MIN pins to outside quotes
    - Feasibility checks: can_interior_buy, can_interior_sell
  - assertions.py: C1-C6 programmatic invariant checks
    - C1: Double-entry conservation
    - C2: Quote bounds and pin detection
    - C3: Feasibility pre-checks
    - C4: Passthrough invariants
    - C5: Equity basis (V = C + M*a)
    - C6: Anchor timing discipline
  All arithmetic uses Decimal for precision (no floats).
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add trading execution and event logging for dealer module
  - trading.py: TradeExecutor class for customer trades
    - execute_customer_sell: Event 1 (interior) and Event 9 (passthrough)
    - execute_customer_buy: Event 2 (interior) and Event 10 (passthrough)
    - Deterministic ticket selection with issuer preference
    - C1, C3, C4 assertion checking per trade
    - Automatic quote recomputation after trades
  - events.py: EventLog class for simulation observability
    - Trade logging (side, price, passthrough flag)
    - Settlement and default logging with recovery rates
    - Rebucketing events (Events 11-12)
    - VBT anchor updates after defaults
    - Query methods for day-based event lookup
    - Loss rate computation for VBT anchor updates
    - JSONL and DataFrame export
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add comprehensive dealer module tests (56 tests)
  test_kernel.py: Unit tests for L1 dealer kernel
  - Capacity computation: K* = floor(V/M), X* = S*K*
  - Layoff probability: λ = S/(X* + S)
  - Inside width: I = λ*O
  - Midline formula: p(x) = M - O/(X*+2S)*(x - X*/2)
  - Interior quotes: a(x), b(x)
  - Clipped quotes and pin detection
  - Guard regime (M <= M_MIN)
  - Feasibility checks (can_interior_buy, can_interior_sell)
  - C2 and C5 invariant verification
  test_examples.py: Integration tests from worked examples
  - Example 5: Dealer earns spread over trades
  - Example 4: Inventory limit and VBT layoff
  - Example 6: Bid-side passthrough
  - Example 13: Capacity jump across integer
  - Example 9: Guard regime at low M
  - Examples 10/12: Partial recovery defaults
  - Quote bounds (C2 assertion)
  - Feasibility (C3 assertion)
  - Double-entry (C1 assertion)
  All 56 tests pass with high coverage:
  - kernel.py: 97%
  - trading.py: 93%
  - assertions.py: 89%
  - models.py: 84%
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add dealer ring simulation event loop
  Implements the six-phase event loop per Section 11 of the spec:
  - Phase 1: Maturity updates and rebucketing (Events 11-12)
  - Phase 2: Dealer state pre-computation
  - Phase 3: Sell/buy eligibility determination
  - Phase 4: Order flow processing (Events 1-2, 9-10)
  - Phase 5: Settlement with proportional recovery (Events 6-8)
  - Phase 6: VBT anchor updates
  Key features:
  - DealerRingConfig for all simulation parameters
  - Complete event loop orchestration
  - Proportional recovery for partial defaults
  - VBT anchor adjustment based on bucket loss rates
  - Integration with EventLog for observability
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add simulation integration tests (23 tests)
  Tests cover all six phases of the event loop:
  - Phase 1: Maturity updates and rebucketing (Events 11-12)
  - Phase 2: Dealer pre-computation
  - Phase 3: Sell/buy eligibility sets
  - Phase 4: Randomized order flow
  - Phase 5: Settlement with proportional recovery
  - Phase 6: VBT anchor updates
  Also fixes N_max=0 handling in order flow to support isolated testing.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * feat(dealer): Add HTML report generator for dealer ring simulations
  Implements plan 017 for generating readable HTML reports matching the
  Kalecki ring style. Features:
  - New report.py module with generate_dealer_ring_html() and export_dealer_ring_html()
  - Snapshot capture in DealerRingSimulation (Day 0 + after each day)
  - DaySnapshot dataclass for serializing simulation state
  - to_html() convenience method on simulation
  - Per-day sections showing: events table, dealer state cards (with kernel
    parameters), VBT state cards, trader T-account balance sheets
  - Color-coded event types (trade, rebucket, settlement, default, quote)
  - Pin indicators for dealer quotes at VBT bounds
  - HTML escaping for security
  - 15 new tests for report generation
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Fix rebucket transfer price and add dealer_ring examples folder
  ## Bug Fix
  - Fixed dealer rebucket transfer price to use receiving bucket's VBT
    mid anchor M instead of old-bucket dealer's ask price
  - This preserves equity conservation (E = C + M*a unchanged)
  - Ref: PDF spec "internal sale at the Mid bucket mid M_M = 1"
  ## Examples Folder
  - Added examples/dealer_ring/ for spec examples
  - example1_migrating_claim.py demonstrates:
    - Trader sells ticket to Long dealer at bid ~0.95
    - Ticket tau crosses Long->Mid boundary
    - Internal rebucket at M=1.00 (not ask=0.975)
  - Generated HTML reports go to out/ (gitignored)
  ## Verification
  After fix:
  - Long dealer: a=1, C=1.05 (matches spec)
  - Mid dealer:  a=2, C=0.00 (matches spec)
  - Equity conserved for both dealers
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add verification prompt for Example 1
  Prompt for another AI to check HTML report matches spec,
  including the corrected rebucket transfer price at M_receiving = 1.00.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Complete dealer ring examples 1-14 with PDF-matched numbering
  Implements all 14 worked examples from dealer_examples.pdf:
  - Examples 1-6: Core dealer mechanics (migrating claims, cross-bucket, clipping, VBT layoff, earnings, passthrough)
  - Example 7: Edge rung without interior clipping
  - Example 8: Guard regime at low M
  - Examples 9 & 11: Partial recovery defaults (R=0.375 and R=0.6)
  - Example 10: Trader-held rebucketing
  - Example 12: Capacity integer crossing
  - Example 13: Event-loop harness with eligibility sets
  - Example 14: Ticket-level transfer (no generic materialization)
  Key fixes:
  - Add Guard mode check to can_interior_sell() in kernel.py
  - Fix settlement precision: use remainder-based distribution to avoid
    1/3 + 1/3 + 1/3 != 1 floating-point accumulation errors
  - Fix _pay_holder() to remove tickets from trader's tickets_owned
  Also includes:
  - VERIFICATION_PROMPT.md for independent AI verification
  - assemble_examples.py script to generate worked_examples.txt
  - Updated README.md with all examples and PDF section mappings
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * Add HTML reports for dealer ring examples 1-14
  Generated verification reports showing all examples match PDF specification.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  * NEXT STEP: Integrate dealer module with main Kalecki simulation
  This plan outlines the architecture and implementation steps to unify the
  standalone dealer ring implementation (~3,661 lines, 14 verified examples)
  with the main Bilancio simulation engine.
  Key integration points:
  - Phase 1: Contract-to-Ticket bridge (payables <-> tickets)
  - Phase 2: DealerSubsystem wrapper for main engine
  - Phase 3: YAML configuration extension for dealer settings
  - Phase 4: Parameter sweep infrastructure with dealer support
  - Phase 5: Integration testing and validation
  Goal: Enable scenarios like "100-agent Kalecki ring with dealer-mediated
  secondary market" and compare default rates with/without dealer.
  See docs/plans/016_dealer_kalecki_integration.md for full details.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>
  ---------
  Co-authored-by: Claude <noreply@anthropic.com>

- **f928bf9a** (2025-11-25) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **60d56cef** (2025-11-25) by vladgheorghe
  feat: Implement dealer-Kalecki integration (Plan 016)
  This commit implements the integration between the standalone dealer module
  and the main Bilancio simulation engine, enabling Kalecki ring simulations
  with dealer-mediated secondary markets.
  ## New Files
  ### Core Integration
  - `src/bilancio/dealer/bridge.py` - Contract-to-Ticket conversion functions
    - payables_to_tickets(): Convert Payables to tradeable Tickets
    - assign_bucket(): Determine maturity bucket assignment
    - tickets_to_trader_holdings(): Group tickets by owner
    - apply_trade_results_to_payables(): Sync trades back to contracts
  - `src/bilancio/engines/dealer_integration.py` - DealerSubsystem wrapper
    - DealerSubsystem dataclass: Maintains parallel dealer state
    - initialize_dealer_subsystem(): Set up dealers, VBTs, and traders
    - run_dealer_trading_phase(): Execute trading for a day
    - sync_dealer_to_system(): Sync results back to main system
  ### Configuration
  - DealerConfig, DealerBucketConfig, DealerOrderFlowConfig, DealerTraderPolicyConfig
    models added to config/models.py for YAML scenario specification
  ### Examples
  - `examples/scenarios/kalecki_with_dealer.yaml` - Full dealer-enabled ring
  - `examples/scenarios/simple_dealer.yaml` - Minimal dealer example
  ### Tests
  - `tests/engines/test_dealer_subsystem.py` - DealerSubsystem unit tests
  - `tests/integration/test_dealer_integration.py` - Integration tests (9 tests)
  ## Modified Files
  - `src/bilancio/domain/instruments/credit.py`
    - Added holder_id field for secondary market transfers
    - Added effective_creditor property for settlement
  - `src/bilancio/engines/simulation.py`
    - Added enable_dealer parameter to run_day()
    - Added SubphaseB_Dealer between B1 and B2
  - `src/bilancio/experiments/ring.py`
    - Added dealer_enabled and dealer_config options to sweep runner
  - `src/bilancio/ui/cli.py`
    - Extended sweep CLI to support dealer options
  ## Test Results
  - 246 tests pass (2 skipped with documented reasons)
  - All 14 dealer ring examples still pass
  - New integration tests verify dealer-Kalecki integration
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **233e6638** (2025-11-28) by vladgheorghe
  fix: Address critical PR review issues for dealer-Kalecki integration
  Three critical issues identified in PR review have been fixed:
  1. Settlement now uses effective_creditor (settlement.py:458)
     - Changed from payable.asset_holder_id to payable.effective_creditor
     - Ensures secondary market holders receive payment, not original creditors
  2. Bridge updates holder_id, not asset_holder_id (bridge.py:227)
     - Corrected apply_trade_results_to_payables to update holder_id
     - asset_holder_id remains the original creditor; holder_id tracks transfers
  3. Matured tickets are now cleaned up (dealer_integration.py:342-395)
     - Tickets with remaining_tau=0 are removed from subsystem
     - Prevents unbounded memory growth over long simulations
     - Also removes from inventories and trader holdings
  Additionally:
  - Un-skipped two integration tests that validate these fixes
  - All 248 tests now pass
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **c3f661ea** (2025-11-28) by vladgheorghe
  chore: Update GitHub Actions to use claude-opus-4-5-20251101 model
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **22fa00a3** (2025-11-28) by Vlad Gheorghe
  Merge pull request #19 from vlad-ds/feature/016-dealer-kalecki-integration
  feat: Implement dealer-Kalecki integration (Plan 016)

- **c9ad8abd** (2025-11-28) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **5c4bf285** (2025-11-28) by vladgheorghe
  docs: Add Plan 018 for dealer comparison experiments
  Add implementation plan for running controlled experiments comparing
  Kalecki ring simulations with and without dealer-mediated secondary
  markets. Key features:
  - Control vs treatment design (100 agents, same parameters)
  - Grid sweep across κ, c, μ parameters (125 combinations)
  - Metrics: delta_total, phi_total (consistent with existing code)
  - 10-day maturity horizon with 15-day max simulation
  - Structured CSV/JSON outputs
  Also adds conversation transcript from 20251127 with requirements.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **9dc0942d** (2025-11-28) by vladgheorghe
  feat: Add dealer comparison experiment framework
  Implements paired control/treatment experiments for measuring dealer
  effect on default rates:
  - ComparisonSweepRunner runs same parameters with/without dealer
  - CLI: `bilancio sweep comparison` with full grid support
  - Outputs: comparison.csv (side-by-side metrics), summary.json
  - Metrics: delta_control, delta_treatment, delta_reduction, relief_ratio
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **83bfc6e2** (2025-11-28) by vladgheorghe
  fix: Connect dealer subsystem to scenario loading and simulation
  - Initialize dealer subsystem when config.dealer.enabled is true
  - Convert DealerConfig (YAML model) to DealerRingConfig (internal model)
  - Pass enable_dealer flag to run_day() when dealer_subsystem exists
  - Add enable_dealer parameter to run_step_mode and run_until_stable_mode
  The dealer trading phase now runs (SubphaseB_Dealer events generated),
  but actual trades don't occur yet due to trader cash not being synced
  from the main system. This is a separate issue in dealer_integration.py.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **6947b165** (2025-11-28) by vladgheorghe
  docs: Update plan 018 with known limitations
  Document that dealer trading doesn't occur yet due to trader cash
  not being synced from main system. Control and treatment runs produce
  identical results until this is fixed.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **1f61ae26** (2025-11-28) by vladgheorghe
  fix(dealer): Complete dealer integration with proper trading mechanics
  Major fixes to enable dealer-mediated secondary markets to reduce defaults:
  1. **Add dealer/VBT agents to main system** (dealer_integration.py)
     - Create actual Household agents for dealer_xxx and vbt_xxx entities
     - This allows proper ownership tracking when claims transfer to dealers
  2. **Fix ownership synchronization** (dealer_integration.py)
     - Correct attribute name: holder_id → asset_holder_id
     - Update agent.asset_ids lists when ownership changes
     - Log ClaimTransferredDealer events for all transfers
  3. **Fix price scaling for face values** (dealer_integration.py)
     - Scale unit price (B) by ticket.face to get correct total price
     - Dealer module returns per-unit prices, integration layer scales
  4. **Improve trading eligibility** (dealer_integration.py)
     - Increase lookahead horizon from 3 to 10 days
     - Process up to 10 sellers per trading phase (was 3)
     - Disable buying to prevent liquidity drain
  5. **Fix CLI defaults** (cli.py)
     - Set dealer_share and vbt_share defaults to 0
     - Agents now own 100% of claims initially for fair comparison
  Test results show dealer reduces defaults:
  - Mean relief ratio: 17.1% across parameter grid
  - Best result: 68.8% reduction at κ=1, c=2, μ=0.5
  - 11/18 parameter combinations showed improvement
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **c8146778** (2025-11-28) by vladgheorghe
  docs: Update Plan 018 with test results and mark COMPLETE
  - Replace "Known Limitations" section with actual test results
  - Document mean relief ratio of 17.1% across parameter grid
  - Note best result: 68.8% reduction at κ=1, c=2, μ=0.5
  - Document when dealer helps vs when it's less effective
  - Mark plan status as COMPLETE
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **c0d04f07** (2025-11-28) by vladgheorghe
  docs: Add dealer integration fixes documentation
  Records all issues encountered and fixes applied during the
  debugging session that made dealer trading functional.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **244d47a9** (2025-11-28) by vladgheorghe
  fix(dealer): Add proper Dealer/VBT agent types and fix integration bugs
  - Add DEALER and VBT to AgentKind enum
  - Create proper Dealer and VBT agent classes (replacing Household hack)
  - Fix holder_id vs asset_holder_id in sync (use secondary market holder)
  - Add cleanup for orphaned tickets after agent expulsion
  - Fix missing contracts in balance export (use .get() with None check)
  - Fix zero default rate returning None instead of 0
  All 248 tests pass. Dealer comparison shows 100% relief ratio on test scenario.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **372a0036** (2025-11-28) by vladgheorghe
  fix(dealer): Use round() instead of int() for cash sync
  Fixes truncation bug where fractional cash amounts from dealer trades
  were silently dropped. E.g., 855 × 0.9 = 769.5 was minted as 769.
  Changed int(delta) to round(delta) at sync points (lines 717, 736).
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **eac278c7** (2025-11-28) by vladgheorghe
  fix(dealer): Correct capital model - dealer/VBT bring NEW outside cash
  The dealer subsystem now correctly implements the specification:
  - Traders keep 100% of their receivables (not reallocated)
  - Dealer gets 25% of system cash as NEW money from outside
  - VBT gets 50% of system cash as NEW money from outside
  - Both start with empty inventory, building by purchasing from traders
  Fixes:
  - Issue 12: Capital model corrected (was negative relief, now positive)
  - Issue 13: Invariant check uses effective_creditor for secondary market
  - Issue 14: _remove_contract cleans up secondary market holders
  100-agent test results:
  - κ=0.5: 12.8% relief ratio
  - κ=1.0: 5.9% relief ratio
  - κ=2.0: 13.3% relief ratio
  Updated documentation:
  - Plan 016 marked COMPLETE
  - Plan 018 updated with final results
  - Fixes doc extended with Issues 12-14
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **ece9656f** (2025-11-28) by vladgheorghe
  docs: Add comprehensive dealer comparison analysis
  Detailed analysis of 125 paired experiments comparing Kalecki rings
  with and without dealer market-making. Key findings:
  - 19.3% mean relief ratio, 94/125 pairs improved, 0 worsened
  - Statistical significance: p = 1.92e-18
  - Six economic hypotheses tested and supported
  - c×μ synergy is the dominant interaction effect
  - Higher dealer capital doesn't uniformly improve outcomes
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **a95ce51f** (2025-11-28) by vladgheorghe
  feat(dealer): Re-enable buying per spec Section 11.2
  Re-enables trader buying functionality that was previously disabled.
  Experimental comparison (125 pairs, 100 agents each) shows:
  - With buying: 19.0% mean relief ratio
  - Without buying: 19.3% mean relief ratio
  Buying is slightly counterproductive (-0.3pp) because it reduces
  liquidity of traders who may need cash for their own obligations.
  However, keeping it enabled for spec compliance and further research.
  Fixed method name: payment_due() instead of dues_on_day().
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **9d5a556e** (2025-11-29) by vladgheorghe
  data: Add dealer comparison experiment results (125 pairs, 100 agents)
  Full parameter sweep results:
  - κ (kappa): 0.25, 0.5, 1, 2, 4
  - c (concentration): 0.2, 0.5, 1, 2, 5
  - μ (mu): 0, 0.25, 0.5, 0.75, 1
  Key findings:
  - Mean relief ratio: 19.0%
  - Pairs improved: 94/125 (75%)
  - Pairs worsened: 0/125 (0%)
  Contains aggregate CSV/JSON plus individual run data
  (events.jsonl, balances.csv, metrics.csv, scenario.yaml)
  for all 250 runs (125 control + 125 treatment).
  HTML reports excluded to reduce size.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **7690a61d** (2025-11-29) by vladgheorghe
  data: Add dealer comparison experiment data (250 runs, no HTML)
  Full 125-pair comparison experiment with 100 agents:
  - κ (kappa): 0.25, 0.5, 1, 2, 4
  - concentration: 0.2, 0.5, 1, 2, 5
  - μ (mu): 0, 0.25, 0.5, 0.75, 1
  Results with buying enabled:
  - Mean relief ratio: 19.0%
  - 94/125 pairs improved, 31 unchanged, 0 worsened
  Includes:
  - Aggregate results (comparison.csv, summary.json)
  - Individual runs (scenario.yaml, events.jsonl, balances.csv, metrics.*)
  - Excludes HTML files for size (~35MB total)
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **1cb97994** (2025-11-29) by vladgheorghe
  Merge branch 'feature/018-dealer-comparison-experiments'

- **11bbfa64** (2025-11-29) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **5077dee0** (2025-12-01) by vladgheorghe
  docs: add dealer ring documentation and conversation notes
  - Add New_Kalecki_ring_with_dealers.pdf with updated ring design
  - Add conversation notes from Dec 1, 2025
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **179c8be7** (2025-12-01) by Vlad Gheorghe
  Merge pull request #21 from vlad-ds/docs/dealer-ring-updates
  docs: add dealer ring documentation and conversation notes

- **036b6ad2** (2025-12-01) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **5df10437** (2025-12-01) by vladgheorghe
  feat(dealer): implement Section 8 metrics for functional dealer analysis
  Implements the measurement framework defined in Section 8 of the
  "New Kalecki Ring with Dealers" specification for evaluating
  functional dealer criteria (D1-D3) and requirements (R1-R6).
  Key additions:
  - Trade log with pre/post state tracking (8.1)
  - Dealer P&L and profitability metrics by bucket (8.2)
  - Trader investment returns and liquidity use tracking (8.3)
  - Repayment-priority diagnostics (safety margin tracking) (8.4)
  - Experiment-level summary statistics (8.5)
  Changes:
  - New metrics module: src/bilancio/dealer/metrics.py
    - TradeRecord, DealerSnapshot, TraderSnapshot dataclasses
    - RunMetrics with P&L, return, and summary computations
  - Dealer integration: capture metrics during trading phase
  - Comparison experiment: export dealer metrics to comparison.csv
  - UI/run: export dealer_metrics.json for each treatment run
  - Tests: 15 new test cases for metrics functionality
  The comparison CSV now includes 11 new dealer metric columns:
  dealer_total_pnl, dealer_total_return, dealer_profitable,
  spread_income_total, mean_trader_return, fraction_profitable_traders,
  liquidity_driven_sales, rescue_events, total_trades,
  unsafe_buy_count, fraction_unsafe_buys
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **96dbb341** (2025-12-01) by vladgheorghe
  data: add dealer metrics experiment results (125 pairs)
  Adds the output from the dealer comparison experiment with new
  Section 8 metrics. Includes only the key data files:
  - aggregate/comparison.csv: All 125 comparison results with 11 new
    dealer metric columns
  - aggregate/summary.json: Experiment configuration and summary stats
  - 125 individual dealer_metrics.json files from treatment runs
  Key findings from this experiment:
  - 118/125 runs have non-profitable dealers (mean P&L = -3.84)
  - Non-profitable dealers provide higher relief (4.22% vs 0%)
  - Average 13.4 trades per run
  - 0 liquidity-driven sales, rescue events, unsafe buys
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **fd736599** (2025-12-01) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **3889cada** (2025-12-04) by vladgheorghe
  feat(dealer): add mid price tracking and debt-to-money ratio metrics
  Implements Plan 020 for dealer ring analysis:
  - Track dealer midline and VBT mid prices across all timepoints
  - Add premium/discount metrics vs face value (par = 1)
  - Capture debt-to-money ratio at simulation start as control variable
  - Export time series data to CSV for analysis
  - Add 14 new unit tests for the metrics
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **4530425e** (2025-12-04) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **ac115ab8** (2025-12-04) by vladgheorghe
  docs: add plan 021 for balanced dealer comparison (C & D)
  Add implementation plan for the three-way comparison framework from
  Section 9.3, based on Alex's feedback. Creates fair comparison between:
  - C (Mimic/Passive): Big entities hold securities + cash, no trading
  - D (Dealer/Active): Same starting position WITH trading enabled
  Also captures Alex's clarifications on face value, outside mid, and
  the "off-balance" metric (A.1).
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **2551b914** (2025-12-04) by vladgheorghe
  feat: implement balanced dealer comparison (C vs D) framework
  Implements Plan 021 for comparing passive holders (C) against active
  dealers (D) with identical starting balance sheets.
  Key features:
  - BalancedDealerConfig for face_value, outside_mid_ratio, big_entity_share
  - compile_ring_explorer_balanced() for generating balanced scenarios
  - initialize_balanced_dealer_subsystem() for big entities with inventory
  - Passive mode (no trading) vs Active mode (trading enabled)
  - BalancedComparisonRunner for paired experiments
  - CLI: `bilancio sweep balanced` command
  Math:
  - Face value S = 20 (cashflow at maturity)
  - Outside mid M = ρ × S where ρ is configurable (default 0.75)
  - Traders issue additional debt (β × original), big entities hold claims
  - Traders get matching additional cash to preserve cash/debt ratio
  - Big entities start balanced: Cash = Securities × M
  Results from 125-pair sweep (5κ × 5c × 5μ):
  - Mean trading effect: 2% reduction in defaults
  - 16 pairs showed improvement (12.8%)
  - Trading most effective with high inequality (c=5) and moderate liquidity
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **082dfe18** (2025-12-04) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **6aa82188** (2025-12-04) by vladgheorghe
  data: add balanced dealer comparison results (125 pairs)
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **390e0f30** (2025-12-04) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **eca117b4** (2025-12-05) by vladgheorghe
  data: add balanced dealer individual run results (250 runs)
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **fa361765** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **b8543c74** (2025-12-05) by vladgheorghe
  chore: remove old dealer_metrics_comparison experiment data
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **52413609** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **a17e45b7** (2025-12-05) by vladgheorghe
  feat(dealer): implement Plan 022 enhanced instrumentation (Phases 1,3,4,5)
  Add detailed logging infrastructure for dealer ring experiments to understand
  why dealers help (or don't help) reduce defaults.
  Phase 1 - Enhanced Trade Logging:
  - Add run_id, regime, hit_inventory_limit fields to TradeRecord
  - Update to_dict() to include new fields in CSV exports
  Phase 3 - Inventory Timeseries:
  - Extend DealerSnapshot with max_capacity, capacity_pct, is_at_zero,
    hit_vbt_this_step, total_system_face, dealer_share_pct
  - Add to_inventory_timeseries_csv() export method
  Phase 4 - System State Timeseries:
  - New SystemStateSnapshot dataclass tracking total_face_value,
    face_by_bucket, total_cash, debt_to_money ratio
  - Add _capture_system_state_snapshot() in dealer_integration
  - Add to_system_state_csv() export method
  Phase 5 - Integration:
  - Add detailed_logging config to BalancedComparisonConfig
  - Add detailed_dealer_logging, run_id, regime params to run_scenario
  - Export trades.csv, inventory_timeseries.csv, system_state_timeseries.csv
    when detailed_logging=True
  - Fix circular import in ring.py with lazy import
  Phase 2 (Repayment Events) deferred - most complex, requires linking
  trades to liabilities.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **2cc4d158** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **3b58d4dd** (2025-12-05) by vladgheorghe
  feat(metrics): add RepaymentEvent tracking (Plan 022 Phase 2)
  Implements repayment events tracking to analyze how trading affects
  liability outcomes. For each (trader, liability) pair, records:
  - Outcome: "repaid" or "defaulted"
  - Trading activity before maturity: buy_count, sell_count, net_cash_pnl
  - Strategy classification: no_trade, hold_to_maturity, sell_before, round_trip
  Changes:
  - Add RepaymentEvent dataclass in dealer/metrics.py
  - Add classify_trading_strategy() helper function
  - Add build_repayment_events() to construct events from event log
  - Add to_repayment_events_csv() export method to RunMetrics
  - Integrate into run.py to export repayment_events.csv when
    detailed_dealer_logging is enabled
  The repayment_events.csv enables analysis of whether trading helped
  traders avoid defaults and what strategies were most effective.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **51a8983b** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **0a22a560** (2025-12-05) by vladgheorghe
  docs: mark Plan 022 as complete
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **0c3af8db** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **96f23f88** (2025-12-05) by vladgheorghe
  data: add detailed instrumentation sweep results (125 pairs)
  Full balanced comparison sweep with Plan 022 detailed logging:
  - 125 comparison pairs (5 kappa × 5 concentration × 5 mu)
  - n_agents=5, outside_mid_ratio=1.0, base_seed=42
  Structure:
  - aggregate/comparison.csv: Summary metrics for all C vs D pairs
  - aggregate/summary.json: Aggregate statistics
  - passive/runs/: 125 passive (no trading) individual runs
  - active/runs/: 125 active (with trading) individual runs
  Each active run includes detailed CSVs:
  - trades.csv: Per-trade log with prices, VBT routing
  - inventory_timeseries.csv: Dealer capacity utilization over time
  - system_state_timeseries.csv: Total debt/money evolution
  - repayment_events.csv: Trading strategy vs repayment outcome
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **27e04069** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **7ef3133c** (2025-12-05) by vladgheorghe
  data: full 625-pair sweep with outside_mid_ratio varied
  Complete balanced comparison sweep with Plan 022 detailed logging:
  - 625 comparison pairs (5 kappa × 5 concentration × 5 mu × 5 outside_mid_ratio)
  - n_agents=5, base_seed=42
  Grid values:
  - kappa: [0.25, 0.5, 1, 2, 4]
  - concentration: [0.2, 0.5, 1, 2, 5]
  - mu: [0, 0.25, 0.5, 0.75, 1]
  - outside_mid_ratio: [1.0, 0.9, 0.8, 0.75, 0.5]
  Structure:
  - aggregate/comparison.csv: Summary metrics for all 625 C vs D pairs
  - passive/runs/: 625 passive (no trading) individual runs
  - active/runs/: 625 active (with trading) individual runs
  Each active run includes detailed CSVs:
  - trades.csv, inventory_timeseries.csv, system_state_timeseries.csv, repayment_events.csv
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **eaf9a483** (2025-12-05) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **f41ddba0** (2025-12-08) by vladgheorghe
  feat(analysis): implement default-aware instrumentation (Plan 023)
  Part A: Refactor build_repayment_events() to capture defaulted liabilities
  - Add LiabilityInfo dataclass to track liability settlement status
  - Add build_liability_map() to scan PayableCreated/PayableSettled events
  - Refactor build_repayment_events() to use liability map approach
  - Liabilities that matured but weren't settled are now marked "defaulted"
  Part B: Add analysis scripts for cross-run aggregation
  - strategy_outcomes.py: Analyzes strategy success/failure rates
    - build_strategy_outcomes_by_run() -> strategy_outcomes_by_run.csv
    - build_strategy_outcomes_overall() -> strategy_outcomes_overall.csv
  - dealer_usage_summary.py: Explains dealer effectiveness
    - build_dealer_usage_by_run() -> dealer_usage_by_run.csv
  CLI commands:
  - bilancio sweep strategy-outcomes --experiment <path>
  - bilancio sweep dealer-usage --experiment <path>
  This enables answering: which strategies succeed, why dealers have no
  effect in some runs, and what fraction of defaulters used the dealer.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **2b9042af** (2025-12-08) by vladgheorghe
  feat(cli): expose detailed-logging flag for balanced sweep
  Adds --detailed-logging/--no-detailed-logging option to the
  balanced sweep command to enable/disable detailed CSV logging
  (trades.csv, repayment_events.csv, etc.) from the CLI.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **f492bc42** (2025-12-08) by vladgheorghe
  data: Plan 023 full 625-pair sweep with default-aware instrumentation
  Full sweep results with new repayment_events.csv format that captures
  all matured liabilities (both repaid and defaulted) with trading activity.
  Parameters:
  - n_agents: 5, maturity_days: 10
  - kappas: 0.25, 0.5, 1, 2, 4
  - concentrations: 0.2, 0.5, 1, 2, 5
  - mus: 0, 0.25, 0.5, 0.75, 1
  - outside_mid_ratios: 1.0, 0.9, 0.8, 0.75, 0.5
  - 625 parameter combinations
  New metrics captured:
  - Per-liability outcome (repaid/defaulted)
  - Trading strategy (no_trade, hold_to_maturity, sell_before, round_trip)
  - Buy/sell counts and cash P&L per trader
  - Strategy-specific default rates
  - Dealer usage patterns by run
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **e8b3435e** (2025-12-08) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **fa65efd9** (2025-12-08) by vladgheorghe
  docs: add Stojanovic et al. (2025) dealer simulation paper
  Add academic paper "Liquidity and internal debt: Instrument level
  dealer based simulation" documenting the Bilancio simulator framework
  and the Kalecki ring internal debt experiments.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **4d61f384** (2025-12-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **ac1cb8f9** (2025-12-10) by vladgheorghe
  feat(dealer): Implement Plan 024 balanced dealer/VBT initialization with rollover
  Major changes to improve dealer ring simulation based on PDF specification:
  1. Balanced VBT/Dealer initialization per maturity bucket:
     - VBT holds 25% of claims per bucket (short/mid/long) + matching cash
     - Dealer holds 12.5% of claims per bucket + matching cash
     - Traders keep remaining 62.5%
  2. Continuous rollover of settled claims:
     - New maturity_distance field on Payable instruments
     - When a payable is settled, create new payable with same ΔT
     - Cash flows back from creditor to debtor on rollover
     - rollover_enabled flag in system state and config
  3. Updated scenario generator (ring_explorer.py):
     - compile_ring_explorer_balanced() now properly allocates per bucket
     - Creates vbt_short, vbt_mid, vbt_long entities
     - Creates dealer_short, dealer_mid, dealer_long entities
     - Distributes claims based on maturity (1-3: short, 4-8: mid, 9+: long)
  4. Updated experiment runners:
     - BalancedComparisonConfig with vbt_share_per_bucket, dealer_share_per_bucket
     - RingSweepRunner with rollover_enabled parameter
     - Stability checks account for rollover mode (no open obligations check)
  Files modified:
  - config/models.py: Added VBT/Dealer share params, rollover_enabled to RunConfig
  - domain/instruments/credit.py: Added maturity_distance field
  - config/apply.py: Handle maturity_distance in create_payable
  - engines/settlement.py: Track settled payables, rollover function
  - engines/simulation.py: Rollover phase in run_day, stability check update
  - engines/system.py: rollover_enabled in State
  - engines/dealer_integration.py: Balanced initialization
  - scenarios/generators/ring_explorer.py: Per-bucket allocation
  - experiments/balanced_comparison.py: New parameters
  - experiments/ring.py: rollover_enabled parameter
  - ui/run.py: Apply rollover from config, stability check
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **0b886cba** (2025-12-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **86898626** (2025-12-10) by vladgheorghe
  feat(experiments): add progress tracking and resumption to balanced sweep
  - Show [X/Y] progress and ETA based on average time per pair
  - Load existing results from comparison.csv on startup
  - Skip already-completed parameter combinations
  - Use fixed output directory for resumption (out/experiments/plan024_sweep)
  This allows long-running sweeps to be interrupted and resumed.

- **d187fb9c** (2025-12-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **a06e5bcd** (2025-12-10) by vladgheorghe
  fix(scripts): suppress verbose output, only show progress
  - Filter stdout to only show progress lines and key messages
  - Log full verbose output to sweep.log for debugging
  - Clean terminal output shows only: progress, ETA, completion stats

- **ff8a2545** (2025-12-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **48183454** (2025-12-10) by vladgheorghe
  feat(experiments): add day-by-day progress tracking for sweeps
  - Add progress_callback parameter to run_scenario() and run_until_stable_mode()
  - Pass progress callback through ring.py _execute_run() to run_scenario()
  - Create _make_progress_callback() in balanced_comparison.py for day tracking
  - Update QuietStdout filter to show passive/active day progress lines
  - Shows elapsed time per simulation: "passive: day 5/15 (elapsed: 30s)"
  This gives visibility into long-running simulations instead of waiting
  with no feedback.
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **d2be4503** (2025-12-10) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **c47e85a7** (2025-12-11) by vladgheorghe
  feat(experiments): Plan 024 dealer simulation sweep results (125 pairs)
  Complete parameter sweep comparing passive vs active dealer trading:
  - 5 kappa values (0.25, 0.5, 1, 2, 4)
  - 5 concentration values (0.2, 0.5, 1, 2, 5)
  - 5 mu values (0, 0.25, 0.5, 0.75, 1)
  - 100 traders per scenario, 15 days with rollover
  Key findings:
  - Trading reduces defaults in 84/125 scenarios (67%)
  - Effect increases with leverage: κ=4 avg 9.5%, κ=0.25 avg 0.7%
  - Best result: κ=4, c=5, μ=1 shows 51% reduction (100%→49%)
  - Maturity mismatch (μ) is the key driver of trading benefits
  🤖 Generated with [Claude Code](https://claude.com/claude-code)
  Co-Authored-By: Claude <noreply@anthropic.com>

- **bcce1062** (2025-12-11) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **aec8f628** (2026-01-11) by vladgheorghe
  docs(refactor): add 2026 codebase analysis and refactoring plan
  Comprehensive analysis of codebase structure with recommendations for:
  - Phase 1: Cleanup (dead code, merge modules, flatten nesting)
  - Phase 2: Split large files (CLI, visualization)
  - Phase 3: Add test coverage (experiments framework)
  - Phase 4: Abstractions for cloud/DB scalability
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **8e264a22** (2026-01-11) by vladgheorghe
  docs(refactor): add comprehensive Plan 025 for Phase 1 cleanup
  Full restructuring plan addressing all identified issues:
  Part A - Dead code removal:
  - Delete modules/dealer_ring/ (empty pycache)
  - Delete io/ (stub code)
  - Archive stale TODO.md
  Part B - Split large files:
  - ui/cli.py (1,100 lines) → ui/cli/{run,sweep,utils}.py
  - analysis/visualization.py (2,200 lines) → visualization/{balances,events,phases}.py
  - experiments/ring.py → ring.py + sampling/{grid,lhs,frontier}.py
  Part C - Add test coverage:
  - experiments/ 0-25% → 60%
  - visualization 13% → 50%
  - ui/cli 34% → 60%
  Part D - Flatten scenarios/generators/
  Includes verification steps, rollback plan, and success criteria.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **9d78869a** (2026-01-11) by vladgheorghe
  refactor(cleanup): Part A - remove dead code
  - Delete empty modules/dealer_ring/ directory (only contained __pycache__)
  - Delete io/ module (stub functions that only raised NotImplementedError)
  - Archive stale TODO.md to docs/archive/TODO_2025.md
  - Remove test_io_imports test that tested deleted stubs
  Part of Plan 025 Phase 1 Cleanup.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **8e84355d** (2026-01-11) by vladgheorghe
  refactor(scenarios): Part D - flatten generators/ directory
  - Move ring_explorer.py from scenarios/generators/ to scenarios/
  - Update scenarios/__init__.py to export compile_generator, compile_ring_explorer,
    and compile_ring_explorer_balanced
  - Delete scenarios/generators/ directory
  - Update imports in config/loaders.py, experiments/ring.py,
    tests/scenarios/test_ring_explorer.py, and dashboards/monotonicity_demo/
  Part of Plan 025 Phase 1 Cleanup.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **4238ff09** (2026-01-11) by vladgheorghe
  refactor(structure): Part B - split large files into modules
  B1: Split ui/cli.py (849 lines) into ui/cli/ directory:
  - __init__.py: Main CLI entry point, click group
  - run.py: run, validate, new, analyze commands
  - sweep.py: sweep group and all sweep subcommands
  - utils.py: Shared utilities (console, decimal helpers)
  B2: Split analysis/visualization.py (2203 lines) into visualization/ directory:
  - __init__.py: Re-exports public API
  - balances.py: T-account and balance sheet display
  - events.py: Event table formatting
  - phases.py: Phase summary visualization
  - common.py: Shared utilities and constants
  B3: Extract sampling strategies from experiments/ring.py:
  - sampling/__init__.py: Re-exports
  - sampling/grid.py: Cartesian product sampling
  - sampling/lhs.py: Latin Hypercube Sampling
  - sampling/frontier.py: Binary search frontier detection
  All public APIs preserved for backwards compatibility.
  Part of Plan 025 Phase 1 Cleanup.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **c211e1fd** (2026-01-11) by vladgheorghe
  test(coverage): Part C - add tests for experiments, visualization, CLI
  Added 96 new tests to improve coverage from 53% to 64%:
  C1: tests/experiments/test_sweep_runners.py (33 tests)
  - Grid, LHS, frontier sampling functions
  - RingSweepRunner setup and configuration
  - ComparisonSweepRunner and BalancedComparisonRunner setup
  - Result dataclass calculations
  C2: tests/analysis/test_visualization.py (41 tests)
  - Balance display functions (rich/simple formats)
  - Event display and table functions
  - Phase display functions
  - Build functions for T-accounts and events
  - Multi-agent visualization
  C3: tests/ui/test_cli_integration.py (22 tests)
  - CLI help commands verification
  - Validate command with real scenarios
  - Run command with various options and exports
  - Error handling for invalid inputs
  Test count: 276 → 371
  Coverage: 53% → 64%
  Part of Plan 025 Phase 1 Cleanup.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **6a5f94fc** (2026-01-11) by vladgheorghe
  fix: address PR review feedback
  - Remove duplicate RICH_AVAILABLE definitions in balances.py and events.py
    (now imported only from common.py)
  - Remove dead code _build_events_detailed_renderables_old in events.py
  - Use console.print() instead of click.echo() for Rich-formatted output
    in sweep.py strategy-outcomes and dealer-usage commands
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **8b8ff83c** (2026-01-11) by Vlad Gheorghe
  Merge pull request #23 from vlad-ds/refactor/phase-1-cleanup
  Phase 1 Codebase Cleanup & Restructuring (Plan 025)

- **657921de** (2026-01-11) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **b1ebf91b** (2026-01-11) by vladgheorghe
  feat: add storage and runner abstraction layers (Phase 4)
  Add foundation for cloud/database backend support:
  Storage module (src/bilancio/storage/):
  - RunStatus, RunArtifacts, RunResult, RegistryEntry models
  - ResultStore and RegistryStore protocols
  - FileResultStore: file-based result storage with JSON metadata
  - FileRegistryStore: CSV-based registry with dynamic fields
  Runners module (src/bilancio/runners/):
  - SimulationExecutor protocol for synchronous execution
  - JobExecutor protocol for async/distributed execution (future)
  - LocalExecutor: wraps run_scenario() with structured output
  Tests: 85 new tests (46 storage, 39 runners)
  Total: 371 → 456 tests, 64% → 67% coverage
  Plan: docs/refactor_2026/026_phase4_abstractions.md
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **d8c1c363** (2026-01-11) by vladgheorghe
  refactor: RingSweepRunner uses FileRegistryStore
  - Add registry_store parameter to RingSweepRunner (optional, defaults to FileRegistryStore)
  - Replace manual CSV registry handling with RegistryStore protocol calls
  - Update _upsert_registry to create RegistryEntry objects
  - FileRegistryStore: handle empty experiment_id for flat directory structure
  - FileRegistryStore: add ring-specific fields (phase, S1, L0, metrics_html)
  - Maintain backward compatibility: create empty registry CSV on init
  All 456 tests pass.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **afe539e2** (2026-01-11) by vladgheorghe
  docs: add Plan 027 for executor separation of concerns
  Defines the next stage of refactoring:
  - Executor only runs simulation, returns artifact paths/URIs
  - Executor reports storage location (local vs cloud)
  - MetricsComputer handles all derived metrics (separate concern)
  - ArtifactLoader protocol for fetching from any storage backend
  - Clear path to CloudExecutor implementation
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **4a01e70f** (2026-01-11) by vladgheorghe
  feat(runners): implement Plan 027 executor separation of concerns
  Refactors the runner abstractions to cleanly separate simulation execution
  from metrics computation, enabling future cloud execution support.
  New components:
  - RunOptions: configuration dataclass for run_scenario()
  - ExecutionResult: result with storage_type, storage_base, artifacts
  - ArtifactLoader: protocol for loading artifacts from any storage
  - LocalArtifactLoader: file-based implementation
  - MetricsComputer: extracts metrics computation from LocalExecutor
  - MetricsBundle: dataclass for computed metrics
  Changes:
  - LocalExecutor: now only runs simulation, returns artifact paths
  - RingSweepRunner: uses executor + MetricsComputer pattern
  - Updated protocols with new execute() signature
  Tests: 527 passing (77 new), 67% coverage. Verified with control/treatment sweeps.
  This sets up a clear path for CloudExecutor + S3ArtifactLoader in the future.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **f82653d1** (2026-01-11) by vladgheorghe
  fix(storage): address PR review feedback
  - Fix _row_to_entry bug: metrics were assigned to parameters dict
    instead of metrics dict (P2 bug from Claude/Codex reviews)
  - Add path traversal validation in load_artifact for security
  - Add input validation for experiment_id and run_id to prevent
    malicious path construction
  - Add tests for metrics round-trip through CSV
  - Add tests for security validations
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **ded88327** (2026-01-11) by Vlad Gheorghe
  Merge pull request #24 from vlad-ds/refactor/phase-4-abstractions
  feat: add storage and runner abstraction layers (Phase 4)

- **99280d89** (2026-01-11) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **51674f1a** (2026-01-11) by vladgheorghe
  feat(cloud): implement Modal cloud executor (Plan 028)
  Add CloudExecutor for running simulations on Modal's serverless infrastructure.
  This enables parallel execution of large parameter sweeps in the cloud.
  Key components:
  - cloud/modal_app.py: Modal app with run_simulation function
  - runners/cloud_executor.py: CloudExecutor implementing SimulationExecutor protocol
  - storage/modal_artifact_loader.py: ModalVolumeArtifactLoader for remote artifacts
  - CLI --cloud flag for sweep ring command
  The CloudExecutor:
  - Submits simulations to deployed Modal function
  - Downloads artifacts to local disk after completion
  - Returns correct local paths for MetricsComputer integration
  - Supports both single execution and batch parallel execution
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **047465f9** (2026-01-12) by vladgheorghe
  feat(cloud): add cloud execution support to balanced sweep
  - Add executor parameter to BalancedComparisonRunner
  - Add --cloud flag to `bilancio sweep balanced` CLI command
  - Add Modal usage instructions to CLAUDE.md
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **1d9493eb** (2026-01-12) by vladgheorghe
  feat(jobs): implement job system for tracking simulation runs (Plan 029)
  - Add memorable 4-word job IDs using xkcdpass library
  - Create Job, JobConfig, JobEvent models with serialization
  - Implement JobManager for lifecycle tracking (create/start/progress/complete/fail)
  - Integrate job tracking into sweep ring and sweep balanced CLI commands
  - Write job_manifest.json to output directory for each job
  - Add 39 unit tests for job system
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **88466ae5** (2026-01-12) by vladgheorghe
  docs: add reminder to prominently display Job ID to users
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **be2c9ee0** (2026-01-12) by vladgheorghe
  fix: add xkcdpass to Modal image and handle failed runs gracefully
  - Add xkcdpass dependency to Modal container image
  - Handle None values in comparison result logging
  - Add Modal authentication tip to CLAUDE.md
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **522a5f7b** (2026-01-12) by vladgheorghe
  feat(cloud): display job_id in Modal logs and return modal_call_id
  - Add job_id parameter to Modal run_simulation function
  - Print job info banner at start of execution (visible in Modal logs)
  - Return modal_call_id in execution result
  - Pass job_id from CLI through CloudExecutor to Modal
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **58e9649e** (2026-01-12) by vladgheorghe
  docs: clarify ID structure and add instructions to display IDs to user
  - Add explicit instructions for Claude to display Job ID and Modal Call ID
  - Explain why jobs have multiple runs (parameter sweeps)
  - Use job_id as experiment_id to simplify (removes redundancy)
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **63bdeb87** (2026-01-12) by vladgheorghe
  docs: simplify - just display Job ID to user, not run IDs
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **3f2694f9** (2026-01-12) by vladgheorghe
  docs: include Modal ID for debugging on modal.com
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **54a0cf63** (2026-01-12) by vladgheorghe
  feat(jobs): store Modal call IDs in job manifest
  Propagate modal_call_id from cloud execution through the entire chain
  to job manifest for debugging purposes:
  - Add modal_call_id to ExecutionResult (runners/models.py)
  - Add modal_call_id to RingRunSummary (experiments/ring.py)
  - Add passive/active_modal_call_id to BalancedComparisonResult
  - Update JobManager.record_progress to accept modal_call_id
  - Add modal_call_ids dict to Job model for run_id -> modal_call_id mapping
  - Update sweep CLI to pass modal_call_ids when recording progress
  Job manifest now includes modal_call_ids for easy lookup on modal.com.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **25d02e22** (2026-01-12) by vladgheorghe
  fix(cloud): address PR review feedback
  1. Fix execute_batch storage metadata bug - now correctly updates
     storage_type to "local" and storage_base to local path after
     downloading artifacts (consistent with execute() behavior)
  2. Remove dead code - redundant path logic in _download_run_artifacts
     where both branches did the same thing
  3. Document volume name limitation - CloudConfig and CloudExecutor now
     document that volume_name must match the hardcoded value in modal_app.py
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **06140685** (2026-01-12) by Vlad Gheorghe
  Merge pull request #25 from vlad-ds/feature/cloud-executor
  feat(cloud): implement Modal cloud executor (Plan 028)

- **84f6f7c6** (2026-01-12) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **986503ff** (2026-01-12) by vladgheorghe
  feat(sweeps): add quiet mode for faster sweep execution (Plan 030)
  Add quiet mode that suppresses verbose console output during sweeps.
  This dramatically reduces IO overhead for batch runs while preserving
  all artifacts (events.jsonl, balances.csv, run.html, metrics).
  Changes:
  - Add quiet parameter to RingSweepRunner (default: True)
  - Add quiet field to BalancedComparisonConfig (default: True)
  - Add --quiet/--verbose CLI flag to sweep balanced command
  - Update show_day_summary_renderable to return [] for event_mode="none"
  - Update run_until_stable_mode to skip console.print in quiet mode
  Usage:
    # Default: quiet mode (fast)
    bilancio sweep balanced --out-dir out/sweep ...
    # Verbose mode (for debugging)
    bilancio sweep balanced --verbose --out-dir out/sweep ...
  Performance impact:
    - Previous 22-hour sweep now runs in minutes with quiet mode
    - All data artifacts still generated, only console output suppressed
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **fbb80b9a** (2026-01-12) by vladgheorghe
  feat(cloud): add parallel batch execution with Modal .map()
  - Use Modal's .map() for maximum parallelism instead of spawn/get
  - Add PreparedRun dataclass for batch execution workflow
  - Increase Modal timeout from 10 to 30 minutes
  - Add _run_all_batch() method for parallel sweep execution
  - Document parallelism, cost estimation, and monitoring in CLAUDE.md
  Performance: 25 pairs (50 runs) now complete in ~13 min vs ~22 hours local
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **a47838f8** (2026-01-12) by vladgheorghe
  fix(ui): prevent UnboundLocalError in quiet mode
  Move display_agent_ids computation outside quiet_mode check to prevent
  UnboundLocalError when agent_ids is set but quiet_mode is True.
  Fixes bug identified by Codex review.
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **5d1c8fd8** (2026-01-12) by Vlad Gheorghe
  Merge pull request #26 from vlad-ds/feature/quiet-mode
  feat(sweeps): add quiet mode and parallel cloud execution

- **daed9224** (2026-01-12) by github-actions[bot]
  chore(docs): update codebase_for_llm.md

- **f2914815** (2026-01-12) by vladgheorghe
  feat(storage): add Supabase cloud storage layer (Plan 031)
  Add optional Supabase integration for persistent job/run/metrics storage:
  - Add SupabaseJobStore for job persistence to PostgreSQL
  - Add SupabaseRegistryStore implementing RegistryStore protocol
  - Add supabase_client module with singleton pattern
  - Update JobManager with cloud_store parameter and create_job_manager()
  - Add CLI commands: bilancio jobs ls/get/runs/metrics --cloud
  - Add Modal Volume management: bilancio volume ls/cleanup/rm
  - Add database schema migration for jobs/runs/metrics/events tables
  Architecture supports three modes:
  - Cloud-only (recommended for VMs): cloud=True, local=False
  - Hybrid: cloud=True, local=True
  - Local-only: default when Supabase not configured
  Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

- **79a7eee3** (2026-01-12) by vladgheorghe
  Improve cloud sweep execution

---

## Source Code (src/bilancio)

Below are all the Python files in the src/bilancio directory:

### 📄 src/bilancio/__init__.py

```python
"""Bilancio - Financial modeling and analysis library."""

__version__ = "0.1.0"

# Core imports
from bilancio.core.errors import (
    BilancioError,
    CalculationError,
    ConfigurationError,
    ValidationError,
)
from bilancio.core.time import TimeCoordinate, TimeInterval, now

__all__ = [
    "__version__",
    # Core time utilities
    "TimeCoordinate",
    "TimeInterval",
    "now",
    # Core exceptions
    "BilancioError",
    "ValidationError",
    "CalculationError",
    "ConfigurationError",
]

```

---

### 📄 src/bilancio/analysis/__init__.py

```python
"""Analysis package for bilancio."""

from bilancio.analysis.strategy_outcomes import (
    build_strategy_outcomes_by_run,
    build_strategy_outcomes_overall,
    run_strategy_analysis,
)
from bilancio.analysis.dealer_usage_summary import (
    build_dealer_usage_by_run,
    run_dealer_usage_analysis,
)
from bilancio.analysis.metrics_computer import (
    MetricsBundle,
    MetricsComputer,
)

__all__ = [
    "build_strategy_outcomes_by_run",
    "build_strategy_outcomes_overall",
    "run_strategy_analysis",
    "build_dealer_usage_by_run",
    "run_dealer_usage_analysis",
    "MetricsBundle",
    "MetricsComputer",
]

```

---

### 📄 src/bilancio/analysis/balances.py

```python
"""Balance analysis functions for the bilancio system."""

from __future__ import annotations

from collections import defaultdict
from dataclasses import dataclass
from decimal import Decimal
from typing import Any, Dict

from bilancio.engines.system import System


@dataclass
class AgentBalance:
    """Balance sheet summary for a specific agent."""
    agent_id: str
    assets_by_kind: Dict[str, int]
    liabilities_by_kind: Dict[str, int]
    total_financial_assets: int
    total_financial_liabilities: int
    net_financial: int
    nonfinancial_assets_by_kind: Dict[str, Dict[str, Any]]
    total_nonfinancial_value: Decimal
    nonfinancial_liabilities_by_kind: Dict[str, Dict[str, Any]]
    total_nonfinancial_liability_value: Decimal
    inventory_by_sku: Dict[str, Dict[str, Any]]  # Stock lots owned
    total_inventory_value: Decimal


@dataclass
class TrialBalance:
    """System-wide balance sheet summary."""
    assets_by_kind: Dict[str, int]
    liabilities_by_kind: Dict[str, int]
    total_financial_assets: int
    total_financial_liabilities: int
    nonfinancial_assets_by_kind: Dict[str, Dict[str, Any]]
    total_nonfinancial_value: Decimal
    nonfinancial_liabilities_by_kind: Dict[str, Dict[str, Any]]
    total_nonfinancial_liability_value: Decimal
    inventory_by_sku: Dict[str, Dict[str, Any]]  # System-wide stock lots
    total_inventory_value: Decimal


def agent_balance(system: System, agent_id: str) -> AgentBalance:
    """Calculate balance sheet for a specific agent.
    
    Args:
        system: The bilancio system
        agent_id: ID of the agent to analyze
        
    Returns:
        AgentBalance with calculated totals and breakdowns by instrument kind
    """
    agent = system.state.agents[agent_id]
    
    assets_by_kind = defaultdict(int)
    liabilities_by_kind = defaultdict(int)
    total_financial_assets = 0
    total_financial_liabilities = 0
    nonfinancial_assets_by_kind = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_nonfinancial_value = Decimal('0')
    nonfinancial_liabilities_by_kind = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_nonfinancial_liability_value = Decimal('0')
    inventory_by_sku = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_inventory_value = Decimal('0')
    
    # Sum up stocks (inventory)
    for stock_id in agent.stock_ids:
        stock = system.state.stocks[stock_id]
        inventory_by_sku[stock.sku]['quantity'] += stock.quantity
        inventory_by_sku[stock.sku]['value'] += stock.value
        total_inventory_value += stock.value
    
    # Sum up assets
    for contract_id in agent.asset_ids:
        contract = system.state.contracts.get(contract_id)
        if contract is None:
            # Contract was settled/removed but ID wasn't cleaned from asset_ids
            continue
        assets_by_kind[contract.kind] += contract.amount

        # Check if it's financial (use getattr with default lambda)
        is_financial_func = getattr(contract, 'is_financial', lambda: True)
        if is_financial_func():
            total_financial_assets += contract.amount
        else:
            # Track non-financial assets with quantity and value
            sku = getattr(contract, 'sku', contract.kind)
            nonfinancial_assets_by_kind[sku]['quantity'] += contract.amount

            # Calculate value (always available now)
            valued_amount = getattr(contract, 'valued_amount', Decimal('0'))
            nonfinancial_assets_by_kind[sku]['value'] += valued_amount
            total_nonfinancial_value += valued_amount

    # Sum up liabilities
    for contract_id in agent.liability_ids:
        contract = system.state.contracts.get(contract_id)
        if contract is None:
            # Contract was settled/removed but ID wasn't cleaned from liability_ids
            continue
        liabilities_by_kind[contract.kind] += contract.amount

        # Check if it's financial (use getattr with default lambda)
        is_financial_func = getattr(contract, 'is_financial', lambda: True)
        if is_financial_func():
            total_financial_liabilities += contract.amount
        else:
            # Track non-financial liabilities with quantity and value
            sku = getattr(contract, 'sku', contract.kind)
            nonfinancial_liabilities_by_kind[sku]['quantity'] += contract.amount
            
            # Calculate value (always available now)
            valued_amount = getattr(contract, 'valued_amount', Decimal('0'))
            nonfinancial_liabilities_by_kind[sku]['value'] += valued_amount
            total_nonfinancial_liability_value += valued_amount
    
    net_financial = total_financial_assets - total_financial_liabilities
    
    return AgentBalance(
        agent_id=agent_id,
        assets_by_kind=dict(assets_by_kind),
        liabilities_by_kind=dict(liabilities_by_kind),
        total_financial_assets=total_financial_assets,
        total_financial_liabilities=total_financial_liabilities,
        net_financial=net_financial,
        nonfinancial_assets_by_kind=dict(nonfinancial_assets_by_kind),
        total_nonfinancial_value=total_nonfinancial_value,
        nonfinancial_liabilities_by_kind=dict(nonfinancial_liabilities_by_kind),
        total_nonfinancial_liability_value=total_nonfinancial_liability_value,
        inventory_by_sku=dict(inventory_by_sku),
        total_inventory_value=total_inventory_value
    )


def system_trial_balance(system: System) -> TrialBalance:
    """Calculate system-wide trial balance.
    
    Args:
        system: The bilancio system
        
    Returns:
        TrialBalance with system-wide totals and breakdowns by instrument kind
    """
    assets_by_kind = defaultdict(int)
    liabilities_by_kind = defaultdict(int)
    total_financial_assets = 0
    total_financial_liabilities = 0
    nonfinancial_assets_by_kind = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_nonfinancial_value = Decimal('0')
    nonfinancial_liabilities_by_kind = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_nonfinancial_liability_value = Decimal('0')
    inventory_by_sku = defaultdict(lambda: {'quantity': 0, 'value': Decimal('0')})
    total_inventory_value = Decimal('0')
    
    # Walk all stocks and sum by SKU
    for stock in system.state.stocks.values():
        inventory_by_sku[stock.sku]['quantity'] += stock.quantity
        inventory_by_sku[stock.sku]['value'] += stock.value
        total_inventory_value += stock.value
    
    # Walk all contracts once and sum by kind for both sides
    for contract in system.state.contracts.values():
        # Asset side
        assets_by_kind[contract.kind] += contract.amount
        
        # Liability side  
        liabilities_by_kind[contract.kind] += contract.amount
        
        # Check if it's financial (use getattr with default lambda)
        is_financial_func = getattr(contract, 'is_financial', lambda: True)
        if is_financial_func():
            total_financial_assets += contract.amount
            total_financial_liabilities += contract.amount
        else:
            # Track non-financial liabilities (like delivery obligations) by SKU
            sku = getattr(contract, 'sku', contract.kind)
            nonfinancial_liabilities_by_kind[sku]['quantity'] += contract.amount
            
            # Calculate value (always available now)
            valued_amount = getattr(contract, 'valued_amount', Decimal('0'))
            nonfinancial_liabilities_by_kind[sku]['value'] += valued_amount
            total_nonfinancial_liability_value += valued_amount
    
    return TrialBalance(
        assets_by_kind=dict(assets_by_kind),
        liabilities_by_kind=dict(liabilities_by_kind),
        total_financial_assets=total_financial_assets,
        total_financial_liabilities=total_financial_liabilities,
        nonfinancial_assets_by_kind=dict(nonfinancial_assets_by_kind),
        total_nonfinancial_value=total_nonfinancial_value,
        nonfinancial_liabilities_by_kind=dict(nonfinancial_liabilities_by_kind),
        total_nonfinancial_liability_value=total_nonfinancial_liability_value,
        inventory_by_sku=dict(inventory_by_sku),
        total_inventory_value=total_inventory_value
    )


def as_rows(system: System) -> list[dict]:
    """Convert system balances to list of rows for tabular display.
    
    Args:
        system: The bilancio system
        
    Returns:
        List of dicts, one per agent plus a SYSTEM summary row
    """
    rows = []
    
    # Add row for each agent
    for agent_id in system.state.agents.keys():
        balance = agent_balance(system, agent_id)
        row = {
            'agent_id': agent_id,
            'total_financial_assets': balance.total_financial_assets,
            'total_financial_liabilities': balance.total_financial_liabilities,
            'net_financial': balance.net_financial,
            'total_nonfinancial_value': balance.total_nonfinancial_value,
            'total_inventory_value': balance.total_inventory_value,
            **{f'assets_{kind}': amount for kind, amount in balance.assets_by_kind.items()},
            **{f'liabilities_{kind}': amount for kind, amount in balance.liabilities_by_kind.items()},
            **{f'nonfinancial_{sku}_quantity': data['quantity'] for sku, data in balance.nonfinancial_assets_by_kind.items()},
            **{f'nonfinancial_{sku}_value': data['value'] for sku, data in balance.nonfinancial_assets_by_kind.items()},
            **{f'inventory_{sku}_quantity': data['quantity'] for sku, data in balance.inventory_by_sku.items()},
            **{f'inventory_{sku}_value': data['value'] for sku, data in balance.inventory_by_sku.items()}
        }
        rows.append(row)
    
    # Add SYSTEM summary row
    trial_balance = system_trial_balance(system)
    system_row = {
        'agent_id': 'SYSTEM',
        'total_financial_assets': trial_balance.total_financial_assets,
        'total_financial_liabilities': trial_balance.total_financial_liabilities,
        'net_financial': 0,  # Should always be zero for system-wide view
        'total_nonfinancial_value': trial_balance.total_nonfinancial_value,
        'total_inventory_value': trial_balance.total_inventory_value,
        **{f'assets_{kind}': amount for kind, amount in trial_balance.assets_by_kind.items()},
        **{f'liabilities_{kind}': amount for kind, amount in trial_balance.liabilities_by_kind.items()},
        **{f'nonfinancial_{sku}_quantity': data['quantity'] for sku, data in trial_balance.nonfinancial_liabilities_by_kind.items()},
        **{f'nonfinancial_{sku}_value': data['value'] for sku, data in trial_balance.nonfinancial_liabilities_by_kind.items()},
        **{f'inventory_{sku}_quantity': data['quantity'] for sku, data in trial_balance.inventory_by_sku.items()},
        **{f'inventory_{sku}_value': data['value'] for sku, data in trial_balance.inventory_by_sku.items()}
    }
    rows.append(system_row)
    
    return rows
```

---

### 📄 src/bilancio/analysis/dealer_usage_summary.py

```python
"""
Dealer usage summary analysis for dealer ring experiments.

Explains why some runs show no dealer effect by analyzing:
- Trading activity (trade counts, volumes)
- Inventory utilization (dealer capacity, VBT routing)
- System state evolution (debt/money ratio)
- Relationship between trading and outcomes

Plan 023: Default-Aware Instrumentation
"""

from __future__ import annotations

import logging
from pathlib import Path
from typing import Any, Dict, List, Optional

import pandas as pd

logger = logging.getLogger(__name__)


def build_dealer_usage_by_run(experiment_root: Path) -> pd.DataFrame:
    """
    Build dealer usage summary for each run.

    For each run, reads trades.csv, inventory_timeseries.csv, system_state_timeseries.csv,
    and optionally repayment_events.csv to compute:
    - Trade metrics (counts, volumes)
    - Inventory metrics (capacity utilization, VBT routing)
    - System state metrics (debt/money evolution)
    - Repayment metrics (trading by defaulters/repayers)

    Args:
        experiment_root: Path to experiment directory containing
            aggregate/comparison.csv and active/runs/<run_id>/out/*.csv

    Returns:
        DataFrame with one row per run, containing:
        - Run parameters and comparison metrics
        - Trade metrics
        - Inventory metrics
        - System state metrics
        - Repayment metrics (optional)
    """
    comp_path = experiment_root / "aggregate" / "comparison.csv"
    if not comp_path.exists():
        logger.warning("comparison.csv not found at %s", comp_path)
        return pd.DataFrame()

    comp = pd.read_csv(comp_path)
    rows: List[Dict[str, Any]] = []

    for _, row in comp.iterrows():
        run_id = row.get("active_run_id", "")
        if not run_id:
            continue

        run_dir = experiment_root / "active" / "runs" / run_id
        out_dir = run_dir / "out"

        if not out_dir.exists():
            logger.debug("Output directory not found for run %s", run_id)
            continue

        # Initialize row with run parameters
        row_out: Dict[str, Any] = {
            "run_id": run_id,
            "kappa": row.get("kappa", ""),
            "concentration": row.get("concentration", ""),
            "mu": row.get("mu", ""),
            "outside_mid_ratio": row.get("outside_mid_ratio", ""),
            "delta_passive": row.get("delta_passive", ""),
            "delta_active": row.get("delta_active", ""),
            "trading_effect": row.get("trading_effect", ""),
            "trading_relief_ratio": row.get("trading_relief_ratio", ""),
        }

        # === Trade metrics from trades.csv ===
        trades_path = out_dir / "trades.csv"
        if trades_path.exists():
            try:
                trades = pd.read_csv(trades_path)
                row_out.update(_compute_trade_metrics(trades))
            except Exception as e:
                logger.warning("Failed to read trades.csv for %s: %s", run_id, e)
                row_out.update(_empty_trade_metrics())
        else:
            row_out.update(_empty_trade_metrics())

        # === Inventory metrics from inventory_timeseries.csv ===
        inv_path = out_dir / "inventory_timeseries.csv"
        if inv_path.exists():
            try:
                inv = pd.read_csv(inv_path)
                row_out.update(_compute_inventory_metrics(inv))
            except Exception as e:
                logger.warning("Failed to read inventory_timeseries.csv for %s: %s", run_id, e)
                row_out.update(_empty_inventory_metrics())
        else:
            row_out.update(_empty_inventory_metrics())

        # === System state metrics from system_state_timeseries.csv ===
        sys_path = out_dir / "system_state_timeseries.csv"
        if sys_path.exists():
            try:
                sys_ts = pd.read_csv(sys_path)
                row_out.update(_compute_system_state_metrics(sys_ts))
            except Exception as e:
                logger.warning("Failed to read system_state_timeseries.csv for %s: %s", run_id, e)
                row_out.update(_empty_system_state_metrics())
        else:
            row_out.update(_empty_system_state_metrics())

        # === Repayment metrics from repayment_events.csv (optional) ===
        rep_path = out_dir / "repayment_events.csv"
        if rep_path.exists():
            try:
                rep = pd.read_csv(rep_path)
                row_out.update(_compute_repayment_metrics(rep))
            except Exception as e:
                logger.warning("Failed to read repayment_events.csv for %s: %s", run_id, e)
                row_out.update(_empty_repayment_metrics())
        else:
            row_out.update(_empty_repayment_metrics())

        rows.append(row_out)

    return pd.DataFrame(rows)


def _compute_trade_metrics(trades: pd.DataFrame) -> Dict[str, Any]:
    """Compute trade metrics from trades.csv."""
    if trades.empty:
        return _empty_trade_metrics()

    dealer_trade_count = len(trades)

    # Identify trader trades (H-entities)
    if "trader_id" in trades.columns:
        trader_trades = trades[trades["trader_id"].str.startswith("H", na=False)]
    else:
        trader_trades = pd.DataFrame()

    trader_dealer_trade_count = len(trader_trades)
    n_traders_using_dealer = trader_trades["trader_id"].nunique() if not trader_trades.empty else 0

    # Compute volumes
    if not trader_trades.empty:
        if "face_value" in trader_trades.columns:
            total_face_traded = pd.to_numeric(trader_trades["face_value"], errors="coerce").sum()
        else:
            total_face_traded = 0.0

        if "price" in trader_trades.columns:
            total_cash_volume = pd.to_numeric(trader_trades["price"], errors="coerce").sum()
        else:
            total_cash_volume = 0.0
    else:
        total_face_traded = 0.0
        total_cash_volume = 0.0

    return {
        "dealer_trade_count": int(dealer_trade_count),
        "trader_dealer_trade_count": int(trader_dealer_trade_count),
        "n_traders_using_dealer": int(n_traders_using_dealer),
        "total_face_traded": float(total_face_traded),
        "total_cash_volume": float(total_cash_volume),
    }


def _empty_trade_metrics() -> Dict[str, Any]:
    """Return empty trade metrics."""
    return {
        "dealer_trade_count": 0,
        "trader_dealer_trade_count": 0,
        "n_traders_using_dealer": 0,
        "total_face_traded": 0.0,
        "total_cash_volume": 0.0,
    }


def _compute_inventory_metrics(inv: pd.DataFrame) -> Dict[str, Any]:
    """Compute inventory metrics from inventory_timeseries.csv."""
    if inv.empty:
        return _empty_inventory_metrics()

    # Group by day and compute daily aggregates
    if "day" not in inv.columns:
        return _empty_inventory_metrics()

    # Check if required columns exist
    has_inventory = "dealer_inventory" in inv.columns
    has_zero = "is_at_zero" in inv.columns
    has_vbt = "hit_vbt_this_step" in inv.columns

    if has_inventory:
        inv["_any_positive"] = pd.to_numeric(inv["dealer_inventory"], errors="coerce") > 0
    else:
        inv["_any_positive"] = False

    if has_zero:
        # is_at_zero might be string "True"/"False" or boolean
        inv["_is_zero"] = inv["is_at_zero"].astype(str).str.lower() == "true"
    else:
        inv["_is_zero"] = False

    if has_vbt:
        inv["_hit_vbt"] = inv["hit_vbt_this_step"].astype(str).str.lower() == "true"
    else:
        inv["_hit_vbt"] = False

    # Aggregate by day
    inv_by_day = inv.groupby("day").agg(
        any_positive=("_any_positive", "any"),
        all_zero=("_is_zero", "all"),
        any_vbt=("_hit_vbt", "any"),
    )

    n_days = len(inv_by_day)
    if n_days == 0:
        return _empty_inventory_metrics()

    dealer_active_fraction = float(inv_by_day["any_positive"].mean())
    dealer_empty_fraction = float(inv_by_day["all_zero"].mean())
    vbt_usage_fraction = float(inv_by_day["any_vbt"].mean())

    return {
        "dealer_active_fraction": dealer_active_fraction,
        "dealer_empty_fraction": dealer_empty_fraction,
        "vbt_usage_fraction": vbt_usage_fraction,
    }


def _empty_inventory_metrics() -> Dict[str, Any]:
    """Return empty inventory metrics."""
    return {
        "dealer_active_fraction": None,
        "dealer_empty_fraction": None,
        "vbt_usage_fraction": None,
    }


def _compute_system_state_metrics(sys_ts: pd.DataFrame) -> Dict[str, Any]:
    """Compute system state metrics from system_state_timeseries.csv."""
    if sys_ts.empty:
        return _empty_system_state_metrics()

    # Convert columns to numeric
    if "debt_to_money" in sys_ts.columns:
        sys_ts["debt_to_money"] = pd.to_numeric(sys_ts["debt_to_money"], errors="coerce")
        mean_debt_to_money = float(sys_ts["debt_to_money"].mean())
        final_debt_to_money = float(sys_ts["debt_to_money"].iloc[-1])
    else:
        mean_debt_to_money = None
        final_debt_to_money = None

    if "total_face_value" in sys_ts.columns:
        sys_ts["total_face_value"] = pd.to_numeric(sys_ts["total_face_value"], errors="coerce")
        total_face0 = float(sys_ts["total_face_value"].iloc[0])
        total_faceT = float(sys_ts["total_face_value"].iloc[-1])
        debt_shrink_rate = (total_face0 - total_faceT) / total_face0 if total_face0 > 0 else 0.0
    else:
        debt_shrink_rate = None

    return {
        "mean_debt_to_money": mean_debt_to_money,
        "final_debt_to_money": final_debt_to_money,
        "debt_shrink_rate": debt_shrink_rate,
    }


def _empty_system_state_metrics() -> Dict[str, Any]:
    """Return empty system state metrics."""
    return {
        "mean_debt_to_money": None,
        "final_debt_to_money": None,
        "debt_shrink_rate": None,
    }


def _compute_repayment_metrics(rep: pd.DataFrame) -> Dict[str, Any]:
    """Compute repayment metrics from repayment_events.csv."""
    if rep.empty:
        return _empty_repayment_metrics()

    # Check if required columns exist
    if "buy_count" not in rep.columns or "sell_count" not in rep.columns:
        return _empty_repayment_metrics()

    if "outcome" not in rep.columns or "face_value" not in rep.columns:
        return _empty_repayment_metrics()

    # Convert to numeric
    rep["face_value"] = pd.to_numeric(rep["face_value"], errors="coerce").fillna(0)
    rep["buy_count"] = pd.to_numeric(rep["buy_count"], errors="coerce").fillna(0)
    rep["sell_count"] = pd.to_numeric(rep["sell_count"], errors="coerce").fillna(0)

    # Mark rows where trader used dealer
    rep["used_dealer"] = (rep["buy_count"] + rep["sell_count"]) > 0

    def frac_used(outcome: str) -> Optional[float]:
        """Compute fraction of face value that traded with dealer for given outcome."""
        sub = rep[rep["outcome"] == outcome]
        if sub.empty:
            return None
        total_face = sub["face_value"].sum()
        if total_face == 0:
            return 0.0
        traded_face = sub.loc[sub["used_dealer"], "face_value"].sum()
        return float(traded_face / total_face)

    frac_defaulted_that_traded = frac_used("defaulted")
    frac_repaid_that_traded = frac_used("repaid")

    return {
        "frac_defaulted_that_traded": frac_defaulted_that_traded,
        "frac_repaid_that_traded": frac_repaid_that_traded,
    }


def _empty_repayment_metrics() -> Dict[str, Any]:
    """Return empty repayment metrics."""
    return {
        "frac_defaulted_that_traded": None,
        "frac_repaid_that_traded": None,
    }


def run_dealer_usage_analysis(experiment_root: Path) -> Path:
    """
    Run complete dealer usage analysis on an experiment.

    Reads various CSV files and computes metrics explaining
    why dealers have or don't have an effect.

    Args:
        experiment_root: Path to experiment directory

    Returns:
        Path to the written dealer_usage_by_run.csv file
    """
    logger.info("Running dealer usage analysis on %s", experiment_root)

    # Build metrics
    df = build_dealer_usage_by_run(experiment_root)

    if df.empty:
        logger.warning("No data found for dealer usage analysis")
        return Path()

    # Write output
    aggregate_dir = experiment_root / "aggregate"
    aggregate_dir.mkdir(parents=True, exist_ok=True)

    output_path = aggregate_dir / "dealer_usage_by_run.csv"
    df.to_csv(output_path, index=False)
    logger.info("Wrote %d rows to %s", len(df), output_path)

    return output_path


def main() -> None:
    """CLI entry point for dealer usage analysis."""
    import argparse

    parser = argparse.ArgumentParser(
        description="Analyze dealer usage patterns across experiment runs"
    )
    parser.add_argument(
        "--experiment",
        type=Path,
        required=True,
        help="Path to experiment directory (containing aggregate/comparison.csv)",
    )
    parser.add_argument(
        "-v", "--verbose",
        action="store_true",
        help="Enable verbose logging",
    )

    args = parser.parse_args()

    logging.basicConfig(
        level=logging.DEBUG if args.verbose else logging.INFO,
        format="%(levelname)s: %(message)s",
    )

    output_path = run_dealer_usage_analysis(args.experiment)

    if output_path.exists():
        print(f"Dealer usage summary: {output_path}")
    else:
        print("No output generated - check that required CSV files exist")


if __name__ == "__main__":
    main()

```

---

### 📄 src/bilancio/analysis/loaders.py

```python
"""Lightweight loaders for analytics inputs (events JSONL, balances CSV).

Stdlib only; keeps parsing minimal and robust to schema changes.
"""

from __future__ import annotations

import csv
import json
from decimal import Decimal
from pathlib import Path
from typing import Dict, Iterable, Iterator, List


def _to_decimal(val) -> Decimal:
    """Best-effort Decimal conversion for numbers represented as int/float/str."""
    if val is None:
        return Decimal("0")
    if isinstance(val, Decimal):
        return val
    # Normalize bools to Decimal 0/1
    if isinstance(val, bool):
        return Decimal(int(val))
    # JSONL may encode Decimals as numbers or strings
    try:
        return Decimal(str(val))
    except Exception:
        return Decimal("0")


def read_events_jsonl(path: Path | str) -> Iterator[Dict]:
    """Yield events (dict) from a JSONL file in recorded order.

    Ensures numeric fields like amount/day/due_day are normalized to Python types
    (Decimal for amounts, int for day counters when available).
    """
    p = Path(path)
    with p.open("r") as f:
        for line in f:
            if not line.strip():
                continue
            evt = json.loads(line)
            # Normalize common fields if present
            if "amount" in evt:
                evt["amount"] = _to_decimal(evt["amount"])
            if "day" in evt and evt["day"] is not None:
                try:
                    evt["day"] = int(evt["day"])  # day indices are integers in the engine
                except Exception:
                    pass
            if "due_day" in evt and evt["due_day"] is not None:
                try:
                    evt["due_day"] = int(evt["due_day"])  # due_day recorded on creation
                except Exception:
                    pass
            yield evt


def read_balances_csv(path: Path | str) -> List[Dict]:
    """Read balances CSV produced by export.writers.write_balances_csv.

    Returns a list of dict rows. Numeric fields remain as strings unless parsed explicitly
    by downstream code. Rows with ad-hoc summary fields (e.g., item_type) are preserved.
    """
    p = Path(path)
    rows: List[Dict] = []
    with p.open("r", newline="") as f:
        reader = csv.DictReader(f)
        for row in reader:
            rows.append(row)
    return rows


```

---

### 📄 src/bilancio/analysis/metrics.py

```python
from __future__ import annotations

"""Analytics and metrics for payment microstructure (Kalecki-style scenarios).

Includes existing financial placeholders (NPV/IRR) kept intact for tests,
plus new metrics used by the Kalecki ring baseline analysis.
"""


# TODO: Import CashFlow and Money from appropriate modules once defined
# from bilancio.domain.instruments import CashFlow
# from bilancio.core.money import Money


def calculate_npv(flows: list["CashFlow"], rate: float) -> "Money":
    """Calculate Net Present Value of cash flows.
    
    Args:
        flows: List of cash flows to analyze
        rate: Discount rate to use for NPV calculation
        
    Returns:
        The net present value as a Money object
        
    TODO: Implement NPV calculation logic
    """
    raise NotImplementedError("NPV calculation not yet implemented")


def calculate_irr(flows: list["CashFlow"]) -> float:
    """Calculate Internal Rate of Return for cash flows.
    
    Args:
        flows: List of cash flows to analyze
        
    Returns:
        The internal rate of return as a float
        
    TODO: Implement IRR calculation logic
    """
    raise NotImplementedError("IRR calculation not yet implemented")


# ---------------------------------------------------------------------------
# Kalecki metrics API
# ---------------------------------------------------------------------------

from collections import defaultdict
from dataclasses import dataclass
from decimal import Decimal
from typing import Callable, Dict, Iterable, Iterator, List, Optional, Tuple


# Types
Event = dict
AgentId = str


def dues_for_day(events: Iterable[Event], t: int) -> List[dict]:
    """Return dues maturing on day t from creation events.

    We look for PayableCreated (or similarly named) events that carry a due_day.
    Output items minimally include: debtor, creditor, amount, due_day, and ids if present.
    """
    dues: List[dict] = []
    for e in events:
        kind = e.get("kind")
        if kind == "PayableCreated" and int(e.get("due_day", -1)) == int(t):
            dues.append(
                {
                    "debtor": e.get("debtor") or e.get("from"),
                    "creditor": e.get("creditor") or e.get("to"),
                    "amount": Decimal(e.get("amount", 0)),
                    "due_day": int(e.get("due_day")),
                    "pid": e.get("payable_id") or e.get("pid"),
                    "alias": e.get("alias"),
                }
            )
    return dues


def net_vectors(dues: Iterable[dict]) -> Dict[AgentId, Dict[str, Decimal]]:
    """Compute F (outflows due), I (inflows due), and n=I-F per agent.

    Returns mapping: agent -> {"F": Decimal, "I": Decimal, "n": Decimal}
    """
    F: Dict[AgentId, Decimal] = defaultdict(lambda: Decimal("0"))
    I: Dict[AgentId, Decimal] = defaultdict(lambda: Decimal("0"))

    for d in dues:
        a = Decimal(d.get("amount", 0))
        debtor = d.get("debtor") or d.get("from")
        creditor = d.get("creditor") or d.get("to")
        if debtor:
            F[debtor] += a
        if creditor:
            I[creditor] += a

    agents = set(F.keys()) | set(I.keys())
    nets: Dict[AgentId, Dict[str, Decimal]] = {}
    for agent in agents:
        f = F.get(agent, Decimal("0"))
        i = I.get(agent, Decimal("0"))
        nets[agent] = {"F": f, "I": i, "n": i - f}
    return nets


def raw_minimum_liquidity(nets: Dict[AgentId, Dict[str, Decimal]]) -> Decimal:
    """Mbar = sum over agents of max(0, F - I)."""
    total = Decimal("0")
    for v in nets.values():
        total += max(Decimal("0"), v["F"] - v["I"])
    return total


def size_and_bunching(
    dues: Iterable[dict], bin_fn: Optional[Callable[[dict], str]] = None
) -> Tuple[Decimal, Decimal]:
    """Return (S_t, BI_t). If no bin_fn, BI_t=0.

    S_t is total amount due that day.
    BI_t is an optional concentration index across user-provided bins.
    """
    amounts: List[Decimal] = [Decimal(d.get("amount", 0)) for d in dues]
    S_t = sum(amounts, start=Decimal("0"))

    if not bin_fn:
        return S_t, Decimal("0")

    from statistics import mean, pstdev

    buckets: Dict[str, Decimal] = defaultdict(lambda: Decimal("0"))
    for d in dues:
        buckets[bin_fn(d)] += Decimal(d.get("amount", 0))

    vals = list(buckets.values())
    if not vals:
        return S_t, Decimal("0")
    m = Decimal(str(mean([float(v) for v in vals])))
    if m == 0:
        return S_t, Decimal("0")
    sd = Decimal(str(pstdev([float(v) for v in vals])))
    return S_t, sd / m


def phi_delta(events: Iterable[Event], dues: Iterable[dict], t: int) -> Tuple[Optional[Decimal], Optional[Decimal]]:
    """Compute on-time settlement ratio phi_t and delta_t = 1 - phi_t.

    Numerator: settled events with day==t and original due_day==t.
    Denominator: S_t from dues list.
    """
    # Map payable IDs (pid/alias) to due_day for matching
    id_to_due: Dict[str, int] = {}
    for d in dues:
        if d.get("pid"):
            id_to_due[str(d["pid"])] = int(d.get("due_day", -1))
        if d.get("alias"):
            id_to_due[str(d["alias"])] = int(d.get("due_day", -1))

    S_t = sum((Decimal(d.get("amount", 0)) for d in dues), start=Decimal("0"))
    if S_t == 0:
        return None, None

    num = Decimal("0")
    for e in events:
        if e.get("kind") != "PayableSettled":
            continue
        if int(e.get("day", -1)) != int(t):
            continue
        # Match either by pid or alias if present
        pid = str(e.get("pid") or e.get("contract_id") or "")
        alias = str(e.get("alias") or "")
        due = None
        if pid and pid in id_to_due:
            due = id_to_due[pid]
        elif alias and alias in id_to_due:
            due = id_to_due[alias]
        if due == int(t):
            num += Decimal(e.get("amount", 0))

    phi = num / S_t
    return phi, (Decimal("1") - phi)


def replay_intraday_peak(
    events: Iterable[Event], t: int
) -> Tuple[Decimal, List[dict], Decimal]:
    """Replay day-t PayableSettled events in order to compute RTGS peak.

    Returns (Mpeak_t, steps_table, gross_settled_t)
    steps_table rows: {step, payer, payee, amount, P_prefix}
    """
    Delta: Dict[AgentId, Decimal] = defaultdict(lambda: Decimal("0"))
    gross = Decimal("0")
    peak = Decimal("0")
    steps: List[dict] = []
    step_idx = 0

    for e in events:
        if e.get("kind") != "PayableSettled":
            continue
        if int(e.get("day", -1)) != int(t):
            continue
        amount = Decimal(e.get("amount", 0))
        payer = e.get("debtor") or e.get("from")
        payee = e.get("creditor") or e.get("to")
        if amount == 0:
            continue
        # Update cumulative net outflows
        if payer:
            Delta[payer] += amount
        if payee:
            Delta[payee] -= amount
        gross += amount
        P = sum((x if x > 0 else Decimal("0")) for x in Delta.values())
        if P > peak:
            peak = P
        step_idx += 1
        steps.append({
            "day": int(t),
            "step": step_idx,
            "payer": payer,
            "payee": payee,
            "amount": amount,
            "P_prefix": P,
        })

    return peak, steps, gross


def velocity(gross_settled_t: Decimal, Mpeak_t: Decimal) -> Optional[Decimal]:
    """gross_settled_t / Mpeak_t, None if division not defined."""
    if Mpeak_t and Mpeak_t != 0:
        return gross_settled_t / Mpeak_t
    return None


def creditor_hhi_plus(nets: Dict[AgentId, Dict[str, Decimal]]) -> Optional[Decimal]:
    """HHI over positive n_i (creditor side). Returns None if no creditors."""
    pos = [v["n"] for v in nets.values() if v["n"] > 0]
    if not pos:
        return None
    s = sum(pos, start=Decimal("0"))
    if s == 0:
        return None
    return sum(((x / s) ** 2 for x in pos), start=Decimal("0"))


def debtor_shortfall_shares(
    nets: Dict[AgentId, Dict[str, Decimal]]
) -> Dict[AgentId, Optional[Decimal]]:
    """DS_t(i) per agent (or None if no net debtors)."""
    short = {a: max(Decimal("0"), v["F"] - v["I"]) for a, v in nets.items()}
    denom = sum(short.values(), start=Decimal("0"))
    if denom == 0:
        return {a: None for a in nets.keys()}
    return {a: (val / denom if denom != 0 else None) for a, val in short.items()}


def start_of_day_money(bal_rows: List[dict], t: int) -> Decimal:
    """Sum system means-of-payment at start of day t.

    Since the current CSV is a snapshot (no day column), for baseline we use the
    system total of means-of-payment: assets_cash, assets_bank_deposit,
    assets_reserve_deposit across all agents (excluding ad-hoc summary rows).

    For closed systems without injections/withdrawals across the day, this equals
    the start-of-day supply. This matches the Kalecki ring baseline.
    """
    def _get_decimal(row, key: str) -> Decimal:
        val = row.get(key)
        if val in (None, "", "None"):
            return Decimal("0")
        try:
            return Decimal(str(val))
        except Exception:
            return Decimal("0")

    total = Decimal("0")
    for row in bal_rows:
        # Skip ad-hoc summary rows that don't represent a standard balance snapshot
        if row.get("item_type"):
            continue
        # Skip the SYSTEM aggregate row to avoid double counting
        if str(row.get("agent_id", "")).upper() == "SYSTEM":
            continue
        # Sum across means-of-payment kinds
        total += _get_decimal(row, "assets_cash")
        total += _get_decimal(row, "assets_bank_deposit")
        total += _get_decimal(row, "assets_reserve_deposit")
    return total


def liquidity_gap(Mbar_t: Decimal, M_t: Decimal) -> Decimal:
    """G_t = max(0, Mbar_t - M_t)."""
    gap = Mbar_t - M_t
    return gap if gap > 0 else Decimal("0")


def alpha(Mbar_t: Decimal, S_t: Decimal) -> Optional[Decimal]:
    """alpha_t = 1 - Mbar_t / S_t (None if S_t==0)."""
    if S_t == 0:
        return None
    return Decimal("1") - (Mbar_t / S_t)


def microstructure_gain_lower_bound(
    Mbar_t: Decimal, Mpeak_rtgs: Decimal
) -> Optional[Decimal]:
    """Lower bound for LSM gain using only RTGS run: 1 - Mbar / Mpeak_rtgs."""
    if not Mpeak_rtgs:
        return None
    return Decimal("1") - (Mbar_t / Mpeak_rtgs)

```

---

### 📄 src/bilancio/analysis/metrics_computer.py

```python
"""Metrics computation extracted from LocalExecutor for reuse.

This module provides a MetricsComputer class that can compute metrics from
simulation artifacts (events.jsonl, balances.csv) regardless of where the
simulation ran (local or remote).
"""

from __future__ import annotations

from dataclasses import dataclass
from pathlib import Path
from typing import Any, Dict, List, Optional

from bilancio.storage.artifact_loaders import ArtifactLoader
from bilancio.analysis.loaders import read_events_jsonl, read_balances_csv
from bilancio.analysis.report import (
    compute_day_metrics,
    summarize_day_metrics,
    write_day_metrics_csv,
    write_day_metrics_json,
    write_debtor_shares_csv,
    write_intraday_csv,
    write_metrics_html,
)


@dataclass
class MetricsBundle:
    """Bundle of computed metrics from a simulation run.

    Contains all computed metrics in structured form for further processing
    or writing to output files.
    """

    day_metrics: List[Dict[str, Any]]
    """Per-day metrics rows (S_t, Mbar_t, phi_t, etc.)."""

    debtor_shares: List[Dict[str, Any]]
    """Debtor shortfall shares (day, agent, DS_t)."""

    intraday: List[Dict[str, Any]]
    """Intraday settlement steps (day, step, P_prefix, etc.)."""

    summary: Dict[str, Any]
    """Aggregate summary from summarize_day_metrics (phi_total, delta_total, etc.)."""


class MetricsComputer:
    """Computes metrics from simulation artifacts.

    Uses an ArtifactLoader to read events and balances, then applies
    the standard metrics computation pipeline from bilancio.analysis.report.

    Example:
        loader = LocalArtifactLoader(base_path=Path("/some/experiment/dir"))
        computer = MetricsComputer(loader)

        artifacts = {
            "events_jsonl": "runs/run_001/out/events.jsonl",
            "balances_csv": "runs/run_001/out/balances.csv",
        }
        bundle = computer.compute(artifacts)

        output_paths = computer.write_outputs(bundle, Path("/output/dir"))
    """

    def __init__(self, loader: ArtifactLoader) -> None:
        """Initialize with an artifact loader.

        Args:
            loader: An ArtifactLoader implementation for reading artifacts.
        """
        self.loader = loader

    def compute(
        self,
        artifacts: Dict[str, str],
        day_list: Optional[List[int]] = None,
    ) -> MetricsBundle:
        """Compute metrics from simulation artifacts.

        Args:
            artifacts: Dict mapping artifact names to references.
                Required: 'events_jsonl'
                Optional: 'balances_csv' (for M_t, G_t metrics)
            day_list: Optional list of days to compute metrics for.
                If None, days are inferred from events.

        Returns:
            MetricsBundle containing all computed metrics.

        Raises:
            KeyError: If required artifact 'events_jsonl' is missing.
            FileNotFoundError: If referenced artifact files don't exist.
        """
        # Load events (required)
        events_ref = artifacts.get("events_jsonl")
        if not events_ref:
            raise KeyError("Missing required artifact: 'events_jsonl'")

        events_text = self.loader.load_text(events_ref)
        # Parse JSONL from text - we need to handle this since read_events_jsonl takes a path
        events = self._parse_events_from_text(events_text)

        # Load balances (optional, enables M_t and G_t computation)
        balances_rows: Optional[List[Dict[str, Any]]] = None
        balances_ref = artifacts.get("balances_csv")
        if balances_ref and self.loader.exists(balances_ref):
            balances_text = self.loader.load_text(balances_ref)
            balances_rows = self._parse_balances_from_text(balances_text)

        # Compute day metrics
        result = compute_day_metrics(
            events=events,
            balances_rows=balances_rows,
            day_list=day_list,
        )

        # Compute summary
        summary = summarize_day_metrics(result["day_metrics"])

        return MetricsBundle(
            day_metrics=result["day_metrics"],
            debtor_shares=result["debtor_shares"],
            intraday=result["intraday"],
            summary=summary,
        )

    def write_outputs(
        self,
        bundle: MetricsBundle,
        output_dir: Path,
        title: Optional[str] = None,
        subtitle: Optional[str] = None,
    ) -> Dict[str, Path]:
        """Write metrics bundle to output files.

        Args:
            bundle: The computed MetricsBundle to write.
            output_dir: Directory to write output files to.
            title: Optional title for HTML report.
            subtitle: Optional subtitle for HTML report.

        Returns:
            Dict mapping output types to their file paths:
                - 'metrics_csv': Path to metrics.csv
                - 'metrics_json': Path to metrics.json
                - 'debtor_shares_csv': Path to debtor_shares.csv
                - 'intraday_csv': Path to intraday.csv
                - 'metrics_html': Path to metrics.html
        """
        output_dir = Path(output_dir)
        output_dir.mkdir(parents=True, exist_ok=True)

        paths: Dict[str, Path] = {}

        # Write metrics CSV
        metrics_csv_path = output_dir / "metrics.csv"
        write_day_metrics_csv(metrics_csv_path, bundle.day_metrics)
        paths["metrics_csv"] = metrics_csv_path

        # Write metrics JSON
        metrics_json_path = output_dir / "metrics.json"
        write_day_metrics_json(metrics_json_path, bundle.day_metrics)
        paths["metrics_json"] = metrics_json_path

        # Write debtor shares CSV
        debtor_shares_path = output_dir / "debtor_shares.csv"
        write_debtor_shares_csv(debtor_shares_path, bundle.debtor_shares)
        paths["debtor_shares_csv"] = debtor_shares_path

        # Write intraday CSV
        intraday_path = output_dir / "intraday.csv"
        write_intraday_csv(intraday_path, bundle.intraday)
        paths["intraday_csv"] = intraday_path

        # Write metrics HTML
        metrics_html_path = output_dir / "metrics.html"
        write_metrics_html(
            metrics_html_path,
            day_metrics=bundle.day_metrics,
            debtor_shares=bundle.debtor_shares,
            intraday=bundle.intraday,
            title=title,
            subtitle=subtitle,
        )
        paths["metrics_html"] = metrics_html_path

        return paths

    def _parse_events_from_text(self, text: str) -> List[Dict[str, Any]]:
        """Parse events from JSONL text content.

        This mirrors read_events_jsonl but works from text instead of file path.
        """
        import json
        from decimal import Decimal

        events: List[Dict[str, Any]] = []
        for line in text.splitlines():
            if not line.strip():
                continue
            evt = json.loads(line)
            # Normalize common fields (same as read_events_jsonl)
            if "amount" in evt:
                evt["amount"] = self._to_decimal(evt["amount"])
            if "day" in evt and evt["day"] is not None:
                try:
                    evt["day"] = int(evt["day"])
                except Exception:
                    pass
            if "due_day" in evt and evt["due_day"] is not None:
                try:
                    evt["due_day"] = int(evt["due_day"])
                except Exception:
                    pass
            events.append(evt)
        return events

    def _parse_balances_from_text(self, text: str) -> List[Dict[str, Any]]:
        """Parse balances from CSV text content.

        This mirrors read_balances_csv but works from text instead of file path.
        """
        import csv
        from io import StringIO

        rows: List[Dict[str, Any]] = []
        reader = csv.DictReader(StringIO(text))
        for row in reader:
            rows.append(dict(row))
        return rows

    @staticmethod
    def _to_decimal(val: Any) -> Any:
        """Best-effort Decimal conversion for numeric values."""
        from decimal import Decimal

        if val is None:
            return Decimal("0")
        if isinstance(val, Decimal):
            return val
        if isinstance(val, bool):
            return Decimal(int(val))
        try:
            return Decimal(str(val))
        except Exception:
            return Decimal("0")

```

---

### 📄 src/bilancio/analysis/report.py

```python
"""Simple reporting helpers for analytics outputs (CSV/JSON/HTML optional).

Outputs are intentionally minimal and stdlib-only.
"""

from __future__ import annotations

import csv
import json
from dataclasses import asdict, dataclass
from decimal import Decimal
from pathlib import Path
from typing import Any, Dict, Iterable, List, Optional, Sequence

from bilancio.analysis.metrics import (
    dues_for_day,
    net_vectors,
    raw_minimum_liquidity,
    size_and_bunching,
    phi_delta,
    replay_intraday_peak,
    velocity,
    creditor_hhi_plus,
    debtor_shortfall_shares,
    start_of_day_money,
    liquidity_gap,
    alpha as alpha_fn,
)


def _to_json(val: Any):
    if isinstance(val, Decimal):
        # avoid lossy float conversion; write as number if integer, else string
        n = val.normalize()
        if n == n.to_integral_value():
            return int(n)
        return str(n)
    if isinstance(val, dict):
        return {k: _to_json(v) for k, v in val.items()}
    if isinstance(val, (list, tuple)):
        return [ _to_json(x) for x in val ]
    return val


def write_day_metrics_csv(path: Path | str, rows: List[Dict[str, Any]]) -> None:
    p = Path(path)
    p.parent.mkdir(parents=True, exist_ok=True)
    if not rows:
        # still create an empty file with headers day only
        with p.open("w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=["day"])
            writer.writeheader()
        return
    # All keys across rows
    keys: List[str] = sorted({k for r in rows for k in r.keys()})
    with p.open("w", newline="") as f:
        writer = csv.DictWriter(f, fieldnames=keys)
        writer.writeheader()
        for r in rows:
            row = {}
            for k in keys:
                v = r.get(k)
                if isinstance(v, Decimal):
                    n = v.normalize()
                    row[k] = int(n) if n == n.to_integral_value() else float(n)
                elif v is None:
                    row[k] = ""
                else:
                    row[k] = v
            writer.writerow(row)


def write_day_metrics_json(path: Path | str, rows: List[Dict[str, Any]]) -> None:
    p = Path(path)
    p.parent.mkdir(parents=True, exist_ok=True)
    with p.open("w") as f:
        json.dump([_to_json(r) for r in rows], f, indent=2)


def write_debtor_shares_csv(path: Path | str, rows: List[Dict[str, Any]]) -> None:
    write_day_metrics_csv(path, rows)


def write_intraday_csv(path: Path | str, rows: List[Dict[str, Any]]) -> None:
    write_day_metrics_csv(path, rows)


def _fmt_num(val: Any) -> str:
    if val is None:
        return "—"
    if isinstance(val, Decimal):
        n = val.normalize()
        try:
            if n == n.to_integral_value():
                return f"{int(n)}"
        except Exception:
            pass
        # Limit to 6 decimal places when not integral
        return f"{float(n):.6f}".rstrip('0').rstrip('.')
    return str(val)


def _group_by(rows: List[Dict[str, Any]], key: str) -> Dict[Any, List[Dict[str, Any]]]:
    out: Dict[Any, List[Dict[str, Any]]] = {}
    for r in rows:
        out.setdefault(r.get(key), []).append(r)
    return out


def parse_day_ranges(spec: str) -> List[int]:
    """Parse comma-separated day ranges like "1,2-4" into a sorted list."""
    out: List[int] = []
    for part in spec.split(','):
        part = part.strip()
        if not part:
            continue
        if '-' in part:
            a, b = part.split('-', 1)
            try:
                start = int(a)
                end = int(b)
            except Exception:
                continue
            rng = range(min(start, end), max(start, end) + 1)
            out.extend(rng)
        else:
            try:
                out.append(int(part))
            except Exception:
                continue
    return sorted(set(out))


def infer_day_list(events: Sequence[Dict[str, Any]]) -> List[int]:
    """Infer useful day indices from events when none specified."""
    due_days = sorted({int(e["due_day"]) for e in events if e.get("kind") == "PayableCreated" and e.get("due_day") is not None})
    settled_days = sorted({int(e["day"]) for e in events if e.get("kind") == "PayableSettled" and e.get("day") is not None})
    day_list = due_days or settled_days
    return day_list


def compute_day_metrics(
    events: Sequence[Dict[str, Any]],
    balances_rows: Optional[Sequence[Dict[str, Any]]] = None,
    day_list: Optional[Sequence[int]] = None,
) -> Dict[str, Any]:
    """Compute Kalecki-style day metrics for a completed run."""
    if day_list is None or len(day_list) == 0:
        day_list = infer_day_list(events)

    if not day_list:
        return {
            "days": [],
            "day_metrics": [],
            "debtor_shares": [],
            "intraday": [],
        }

    metrics_rows: List[dict] = []
    ds_rows: List[dict] = []
    intraday_rows: List[dict] = []

    for t in sorted(set(int(d) for d in day_list)):
        dues = dues_for_day(events, t)
        nets = net_vectors(dues)
        Mbar_t = raw_minimum_liquidity(nets)
        S_t, _ = size_and_bunching(dues)
        phi_t, delta_t = phi_delta(events, dues, t)
        Mpeak_t, steps, gross_t = replay_intraday_peak(events, t)
        v_t = velocity(gross_t, Mpeak_t)
        HHIp_t = creditor_hhi_plus(nets)
        DS = debtor_shortfall_shares(nets)
        n_debtors = sum(1 for a, v in nets.items() if v["F"] > v["I"])
        n_creditors = sum(1 for a, v in nets.items() if v["n"] > 0)

        M_t = None
        G_t = None
        if balances_rows is not None:
            M_t = start_of_day_money(balances_rows, t)
            G_t = liquidity_gap(Mbar_t, M_t)

        alpha_t = alpha_fn(Mbar_t, S_t) if S_t is not None else None

        notes: List[str] = []
        if HHIp_t is None:
            notes.append("no net creditors")
        if all(v is None for v in DS.values()):
            notes.append("no net debtors")

        metrics_rows.append(
            {
                "day": t,
                "S_t": S_t,
                "Mbar_t": Mbar_t,
                "M_t": M_t,
                "G_t": G_t,
                "alpha_t": alpha_t,
                "Mpeak_t": Mpeak_t,
                "gross_settled_t": gross_t,
                "v_t": v_t,
                "phi_t": phi_t,
                "delta_t": delta_t,
                "n_debtors": n_debtors,
                "n_creditors": n_creditors,
                "HHIplus_t": HHIp_t,
                "notes": ", ".join(notes) if notes else "",
            }
        )

        for agent, share in DS.items():
            ds_rows.append({"day": t, "agent": agent, "DS_t": share})

        for row in steps:
            intraday_rows.append(row)

    return {
        "days": sorted(set(int(d) for d in day_list)),
        "day_metrics": metrics_rows,
        "debtor_shares": ds_rows,
        "intraday": intraday_rows,
    }


def summarize_day_metrics(day_metrics: Sequence[Dict[str, Any]]) -> Dict[str, Optional[Decimal]]:
    """Summarize a day metrics table into aggregate indicators."""
    S_total = Decimal("0")
    phi_weighted = Decimal("0")
    delta_weighted = Decimal("0")
    max_G: Optional[Decimal] = None
    alpha_1 = None
    Mpeak_1 = None
    v_1 = None
    HHIplus_1 = None
    max_day = 0

    for row in day_metrics:
        day = int(row.get("day", 0)) if row.get("day") is not None else 0
        max_day = max(max_day, day)

        S_t = row.get("S_t")
        phi_t = row.get("phi_t")
        delta_t = row.get("delta_t")
        G_t = row.get("G_t")

        if isinstance(S_t, str):
            S_t = _decimal_or_none(S_t)
        if isinstance(phi_t, str):
            phi_t = _decimal_or_none(phi_t)
        if isinstance(delta_t, str):
            delta_t = _decimal_or_none(delta_t)
        if isinstance(G_t, str):
            G_t = _decimal_or_none(G_t)

        if S_t is not None:
            S_total += S_t
            if phi_t is not None:
                phi_weighted += S_t * phi_t
            if delta_t is not None:
                delta_weighted += S_t * delta_t

        if G_t is not None:
            max_G = G_t if max_G is None else max(max_G, G_t)

        if day == 1:
            alpha_val = row.get("alpha_t")
            Mpeak_val = row.get("Mpeak_t")
            v_val = row.get("v_t")
            HHI_val = row.get("HHIplus_t")
            if isinstance(alpha_val, str):
                alpha_val = _decimal_or_none(alpha_val)
            if isinstance(Mpeak_val, str):
                Mpeak_val = _decimal_or_none(Mpeak_val)
            if isinstance(v_val, str):
                v_val = _decimal_or_none(v_val)
            if isinstance(HHI_val, str):
                HHI_val = _decimal_or_none(HHI_val)
            alpha_1 = alpha_1 or alpha_val
            Mpeak_1 = Mpeak_1 or Mpeak_val
            v_1 = v_1 or v_val
            HHIplus_1 = HHIplus_1 or HHI_val

    phi_total = (phi_weighted / S_total) if S_total else None
    delta_total = (delta_weighted / S_total) if S_total else None

    return {
        "phi_total": phi_total,
        "delta_total": delta_total,
        "max_G_t": max_G,
        "alpha_1": alpha_1,
        "Mpeak_1": Mpeak_1,
        "v_1": v_1,
        "HHIplus_1": HHIplus_1,
        "max_day": max_day,
    }


def write_metrics_html(
    path: Path | str,
    day_metrics: List[Dict[str, Any]],
    debtor_shares: List[Dict[str, Any]],
    intraday: List[Dict[str, Any]],
    title: Optional[str] = None,
    subtitle: Optional[str] = None,
) -> None:
    """Write a single, self-contained HTML report for analytics.

    - Day-by-day metrics in a table.
    - Debtor shortfall shares (long-form or pivot) in a table.
    - Intraday prefix liquidity plots as tiny inline SVGs (per day).
    - Brief explanations for each metric.
    """
    p = Path(path)
    p.parent.mkdir(parents=True, exist_ok=True)

    # Aggregate summary across days
    def _dec(x):
        return x if isinstance(x, Decimal) else Decimal(str(x)) if x is not None else Decimal("0")

    S_total = sum((_dec(r.get("S_t")) for r in day_metrics), start=Decimal("0"))
    gross_total = sum((_dec(r.get("gross_settled_t")) for r in day_metrics), start=Decimal("0"))
    Mpeak_max = max((_dec(r.get("Mpeak_t")) for r in day_metrics), default=Decimal("0"))
    v_vals = [r.get("v_t") for r in day_metrics if r.get("v_t") is not None]
    v_avg = (sum((_dec(v) for v in v_vals), start=Decimal("0")) / Decimal(len(v_vals))) if v_vals else None
    # Weighted on-time settlement ratio
    phi_weighted_num = Decimal("0")
    if S_total > 0:
        for r in day_metrics:
            S = r.get("S_t")
            phi = r.get("phi_t")
            if S is not None and phi is not None:
                phi_weighted_num += _dec(S) * _dec(phi)
        phi_weighted = phi_weighted_num / S_total if S_total != 0 else None
    else:
        phi_weighted = None

    # Build intraday SVGs per-day
    intraday_by_day = _group_by(intraday, "day")

    def _svg_for_day(day: Any, rows: List[Dict[str, Any]], width: int = 520, height: int = 140) -> str:
        if not rows:
            return ""
        # Sort by step
        rows = sorted(rows, key=lambda r: int(r.get("step", 0)))
        steps = [int(r.get("step", 0)) for r in rows]
        vals = [float(Decimal(str(r.get("P_prefix", 0)))) for r in rows]
        max_step = max(steps) if steps else 1
        max_val = max(vals) if vals else 1.0
        # Margins
        l, r, t, b = 35, 10, 10, 25
        w = width - l - r
        h = height - t - b
        def sx(s):
            return l + (0 if max_step <= 1 else (s - 1) * (w / (max_step - 1)))
        def sy(v):
            return t + (0 if max_val <= 0 else h - (v * h / max_val))
        pts = " ".join(f"{sx(s):.1f},{sy(v):.1f}" for s, v in zip(steps, vals))
        # Axes ticks (simple)
        y0 = t + h
        x0 = l
        x1 = l + w
        # Labels
        max_val_lbl = f"{max_val:.2f}".rstrip('0').rstrip('.')
        return f"""
<svg width=\"{width}\" height=\"{height}\" viewBox=\"0 0 {width} {height}\" xmlns=\"http://www.w3.org/2000/svg\">
  <rect x=\"0\" y=\"0\" width=\"{width}\" height=\"{height}\" fill=\"#fff\"/>
  <line x1=\"{x0}\" y1=\"{y0}\" x2=\"{x1}\" y2=\"{y0}\" stroke=\"#999\" stroke-width=\"1\"/>
  <line x1=\"{x0}\" y1=\"{t}\" x2=\"{x0}\" y2=\"{y0}\" stroke=\"#999\" stroke-width=\"1\"/>
  <text x=\"{x0}\" y=\"{t-2}\" font-size=\"10\" fill=\"#555\">P_prefix</text>
  <text x=\"{x1}\" y=\"{y0+14}\" font-size=\"10\" fill=\"#555\" text-anchor=\"end\">step</text>
  <text x=\"{x0-6}\" y=\"{t+8}\" font-size=\"10\" fill=\"#555\" text-anchor=\"end\">{max_val_lbl}</text>
  <polyline fill=\"none\" stroke=\"#2a7\" stroke-width=\"2\" points=\"{pts}\" />
</svg>
"""

    # Simple, readable HTML with minimal CSS
    html_title = title or "Bilancio Analytics Report"
    html_sub = subtitle or ""

    def _row(k, v):
        return f"<tr><th scope=\"row\">{k}</th><td>{v}</td></tr>"

    # Build day table
    day_cols = [
        ("day", "Day"),
        ("S_t", "Total dues S_t"),
        ("Mbar_t", "Min net liquidity \u0305M_t"),
        ("M_t", "Start-of-day money M_t"),
        ("G_t", "Liquidity gap G_t"),
        ("alpha_t", "Netting potential \u03B1_t"),
        ("Mpeak_t", "Operational peak M^peak_t"),
        ("gross_settled_t", "Gross settled"),
        ("v_t", "Intraday velocity v_t"),
        ("phi_t", "On-time settlement \u03C6_t"),
        ("delta_t", "Deferral/default \u03B4_t"),
        ("n_debtors", "# debtors"),
        ("n_creditors", "# creditors"),
        ("HHIplus_t", "Creditor HHI^+"),
        ("notes", "Notes"),
    ]

    day_table_head = "".join(f"<th>{label}</th>" for _, label in day_cols)
    day_table_rows = []
    for r in sorted(day_metrics, key=lambda x: int(x.get("day", 0))):
        tds = []
        for key, _ in day_cols:
            tds.append(f"<td>{_fmt_num(r.get(key))}</td>")
        day_table_rows.append("<tr>" + "".join(tds) + "</tr>")

    # Debtor shares table
    ds_by_day = _group_by(debtor_shares, "day")
    ds_sections = []
    for d, rows in sorted(ds_by_day.items(), key=lambda kv: int(kv[0])):
        # Gather unique agents for a pivot-like table
        agents = sorted({str(r.get("agent")) for r in rows})
        shares = {str(r.get("agent")): r.get("DS_t") for r in rows}
        ths = "".join(f"<th>{a}</th>" for a in agents)
        tds = "".join(f"<td>{_fmt_num(shares.get(a))}</td>" for a in agents)
        ds_sections.append(
            f"<h4>Day {d}</h4><table class=\"grid\"><thead><tr><th>Agent</th>{ths}</tr></thead>"
            f"<tbody><tr><th>DS_t</th>{tds}</tr></tbody></table>"
        )

    # Intraday SVGs per day
    intraday_sections = []
    for d, rows in sorted(intraday_by_day.items(), key=lambda kv: int(kv[0])):
        svg = _svg_for_day(d, rows)
        intraday_sections.append(f"<h4>Day {d}</h4>" + svg)

    explanations = """
<dl>
  <dt>Total dues S_t</dt>
  <dd>Sum of payment obligations maturing on day t.</dd>
  <dt>Min net liquidity \u0305M_t</dt>
  <dd>Minimum system net liquidity needed if obligations are perfectly offset; equals sum of debtor shortfalls max(0, F_i - I_i).</dd>
  <dt>Start-of-day money M_t</dt>
  <dd>System means-of-payment available at the start of day t (cash, deposits, reserves).</dd>
  <dt>Liquidity gap G_t</dt>
  <dd>Shortfall at the start of the day: max(0, \u0305M_t - M_t).</dd>
  <dt>Netting potential \u03B1_t</dt>
  <dd>Share of dues that can be cleared by circulation/netting: 1 - \u0305M_t / S_t.</dd>
  <dt>Operational peak M^peak_t</dt>
  <dd>Peak amount of money simultaneously out in circuit when replaying realized settlement sequence.</dd>
  <dt>Gross settled</dt>
  <dd>Total value actually settled on day t.</dd>
  <dt>Intraday velocity v_t</dt>
  <dd>How intensively money is reused intraday: gross settled / operational peak.</dd>
  <dt>On-time settlement \u03C6_t</dt>
  <dd>Share of dues with due_day=t that settle on day t.</dd>
  <dt>Deferral/default \u03B4_t</dt>
  <dd>1 - \u03C6_t (portion not settled on time; may reflect deferrals or defaults).</dd>
  <dt>Creditor HHI^+</dt>
  <dd>Concentration of net creditor positions among those with n_i > 0.</dd>
  <dt>Debtor shortfall shares DS_t(i)</dt>
  <dd>Each net debtor's share of \u0305M_t, indicating who needs liquidity.</dd>
</dl>
"""

    html = f"""
<!doctype html>
<html lang=\"en\">
<head>
  <meta charset=\"utf-8\" />
  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />
  <title>{html_title}</title>
  <style>
    body {{ font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; color: #222; }}
    h1 {{ margin: 0 0 4px; font-size: 22px; }}
    h2 {{ margin-top: 28px; font-size: 18px; }}
    h3 {{ margin-top: 18px; font-size: 16px; }}
    h4 {{ margin-top: 12px; font-size: 14px; }}
    p.small {{ color: #555; margin-top: 4px; }}
    table.grid {{ border-collapse: collapse; width: 100%; margin-top: 8px; }}
    table.grid th, table.grid td {{ border: 1px solid #ddd; padding: 6px 8px; font-size: 13px; }}
    table.grid thead th {{ background: #f8f8f8; text-align: left; }}
    .summary {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 8px; margin-top: 8px; }}
    .card {{ border: 1px solid #eee; padding: 10px; border-radius: 6px; background: #fcfcfc; }}
    .muted {{ color: #666; }}
    dl {{ display: grid; grid-template-columns: max-content 1fr; grid-gap: 4px 16px; font-size: 13px; }}
    dt {{ font-weight: 600; }}
    dd {{ margin: 0 0 8px 0; color: #333; }}
  </style>
  <meta name=\"generator\" content=\"Bilancio Analytics\" />
  <meta name=\"description\" content=\"Kalecki-style payment microstructure metrics\" />
  <meta name=\"robots\" content=\"noindex\" />
</head>
<body>
  <header>
    <h1>{html_title}</h1>
    {f'<p class="small muted">{html_sub}</p>' if html_sub else ''}
  </header>

  <section>
    <h2>Summary Across Days</h2>
    <div class=\"summary\">
      <div class=\"card\"><div class=\"muted\">Days analyzed</div><div><strong>{len(day_metrics)}</strong></div></div>
      <div class=\"card\"><div class=\"muted\">Total dues \u2211 S_t</div><div><strong>{_fmt_num(S_total)}</strong></div></div>
      <div class=\"card\"><div class=\"muted\">Gross settled total</div><div><strong>{_fmt_num(gross_total)}</strong></div></div>
      <div class=\"card\"><div class=\"muted\">Max operational peak</div><div><strong>{_fmt_num(Mpeak_max)}</strong></div></div>
      <div class=\"card\"><div class=\"muted\">Avg velocity</div><div><strong>{_fmt_num(v_avg)}</strong></div></div>
      <div class=\"card\"><div class=\"muted\">Weighted on-time \u03C6</div><div><strong>{_fmt_num(phi_weighted)}</strong></div></div>
    </div>
  </section>

  <section>
    <h2>Day-by-Day Metrics</h2>
    <table class=\"grid\">
      <thead>
        <tr>{day_table_head}</tr>
      </thead>
      <tbody>
        {''.join(day_table_rows)}
      </tbody>
    </table>
  </section>

  <section>
    <h2>Debtor Shortfall Shares DS_t(i)</h2>
    {''.join(ds_sections) if ds_sections else '<p class="muted">No net debtors on analyzed days.</p>'}
  </section>

  <section>
    <h2>Intraday Diagnostics: Prefix Liquidity P(s)</h2>
    <p class=\"small muted\">For each settlement sequence on day t, P(s) = \u2211_i max(0, \u0394_i(s)) and M^peak_t = max_s P(s).</p>
    {''.join(intraday_sections) if intraday_sections else '<p class="muted">No settlement steps found.</p>'}
  </section>

  <section>
    <h2>Metric Explanations</h2>
    {explanations}
  </section>
</body>
</html>
"""

    with p.open("w") as f:
        f.write(html)


def _resolve_path(base: Path, value: str) -> Path:
    p = Path(value)
    if not p.is_absolute():
        return base / p
    return p


def _decimal_or_none(val: Any) -> Optional[Decimal]:
    if val is None or val == "":
        return None
    try:
        return Decimal(str(val))
    except Exception:
        return None


def aggregate_runs(
    registry_csv: Path | str,
    results_csv: Path | str,
) -> List[Dict[str, Any]]:
    """Aggregate per-run metrics into a single CSV."""
    registry_path = Path(registry_csv)
    results_path = Path(results_csv)
    results_path.parent.mkdir(parents=True, exist_ok=True)

    rows: List[Dict[str, Any]] = []

    with registry_path.open("r", newline="") as fh:
        reader = csv.DictReader(fh)
        registry_rows = list(reader)

    for entry in registry_rows:
        if entry.get("status") != "completed":
            continue
        metrics_rel = entry.get("metrics_csv")
        if not metrics_rel:
            continue

        metrics_path = _resolve_path(registry_path.parent, metrics_rel)
        if not metrics_path.exists():
            continue

        with metrics_path.open("r", newline="") as fh:
            metrics_reader = csv.DictReader(fh)
            metrics = list(metrics_reader)

        if not metrics:
            continue

        summary = summarize_day_metrics(metrics)

        rows.append({
            "run_id": entry.get("run_id"),
            "phase": entry.get("phase"),
            "seed": entry.get("seed"),
            "n_agents": entry.get("n_agents"),
            "kappa": entry.get("kappa"),
            "concentration": entry.get("concentration"),
            "mu": entry.get("mu"),
            "monotonicity": entry.get("monotonicity"),
            "S1": entry.get("S1"),
            "L0": entry.get("L0"),
            "phi_total": summary.get("phi_total"),
            "delta_total": summary.get("delta_total"),
            "max_G_t": summary.get("max_G_t"),
            "alpha_1": summary.get("alpha_1"),
            "Mpeak_1": summary.get("Mpeak_1"),
            "v_1": summary.get("v_1"),
            "HHIplus_1": summary.get("HHIplus_1"),
            "time_to_stability": entry.get("time_to_stability") or str(summary.get("max_day", "")),
            "metrics_csv": metrics_rel,
        })

    fieldnames = [
        "run_id",
        "phase",
        "seed",
        "n_agents",
        "kappa",
        "concentration",
        "mu",
        "monotonicity",
        "S1",
        "L0",
        "phi_total",
        "delta_total",
        "max_G_t",
        "alpha_1",
        "Mpeak_1",
        "v_1",
        "HHIplus_1",
        "time_to_stability",
        "metrics_csv",
    ]

    with results_path.open("w", newline="") as fh:
        writer = csv.DictWriter(fh, fieldnames=fieldnames)
        writer.writeheader()
        for row in rows:
            out_row = {}
            for field in fieldnames:
                val = row.get(field)
                if isinstance(val, Decimal):
                    out_row[field] = _fmt_num(val)
                elif val is None:
                    out_row[field] = ""
                else:
                    out_row[field] = val
            writer.writerow(out_row)

    return rows


def render_dashboard(results_csv: Path | str, dashboard_html: Path | str) -> None:
    """Render an aggregate HTML dashboard from results CSV."""
    results_path = Path(results_csv)
    dashboard_path = Path(dashboard_html)
    dashboard_path.parent.mkdir(parents=True, exist_ok=True)

    with results_path.open("r", newline="") as fh:
        reader = csv.DictReader(fh)
        rows = list(reader)

    total_runs = len(rows)
    phi_values = [_decimal_or_none(r.get("phi_total")) for r in rows]
    phi_values = [v for v in phi_values if v is not None]
    delta_values = [_decimal_or_none(r.get("delta_total")) for r in rows]
    delta_values = [v for v in delta_values if v is not None]
    max_g_values = [_decimal_or_none(r.get("max_G_t")) for r in rows if r.get("max_G_t")]

    avg_phi = (sum(phi_values, start=Decimal("0")) / Decimal(len(phi_values))) if phi_values else None
    avg_delta = (sum(delta_values, start=Decimal("0")) / Decimal(len(delta_values))) if delta_values else None
    max_gap = max(max_g_values) if max_g_values else None

    table_rows = []
    for r in rows:
        table_rows.append(
            "<tr>"
            f"<td>{r.get('run_id')}</td>"
            f"<td>{r.get('phase')}</td>"
            f"<td>{r.get('kappa')}</td>"
            f"<td>{r.get('concentration')}</td>"
            f"<td>{r.get('mu')}</td>"
            f"<td>{r.get('monotonicity')}</td>"
            f"<td>{r.get('phi_total')}</td>"
            f"<td>{r.get('delta_total')}</td>"
            f"<td>{r.get('max_G_t')}</td>"
            f"<td>{r.get('time_to_stability')}</td>"
            "</tr>"
        )

    html = f"""
<!doctype html>
<html lang=\"en\">
<head>
  <meta charset=\"utf-8\" />
  <title>Ring Sweep Dashboard</title>
  <style>
    body {{ font-family: system-ui, -apple-system, Segoe UI, sans-serif; margin: 24px; color: #222; }}
    h1 {{ margin-top: 0; }}
    .summary {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin: 16px 0; }}
    .card {{ border: 1px solid #ddd; border-radius: 6px; padding: 12px; background: #fafafa; }}
    table {{ width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 13px; }}
    th, td {{ border: 1px solid #ddd; padding: 6px 8px; text-align: left; }}
    th {{ background: #f4f4f4; }}
  </style>
</head>
<body>
  <h1>Kalecki Ring Sweep Dashboard</h1>
  <div class=\"summary\">
    <div class=\"card\"><div>Total runs</div><strong>{total_runs}</strong></div>
    <div class=\"card\"><div>Average \u03C6_total</div><strong>{_fmt_num(avg_phi)}</strong></div>
    <div class=\"card\"><div>Average \u03B4_total</div><strong>{_fmt_num(avg_delta)}</strong></div>
    <div class=\"card\"><div>Max liquidity gap</div><strong>{_fmt_num(max_gap)}</strong></div>
  </div>
  <table>
    <thead>
      <tr>
        <th>Run</th><th>Phase</th><th>\u03BA</th><th>c</th><th>\u03BC</th><th>m</th><th>\u03C6_total</th><th>\u03B4_total</th><th>max G_t</th><th>Days</th>
      </tr>
    </thead>
    <tbody>
      {''.join(table_rows)}
    </tbody>
  </table>
</body>
</html>
"""

    with dashboard_path.open("w", encoding="utf-8") as fh:
        fh.write(html)

```

---

### 📄 src/bilancio/analysis/strategy_outcomes.py

```python
"""
Strategy outcomes analysis for dealer ring experiments.

Analyzes repayment_events.csv files across runs to determine:
- Which trading strategies are used most
- Default rates per strategy
- Relationship between parameters and strategy success

Plan 023: Default-Aware Instrumentation
"""

from __future__ import annotations

import logging
from decimal import Decimal
from pathlib import Path
from typing import Any, Dict, List, Optional

import pandas as pd

logger = logging.getLogger(__name__)

STRATEGIES = ["no_trade", "hold_to_maturity", "sell_before", "round_trip"]


def build_strategy_outcomes_by_run(experiment_root: Path) -> pd.DataFrame:
    """
    Build strategy outcomes for each run.

    For each run in the experiment, reads repayment_events.csv and computes:
    - Count and face value per strategy
    - Default count and face value per strategy
    - Default rate per strategy

    Args:
        experiment_root: Path to experiment directory containing
            aggregate/comparison.csv and active/runs/<run_id>/out/repayment_events.csv

    Returns:
        DataFrame with one row per run, containing:
        - Run parameters (kappa, concentration, mu, outside_mid_ratio, etc.)
        - Comparison metrics (delta_passive, delta_active, trading_effect)
        - Per-strategy metrics (count, face, default_count, default_face, default_rate)
    """
    comp_path = experiment_root / "aggregate" / "comparison.csv"
    if not comp_path.exists():
        logger.warning("comparison.csv not found at %s", comp_path)
        return pd.DataFrame()

    comp = pd.read_csv(comp_path)
    rows: List[Dict[str, Any]] = []

    for _, row in comp.iterrows():
        run_id = row.get("active_run_id", "")
        if not run_id:
            continue

        run_dir = experiment_root / "active" / "runs" / run_id
        rep_path = run_dir / "out" / "repayment_events.csv"

        if not rep_path.exists():
            logger.debug("repayment_events.csv not found for run %s", run_id)
            continue

        try:
            rep = pd.read_csv(rep_path)
        except Exception as e:
            logger.warning("Failed to read %s: %s", rep_path, e)
            continue

        if rep.empty:
            continue

        # Convert face_value to numeric
        rep["face_value"] = pd.to_numeric(rep["face_value"], errors="coerce").fillna(0)

        # Compute totals
        total_face = rep["face_value"].sum()
        total_liab = len(rep)
        default_face_total = rep.loc[rep["outcome"] == "defaulted", "face_value"].sum()
        default_count_total = (rep["outcome"] == "defaulted").sum()

        # Compute per-strategy metrics
        strat_metrics: Dict[str, Any] = {}
        for strat in STRATEGIES:
            strat_rows = rep[rep["strategy"] == strat]
            face_strat = strat_rows["face_value"].sum()
            default_rows = strat_rows[strat_rows["outcome"] == "defaulted"]

            strat_metrics[f"count_{strat}"] = len(strat_rows)
            strat_metrics[f"face_{strat}"] = float(face_strat)
            strat_metrics[f"default_count_{strat}"] = len(default_rows)
            strat_metrics[f"default_face_{strat}"] = float(default_rows["face_value"].sum())
            strat_metrics[f"default_rate_{strat}"] = (
                float(default_rows["face_value"].sum() / face_strat) if face_strat > 0 else 0.0
            )

        row_out = {
            "run_id": run_id,
            "kappa": row.get("kappa", ""),
            "concentration": row.get("concentration", ""),
            "mu": row.get("mu", ""),
            "outside_mid_ratio": row.get("outside_mid_ratio", ""),
            "seed": row.get("seed", ""),
            "face_value": row.get("face_value", ""),
            "delta_passive": row.get("delta_passive", ""),
            "delta_active": row.get("delta_active", ""),
            "trading_effect": row.get("trading_effect", ""),
            "trading_relief_ratio": row.get("trading_relief_ratio", ""),
            "total_liabilities": total_liab,
            "total_face_value": float(total_face),
            "default_count_total": int(default_count_total),
            "default_face_total": float(default_face_total),
            "default_rate_total": float(default_face_total / total_face) if total_face > 0 else 0.0,
            **strat_metrics,
        }
        rows.append(row_out)

    return pd.DataFrame(rows)


def build_strategy_outcomes_overall(
    by_run_df: pd.DataFrame,
    group_cols: Optional[List[str]] = None,
) -> pd.DataFrame:
    """
    Aggregate strategy outcomes across runs.

    Groups by parameters and strategy to compute aggregate metrics.

    Args:
        by_run_df: DataFrame from build_strategy_outcomes_by_run()
        group_cols: Columns to group by (default: kappa, concentration, mu, outside_mid_ratio)

    Returns:
        DataFrame with one row per (parameter combination, strategy), containing:
        - total_face: Sum of face values across runs for this strategy
        - default_face: Sum of defaulted face values
        - default_rate: default_face / total_face
        - runs_using_strategy: Count of runs where strategy was used
        - mean_trading_effect: Mean trading effect for these runs
    """
    if by_run_df.empty:
        return pd.DataFrame()

    if group_cols is None:
        group_cols = ["kappa", "concentration", "mu", "outside_mid_ratio"]

    # Ensure group columns exist
    available_cols = [c for c in group_cols if c in by_run_df.columns]
    if not available_cols:
        logger.warning("No group columns found in DataFrame")
        return pd.DataFrame()

    rows: List[Dict[str, Any]] = []

    for combo, group in by_run_df.groupby(available_cols, dropna=False):
        # Handle single column case
        if len(available_cols) == 1:
            combo = (combo,)

        combo_dict = dict(zip(available_cols, combo))

        for strat in STRATEGIES:
            face_col = f"face_{strat}"
            default_face_col = f"default_face_{strat}"
            count_col = f"count_{strat}"

            if face_col not in group.columns:
                continue

            face_total = group[face_col].sum()
            default_face = group[default_face_col].sum() if default_face_col in group.columns else 0
            runs_using = (group[count_col] > 0).sum() if count_col in group.columns else 0

            # Get mean trading effect for runs that used this strategy
            if count_col in group.columns and "trading_effect" in group.columns:
                used_mask = group[count_col] > 0
                trading_effects = pd.to_numeric(group.loc[used_mask, "trading_effect"], errors="coerce")
                mean_effect = trading_effects.mean() if not trading_effects.empty else 0.0
            else:
                mean_effect = 0.0

            row_out = {
                "strategy": strat,
                **combo_dict,
                "total_face": float(face_total),
                "default_face": float(default_face),
                "default_rate": float(default_face / face_total) if face_total > 0 else 0.0,
                "runs_using_strategy": int(runs_using),
                "mean_trading_effect": float(mean_effect) if pd.notna(mean_effect) else 0.0,
            }
            rows.append(row_out)

    return pd.DataFrame(rows)


def run_strategy_analysis(experiment_root: Path) -> tuple[Path, Path]:
    """
    Run complete strategy outcomes analysis on an experiment.

    Reads comparison.csv and repayment_events.csv files,
    computes metrics, and writes output CSVs.

    Args:
        experiment_root: Path to experiment directory

    Returns:
        Tuple of (by_run_path, overall_path) for the written files
    """
    logger.info("Running strategy outcomes analysis on %s", experiment_root)

    # Build per-run metrics
    by_run_df = build_strategy_outcomes_by_run(experiment_root)

    if by_run_df.empty:
        logger.warning("No data found for strategy analysis")
        return Path(), Path()

    # Build overall aggregates
    overall_df = build_strategy_outcomes_overall(by_run_df)

    # Write outputs
    aggregate_dir = experiment_root / "aggregate"
    aggregate_dir.mkdir(parents=True, exist_ok=True)

    by_run_path = aggregate_dir / "strategy_outcomes_by_run.csv"
    by_run_df.to_csv(by_run_path, index=False)
    logger.info("Wrote %d rows to %s", len(by_run_df), by_run_path)

    overall_path = aggregate_dir / "strategy_outcomes_overall.csv"
    overall_df.to_csv(overall_path, index=False)
    logger.info("Wrote %d rows to %s", len(overall_df), overall_path)

    return by_run_path, overall_path


def main() -> None:
    """CLI entry point for strategy outcomes analysis."""
    import argparse

    parser = argparse.ArgumentParser(
        description="Analyze trading strategy outcomes across experiment runs"
    )
    parser.add_argument(
        "--experiment",
        type=Path,
        required=True,
        help="Path to experiment directory (containing aggregate/comparison.csv)",
    )
    parser.add_argument(
        "-v", "--verbose",
        action="store_true",
        help="Enable verbose logging",
    )

    args = parser.parse_args()

    logging.basicConfig(
        level=logging.DEBUG if args.verbose else logging.INFO,
        format="%(levelname)s: %(message)s",
    )

    by_run_path, overall_path = run_strategy_analysis(args.experiment)

    if by_run_path.exists():
        print(f"Strategy outcomes by run: {by_run_path}")
        print(f"Strategy outcomes overall: {overall_path}")
    else:
        print("No output generated - check that repayment_events.csv files exist")


if __name__ == "__main__":
    main()

```

---

### 📄 src/bilancio/analysis/visualization/__init__.py

```python
"""Balance sheet visualization utilities for the bilancio system.

This module has been split into submodules for better organization:
- balances: Balance sheet and T-account display
- events: Event table formatting
- phases: Phase summary visualization
- common: Shared utilities and constants
"""

from __future__ import annotations

# Re-export public API from submodules to maintain backward compatibility

# Common utilities and types
from bilancio.analysis.visualization.common import (
    RICH_AVAILABLE,
    RenderableType,
    BalanceRow,
    TAccount,
    parse_day_from_maturity,
)

# Balance sheet functions
from bilancio.analysis.visualization.balances import (
    display_agent_balance_table,
    display_agent_balance_from_balance,
    display_multiple_agent_balances,
    build_t_account_rows,
    display_agent_t_account,
    display_agent_t_account_renderable,
    display_agent_balance_table_renderable,
    display_multiple_agent_balances_renderable,
)

# Event display functions
from bilancio.analysis.visualization.events import (
    display_events,
    display_events_table,
    display_events_table_renderable,
    display_events_for_day,
    display_events_renderable,
    display_events_for_day_renderable,
)

# Phase summary functions
from bilancio.analysis.visualization.phases import (
    display_events_tables_by_phase_renderables,
)

__all__ = [
    # Common
    'RICH_AVAILABLE',
    'RenderableType',
    'BalanceRow',
    'TAccount',
    'parse_day_from_maturity',
    # Balance sheets
    'display_agent_balance_table',
    'display_agent_balance_from_balance',
    'display_multiple_agent_balances',
    'build_t_account_rows',
    'display_agent_t_account',
    'display_agent_t_account_renderable',
    'display_agent_balance_table_renderable',
    'display_multiple_agent_balances_renderable',
    # Events
    'display_events',
    'display_events_table',
    'display_events_table_renderable',
    'display_events_for_day',
    'display_events_renderable',
    'display_events_for_day_renderable',
    # Phases
    'display_events_tables_by_phase_renderables',
]

```

---

### 📄 src/bilancio/analysis/visualization/balances.py

```python
"""Balance sheet and T-account display functions."""

from __future__ import annotations

from typing import Any, List, Optional, Union

from bilancio.analysis.balances import AgentBalance, agent_balance
from bilancio.engines.system import System
from bilancio.analysis.visualization.common import (
    RICH_AVAILABLE,
    RenderableType,
    _format_currency,
    BalanceRow,
    TAccount,
    _format_agent,
    parse_day_from_maturity,
)

# Import Rich components only if available
if RICH_AVAILABLE:
    from rich.console import Console
    from rich.table import Table
    from rich.columns import Columns
    from rich.text import Text
    from rich import box



def display_agent_balance_table(
    system: System,
    agent_id: str,
    format: str = 'rich',
    title: Optional[str] = None
) -> None:
    """
    Display a single agent's balance sheet as a T-account style table.
    
    Args:
        system: The bilancio system instance
        agent_id: ID of the agent to display
        format: Display format ('rich' or 'simple')
        title: Optional custom title for the table
    """
    if format == 'rich' and not RICH_AVAILABLE:
        print("Warning: rich library not available, falling back to simple format")
        format = 'simple'
    
    # Get agent balance
    balance = agent_balance(system, agent_id)
    
    # Get agent info
    agent = system.state.agents[agent_id]
    if title is None:
        # Show both name and ID for clarity
        if agent.name and agent.name != agent_id:
            title = f"{agent.name} [{agent_id}] ({agent.kind})"
        else:
            title = f"{agent_id} ({agent.kind})"
    
    if format == 'rich':
        _display_rich_agent_balance(title, balance)
    else:
        _display_simple_agent_balance(title, balance)


def display_agent_balance_from_balance(
    balance: AgentBalance,
    format: str = 'rich',
    title: Optional[str] = None
) -> None:
    """
    Display an agent's balance sheet from an AgentBalance object.
    
    Args:
        balance: The AgentBalance object to display
        format: Display format ('rich' or 'simple')
        title: Optional custom title for the table
    """
    if format == 'rich' and not RICH_AVAILABLE:
        print("Warning: rich library not available, falling back to simple format")
        format = 'simple'
    
    if title is None:
        title = f"Agent {balance.agent_id}"
    
    if format == 'rich':
        _display_rich_agent_balance(title, balance)
    else:
        _display_simple_agent_balance(title, balance)


def display_multiple_agent_balances(
    system: System,
    items: List[Union[str, AgentBalance]], 
    format: str = 'rich'
) -> None:
    """
    Display multiple agent balance sheets side by side for comparison.
    
    Args:
        system: The bilancio system instance
        items: List of agent IDs (str) or AgentBalance instances
        format: Display format ('rich' or 'simple')
    """
    if format == 'rich' and not RICH_AVAILABLE:
        print("Warning: rich library not available, falling back to simple format")
        format = 'simple'
    
    # Convert agent IDs to balance objects if needed
    balances = []
    for item in items:
        if isinstance(item, str):
            balances.append(agent_balance(system, item))
        else:
            balances.append(item)
    
    if format == 'rich':
        _display_rich_multiple_agent_balances(balances, system)
    else:
        _display_simple_multiple_agent_balances(balances, system)


def _display_rich_agent_balance(title: str, balance: AgentBalance) -> None:
    """Display a single agent balance using rich formatting."""
    console = Console()
    
    # Create the main table with wider columns to avoid truncation
    table = Table(title=title, box=box.ROUNDED, title_style="bold cyan")
    table.add_column("ASSETS", style="green", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="green", width=15, no_wrap=True)
    table.add_column("LIABILITIES", style="red", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="red", width=15, no_wrap=True)
    
    asset_rows = []
    
    # First: Add inventory (stocks owned) - these are physical assets
    if hasattr(balance, 'inventory_by_sku'):
        for sku, data in balance.inventory_by_sku.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} [{qty} unit{'s' if qty != 1 else ''}]"
                amount = _format_currency(int(data['value']))
                asset_rows.append((name, amount))
    
    # Second: Add non-financial assets (rights to receive goods)
    # Track which SKUs we've already displayed
    displayed_asset_skus = set()
    for sku, data in balance.nonfinancial_assets_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} receivable [{qty} unit{'s' if qty != 1 else ''}]"
            amount = _format_currency(int(data['value']))
            asset_rows.append((name, amount))
            displayed_asset_skus.add(sku)
    
    # Third: Add financial assets (everything else in assets_by_kind)
    # These are guaranteed to be financial since non-financial are already handled
    financial_asset_kinds = set()
    for asset_type in sorted(balance.assets_by_kind.keys()):
        # Skip if this is a non-financial type we already displayed
        # We identify non-financial by checking if its SKU was in nonfinancial_assets_by_kind
        is_nonfinancial = False
        for sku in displayed_asset_skus:
            # This is a heuristic but works for current instrument types
            if asset_type in ['delivery_obligation']:
                is_nonfinancial = True
                break
        
        if not is_nonfinancial and asset_type not in financial_asset_kinds:
            name = asset_type
            amount = _format_currency(balance.assets_by_kind[asset_type])
            asset_rows.append((name, amount))
            financial_asset_kinds.add(asset_type)
    
    liability_rows = []
    
    # First: Add non-financial liabilities (obligations to deliver goods)
    displayed_liability_skus = set()
    for sku, data in balance.nonfinancial_liabilities_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} obligation [{qty} unit{'s' if qty != 1 else ''}]"
            amount = _format_currency(int(data['value']))
            liability_rows.append((name, amount))
            displayed_liability_skus.add(sku)
    
    # Second: Add financial liabilities (everything else in liabilities_by_kind)
    financial_liability_kinds = set()
    for liability_type in sorted(balance.liabilities_by_kind.keys()):
        # Skip if this is a non-financial type we already displayed
        is_nonfinancial = False
        for sku in displayed_liability_skus:
            if liability_type in ['delivery_obligation']:
                is_nonfinancial = True
                break
        
        if not is_nonfinancial and liability_type not in financial_liability_kinds:
            name = liability_type
            amount = _format_currency(balance.liabilities_by_kind[liability_type])
            liability_rows.append((name, amount))
            financial_liability_kinds.add(liability_type)
    
    # Determine the maximum number of rows needed
    max_rows = max(len(asset_rows), len(liability_rows), 1)
    
    for i in range(max_rows):
        asset_name, asset_amount = asset_rows[i] if i < len(asset_rows) else ("", "")
        liability_name, liability_amount = liability_rows[i] if i < len(liability_rows) else ("", "")
        
        table.add_row(asset_name, asset_amount, liability_name, liability_amount)
    
    # Add separator and totals
    table.add_row("", "", "", "", end_section=True)
    table.add_row(
        Text("TOTAL FINANCIAL", style="bold green"),
        Text(_format_currency(balance.total_financial_assets), style="bold green"),
        Text("TOTAL FINANCIAL", style="bold red"),
        Text(_format_currency(balance.total_financial_liabilities), style="bold red")
    )
    
    # Add valued non-financial total if present
    if balance.total_nonfinancial_value is not None and balance.total_nonfinancial_value > 0:
        table.add_row(
            Text("TOTAL VALUED DELIV.", style="bold green"),
            Text(_format_currency(int(balance.total_nonfinancial_value)), style="bold green"),
            "",
            ""
        )
        total_assets = balance.total_financial_assets + int(balance.total_nonfinancial_value)
        table.add_row(
            Text("TOTAL ASSETS", style="bold green"),
            Text(_format_currency(total_assets), style="bold green"),
            "",
            ""
        )
    
    # Add visual separation before net worth
    table.add_row("", "", "", "", end_section=True)
    
    # Add net worth with clear separation
    net_financial = balance.net_financial
    net_worth_style = "bold green" if net_financial >= 0 else "bold red"
    table.add_row(
        "",
        "",
        Text("NET FINANCIAL", style="bold blue"),
        Text(_format_currency(net_financial, show_sign=True), style=net_worth_style)
    )
    
    console.print(table)


def _display_simple_agent_balance(title: str, balance: AgentBalance) -> None:
    """Display a single agent balance using simple text formatting."""
    print(f"\n{title}")
    print("=" * 70)
    print(f"{'ASSETS':<30} {'Amount':>12} | {'LIABILITIES':<30} {'Amount':>12}")
    print("-" * 70)
    
    asset_rows = []
    
    # First: Add inventory (stocks owned)
    if hasattr(balance, 'inventory_by_sku'):
        for sku, data in balance.inventory_by_sku.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} [{qty} unit{'s' if qty != 1 else ''}]"
                if len(name) > 29:
                    name = name[:26] + "..."
                amount = _format_currency(int(data['value']))
                asset_rows.append((name, amount))
    
    # Second: Add non-financial assets (rights to receive goods)
    displayed_asset_skus = set()
    for sku, data in balance.nonfinancial_assets_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} receivable [{qty} unit{'s' if qty != 1 else ''}]"
            if len(name) > 29:
                name = name[:26] + "..."
            amount = _format_currency(int(data['value']))
            asset_rows.append((name, amount))
            displayed_asset_skus.add(sku)
    
    # Third: Add financial assets
    financial_asset_kinds = set()
    for asset_type in sorted(balance.assets_by_kind.keys()):
        # Skip non-financial types
        is_nonfinancial = asset_type in ['delivery_obligation']
        
        if not is_nonfinancial and asset_type not in financial_asset_kinds:
            name = asset_type
            if len(name) > 29:
                name = name[:26] + "..."
            amount = _format_currency(balance.assets_by_kind[asset_type])
            asset_rows.append((name, amount))
            financial_asset_kinds.add(asset_type)
    
    liability_rows = []
    
    # First: Add non-financial liabilities (obligations to deliver goods)
    displayed_liability_skus = set()
    for sku, data in balance.nonfinancial_liabilities_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} obligation [{qty} unit{'s' if qty != 1 else ''}]"
            if len(name) > 29:
                name = name[:26] + "..."
            amount = _format_currency(int(data['value']))
            liability_rows.append((name, amount))
            displayed_liability_skus.add(sku)
    
    # Second: Add financial liabilities
    financial_liability_kinds = set()
    for liability_type in sorted(balance.liabilities_by_kind.keys()):
        # Skip non-financial types
        is_nonfinancial = liability_type in ['delivery_obligation']
        
        if not is_nonfinancial and liability_type not in financial_liability_kinds:
            name = liability_type
            if len(name) > 29:
                name = name[:26] + "..."
            amount = _format_currency(balance.liabilities_by_kind[liability_type])
            liability_rows.append((name, amount))
            financial_liability_kinds.add(liability_type)
    
    # Determine the maximum number of rows needed
    max_rows = max(len(asset_rows), len(liability_rows), 1)
    
    for i in range(max_rows):
        asset_name, asset_amount = asset_rows[i] if i < len(asset_rows) else ("", "")
        liability_name, liability_amount = liability_rows[i] if i < len(liability_rows) else ("", "")
        
        print(f"{asset_name:<30} {asset_amount:>12} | {liability_name:<30} {liability_amount:>12}")
    
    print("-" * 70)
    print(f"{'TOTAL FINANCIAL':<30} {_format_currency(balance.total_financial_assets):>12} | "
          f"{'TOTAL FINANCIAL':<30} {_format_currency(balance.total_financial_liabilities):>12}")
    
    # Add valued non-financial total if present
    if balance.total_nonfinancial_value is not None and balance.total_nonfinancial_value > 0:
        print(f"{'TOTAL VALUED DELIV.':<30} {_format_currency(int(balance.total_nonfinancial_value)):>12} | {'':>43}")
        total_assets = balance.total_financial_assets + int(balance.total_nonfinancial_value)
        print(f"{'TOTAL ASSETS':<30} {_format_currency(total_assets):>12} | {'':>43}")
    
    print("-" * 70)
    print(f"{'':>44} | {'NET FINANCIAL':<30} {_format_currency(balance.net_financial, show_sign=True):>12}")


def _display_rich_multiple_agent_balances(
    balances: List[AgentBalance], 
    system: Optional[System] = None
) -> None:
    """Display multiple agent balances side by side using rich formatting."""
    console = Console()
    
    # Create individual tables for each balance
    tables = []
    for balance in balances:
        # Get agent name if system is available
        if system and balance.agent_id in system.state.agents:
            agent = system.state.agents[balance.agent_id]
            # Show both name and ID for clarity
            if agent.name and agent.name != balance.agent_id:
                title = f"{agent.name} [{balance.agent_id}]\n({agent.kind})"
            else:
                title = f"{balance.agent_id}\n({agent.kind})"
        else:
            title = f"{balance.agent_id}"
        
        # Create table for this balance sheet
        table = Table(title=title, box=box.ROUNDED, title_style="bold cyan", width=35)
        table.add_column("Item", style="white", width=20)
        table.add_column("Amount", justify="right", style="white", width=12)
        
        # Add assets
        table.add_row(Text("ASSETS", style="bold green underline"), "")
        
        # First: Add inventory (stocks owned)
        if hasattr(balance, 'inventory_by_sku'):
            for sku, data in balance.inventory_by_sku.items():
                qty = data['quantity']
                if qty > 0:
                    name = f"{sku} [{qty}]"
                    if len(name) > 19:
                        name = name[:16] + "..."
                    amount = _format_currency(int(data['value']))
                    table.add_row(
                        Text(name, style="green"),
                        Text(amount, style="green")
                    )
        
        # Second: Add non-financial assets (rights to receive goods)
        displayed_asset_skus = set()
        for sku, data in balance.nonfinancial_assets_by_kind.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} recv [{qty}]"
                if len(name) > 19:
                    name = name[:16] + "..."
                amount = _format_currency(int(data['value']))
                table.add_row(
                    Text(name, style="green"),
                    Text(amount, style="green")
                )
                displayed_asset_skus.add(sku)
        
        # Third: Add financial assets
        for asset_type in sorted(balance.assets_by_kind.keys()):
            # Skip non-financial types
            if asset_type not in ['delivery_obligation']:
                name = asset_type
                if len(name) > 19:
                    name = name[:16] + "..."
                table.add_row(
                    Text(name, style="green"),
                    Text(_format_currency(balance.assets_by_kind[asset_type]), style="green")
                )
        
        table.add_row("", "", end_section=True)
        
        # Add liabilities
        table.add_row(Text("LIABILITIES", style="bold red underline"), "")
        
        # First: Add non-financial liabilities (obligations to deliver goods)
        for sku, data in balance.nonfinancial_liabilities_by_kind.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} oblig [{qty}]"
                if len(name) > 19:
                    name = name[:16] + "..."
                amount = _format_currency(int(data['value']))
                table.add_row(
                    Text(name, style="red"),
                    Text(amount, style="red")
                )
        
        # Second: Add financial liabilities
        for liability_type in sorted(balance.liabilities_by_kind.keys()):
            # Skip non-financial types
            if liability_type not in ['delivery_obligation']:
                name = liability_type
                if len(name) > 19:
                    name = name[:16] + "..."
                table.add_row(
                    Text(name, style="red"),
                    Text(_format_currency(balance.liabilities_by_kind[liability_type]), style="red")
                )
        
        # Add totals and net worth
        table.add_row("", "", end_section=True)
        table.add_row(
            Text("Total Financial", style="bold green"),
            Text(_format_currency(balance.total_financial_assets), style="bold green")
        )
        
        # Add valued delivery obligations total if present
        if balance.total_nonfinancial_value is not None and balance.total_nonfinancial_value > 0:
            table.add_row(
                Text("Total Valued", style="bold green"),
                Text(_format_currency(int(balance.total_nonfinancial_value)), style="bold green")
            )
            total_assets = balance.total_financial_assets + int(balance.total_nonfinancial_value)
            table.add_row(
                Text("Total Assets", style="bold green"),
                Text(_format_currency(total_assets), style="bold green")
            )
        
        # Add total liabilities (financial + valued non-financial)
        if balance.total_nonfinancial_liability_value is not None and balance.total_nonfinancial_liability_value > 0:
            table.add_row(
                Text("Total Fin. Liab.", style="bold red"),
                Text(_format_currency(balance.total_financial_liabilities), style="bold red")
            )
            table.add_row(
                Text("Total Valued Liab.", style="bold red"),
                Text(_format_currency(int(balance.total_nonfinancial_liability_value)), style="bold red")
            )
            total_liab = balance.total_financial_liabilities + int(balance.total_nonfinancial_liability_value)
            table.add_row(
                Text("Total Liab.", style="bold red"),
                Text(_format_currency(total_liab), style="bold red")
            )
        else:
            table.add_row(
                Text("Total Liab.", style="bold red"),
                Text(_format_currency(balance.total_financial_liabilities), style="bold red")
            )
        
        net_worth_style = "bold green" if balance.net_financial >= 0 else "bold red"
        table.add_row(
            Text("Net Financial", style="bold blue"),
            Text(_format_currency(balance.net_financial, show_sign=True), style=net_worth_style)
        )
        
        tables.append(table)
    
    # Display tables in columns
    console.print(Columns(tables, equal=True, expand=True))


def _display_simple_multiple_agent_balances(
    balances: List[AgentBalance], 
    system: Optional[System] = None
) -> None:
    """Display multiple agent balances side by side using simple text formatting."""
    # Calculate column width based on number of balance sheets
    console_width = 120
    col_width = max(25, console_width // len(balances) - 2)
    
    # Create headers
    headers = []
    separators = []
    for balance in balances:
        if system and balance.agent_id in system.state.agents:
            agent = system.state.agents[balance.agent_id]
            header = f"{agent.name or balance.agent_id} ({agent.kind})"
        else:
            header = balance.agent_id
        
        if len(header) > col_width:
            header = header[:col_width-3] + "..."
        headers.append(header.center(col_width))
        separators.append("-" * col_width)
    
    print("\n" + " | ".join(headers))
    print(" | ".join(separators))
    
    # Collect all data for each balance sheet
    balance_data = []
    max_rows = 0
    
    for balance in balances:
        data = []
        data.append(("ASSETS", ""))
        
        # First: Add inventory (stocks owned)
        if hasattr(balance, 'inventory_by_sku'):
            for sku, inv_data in balance.inventory_by_sku.items():
                qty = inv_data['quantity']
                if qty > 0:
                    name = f"{sku} [{qty}]"
                    amount = _format_currency(int(inv_data['value']))
                    if len(name + " " + amount) > col_width:
                        name = name[:col_width-len(amount)-4] + "..."
                    data.append((name, amount))
        
        # Second: Add non-financial assets (rights to receive goods)
        for sku, asset_data in balance.nonfinancial_assets_by_kind.items():
            qty = asset_data['quantity']
            if qty > 0:
                name = f"{sku} recv [{qty}]"
                amount = _format_currency(int(asset_data['value']))
                if len(name + " " + amount) > col_width:
                    name = name[:col_width-len(amount)-4] + "..."
                data.append((name, amount))
        
        # Third: Add financial assets
        for asset_type in sorted(balance.assets_by_kind.keys()):
            # Skip non-financial types
            if asset_type not in ['delivery_obligation']:
                amount = _format_currency(balance.assets_by_kind[asset_type])
                asset_name = asset_type
                if len(asset_name + " " + amount) > col_width:
                    asset_name = asset_name[:col_width-len(amount)-4] + "..."
                data.append((asset_name, amount))
        
        data.append(("", ""))
        data.append(("LIABILITIES", ""))
        
        # First: Add non-financial liabilities (obligations to deliver goods)
        for sku, liability_data in balance.nonfinancial_liabilities_by_kind.items():
            qty = liability_data['quantity']
            if qty > 0:
                name = f"{sku} oblig [{qty}]"
                amount = _format_currency(int(liability_data['value']))
                if len(name + " " + amount) > col_width:
                    name = name[:col_width-len(amount)-4] + "..."
                data.append((name, amount))
        
        # Second: Add financial liabilities
        for liability_type in sorted(balance.liabilities_by_kind.keys()):
            # Skip non-financial types
            if liability_type not in ['delivery_obligation']:
                amount = _format_currency(balance.liabilities_by_kind[liability_type])
                liability_name = liability_type
                if len(liability_name + " " + amount) > col_width:
                    liability_name = liability_name[:col_width-len(amount)-4] + "..."
                data.append((liability_name, amount))
        
        data.append(("", ""))
        data.append(("Total Financial", _format_currency(balance.total_financial_assets)))
        
        # Add valued delivery obligations total if present
        if balance.total_nonfinancial_value is not None and balance.total_nonfinancial_value > 0:
            data.append(("Total Valued", _format_currency(int(balance.total_nonfinancial_value))))
            total_assets = balance.total_financial_assets + int(balance.total_nonfinancial_value)
            data.append(("Total Assets", _format_currency(total_assets)))
        
        # Add total liabilities
        if balance.total_nonfinancial_liability_value is not None and balance.total_nonfinancial_liability_value > 0:
            data.append(("Total Valued Liab.", _format_currency(int(balance.total_nonfinancial_liability_value))))
            total_liab = balance.total_financial_liabilities + int(balance.total_nonfinancial_liability_value)
            data.append(("Total Liab.", _format_currency(total_liab)))
        else:
            data.append(("Total Liab.", _format_currency(balance.total_financial_liabilities)))
        data.append(("Net Financial", _format_currency(balance.net_financial, show_sign=True)))
        
        balance_data.append(data)
        max_rows = max(max_rows, len(data))
    
    # Print rows
    for row_idx in range(max_rows):
        row_parts = []
        for balance_idx, data in enumerate(balance_data):
            if row_idx < len(data):
                item, amount = data[row_idx]
                if amount:
                    line = f"{item} {amount}".rjust(col_width)
                else:
                    line = item.ljust(col_width)
            else:
                line = " " * col_width
            row_parts.append(line)
        
        print(" | ".join(row_parts))


def build_t_account_rows(system: System, agent_id: str) -> TAccount:
    """Build detailed T-account rows from system state for an agent."""
    assets: List[BalanceRow] = []
    liabilities: List[BalanceRow] = []

    agent = system.state.agents[agent_id]

    # Inventory (stocks owned) as assets
    for stock_id in agent.stock_ids:
        lot = system.state.stocks[stock_id]
        try:
            value_minor = int(lot.value)
        except Exception:
            # Fallback for Decimals
            value_minor = int(float(lot.value))
        assets.append(BalanceRow(
            name=f"{lot.sku}",
            quantity=int(lot.quantity),
            value_minor=value_minor,
            counterparty_name="—",
            maturity="—",
        ))

    # Precompute id->alias map for quick lookups
    try:
        id_to_alias = {cid: alias for alias, cid in (system.state.aliases or {}).items()}
    except Exception:
        id_to_alias = {}

    # Contracts as assets (held by agent)
    for cid in agent.asset_ids:
        c = system.state.contracts[cid]
        if c.kind == "delivery_obligation":
            # Receivable goods
            # valued_amount is Decimal
            valued = getattr(c, 'valued_amount', None)
            try:
                valued_minor = int(valued) if valued is not None else None
            except Exception:
                valued_minor = int(float(valued)) if valued is not None else None
            counterparty = _format_agent(c.liability_issuer_id, system)
            maturity = f"Day {getattr(c, 'due_day', '—')}"
            assets.append(BalanceRow(
                name=f"{getattr(c, 'sku', 'goods')} receivable",
                quantity=int(c.amount) if c.amount is not None else None,
                value_minor=valued_minor,
                counterparty_name=counterparty,
                maturity=maturity,
                id_or_alias=id_to_alias.get(cid, cid),
            ))
        else:
            # Financial assets
            counterparty = _format_agent(c.liability_issuer_id, system)
            maturity = "on-demand" if c.kind in ("cash", "bank_deposit", "reserve_deposit") else (
                f"Day {getattr(c, 'due_day', '—')}" if hasattr(c, 'due_day') else "—"
            )
            assets.append(BalanceRow(
                name=f"{c.kind}",
                quantity=None,
                value_minor=int(c.amount) if c.amount is not None else None,
                counterparty_name=counterparty if c.kind != "cash" else "—",
                maturity=maturity,
                id_or_alias=id_to_alias.get(cid, cid),
            ))

    # Contracts as liabilities (issued by agent)
    for cid in agent.liability_ids:
        c = system.state.contracts[cid]
        if c.kind == "delivery_obligation":
            valued = getattr(c, 'valued_amount', None)
            try:
                valued_minor = int(valued) if valued is not None else None
            except Exception:
                valued_minor = int(float(valued)) if valued is not None else None
            counterparty = _format_agent(c.asset_holder_id, system)
            maturity = f"Day {getattr(c, 'due_day', '—')}"
            liabilities.append(BalanceRow(
                name=f"{getattr(c, 'sku', 'goods')} obligation",
                quantity=int(c.amount) if c.amount is not None else None,
                value_minor=valued_minor,
                counterparty_name=counterparty,
                maturity=maturity,
                id_or_alias=id_to_alias.get(cid, cid),
            ))
        else:
            counterparty = _format_agent(c.asset_holder_id, system)
            maturity = "on-demand" if c.kind in ("cash", "bank_deposit", "reserve_deposit") else (
                f"Day {getattr(c, 'due_day', '—')}" if hasattr(c, 'due_day') else "—"
            )
            liabilities.append(BalanceRow(
                name=f"{c.kind}",
                quantity=None,
                value_minor=int(c.amount) if c.amount is not None else None,
                counterparty_name=counterparty,
                maturity=maturity,
                id_or_alias=id_to_alias.get(cid, cid),
            ))

    # Ordering within each side
    def sort_key_assets(row: BalanceRow):
        # Inventory first (has quantity and counterparty '—' and maturity '—'),
        # then receivables (name ends with 'receivable'), then financial by kind order
        financial_order = {"cash": 0, "bank_deposit": 1, "reserve_deposit": 2, "payable": 3}
        if row.quantity is not None and row.counterparty_name == "—":
            return (0, 0, row.name or "")
        if row.name.endswith("receivable"):
            day_num = parse_day_from_maturity(row.maturity)
            return (1, day_num, row.name)
        return (2, financial_order.get(row.name, 99), row.name)

    def sort_key_liabs(row: BalanceRow):
        # Obligations (name ends with 'obligation') by due day, then financial by order
        financial_order = {"payable": 0, "bank_deposit": 1, "reserve_deposit": 2, "cash": 3}
        if row.name.endswith("obligation"):
            day_num = parse_day_from_maturity(row.maturity)
            return (0, day_num, row.name)
        return (1, financial_order.get(row.name, 99), row.name)

    assets.sort(key=sort_key_assets)
    liabilities.sort(key=sort_key_liabs)

    return TAccount(assets=assets, liabilities=liabilities)


def display_agent_t_account(system: System, agent_id: str, format: str = 'rich') -> None:
    """Display detailed T-account table for an agent."""
    if format == 'rich' and not RICH_AVAILABLE:
        format = 'simple'
    if format == 'rich':
        table = display_agent_t_account_renderable(system, agent_id)
        Console().print(table)
    else:
        # Simple ASCII fallback
        acct = build_t_account_rows(system, agent_id)
        columns = ["Name", "Qty", "Value", "Counterparty", "Maturity"]
        # Prepare rows
        max_rows = max(len(acct.assets), len(acct.liabilities))
        header = " | ".join([f"Assets:{c}" for c in columns] + [f"Liabilities:{c}" for c in columns])
        print(header)
        print("-" * len(header))
        for i in range(max_rows):
            a = acct.assets[i] if i < len(acct.assets) else None
            l = acct.liabilities[i] if i < len(acct.liabilities) else None
            def fmt_qty(r): return f"{r.quantity:,}" if (r and r.quantity is not None) else "—"
            def fmt_val(r):
                if not r or r.value_minor is None: return "—"
                return _format_currency(int(r.value_minor))
            def cells(r):
                if not r: return ("", "", "", "", "")
                return (r.name, fmt_qty(r), fmt_val(r), r.counterparty_name or "—", r.maturity or "—")
            row = list(cells(a) + cells(l))
            print(" | ".join(str(x) for x in row))


def display_agent_t_account_renderable(system: System, agent_id: str) -> RenderableType:
    """Return a Rich Table renderable for detailed T-account."""
    if not RICH_AVAILABLE:
        # Fallback to string
        acct = build_t_account_rows(system, agent_id)
        lines = []
        columns = ["Name", "Qty", "Value", "Counterparty", "Maturity"]
        lines.append(" | ".join([f"Assets:{c}" for c in columns] + [f"Liabilities:{c}" for c in columns]))
        max_rows = max(len(acct.assets), len(acct.liabilities))
        for i in range(max_rows):
            a = acct.assets[i] if i < len(acct.assets) else None
            l = acct.liabilities[i] if i < len(acct.liabilities) else None
            def fmt_qty(r): return f"{r.quantity:,}" if (r and r.quantity is not None) else "—"
            def fmt_val(r):
                if not r or r.value_minor is None: return "—"
                return _format_currency(int(r.value_minor))
            def cells(r):
                if not r: return ("", "", "", "", "")
                return (r.name, fmt_qty(r), fmt_val(r), r.counterparty_name or "—", r.maturity or "—")
            row = list(cells(a) + cells(l))
            lines.append(" | ".join(str(x) for x in row))
        return "\n".join(lines)

    # Rich path
    from rich.table import Table as RichTable
    from rich import box as rich_box
    acct = build_t_account_rows(system, agent_id)

    ag = system.state.agents[agent_id]
    title = f"{ag.name} [{agent_id}] ({ag.kind})" if ag.name and ag.name != agent_id else f"{agent_id} ({ag.kind})"

    table = RichTable(title=title, box=rich_box.HEAVY, title_style="bold cyan", show_lines=True)
    # Add 10 columns: 5 for assets, 5 for liabilities
    table.add_column("Name", style="green", justify="left")
    table.add_column("Qty", style="green", justify="right")
    table.add_column("Value", style="green", justify="right")
    table.add_column("Counterparty", style="green", justify="left")
    table.add_column("Maturity", style="green", justify="right")
    table.add_column("Name", style="red", justify="left")
    table.add_column("Qty", style="red", justify="right")
    table.add_column("Value", style="red", justify="right")
    table.add_column("Counterparty", style="red", justify="left")
    table.add_column("Maturity", style="red", justify="right")
    try:
        table.row_styles = ["on #ffffff", "on #fff2cc"]
    except Exception:
        pass

    def fmt_qty(r): return f"{r.quantity:,}" if (r and r.quantity is not None) else "—"
    def fmt_val(r):
        if not r or r.value_minor is None: return "—"
        return _format_currency(int(r.value_minor))
    def cells(r):
        if not r: return ("", "", "", "", "")
        return (r.name, fmt_qty(r), fmt_val(r), r.counterparty_name or "—", r.maturity or "—")

    max_rows = max(len(acct.assets), len(acct.liabilities))
    for i in range(max_rows):
        a = acct.assets[i] if i < len(acct.assets) else None
        l = acct.liabilities[i] if i < len(acct.liabilities) else None
        table.add_row(*cells(a), *cells(l))
    return table


def display_agent_balance_table_renderable(
    system: System,
    agent_id: str,
    format: str = 'rich',
    title: Optional[str] = None
) -> Union[RenderableType, str]:
    """
    Return a renderable for a single agent's balance sheet as a T-account style table.
    
    Args:
        system: The bilancio system instance
        agent_id: ID of the agent to display
        format: Display format ('rich' or 'simple')
        title: Optional custom title for the table
        
    Returns:
        Rich Table renderable for rich format, or string for simple format
    """
    if format == 'rich' and not RICH_AVAILABLE:
        format = 'simple'
    
    # Get agent balance
    balance = agent_balance(system, agent_id)
    
    if format == 'rich':
        # Get agent info
        agent = system.state.agents[agent_id]
        if title is None:
            # Show both name and ID for clarity
            if agent.name and agent.name != agent_id:
                title = f"{agent.name} [{agent_id}] ({agent.kind})"
            else:
                title = f"{agent_id} ({agent.kind})"
        
        return _create_rich_agent_balance_table(title, balance)
    else:
        # Return simple text format as string
        return _build_simple_agent_balance_string(balance, system, agent_id, title)


def display_multiple_agent_balances_renderable(
    system: System,
    items: List[Union[str, AgentBalance]], 
    format: str = 'rich'
) -> Union[RenderableType, str]:
    """
    Return renderables for multiple agent balance sheets side by side for comparison.
    
    Args:
        system: The bilancio system instance
        items: List of agent IDs (str) or AgentBalance instances
        format: Display format ('rich' or 'simple')
        
    Returns:
        Rich Columns renderable for rich format, or string for simple format
    """
    if format == 'rich' and not RICH_AVAILABLE:
        format = 'simple'
    
    # Convert agent IDs to balance objects if needed
    balances = []
    for item in items:
        if isinstance(item, str):
            balances.append(agent_balance(system, item))
        else:
            balances.append(item)
    
    if format == 'rich':
        # Create individual tables for each balance
        tables = []
        for balance in balances:
            # Get agent name if system is available
            if system and balance.agent_id in system.state.agents:
                agent = system.state.agents[balance.agent_id]
                # Show both name and ID for clarity
                if agent.name and agent.name != balance.agent_id:
                    title = f"{agent.name} [{balance.agent_id}]\n({agent.kind})"
                else:
                    title = f"{balance.agent_id}\n({agent.kind})"
            else:
                title = f"{balance.agent_id}"
            
            table = _create_compact_rich_balance_table(title, balance)
            tables.append(table)
        
        return Columns(tables, equal=True, expand=True)
    else:
        # Return simple text format as string
        return _build_simple_multiple_agent_balances_string(balances, system)


def _create_rich_agent_balance_table(title: str, balance: AgentBalance) -> Table:
    """Create a Rich Table for a single agent balance (returns table instead of printing)."""
    # Create the main table with wider columns to avoid truncation
    table = Table(title=title, box=box.ROUNDED, title_style="bold cyan")
    table.add_column("ASSETS", style="green", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="green", width=15, no_wrap=True)
    table.add_column("LIABILITIES", style="red", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="red", width=15, no_wrap=True)
    
    asset_rows = []
    
    # First: Add inventory (stocks owned) - these are physical assets
    if hasattr(balance, 'inventory_by_sku'):
        for sku, data in balance.inventory_by_sku.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} [{qty} unit{'s' if qty != 1 else ''}]"
                amount = _format_currency(int(data['value']))
                asset_rows.append((name, amount))
    
    # Second: Add non-financial assets (rights to receive goods)
    displayed_asset_skus = set()
    for sku, data in balance.nonfinancial_assets_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} receivable [{qty} unit{'s' if qty != 1 else ''}]"
            amount = _format_currency(int(data['value']))
            asset_rows.append((name, amount))
            displayed_asset_skus.add(sku)
    
    # Third: Add financial assets (everything else in assets_by_kind)
    financial_asset_kinds = set()
    for asset_type in sorted(balance.assets_by_kind.keys()):
        # Skip if this is a non-financial type we already displayed
        is_nonfinancial = False
        for sku in displayed_asset_skus:
            # This is a heuristic but works for current instrument types
            if asset_type in ['delivery_obligation']:
                is_nonfinancial = True
                break
        
        if not is_nonfinancial and asset_type not in financial_asset_kinds:
            name = asset_type
            amount = _format_currency(balance.assets_by_kind[asset_type])
            asset_rows.append((name, amount))
            financial_asset_kinds.add(asset_type)
    
    liability_rows = []
    
    # First: Add non-financial liabilities (obligations to deliver goods)
    displayed_liability_skus = set()
    for sku, data in balance.nonfinancial_liabilities_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} obligation [{qty} unit{'s' if qty != 1 else ''}]"
            amount = _format_currency(int(data['value']))
            liability_rows.append((name, amount))
            displayed_liability_skus.add(sku)
    
    # Second: Add financial liabilities (everything else in liabilities_by_kind)
    financial_liability_kinds = set()
    for liability_type in sorted(balance.liabilities_by_kind.keys()):
        # Skip if this is a non-financial type we already displayed
        is_nonfinancial = False
        for sku in displayed_liability_skus:
            if liability_type in ['delivery_obligation']:
                is_nonfinancial = True
                break
        
        if not is_nonfinancial and liability_type not in financial_liability_kinds:
            name = liability_type
            amount = _format_currency(balance.liabilities_by_kind[liability_type])
            liability_rows.append((name, amount))
            financial_liability_kinds.add(liability_type)
    
    # Determine the maximum number of rows needed
    max_rows = max(len(asset_rows), len(liability_rows), 1)
    
    for i in range(max_rows):
        asset_name, asset_amount = asset_rows[i] if i < len(asset_rows) else ("", "")
        liability_name, liability_amount = liability_rows[i] if i < len(liability_rows) else ("", "")
        
        table.add_row(asset_name, asset_amount, liability_name, liability_amount)
    
    # Add separator and totals
    table.add_row("", "", "", "", end_section=True)
    table.add_row(
        Text("TOTAL FINANCIAL", style="bold green"),
        Text(_format_currency(balance.total_financial_assets), style="bold green"),
        Text("TOTAL FINANCIAL", style="bold red"),
        Text(_format_currency(balance.total_financial_liabilities), style="bold red")
    )
    
    # Add valued non-financial total if present
    if balance.total_nonfinancial_value is not None and balance.total_nonfinancial_value > 0:
        table.add_row(
            Text("TOTAL VALUED DELIV.", style="bold green"),
            Text(_format_currency(int(balance.total_nonfinancial_value)), style="bold green"),
            "",
            ""
        )
        total_assets = balance.total_financial_assets + int(balance.total_nonfinancial_value)
        table.add_row(
            Text("TOTAL ASSETS", style="bold green"),
            Text(_format_currency(total_assets), style="bold green"),
            "",
            ""
        )
    
    # Add visual separation before net worth
    table.add_row("", "", "", "", end_section=True)
    
    # Add net worth with clear separation
    net_financial = balance.net_financial
    net_worth_style = "bold green" if net_financial >= 0 else "bold red"
    table.add_row(
        "",
        "",
        Text("NET FINANCIAL", style="bold blue"),
        Text(_format_currency(net_financial, show_sign=True), style=net_worth_style)
    )
    
    return table


def _create_compact_rich_balance_table(title: str, balance: AgentBalance) -> Table:
    """Create a compact Rich Table for multiple balance display."""
    table = Table(title=title, box=box.ROUNDED, title_style="bold cyan", width=35)
    table.add_column("Item", style="white", width=20)
    table.add_column("Amount", justify="right", style="white", width=12)
    
    # Add assets
    table.add_row(Text("ASSETS", style="bold green underline"), "")
    
    # First: Add inventory (stocks owned)
    if hasattr(balance, 'inventory_by_sku'):
        for sku, data in balance.inventory_by_sku.items():
            qty = data['quantity']
            if qty > 0:
                name = f"{sku} [{qty}]"
                if len(name) > 19:
                    name = name[:16] + "..."
                amount = _format_currency(int(data['value']))
                table.add_row(
                    Text(name, style="green"),
                    Text(amount, style="green")
                )
    
    # Second: Add non-financial assets (rights to receive goods)
    for sku, data in balance.nonfinancial_assets_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} recv [{qty}]"
            if len(name) > 19:
                name = name[:16] + "..."
            amount = _format_currency(int(data['value']))
            table.add_row(
                Text(name, style="green"),
                Text(amount, style="green")
            )
    
    # Third: Add financial assets
    for asset_type in sorted(balance.assets_by_kind.keys()):
        # Skip non-financial types
        if asset_type not in ['delivery_obligation']:
            name = asset_type
            if len(name) > 19:
                name = name[:16] + "..."
            table.add_row(
                Text(name, style="green"),
                Text(_format_currency(balance.assets_by_kind[asset_type]), style="green")
            )
    
    table.add_row("", "", end_section=True)
    
    # Add liabilities
    table.add_row(Text("LIABILITIES", style="bold red underline"), "")
    
    # First: Add non-financial liabilities (obligations to deliver goods)
    for sku, data in balance.nonfinancial_liabilities_by_kind.items():
        qty = data['quantity']
        if qty > 0:
            name = f"{sku} oblig [{qty}]"
            if len(name) > 19:
                name = name[:16] + "..."
            amount = _format_currency(int(data['value']))
            table.add_row(
                Text(name, style="red"),
                Text(amount, style="red")
            )
    
    # Second: Add financial liabilities
    for liability_type in sorted(balance.liabilities_by_kind.keys()):
        # Skip non-financial types
        if liability_type not in ['delivery_obligation']:
            name = liability_type
            if len(name) > 19:
                name = name[:16] + "..."
            table.add_row(
                Text(name, style="red"),
                Text(_format_currency(balance.liabilities_by_kind[liability_type]), style="red")
            )
    
    # Add totals and net worth
    table.add_row("", "", end_section=True)
    table.add_row(
        Text("Total Financial", style="bold green"),
        Text(_format_currency(balance.total_financial_assets), style="bold green")
    )
    table.add_row(
        Text("Total Liab.", style="bold red"),
        Text(_format_currency(balance.total_financial_liabilities), style="bold red")
    )
    
    net_worth_style = "bold green" if balance.net_financial >= 0 else "bold red"
    table.add_row(
        Text("Net Financial", style="bold blue"),
        Text(_format_currency(balance.net_financial, show_sign=True), style=net_worth_style)
    )
    
    return table


def _build_simple_agent_balance_string(
    balance: AgentBalance, 
    system: Optional[System] = None, 
    agent_id: Optional[str] = None,
    title: Optional[str] = None
) -> str:
    """Build a simple text format balance sheet string."""
    lines = []
    
    # Get title
    if title is None:
        if system and agent_id and agent_id in system.state.agents:
            agent = system.state.agents[agent_id]
            if agent.name and agent.name != agent_id:
                title = f"{agent.name} [{agent_id}] ({agent.kind})"
            else:
                title = f"{agent_id} ({agent.kind})"
        else:
            title = f"Agent {balance.agent_id}"
    
    lines.append(f"\n{title}")
    lines.append("=" * 70)
    lines.append(f"{'ASSETS':<30} {'Amount':>12} | {'LIABILITIES':<30} {'Amount':>12}")
    lines.append("-" * 70)
    
    # Simplified balance sheet representation for simple format
    lines.append(f"{'Total Financial':<30} {_format_currency(balance.total_financial_assets):>12} | "
          f"{'Total Financial':<30} {_format_currency(balance.total_financial_liabilities):>12}")
    
    lines.append("-" * 70)
    lines.append(f"{'':>44} | {'NET FINANCIAL':<30} {_format_currency(balance.net_financial, show_sign=True):>12}")
    
    return "\n".join(lines)


def _build_simple_multiple_agent_balances_string(
    balances: List[AgentBalance], 
    system: Optional[System] = None
) -> str:
    """Build a simple text format for multiple agent balances."""
    lines = []
    lines.append("\nMultiple Agent Balances (Simplified View)")
    lines.append("=" * 60)
    
    for balance in balances:
        if system and balance.agent_id in system.state.agents:
            agent = system.state.agents[balance.agent_id]
            header = f"{agent.name or balance.agent_id} ({agent.kind})"
        else:
            header = balance.agent_id
        
        lines.append(f"{header}: Net Financial = {_format_currency(balance.net_financial, show_sign=True)}")
    
    return "\n".join(lines)


```

---

### 📄 src/bilancio/analysis/visualization/common.py

```python
"""Common utilities and types for visualization modules."""

from __future__ import annotations

from dataclasses import dataclass
from typing import Any, Optional
import math

try:
    from rich.console import Console, RenderableType
    RICH_AVAILABLE = True
except ImportError:
    RICH_AVAILABLE = False
    RenderableType = Any


def _format_currency(amount: int, show_sign: bool = False) -> str:
    """Format an integer amount as currency."""
    formatted = f"{amount:,}"
    if show_sign and amount > 0:
        formatted = f"+{formatted}"
    return formatted


def _print(text: str, console: Optional['Console'] = None) -> None:
    """Print using Rich console if available, otherwise regular print."""
    if console:
        console.print(text)
    else:
        print(text)


def _format_agent(agent_id: str, system) -> str:
    """Format agent as 'Name [ID]' if available.

    Args:
        agent_id: The agent ID to format
        system: The System instance (imported locally to avoid circular imports)
    """
    ag = system.state.agents.get(agent_id)
    if ag is None:
        return agent_id
    if ag.name and ag.name != agent_id:
        return f"{ag.name} [{agent_id}]"
    return agent_id


def parse_day_from_maturity(maturity_str: Optional[str]) -> int:
    """Parse a day number from maturity strings like 'Day 42'.

    Returns an integer day. If the input cannot be parsed, returns a large
    sentinel value to sort unknown maturities last.
    """
    if not isinstance(maturity_str, str):
        return math.inf  # type: ignore[return-value]
    s = maturity_str.strip()
    if not s.startswith("Day "):
        return math.inf  # type: ignore[return-value]
    try:
        return int(s[4:].strip())
    except Exception:
        return math.inf  # type: ignore[return-value]


@dataclass
class BalanceRow:
    name: str
    quantity: Optional[int]
    value_minor: Optional[int]
    counterparty_name: Optional[str]
    maturity: Optional[str]
    id_or_alias: Optional[str] = None


@dataclass
class TAccount:
    assets: list[BalanceRow]
    liabilities: list[BalanceRow]

```

---

### 📄 src/bilancio/analysis/visualization/events.py

```python
"""Event table formatting and display functions."""

from __future__ import annotations

from collections import defaultdict
from typing import Any, Dict, List, Optional

from bilancio.engines.system import System
from bilancio.analysis.visualization.common import (
    RICH_AVAILABLE,
    RenderableType,
    _print,
)

# Import Rich components only if available
if RICH_AVAILABLE:
    from rich.console import Console
    from rich.table import Table
    from rich.text import Text
    from rich import box



def display_events(events: List[Dict[str, Any]], format: str = 'detailed') -> None:
    """
    Display system events in a nicely formatted way.
    
    Args:
        events: List of event dictionaries from sys.state.events
        format: Display format ('detailed' or 'summary')
    """
    console = Console() if RICH_AVAILABLE else None
    
    if not events:
        _print("No events to display.", console)
        return
    
    if format == 'summary':
        _display_events_summary(events, console)
    else:
        _display_events_detailed(events, console)


def display_events_table(events: List[Dict[str, Any]], group_by_day: bool = True) -> None:
    """Render events as a table with canonical columns.

    Falls back to simple text when Rich is not available.
    """
    console = Console() if RICH_AVAILABLE else None

    if not events:
        _print("No events to display.", console)
        return

    columns = ["Day", "Phase", "Kind", "From", "To", "SKU/Instr", "Qty", "Amount", "Notes"]

    # Sort events deterministically
    # Drop phase marker events; preserve original insertion (chronological) order
    evs = [e for e in events if e.get("kind") not in ("PhaseA", "PhaseB", "PhaseC")]

    if RICH_AVAILABLE:
        from rich.table import Table as RichTable
        from rich import box as rich_box
        table = RichTable(title="Events", box=rich_box.HEAVY, show_lines=True)
        # Column definitions with better alignment
        table.add_column("Day", justify="right")
        table.add_column("Phase", justify="left")
        table.add_column("Kind", justify="left")
        table.add_column("From", justify="left")
        table.add_column("To", justify="left")
        table.add_column("SKU/Instr", justify="left")
        table.add_column("Qty", justify="right")
        table.add_column("Amount", justify="right")
        table.add_column("Notes", justify="left")
        # Alternate row shading for readability
        try:
            table.row_styles = ["on #ffffff", "on #e6f2ff"]
        except Exception:
            pass

        for e in evs:
            kind = str(e.get("kind", ""))
            # Canonical from/to mapping by kind
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer")
                to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank")
                to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner")
                to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer") or e.get("agent")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"

            notes = ""
            if kind == "ClientPayment":
                notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                if 'due_day' in e:
                    notes += f"; due {e.get('due_day')}"
            elif kind == "AgentDefaulted":
                shortfall = e.get('shortfall')
                trigger = e.get('trigger_contract')
                parts = []
                if shortfall is not None:
                    parts.append(f"shortfall {shortfall}")
                if trigger:
                    parts.append(f"trigger {trigger}")
                if parts:
                    notes = ", ".join(parts)

            table.add_row(
                str(e.get("day", "—")),
                str(e.get("phase", "—")),
                kind,
                str(frm or "—"),
                str(to or "—"),
                str(sku),
                str(qty),
                str(amt),
                notes,
            )

        console.print(table) if console else print(table)
    else:
        # Simple header + rows
        header = " | ".join(columns)
        print(header)
        print("-" * len(header))
        for e in evs:
            kind = str(e.get("kind", ""))
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer")
                to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank")
                to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner")
                to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer") or e.get("agent")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"
            notes = ""
            if kind == "ClientPayment":
                notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                if 'due_day' in e:
                    notes += f"; due {e.get('due_day')}"
            elif kind == "AgentDefaulted":
                shortfall = e.get('shortfall')
                trigger = e.get('trigger_contract')
                parts = []
                if shortfall is not None:
                    parts.append(f"shortfall {shortfall}")
                if trigger:
                    parts.append(f"trigger {trigger}")
                if parts:
                    notes = ", ".join(parts)
            row = [
                str(e.get("day", "—")),
                str(e.get("phase", "—")),
                kind,
                str(frm or "—"),
                str(to or "—"),
                str(sku),
                str(qty),
                str(amt),
                notes,
            ]
            print(" | ".join(row))


def display_events_table_renderable(events: List[Dict[str, Any]]) -> RenderableType:
    """Return a Rich Table renderable (or string) for events table."""
    if not events:
        return Text("No events to display.", style="dim") if RICH_AVAILABLE else "No events to display."

    columns = ["Day", "Phase", "Kind", "From", "To", "SKU/Instr", "Qty", "Amount", "Notes"]
    # Drop phase marker events; preserve original insertion (chronological) order
    evs = [e for e in events if e.get("kind") not in ("PhaseA", "PhaseB", "PhaseC")]

    if RICH_AVAILABLE:
        from rich.table import Table as RichTable
        from rich import box as rich_box
        table = RichTable(title="Events", box=rich_box.HEAVY, show_lines=True)
        table.add_column("Day", justify="right")
        table.add_column("Phase", justify="left")
        table.add_column("Kind", justify="left")
        table.add_column("From", justify="left")
        table.add_column("To", justify="left")
        table.add_column("SKU/Instr", justify="left")
        table.add_column("Qty", justify="right")
        table.add_column("Amount", justify="right")
        table.add_column("Notes", justify="left")
        try:
            table.row_styles = ["on #ffffff", "on #e6f2ff"]
        except Exception:
            pass

        for e in evs:
            kind = str(e.get("kind", ""))
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer")
                to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank")
                to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner")
                to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"
            notes = ""
            if kind == "ClientPayment":
                notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                if 'due_day' in e:
                    notes += f"; due {e.get('due_day')}"

            table.add_row(
                str(e.get("day", "—")),
                str(e.get("phase", "—")),
                kind,
                str(frm or "—"),
                str(to or "—"),
                str(sku),
                str(qty),
                str(amt),
                notes,
            )
        return table
    else:
        header = " | ".join(columns)
        lines = [header, "-" * len(header)]
        for e in evs:
            kind = str(e.get("kind", ""))
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer")
                to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank")
                to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner")
                to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"
            notes = ""
            if kind == "ClientPayment":
                notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                if 'due_day' in e:
                    notes += f"; due {e.get('due_day')}"
            row = [
                str(e.get("day", "—")),
                str(e.get("phase", "—")),
                kind,
                str(frm or "—"),
                str(to or "—"),
                str(sku),
                str(qty),
                str(amt),
                notes,
            ]
            lines.append(" | ".join(row))
        return "\n".join(lines)


def _display_events_summary(events: List[Dict[str, Any]], console: Optional['Console'] = None) -> None:
    """Display events in a condensed summary format."""
    for event in events:
        kind = event.get("kind", "Unknown")
        day = event.get("day", "?")
        
        if kind == "PayableSettled":
            _print(f"Day {day}: 💰 {event['debtor']} → {event['creditor']}: ${event['amount']}", console)
        elif kind == "DeliveryObligationSettled":
            qty = event.get('qty', event.get('quantity', 'N/A'))
            _print(f"Day {day}: 📦 {event['debtor']} → {event['creditor']}: {qty} {event.get('sku', 'items')}", console)
        elif kind == "StockTransferred":
            _print(f"Day {day}: 🚚 {event['frm']} → {event['to']}: {event['qty']} {event['sku']}", console)
        elif kind == "CashTransferred":
            _print(f"Day {day}: 💵 {event['frm']} → {event['to']}: ${event['amount']}", console)



def _display_events_detailed(events: List[Dict[str, Any]], console: Optional['Console'] = None) -> None:
    """Display events grouped by day with detailed formatting."""
    # Separate setup events from day events
    setup_events = []
    events_by_day = defaultdict(list)
    
    for event in events:
        # Check if this is a setup phase event
        if event.get("phase") == "setup":
            setup_events.append(event)
        else:
            day = event.get("day", -1)
            events_by_day[day].append(event)
    
    # Display setup events first if any
    if setup_events:
        _print(f"\n📅 Setup Phase:", console)
        # Setup events don't have phase markers, display them directly
        for event in setup_events:
            _display_single_event(event, console, indent="  ")
    
    # Display events for each day
    for day in sorted(events_by_day.keys()):
        if day >= 0:
            _print(f"\n📅 Day {day}:", console)
        else:
            _print(f"\n📅 Unknown Day:", console)
        
        _display_day_events(events_by_day[day], console)


def _display_day_events(day_events: List[Dict[str, Any]], console: Optional['Console'] = None) -> None:
    """Display events for a single day with proper formatting."""
    # Group events by their phase timing
    phase_a_events = []
    phase_b_events = []
    phase_c_events = []
    
    # Track which phase we're in based on phase markers
    current_phase = "A"  # Start with phase A
    
    for event in day_events:
        kind = event.get("kind", "Unknown")
        
        # Phase markers change which phase we're in
        if kind == "PhaseA":
            current_phase = "A"
        elif kind == "PhaseB":
            current_phase = "B"
        elif kind == "PhaseC":
            current_phase = "C"
        else:
            # Regular events go into the current phase bucket
            if current_phase == "A":
                phase_a_events.append(event)
            elif current_phase == "B":
                phase_b_events.append(event)
            elif current_phase == "C":
                phase_c_events.append(event)
    
    # Always display all three phases
    # Phase A - No-op phase, just marks beginning of day
    _print(f"\n  ⏰ Phase A: Day begins", console)
    for event in phase_a_events:
        _display_single_event(event, console, indent="    ")
    
    # Phase B - Settlement phase where obligations are fulfilled
    _print(f"\n  💳 Phase B: Settlement (fulfilling due obligations)", console)
    for event in phase_b_events:
        _display_single_event(event, console, indent="    ")
    
    # Phase C - Intraday netting
    _print(f"\n  📋 Phase C: Intraday netting", console)
    for event in phase_c_events:
        _display_single_event(event, console, indent="    ")
    
    # Mark end of day
    _print(f"\n  🌙 Day ended", console)


def _display_single_event(event: Dict[str, Any], console: Optional['Console'] = None, indent: str = "  ") -> None:
    """Display a single event with proper formatting."""
    kind = event.get("kind", "Unknown")
    
    if kind == "StockCreated":
        _print(f"{indent}🏭 Stock created: {event['owner']} gets {event['qty']} {event['sku']}", console)
    
    elif kind == "CashMinted":
        _print(f"{indent}💰 Cash minted: ${event['amount']} to {event['to']}", console)
    
    elif kind == "PayableSettled":
        _print(f"{indent}✅ Payment settled: {event['debtor']} → {event['creditor']}: ${event['amount']}", console)
    
    elif kind == "PayableCancelled":
        _print(f"{indent}  └─ Payment obligation removed from books", console)
    
    elif kind == "DeliveryObligationSettled":
        qty = event.get('qty', event.get('quantity', 'N/A'))
        sku = event.get('sku', 'items')
        _print(f"{indent}✅ Delivery settled: {event['debtor']} → {event['creditor']}: {qty} {sku}", console)
    
    elif kind == "DeliveryObligationCancelled":
        _print(f"{indent}  └─ Delivery obligation removed from books", console)
    
    elif kind == "StockTransferred":
        _print(f"{indent}📦 Stock transferred: {event['frm']} → {event['to']}: {event['qty']} {event['sku']}", console)
    
    elif kind == "CashTransferred":
        _print(f"{indent}💵 Cash transferred: {event['frm']} → {event['to']}: ${event['amount']}", console)
    
    elif kind == "StockSplit":
        sku = event.get('sku', 'N/A')
        original_qty = event.get('original_qty', 0)
        split_qty = event.get('split_qty', 0)
        remaining_qty = event.get('remaining_qty', 0)
        # Show shortened IDs for readability
        original_id = event.get('original_id', '')
        new_id = event.get('new_id', '')
        short_orig = original_id.split('_')[-1][:8] if original_id else 'N/A'
        short_new = new_id.split('_')[-1][:8] if new_id else 'N/A'
        _print(f"{indent}📊 Stock split: {short_orig} → {short_new}: {split_qty} {sku} (keeping {remaining_qty})", console)
    
    elif kind == "ReservesMinted":
        amount = event.get('amount', 0)
        to = event.get('to', 'N/A')
        _print(f"{indent}🏦 Reserves minted: ${amount} to {to}", console)
    
    elif kind == "CashDeposited":
        customer = event.get('customer', 'N/A')
        bank = event.get('bank', 'N/A')
        amount = event.get('amount', 0)
        _print(f"{indent}🏧 Cash deposited: {customer} → {bank}: ${amount}", console)
    
    elif kind == "DeliveryObligationCreated":
        frm = event.get('frm', event.get('from', 'N/A'))
        to = event.get('to', 'N/A')
        qty = event.get('qty', event.get('quantity', 0))
        sku = event.get('sku', 'N/A')
        due_day = event.get('due_day', 'N/A')
        _print(f"{indent}📝 Delivery obligation created: {frm} → {to}: {qty} {sku} (due day {due_day})", console)
    
    elif kind == "PayableCreated":
        frm = event.get('frm', event.get('from', event.get('debtor', 'N/A')))
        to = event.get('to', event.get('creditor', 'N/A'))
        amount = event.get('amount', 0)
        due_day = event.get('due_day', 'N/A')
        _print(f"{indent}💸 Payable created: {frm} → {to}: ${amount} (due day {due_day})", console)
    
    elif kind == "ClientPayment":
        payer = event.get('payer', 'N/A')
        payee = event.get('payee', 'N/A')
        amount = event.get('amount', 0)
        payer_bank = event.get('payer_bank', '')
        payee_bank = event.get('payee_bank', '')
        _print(f"{indent}💳 Client payment: {payer} ({payer_bank}) → {payee} ({payee_bank}): ${amount}", console)
    
    elif kind == "InterbankCleared":
        debtor = event.get('debtor_bank', 'N/A')
        creditor = event.get('creditor_bank', 'N/A')
        amount = event.get('amount', 0)
        _print(f"{indent}🏦 Interbank cleared: {debtor} → {creditor}: ${amount} (netted)", console)
    
    elif kind == "ReservesTransferred":
        frm = event.get('frm', 'N/A')
        to = event.get('to', 'N/A')
        amount = event.get('amount', 0)
        _print(f"{indent}💰 Reserves transferred: {frm} → {to}: ${amount}", console)
    
    elif kind == "InstrumentMerged":
        # This is a technical event, show it more compactly
        _print(f"{indent}🔀 Instruments merged", console)
    
    elif kind == "InterbankOvernightCreated":
        debtor = event.get('debtor_bank', 'N/A')
        creditor = event.get('creditor_bank', 'N/A')
        amount = event.get('amount', 0)
        _print(f"{indent}🌙 Overnight payable created: {debtor} → {creditor}: ${amount}", console)
    
    elif kind in ["PhaseA", "PhaseB", "PhaseC"]:
        # Phase markers are not displayed as events themselves
        pass
    
    else:
        # For any other event types, show raw data
        _print(f"{indent}• {kind}: {event}", console)


def display_events_for_day(system: System, day: int) -> None:
    """
    Display all events that occurred on a specific simulation day.
    
    Args:
        system: The bilancio system instance
        day: The simulation day to display events for
    """
    console = Console() if RICH_AVAILABLE else None
    events = [e for e in system.state.events if e.get("day") == day]
    
    if not events:
        _print("  No events occurred on this day.", console)
        return
    
    _display_day_events(events, console)


def display_events_renderable(events: List[Dict[str, Any]], format: str = 'detailed') -> List[RenderableType]:
    """
    Return renderables for system events in a nicely formatted way.
    
    Args:
        events: List of event dictionaries from sys.state.events
        format: Display format ('detailed' or 'summary')
        
    Returns:
        List of Rich renderables (or strings for simple format)
    """
    if not events:
        if RICH_AVAILABLE:
            return [Text("No events to display.", style="dim")]
        else:
            return ["No events to display."]
    
    if format == 'summary':
        return _build_events_summary_renderables(events)
    else:
        return _build_events_detailed_renderables(events)


def display_events_for_day_renderable(system: System, day: int) -> List[RenderableType]:
    """
    Return renderables for all events that occurred on a specific simulation day.
    
    Args:
        system: The bilancio system instance
        day: The simulation day to display events for
        
    Returns:
        List of Rich renderables (or strings for simple format)
    """
    events = [e for e in system.state.events if e.get("day") == day]
    
    if not events:
        if RICH_AVAILABLE:
            return [Text("  No events occurred on this day.", style="dim")]
        else:
            return ["  No events occurred on this day."]
    
    return _build_day_events_renderables(events)


def _build_events_summary_renderables(events: List[Dict[str, Any]]) -> List[RenderableType]:
    """Build renderables for events in summary format."""
    renderables = []
    
    for event in events:
        kind = event.get("kind", "Unknown")
        day = event.get("day", "?")
        
        if kind == "PayableSettled":
            text = f"Day {day}: 💰 {event['debtor']} → {event['creditor']}: ${event['amount']}"
        elif kind == "DeliveryObligationSettled":
            qty = event.get('qty', event.get('quantity', 'N/A'))
            text = f"Day {day}: 📦 {event['debtor']} → {event['creditor']}: {qty} {event.get('sku', 'items')}"
        elif kind == "StockTransferred":
            text = f"Day {day}: 🚚 {event['frm']} → {event['to']}: {event['qty']} {event['sku']}"
        elif kind == "CashTransferred":
            text = f"Day {day}: 💵 {event['frm']} → {event['to']}: ${event['amount']}"
        else:
            continue  # Skip other events in summary mode
        
        if RICH_AVAILABLE:
            renderables.append(Text(text))
        else:
            renderables.append(text)
    
    return renderables


def _build_events_detailed_renderables(events: List[Dict[str, Any]]) -> List[RenderableType]:
    """Build renderables for events in detailed format, organized by phases."""
    # Import and use the phase-aware version
    from bilancio.analysis.visualization_phases import build_events_detailed_with_phases
    return build_events_detailed_with_phases(events, RICH_AVAILABLE)


def _format_single_event(event: Dict[str, Any], registry) -> List[RenderableType]:
    """Format a single event and return renderables."""
    renderables = []
    
    # Format the event using the registry
    title, lines, icon = registry.format(event)
    
    if RICH_AVAILABLE:
        from rich.text import Text
        # Create a nice formatted display with icon and details
        text = Text()
        
        # Add icon and title with color based on event type
        if "Transfer" in title or "Payment" in title:
            text.append(title, style="bold cyan")
        elif "Settled" in title or "Cleared" in title:
            text.append(title, style="bold green")
        elif "Created" in title or "Minted" in title:
            text.append(title, style="bold yellow")
        elif "Consolidation" in title or "Split" in title:
            text.append(title, style="dim italic")
        else:
            text.append(title, style="bold")
        
        # Add details with proper indentation and styling
        if lines:
            for i, line in enumerate(lines[:3]):  # Show up to 3 lines
                text.append("\n   ")
                if "→" in line or "←" in line:
                    # Flow lines - make them prominent
                    text.append(line, style="white")
                elif ":" in line:
                    # Split field and value for better formatting
                    parts = line.split(":", 1)
                    if len(parts) == 2:
                        field, value = parts
                        text.append(field + ":", style="dim")
                        text.append(value, style="white")
                    else:
                        text.append(line, style="dim white")
                elif line.startswith("("):
                    # Technical explanations in parentheses - make them dimmer
                    text.append(line, style="dim italic")
                else:
                    text.append(line, style="white")
        
        renderables.append(text)
    else:
        # Simple text format
        text = f"• {title}"
        if lines:
            text += " - " + ", ".join(lines[:2])
        renderables.append(text)
    
    return [renderables[0]] if renderables else []


def _build_day_events_renderables(events: List[Dict[str, Any]]) -> List[RenderableType]:
    """Build renderables for events in a single day."""
    return _build_events_detailed_renderables(events)

```

---

### 📄 src/bilancio/analysis/visualization/phases.py

```python
"""Phase summary visualization for events."""

from __future__ import annotations

from typing import Any, Dict, List, Optional

from bilancio.analysis.visualization.common import RICH_AVAILABLE, RenderableType


def display_events_tables_by_phase_renderables(events: List[Dict[str, Any]], day: Optional[int] = None) -> List[RenderableType]:
    """Return three event tables (A, B, C) using phase markers as section dividers.

    - Excludes PhaseA/PhaseB/PhaseC events from rows.
    - Titles indicate the phase and optional day.
    """
    if RICH_AVAILABLE:
        from rich.table import Table as RichTable
        from rich import box as rich_box
        from rich.text import Text as RichText

    # If these are setup-phase events (day 0), render as a single "Setup" table
    if any(e.get("phase") == "setup" for e in events):
        return _build_single_setup_table(events, day)

    # Group by phase markers in original order
    buckets = {"A": [], "B": [], "C": []}
    current = "A"
    for e in events:
        kind = e.get("kind")
        if kind == "PhaseA":
            current = "A"; continue
        if kind == "PhaseB":
            current = "B"; continue
        if kind == "PhaseC":
            current = "C"; continue
        buckets[current].append(e)

    def build_table(phase: str, rows: List[Dict[str, Any]]):
        title_parts = {
            "A": "Phase A — Start of day",
            "B": "Phase B — Settlement",
            "C": "Phase C — Clearing"
        }
        title = title_parts.get(phase, f"Phase {phase}")
        if day is not None:
            title = f"{title} (Day {day})"

        if not RICH_AVAILABLE:
            # Simple text fallback
            header = ["Kind", "From", "To", "SKU/Instr", "Qty", "Amount", "Notes"]
            out = [f"{title}", " | ".join(header), "-" * 80]
            for e in rows:
                kind = str(e.get("kind", ""))
                # map from/to like in table renderers
                if kind in ("CashDeposited", "CashWithdrawn"):
                    frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                    to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
                elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                    frm = e.get("payer"); to = e.get("payee")
                elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                    frm = e.get("debtor_bank"); to = e.get("creditor_bank")
                elif kind == "StockCreated":
                    frm = e.get("owner"); to = None
                else:
                    frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
                    to = e.get("to") or e.get("creditor") or e.get("payee")
                sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
                qty = e.get("qty") or e.get("quantity") or "—"
                amt = e.get("amount") or "—"
                notes = ""
                if kind == "ClientPayment":
                    notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
                elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                    notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                    if 'due_day' in e:
                        notes += f"; due {e.get('due_day')}"
                elif kind == "AgentDefaulted":
                    shortfall = e.get('shortfall')
                    trigger = e.get('trigger_contract')
                    parts = []
                    if shortfall is not None:
                        parts.append(f"shortfall {shortfall}")
                    if trigger:
                        parts.append(f"trigger {trigger}")
                    if parts:
                        notes = ", ".join(parts)
                out.append(" | ".join(map(str, [kind, frm or "—", to or "—", sku, qty, amt, notes])))
            return "\n".join(out)

        # Rich table
        table = RichTable(title=title, box=rich_box.HEAVY, show_lines=True)
        table.add_column("Kind", justify="left")
        table.add_column("From", justify="left")
        table.add_column("To", justify="left")
        table.add_column("SKU/Instr", justify="left")
        table.add_column("Qty", justify="right")
        table.add_column("Amount", justify="right")
        table.add_column("Notes", justify="left")
        try:
            table.row_styles = ["on #ffffff", "on #e6f2ff"] if phase != "C" else ["on #ffffff", "on #fff2cc"]
        except Exception:
            pass
        for e in rows:
            kind = str(e.get("kind", ""))
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer"); to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank"); to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner"); to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"
            notes = ""
            if kind == "ClientPayment":
                notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
                if 'due_day' in e:
                    notes += f"; due {e.get('due_day')}"
            elif kind == "AgentDefaulted":
                shortfall = e.get('shortfall')
                trigger = e.get('trigger_contract')
                parts = []
                if shortfall is not None:
                    parts.append(f"shortfall {shortfall}")
                if trigger:
                    parts.append(f"trigger {trigger}")
                if parts:
                    notes = ", ".join(parts)
            table.add_row(kind, str(frm or "—"), str(to or "—"), str(sku), str(qty), str(amt), notes)
        return table

    renderables: List[RenderableType] = []
    # Phase A is intentionally empty for now; only include if it has rows
    if buckets["A"]:
        renderables.append(build_table("A", buckets["A"]))
    # Phase B: settlements
    renderables.append(build_table("B", buckets["B"]))
    # Phase C: clearing
    renderables.append(build_table("C", buckets["C"]))
    return renderables


def _build_single_setup_table(events: List[Dict[str, Any]], day: Optional[int] = None) -> List[RenderableType]:
    """Render a single setup table for setup-phase events (day 0)."""
    rows = [e for e in events if e.get("phase") == "setup" and e.get("kind") not in ("PhaseA","PhaseB","PhaseC")]
    title = "Setup"
    if day is not None:
        title = f"{title} (Day {day})"
    if not RICH_AVAILABLE:
        header = ["Kind", "From", "To", "SKU/Instr", "Qty", "Amount", "Notes"]
        out = [title, " | ".join(header), "-" * 80]
        for e in rows:
            kind = str(e.get("kind", ""))
            if kind in ("CashDeposited", "CashWithdrawn"):
                frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
                to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
            elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
                frm = e.get("payer"); to = e.get("payee")
            elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
                frm = e.get("debtor_bank"); to = e.get("creditor_bank")
            elif kind == "StockCreated":
                frm = e.get("owner"); to = None
            else:
                frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
                to = e.get("to") or e.get("creditor") or e.get("payee")
            sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
            qty = e.get("qty") or e.get("quantity") or "—"
            amt = e.get("amount") or "—"
            notes = ""
            out.append(" | ".join(map(str, [kind, frm or "—", to or "—", sku, qty, amt, notes])))
        return ["\n".join(out)]

    from rich.table import Table as RichTable
    from rich import box as rich_box
    table = RichTable(title=title, box=rich_box.HEAVY, show_lines=True)
    table.add_column("Kind", justify="left")
    table.add_column("From", justify="left")
    table.add_column("To", justify="left")
    table.add_column("SKU/Instr", justify="left")
    table.add_column("Qty", justify="right")
    table.add_column("Amount", justify="right")
    table.add_column("Notes", justify="left")
    try:
        table.row_styles = ["on #ffffff", "on #e6f2ff"]
    except Exception:
        pass
    for e in rows:
        kind = str(e.get("kind", ""))
        if kind in ("CashDeposited", "CashWithdrawn"):
            frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
            to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
        elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
            frm = e.get("payer"); to = e.get("payee")
        elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
            frm = e.get("debtor_bank"); to = e.get("creditor_bank")
        elif kind == "StockCreated":
            frm = e.get("owner"); to = None
        else:
            frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer")
            to = e.get("to") or e.get("creditor") or e.get("payee")
        sku = e.get("sku") or e.get("instr_id") or e.get("stock_id") or "—"
        qty = e.get("qty") or e.get("quantity") or "—"
        amt = e.get("amount") or "—"
        notes = ""
        table.add_row(kind, str(frm or "—"), str(to or "—"), str(sku), str(qty), str(amt), notes)
    return [table]

```

---

### 📄 src/bilancio/analysis/visualization_phases.py

```python
"""Phase-aware event visualization for bilancio."""

from typing import List, Dict, Any, Union
from rich.text import Text

RenderableType = Any  # Type alias for renderables

def build_events_detailed_with_phases(events: List[Dict[str, Any]], RICH_AVAILABLE: bool = True) -> List[RenderableType]:
    """Build renderables for events in detailed format, properly organized by phase markers."""
    renderables = []
    
    # Use the formatter registry to format events nicely
    from bilancio.ui.render.formatters import registry
    
    # Group events by phase markers (PhaseA, PhaseB, PhaseC)
    # Events between PhaseA and PhaseB are in Phase A
    # Events between PhaseB and PhaseC are in Phase B  
    # Events after PhaseC are in Phase C
    phase_a_events = []
    phase_b_events = []
    phase_c_events = []
    setup_events = []
    
    current_phase = None
    for event in events:
        kind = event.get("kind", "Unknown")
        
        # Check for phase markers to update current phase
        if kind == "PhaseA":
            current_phase = "A"
            continue  # Skip the marker itself
        elif kind == "PhaseB":
            current_phase = "B"
            continue  # Skip the marker itself
        elif kind == "PhaseC":
            current_phase = "C"
            continue  # Skip the marker itself
        
        # Sort events into phases based on current phase
        if event.get("phase") == "setup":
            setup_events.append(event)
        elif current_phase == "A":
            phase_a_events.append(event)
        elif current_phase == "B":
            phase_b_events.append(event)
        elif current_phase == "C":
            phase_c_events.append(event)
        else:
            # Events before any phase marker (during simulation but no phase set yet)
            # This shouldn't happen but default to phase A
            if event.get("phase") == "simulation":
                phase_a_events.append(event)
    
    # Display setup events if any
    if setup_events:
        if RICH_AVAILABLE:
            phase_header = Text("Setup", style="bold magenta")
            renderables.append(phase_header)
        else:
            renderables.append("Setup")
        
        for event in setup_events:
            renderables.extend(_format_single_event(event, registry, RICH_AVAILABLE))
    
    # Display Phase A events (usually empty as it's just a marker)
    if phase_a_events:
        if RICH_AVAILABLE:
            phase_header = Text("\nPhase A", style="bold cyan")
            renderables.append(phase_header)
        else:
            renderables.append("\nPhase A")
        
        for event in phase_a_events:
            renderables.extend(_format_single_event(event, registry, RICH_AVAILABLE))
    
    # Display Phase B events - Settle obligations due
    if phase_b_events:
        if RICH_AVAILABLE:
            phase_header = Text("\nPhase B - Settle obligations due", style="bold yellow")
            renderables.append(phase_header)
        else:
            renderables.append("\nPhase B - Settle obligations due")
            
        for event in phase_b_events:
            renderables.extend(_format_single_event(event, registry, RICH_AVAILABLE))
    
    # Display Phase C events - Clear intraday nets
    if phase_c_events:
        if RICH_AVAILABLE:
            phase_header = Text("\nPhase C - Clear intraday nets", style="bold green")
            renderables.append(phase_header)
        else:
            renderables.append("\nPhase C - Clear intraday nets")
            
        for event in phase_c_events:
            renderables.extend(_format_single_event(event, registry, RICH_AVAILABLE))
    
    return renderables


def _format_single_event(event: Dict[str, Any], registry, RICH_AVAILABLE: bool) -> List[RenderableType]:
    """Format a single event and return renderables."""
    renderables = []
    
    # Format the event using the registry
    title, lines, icon = registry.format(event)
    
    if RICH_AVAILABLE:
        from rich.text import Text
        # Create a nice formatted display with icon and details
        text = Text()
        
        # Add icon and title with color based on event type
        if "Transfer" in title or "Payment" in title:
            text.append(title, style="bold cyan")
        elif "Settled" in title or "Cleared" in title:
            text.append(title, style="bold green")
        elif "Created" in title or "Minted" in title:
            text.append(title, style="bold yellow")
        elif "Consolidation" in title or "Split" in title:
            text.append(title, style="dim italic")
        else:
            text.append(title, style="bold")
        
        # Add details with proper indentation and styling
        if lines:
            for i, line in enumerate(lines[:3]):  # Show up to 3 lines
                text.append("\n   ")
                if "→" in line or "←" in line:
                    # Flow lines - make them prominent
                    text.append(line, style="white")
                elif ":" in line:
                    # Split field and value for better formatting
                    parts = line.split(":", 1)
                    if len(parts) == 2:
                        field, value = parts
                        text.append(field + ":", style="dim")
                        text.append(value, style="white")
                    else:
                        text.append(line, style="dim white")
                elif line.startswith("("):
                    # Technical explanations in parentheses - make them dimmer
                    text.append(line, style="dim italic")
                else:
                    text.append(line, style="white")
        
        renderables.append(text)
    else:
        # Simple text format
        text = f"• {title}"
        if lines:
            text += " - " + ", ".join(lines[:2])
        renderables.append(text)
    
    return [renderables[0]] if renderables else []
```

---

### 📄 src/bilancio/cloud/__init__.py

```python
"""Cloud execution module for running simulations on Modal."""

from bilancio.cloud.config import CloudConfig

__all__ = ["CloudConfig"]

```

---

### 📄 src/bilancio/cloud/config.py

```python
"""Configuration for cloud execution."""

from dataclasses import dataclass, field
import os
from typing import Optional


@dataclass
class CloudConfig:
    """Configuration for cloud execution.

    Attributes:
        volume_name: Name of the Modal Volume for storing results.
            Note: This must match the volume name in modal_app.py (hardcoded as
            "bilancio-results"). Changing this without also updating modal_app.py
            will cause download failures.
        timeout_seconds: Maximum execution time per simulation.
        memory_mb: Memory allocation in MB.
        max_parallel: Maximum concurrent Modal function calls.
        gpu: Optional GPU type (e.g., "T4", "A10G", "A100").
    """

    # Note: This must match the volume name hardcoded in modal_app.py
    volume_name: str = field(
        default_factory=lambda: os.getenv("BILANCIO_MODAL_VOLUME", "bilancio-results")
    )
    timeout_seconds: int = field(
        default_factory=lambda: int(os.getenv("BILANCIO_CLOUD_TIMEOUT", "600"))
    )
    memory_mb: int = field(
        default_factory=lambda: int(os.getenv("BILANCIO_CLOUD_MEMORY", "2048"))
    )
    max_parallel: int = field(
        default_factory=lambda: int(os.getenv("BILANCIO_CLOUD_MAX_PARALLEL", "50"))
    )

    # GPU configuration (for future ML workloads)
    gpu: Optional[str] = None

```

---

### 📄 src/bilancio/cloud/modal_app.py

```python
"""Modal app definition for cloud simulation execution.

This module defines the Modal app, container image, volume, and remote
function for running bilancio simulations in the cloud.
"""

from __future__ import annotations

import modal

# Define the Modal app
app = modal.App("bilancio-simulations")

# Create a persistent volume for storing results
# Results persist across function invocations
results_volume = modal.Volume.from_name(
    "bilancio-results",
    create_if_missing=True,
)

# Define the container image with all bilancio dependencies
# We add the local source code to the image
image = (
    modal.Image.debian_slim(python_version="3.11")
    .pip_install(
        "numpy>=1.24.0",
        "pandas>=2.0.0",
        "scipy>=1.10.0",
        "pydantic>=2.0.0",
        "networkx>=3.0",
        "pyyaml>=6.0",
        "rich>=13.0.0",
        "jinja2>=3.0",
        "click>=8.0",
        "xkcdpass>=1.19.0",
    )
    .add_local_python_source("bilancio")
)

RESULTS_MOUNT_PATH = "/results"


@app.function(
    image=image,
    volumes={RESULTS_MOUNT_PATH: results_volume},
    timeout=1800,  # 30 minutes max per simulation
    memory=2048,  # 2GB RAM
)
def run_simulation(
    scenario_config: dict,
    run_id: str,
    experiment_id: str,
    options: dict,
    job_id: str = "",
) -> dict:
    """Run a single simulation in the cloud.

    Args:
        scenario_config: Full scenario YAML as dict
        run_id: Unique identifier for this run
        experiment_id: Groups related runs together
        options: RunOptions as dict (mode, max_days, quiet_days, etc.)
        job_id: Bilancio job ID (for logging/tracking)

    Returns:
        Dict with status, artifact paths (relative to volume), metrics, error
    """
    import time
    from pathlib import Path

    import yaml

    start_time = time.time()

    # Log job info prominently at the start (visible in Modal logs)
    import sys
    modal_call_id = modal.current_function_call_id()
    print("=" * 60, flush=True)
    print(f"BILANCIO SIMULATION", flush=True)
    print(f"  Job ID:      {job_id or 'N/A'}", flush=True)
    print(f"  Run ID:      {run_id}", flush=True)
    print(f"  Experiment:  {experiment_id}", flush=True)
    print(f"  Modal Call:  {modal_call_id}", flush=True)
    print("=" * 60, flush=True)
    sys.stdout.flush()

    # Create output directory on the volume
    run_dir = Path(RESULTS_MOUNT_PATH) / experiment_id / "runs" / run_id
    run_dir.mkdir(parents=True, exist_ok=True)
    out_dir = run_dir / "out"
    out_dir.mkdir(exist_ok=True)

    # Write scenario YAML
    scenario_path = run_dir / "scenario.yaml"
    scenario_path.write_text(yaml.dump(scenario_config, default_flow_style=False))

    try:
        # Import bilancio inside the function (container context)
        from bilancio.ui.run import run_scenario

        # Execute simulation
        run_scenario(
            path=scenario_path,
            mode=options.get("mode", "until_stable"),
            max_days=options.get("max_days", 90),
            quiet_days=options.get("quiet_days", 2),
            show=options.get("show_events", "detailed"),
            check_invariants=options.get("check_invariants", "daily"),
            default_handling=options.get("default_handling", "fail-fast"),
            export={
                "balances_csv": str(out_dir / "balances.csv"),
                "events_jsonl": str(out_dir / "events.jsonl"),
            },
            html_output=run_dir / "run.html",
            t_account=options.get("t_account", False),
            detailed_dealer_logging=options.get("detailed_dealer_logging", False),
            run_id=run_id,
            regime=options.get("regime", ""),
        )

        # Commit changes to volume
        results_volume.commit()

        execution_time_ms = int((time.time() - start_time) * 1000)

        # Build artifact paths (relative to run directory within volume)
        artifacts = {
            "scenario_yaml": "scenario.yaml",
            "events_jsonl": "out/events.jsonl",
            "balances_csv": "out/balances.csv",
            "run_html": "run.html",
        }

        return {
            "run_id": run_id,
            "status": "completed",
            "storage_type": "modal_volume",
            "storage_base": f"{experiment_id}/runs/{run_id}",
            "artifacts": artifacts,
            "execution_time_ms": execution_time_ms,
            "error": None,
            "modal_call_id": modal_call_id,
        }

    except Exception as e:
        execution_time_ms = int((time.time() - start_time) * 1000)

        # Still commit to preserve any partial output
        results_volume.commit()

        return {
            "run_id": run_id,
            "status": "failed",
            "storage_type": "modal_volume",
            "storage_base": f"{experiment_id}/runs/{run_id}",
            "artifacts": {},
            "execution_time_ms": execution_time_ms,
            "error": str(e),
            "modal_call_id": modal_call_id,
        }


@app.function(
    image=image,
    timeout=60,
    memory=256,
)
def health_check() -> dict:
    """Simple health check to verify Modal deployment.

    Returns:
        Dict with status and bilancio version info.
    """
    try:
        import bilancio

        return {
            "status": "ok",
            "bilancio_available": True,
            "version": getattr(bilancio, "__version__", "unknown"),
        }
    except ImportError as e:
        return {
            "status": "error",
            "bilancio_available": False,
            "error": str(e),
        }


# Local entrypoint for testing
@app.local_entrypoint()
def main():
    """Test the Modal deployment with a health check."""
    print("Running health check...")
    result = health_check.remote()
    print(f"Health check result: {result}")

    if result["status"] == "ok":
        print("Modal deployment is healthy!")
    else:
        print(f"Modal deployment has issues: {result.get('error', 'unknown')}")

```

---

### 📄 src/bilancio/config/__init__.py

```python
"""Configuration layer for Bilancio scenarios."""

from .loaders import load_yaml
from .models import ScenarioConfig
from .apply import apply_to_system

__all__ = ["load_yaml", "ScenarioConfig", "apply_to_system"]
```

---

### 📄 src/bilancio/config/apply.py

```python
"""Apply configuration to a Bilancio system."""

from typing import Dict, Any
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.domain.agents import Bank, Household, Firm, CentralBank, Treasury
from bilancio.ops.banking import deposit_cash, withdraw_cash, client_payment
from bilancio.domain.instruments.credit import Payable
from bilancio.core.errors import ValidationError
from bilancio.core.atomic_tx import atomic

from .models import ScenarioConfig, AgentSpec
from .loaders import parse_action


def create_agent(spec: AgentSpec) -> Any:
    """Create an agent from specification.
    
    Args:
        spec: Agent specification
        
    Returns:
        Created agent instance
        
    Raises:
        ValueError: If agent kind is unknown
    """
    agent_classes = {
        "central_bank": CentralBank,
        "bank": Bank,
        "household": Household,
        "firm": Firm,
        "treasury": Treasury
    }
    
    agent_class = agent_classes.get(spec.kind)
    if not agent_class:
        raise ValueError(f"Unknown agent kind: {spec.kind}")
    
    # Create agent with id, name, and kind
    # Note: The agent classes set their own kind in __post_init__, but we pass it anyway
    # for compatibility with the base Agent class
    return agent_class(id=spec.id, name=spec.name, kind=spec.kind)


def apply_policy_overrides(system: System, overrides: Dict[str, Any]) -> None:
    """Apply policy overrides to the system.
    
    Args:
        system: System instance
        overrides: Policy override configuration
    """
    if not overrides:
        return
    
    # Apply MOP rank overrides
    if "mop_rank" in overrides and overrides["mop_rank"]:
        for agent_kind, mop_list in overrides["mop_rank"].items():
            system.policy.mop_rank[agent_kind] = mop_list


def apply_action(system: System, action_dict: Dict[str, Any], agents: Dict[str, Any]) -> None:
    """Apply a single action to the system.
    
    Args:
        system: System instance
        action_dict: Action dictionary from config
        agents: Dictionary of agent_id -> agent instance
        
    Raises:
        ValueError: If action cannot be applied
        ValidationError: If action violates system invariants
    """
    # Parse the action
    action = parse_action(action_dict)
    action_type = action.action
    
    try:
        if action_type == "mint_reserves":
            instr_id = system.mint_reserves(
                to_bank_id=action.to,
                amount=action.amount,
                alias=getattr(action, 'alias', None)
            )
            # optional alias capture
            if getattr(action, 'alias', None):
                alias = action.alias
                if alias in system.state.aliases:
                    raise ValueError(f"Alias already exists: {alias}")
                system.state.aliases[alias] = instr_id
            
        elif action_type == "mint_cash":
            instr_id = system.mint_cash(
                to_agent_id=action.to,
                amount=action.amount,
                alias=getattr(action, 'alias', None)
            )
            if getattr(action, 'alias', None):
                alias = action.alias
                if alias in system.state.aliases:
                    raise ValueError(f"Alias already exists: {alias}")
                system.state.aliases[alias] = instr_id
            
        elif action_type == "transfer_reserves":
            system.transfer_reserves(
                from_bank_id=action.from_bank,
                to_bank_id=action.to_bank,
                amount=action.amount
            )
            
        elif action_type == "transfer_cash":
            system.transfer_cash(
                from_agent_id=action.from_agent,
                to_agent_id=action.to_agent,
                amount=action.amount
            )
            
        elif action_type == "deposit_cash":
            deposit_cash(
                system=system,
                customer_id=action.customer,
                bank_id=action.bank,
                amount=action.amount
            )
            
        elif action_type == "withdraw_cash":
            withdraw_cash(
                system=system,
                customer_id=action.customer,
                bank_id=action.bank,
                amount=action.amount
            )
            
        elif action_type == "client_payment":
            # Need to determine banks for payer and payee
            payer = agents.get(action.payer)
            payee = agents.get(action.payee)
            
            if not payer or not payee:
                raise ValueError(f"Unknown agent in client_payment: {action.payer} or {action.payee}")
            
            # Find bank relationships (simplified - assumes first deposit)
            payer_bank = None
            payee_bank = None
            
            # Check for existing deposits to determine banks
            for bank_id in [a.id for a in agents.values() if a.kind == "bank"]:
                if system.deposit_ids(action.payer, bank_id):
                    payer_bank = bank_id
                if system.deposit_ids(action.payee, bank_id):
                    payee_bank = bank_id
            
            if not payer_bank or not payee_bank:
                raise ValueError(f"Cannot determine banks for client_payment from {action.payer} to {action.payee}")
            
            client_payment(
                system=system,
                payer_id=action.payer,
                payer_bank=payer_bank,
                payee_id=action.payee,
                payee_bank=payee_bank,
                amount=action.amount
            )
            
        elif action_type == "create_stock":
            system.create_stock(
                owner_id=action.owner,
                sku=action.sku,
                quantity=action.quantity,
                unit_price=action.unit_price
            )
            
        elif action_type == "transfer_stock":
            # Find stock with matching SKU owned by from_agent
            stocks = [s for s in system.state.stocks.values() 
                     if s.owner_id == action.from_agent and s.sku == action.sku]
            
            if not stocks:
                raise ValueError(f"No stock with SKU {action.sku} owned by {action.from_agent}")
            
            # Transfer from first matching stock
            stock = stocks[0]
            if stock.quantity < action.quantity:
                raise ValueError(f"Insufficient stock: {stock.quantity} < {action.quantity}")
            
            system.transfer_stock(
                stock_id=stock.id,
                from_owner=action.from_agent,
                to_owner=action.to_agent,
                quantity=action.quantity if action.quantity < stock.quantity else None
            )
            
        elif action_type == "create_delivery_obligation":
            instr_id = system.create_delivery_obligation(
                from_agent=action.from_agent,
                to_agent=action.to_agent,
                sku=action.sku,
                quantity=action.quantity,
                unit_price=action.unit_price,
                due_day=action.due_day,
                alias=getattr(action, 'alias', None)
            )
            if getattr(action, 'alias', None):
                alias = action.alias
                if alias in system.state.aliases:
                    raise ValueError(f"Alias already exists: {alias}")
                system.state.aliases[alias] = instr_id
            
        elif action_type == "create_payable":
            # Create a Payable instrument
            # Payable uses asset_holder_id (creditor) and liability_issuer_id (debtor)
            # Note: amount should be in minor units (e.g., cents)
            # If the input is in major units (e.g., dollars), multiply by 100
            # For now, we assume the YAML amounts are already in minor units

            # Plan 024: maturity_distance for rollover - defaults to due_day if not set
            maturity_distance = getattr(action, 'maturity_distance', None)
            if maturity_distance is None:
                maturity_distance = action.due_day

            payable = Payable(
                id=system.new_contract_id("PAY"),
                kind="payable",  # Will be set by __post_init__ but required by dataclass
                amount=int(action.amount),  # Assumes amount is already in minor units
                denom="X",  # Default denomination - could be made configurable
                asset_holder_id=action.to_agent,  # creditor holds the asset
                liability_issuer_id=action.from_agent,  # debtor issues the liability
                due_day=action.due_day,
                maturity_distance=maturity_distance,  # Plan 024: for continuous rollover
            )
            system.add_contract(payable)
            # optional alias capture
            if getattr(action, 'alias', None):
                alias = action.alias
                if alias in system.state.aliases:
                    raise ValueError(f"Alias already exists: {alias}")
                system.state.aliases[alias] = payable.id

            # Log the event
            system.log("PayableCreated",
                debtor=action.from_agent,
                creditor=action.to_agent,
                amount=int(action.amount),
                due_day=action.due_day,
                maturity_distance=maturity_distance,
                payable_id=payable.id,
                alias=getattr(action, 'alias', None)
            )
        
        elif action_type == "transfer_claim":
            # Transfer claim (reassign asset holder) by alias or id (order-independent validation)
            data = action
            alias = getattr(data, 'contract_alias', None)
            explicit_id = getattr(data, 'contract_id', None)
            id_from_alias = None
            if alias is not None:
                id_from_alias = system.state.aliases.get(alias)
                if id_from_alias is None:
                    raise ValueError(f"Unknown alias: {alias}")
            if alias is not None and explicit_id is not None and id_from_alias != explicit_id:
                raise ValueError(f"Alias {alias} and contract_id {explicit_id} refer to different contracts")
            resolved_id = explicit_id or id_from_alias
            if not resolved_id:
                raise ValueError("transfer_claim requires contract_alias or contract_id to resolve a contract")

            instr = system.state.contracts.get(resolved_id)
            if instr is None:
                raise ValueError(f"Contract not found: {resolved_id}")

            old_holder_id = instr.asset_holder_id
            new_holder_id = data.to_agent

            # Perform reassignment atomically
            with atomic(system):
                old_holder = system.state.agents[old_holder_id]
                new_holder = system.state.agents[new_holder_id]
                if resolved_id not in old_holder.asset_ids:
                    raise ValueError(f"Contract {resolved_id} not in old holder's assets")
                old_holder.asset_ids.remove(resolved_id)
                new_holder.asset_ids.append(resolved_id)
                instr.asset_holder_id = new_holder_id
                system.log("ClaimTransferred",
                           contract_id=resolved_id,
                           frm=old_holder_id,
                           to=new_holder_id,
                           contract_kind=instr.kind,
                           amount=getattr(instr, 'amount', None),
                           due_day=getattr(instr, 'due_day', None),
                           sku=getattr(instr, 'sku', None),
                           alias=alias)
            
        else:
            raise ValueError(f"Unknown action type: {action_type}")
            
    except Exception as e:
        # Add context to the error
        raise ValueError(f"Failed to apply {action_type}: {e}")


def _collect_alias_from_action(action_model) -> str | None:
    return getattr(action_model, 'alias', None)


def validate_scheduled_aliases(config: ScenarioConfig) -> None:
    """Preflight check: ensure aliases referenced by scheduled actions exist by the time of use,
    and detect duplicates across initial and scheduled actions.
    Raises ValueError with a clear message on violation.
    """
    alias_set: set[str] = set()

    # 1) Process initial_actions (creation only)
    for act in config.initial_actions or []:
        try:
            m = parse_action(act)
        except Exception:
            # malformed action will be caught elsewhere
            continue
        alias = _collect_alias_from_action(m)
        if alias:
            if alias in alias_set:
                raise ValueError(f"Duplicate alias in initial_actions: {alias}")
            alias_set.add(alias)

    # 2) Group scheduled by day preserving order
    by_day: dict[int, list] = {}
    for sa in getattr(config, 'scheduled_actions', []) or []:
        by_day.setdefault(sa.day, []).append(sa.action)

    # 3) Validate day by day
    for day in sorted(by_day.keys()):
        for act in by_day[day]:
            try:
                m = parse_action(act)
            except Exception:
                continue
            action_type = m.action
            if action_type == 'transfer_claim':
                alias = getattr(m, 'contract_alias', None)
                if alias and alias not in alias_set:
                    raise ValueError(
                        f"Scheduled transfer_claim references unknown alias '{alias}' on day {day}. "
                        "Ensure it is created earlier (same day allowed only if ordered before use)."
                    )
            else:
                # Capture new aliases created by scheduled actions
                new_alias = _collect_alias_from_action(m)
                if new_alias:
                    if new_alias in alias_set:
                        raise ValueError(f"Duplicate alias detected: '{new_alias}' already defined before day {day}")
                    alias_set.add(new_alias)


def apply_to_system(config: ScenarioConfig, system: System) -> None:
    """Apply a scenario configuration to a system.

    This function:
    1. Creates and adds all agents
    2. Applies policy overrides
    3. Executes all initial actions within System.setup()
    4. Initializes dealer subsystem if configured
    5. Optionally validates invariants

    Args:
        config: Scenario configuration
        system: System instance to configure

    Raises:
        ValueError: If configuration cannot be applied
        ValidationError: If system invariants are violated
    """
    agents = {}

    # Use setup context for all initialization
    with system.setup():
        # Create and add agents
        for agent_spec in config.agents:
            agent = create_agent(agent_spec)
            system.add_agent(agent)
            agents[agent.id] = agent

        # Apply policy overrides
        if config.policy_overrides:
            apply_policy_overrides(system, config.policy_overrides.model_dump())

        # Execute initial actions
        for action_dict in config.initial_actions:
            apply_action(system, action_dict, agents)

            # Optional: check invariants after each action for debugging
            # system.assert_invariants()

    # Final invariant check outside of setup
    system.assert_invariants()

    # Initialize dealer subsystem if configured
    if config.dealer and config.dealer.enabled:
        from bilancio.engines.dealer_integration import initialize_dealer_subsystem
        from bilancio.dealer.simulation import DealerRingConfig
        from bilancio.dealer.models import BucketConfig

        # Convert DealerConfig (YAML model) to DealerRingConfig (internal model)
        bucket_configs = []
        for name, bc in config.dealer.buckets.items():
            bucket_configs.append(BucketConfig(
                name=name,
                tau_min=bc.tau_min,
                tau_max=bc.tau_max if bc.tau_max is not None else 999,
            ))
        # Sort by tau_min to ensure proper ordering
        bucket_configs.sort(key=lambda b: b.tau_min)

        # Build VBT anchors from bucket configs
        vbt_anchors = {}
        for name, bc in config.dealer.buckets.items():
            vbt_anchors[name] = (bc.M, bc.O)

        dealer_ring_config = DealerRingConfig(
            ticket_size=config.dealer.ticket_size,
            buckets=bucket_configs,
            vbt_anchors=vbt_anchors,
            dealer_share=config.dealer.dealer_share,
            vbt_share=config.dealer.vbt_share,
            seed=42,  # Default seed - can be made configurable later
        )

        system.state.dealer_subsystem = initialize_dealer_subsystem(system, dealer_ring_config)

```

---

### 📄 src/bilancio/config/loaders.py

```python
"""YAML loading utilities for Bilancio configuration."""

import yaml
from pathlib import Path
from typing import Any, Dict
from decimal import Decimal, InvalidOperation, DecimalException
from pydantic import ValidationError, TypeAdapter

from .models import (
    ScenarioConfig,
    MintReserves,
    MintCash,
    TransferReserves,
    TransferCash,
    DepositCash,
    WithdrawCash,
    ClientPayment,
    CreateStock,
    TransferStock,
    CreateDeliveryObligation,
    CreatePayable,
    Action,
    GeneratorConfig,
)


def decimal_constructor(loader, node):
    """Construct Decimal from YAML scalar."""
    value = loader.construct_scalar(node)
    return Decimal(value)


# Register Decimal constructor for YAML
yaml.SafeLoader.add_constructor('!decimal', decimal_constructor)


def parse_action(action_dict: Dict[str, Any]) -> Action:
    """Parse a single action dictionary into the appropriate Action model.
    
    Args:
        action_dict: Dictionary containing action specification
        
    Returns:
        Parsed Action model instance
        
    Raises:
        ValueError: If action type is unknown or validation fails
    """
    # Determine action type from the dictionary keys
    if "mint_reserves" in action_dict:
        data = action_dict["mint_reserves"]
        return MintReserves(**data)
    elif "mint_cash" in action_dict:
        data = action_dict["mint_cash"]
        return MintCash(**data)
    elif "transfer_reserves" in action_dict:
        data = action_dict["transfer_reserves"]
        return TransferReserves(**data)
    elif "transfer_cash" in action_dict:
        data = action_dict["transfer_cash"]
        return TransferCash(**data)
    elif "deposit_cash" in action_dict:
        data = action_dict["deposit_cash"]
        return DepositCash(**data)
    elif "withdraw_cash" in action_dict:
        data = action_dict["withdraw_cash"]
        return WithdrawCash(**data)
    elif "client_payment" in action_dict:
        data = action_dict["client_payment"]
        return ClientPayment(**data)
    elif "create_stock" in action_dict:
        data = action_dict["create_stock"]
        return CreateStock(**data)
    elif "transfer_stock" in action_dict:
        data = action_dict["transfer_stock"]
        return TransferStock(**data)
    elif "create_delivery_obligation" in action_dict:
        data = action_dict["create_delivery_obligation"]
        # The model handles aliases automatically via pydantic
        return CreateDeliveryObligation(**data)
    elif "create_payable" in action_dict:
        data = action_dict["create_payable"]
        # The model handles aliases automatically via pydantic
        return CreatePayable(**data)
    elif "transfer_claim" in action_dict:
        data = action_dict["transfer_claim"]
        from .models import TransferClaim
        return TransferClaim(**data)
    else:
        raise ValueError(f"Unknown action type in: {action_dict}")


def preprocess_config(data: Dict[str, Any]) -> Dict[str, Any]:
    """Preprocess configuration data before validation.
    
    Converts string decimals to Decimal objects and handles
    other necessary transformations.
    
    Args:
        data: Raw configuration dictionary
        
    Returns:
        Preprocessed configuration dictionary
    """
    def convert_decimals(obj):
        """Recursively convert string decimals to Decimal objects."""
        if isinstance(obj, dict):
            return {k: convert_decimals(v) for k, v in obj.items()}
        elif isinstance(obj, list):
            return [convert_decimals(item) for item in obj]
        elif isinstance(obj, str):
            # Safely try to convert strings to Decimal
            # Only convert if the string is a valid number
            try:
                # Try to create a Decimal - this will validate the format
                decimal_value = Decimal(obj)
                # Additional check: ensure it's actually a number-like string
                # and not something like 'infinity' or 'nan'
                if decimal_value.is_finite():
                    return decimal_value
                else:
                    return obj
            except (ValueError, InvalidOperation, DecimalException):
                # Not a valid decimal, return as-is
                return obj
        else:
            return obj
    
    return convert_decimals(data)


def load_yaml(path: Path | str) -> ScenarioConfig:
    """Load and validate a scenario configuration from a YAML file.
    
    Args:
        path: Path to the YAML configuration file
        
    Returns:
        Validated ScenarioConfig instance
        
    Raises:
        FileNotFoundError: If the configuration file doesn't exist
        yaml.YAMLError: If the YAML is malformed
        ValidationError: If the configuration doesn't match the schema
        ValueError: If there are semantic errors in the configuration
    """
    path = Path(path)
    
    if not path.exists():
        raise FileNotFoundError(f"Configuration file not found: {path}")
    
    try:
        with open(path, 'r') as f:
            data = yaml.safe_load(f)
    except yaml.YAMLError as e:
        raise yaml.YAMLError(f"Failed to parse YAML from {path}: {e}")
    
    if not isinstance(data, dict):
        raise ValueError(f"Configuration file must contain a YAML dictionary, got {type(data)}")
    
    # Preprocess the configuration
    data = preprocess_config(data)
    
    # Handle generator specs by compiling into a concrete scenario first
    if "generator" in data:
        adapter = TypeAdapter(GeneratorConfig)
        try:
            generator_spec = adapter.validate_python(data)
        except ValidationError as e:
            errors = []
            for error in e.errors():
                loc = " -> ".join(str(l) for l in error['loc'])
                msg = error['msg']
                errors.append(f"  - {loc}: {msg}")
            error_msg = f"Generator validation failed:\n" + "\n".join(errors)
            raise ValueError(error_msg) from e

        from bilancio.scenarios import compile_generator

        try:
            compiled = compile_generator(generator_spec, source_path=path)
        except Exception as e:
            raise ValueError(f"Failed to compile generator '{generator_spec.generator}': {e}") from e

        data = preprocess_config(compiled)

    # Parse initial_actions if present
    if "initial_actions" in data:
        try:
            parsed_actions = []
            for action_dict in data["initial_actions"]:
                # Keep the original dict for now - we'll parse in apply.py
                parsed_actions.append(action_dict)
            data["initial_actions"] = parsed_actions
        except (ValueError, ValidationError) as e:
            raise ValueError(f"Failed to parse initial_actions: {e}")
    
    # Validate using pydantic
    try:
        config = ScenarioConfig(**data)
    except ValidationError as e:
        # Format validation errors nicely
        errors = []
        for error in e.errors():
            loc = " -> ".join(str(l) for l in error['loc'])
            msg = error['msg']
            errors.append(f"  - {loc}: {msg}")
        
        error_msg = f"Configuration validation failed:\n" + "\n".join(errors)
        raise ValueError(error_msg)
    
    return config

```

---

### 📄 src/bilancio/config/models.py

```python
"""Pydantic models for Bilancio scenario configuration."""

from typing import Literal, Optional, Union, List, Dict, Any, Annotated
from decimal import Decimal
from pydantic import BaseModel, Field, field_validator, model_validator


class PolicyOverrides(BaseModel):
    """Policy configuration overrides."""
    mop_rank: Optional[Dict[str, List[str]]] = Field(
        None,
        description="Override default settlement order per agent kind"
    )


class AgentSpec(BaseModel):
    """Specification for an agent in the scenario."""
    id: str = Field(..., description="Unique identifier for the agent")
    kind: Literal["central_bank", "bank", "household", "firm", "treasury"] = Field(
        ..., description="Type of agent"
    )
    name: str = Field(..., description="Human-readable name for the agent")


class MintReserves(BaseModel):
    """Action to mint reserves to a bank."""
    action: Literal["mint_reserves"] = "mint_reserves"
    to: str = Field(..., description="Target bank ID")
    amount: Decimal = Field(..., description="Amount to mint")
    alias: Optional[str] = Field(
        None,
        description="Optional alias to reference the created reserve_deposit contract later"
    )
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class MintCash(BaseModel):
    """Action to mint cash to an agent."""
    action: Literal["mint_cash"] = "mint_cash"
    to: str = Field(..., description="Target agent ID")
    amount: Decimal = Field(..., description="Amount to mint")
    alias: Optional[str] = Field(
        None,
        description="Optional alias to reference the created cash contract later"
    )
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class TransferReserves(BaseModel):
    """Action to transfer reserves between banks."""
    action: Literal["transfer_reserves"] = "transfer_reserves"
    from_bank: str = Field(..., description="Source bank ID")
    to_bank: str = Field(..., description="Target bank ID")
    amount: Decimal = Field(..., description="Amount to transfer")
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class TransferCash(BaseModel):
    """Action to transfer cash between agents."""
    action: Literal["transfer_cash"] = "transfer_cash"
    from_agent: str = Field(..., description="Source agent ID")
    to_agent: str = Field(..., description="Target agent ID")
    amount: Decimal = Field(..., description="Amount to transfer")
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class DepositCash(BaseModel):
    """Action to deposit cash at a bank."""
    action: Literal["deposit_cash"] = "deposit_cash"
    customer: str = Field(..., description="Customer agent ID")
    bank: str = Field(..., description="Bank ID")
    amount: Decimal = Field(..., description="Amount to deposit")
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class WithdrawCash(BaseModel):
    """Action to withdraw cash from a bank."""
    action: Literal["withdraw_cash"] = "withdraw_cash"
    customer: str = Field(..., description="Customer agent ID")
    bank: str = Field(..., description="Bank ID")
    amount: Decimal = Field(..., description="Amount to withdraw")
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class ClientPayment(BaseModel):
    """Action for client payment between bank accounts."""
    action: Literal["client_payment"] = "client_payment"
    payer: str = Field(..., description="Payer agent ID")
    payee: str = Field(..., description="Payee agent ID")
    amount: Decimal = Field(..., description="Payment amount")
    
    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v


class CreateStock(BaseModel):
    """Action to create stock inventory."""
    action: Literal["create_stock"] = "create_stock"
    owner: str = Field(..., description="Owner agent ID")
    sku: str = Field(..., description="Stock keeping unit identifier")
    quantity: int = Field(..., description="Quantity of items")
    unit_price: Decimal = Field(..., description="Price per unit")
    
    @field_validator("quantity")
    @classmethod
    def quantity_positive(cls, v):
        if v <= 0:
            raise ValueError("Quantity must be positive")
        return v
    
    @field_validator("unit_price")
    @classmethod
    def price_non_negative(cls, v):
        if v < 0:
            raise ValueError("Unit price cannot be negative")
        return v


class TransferStock(BaseModel):
    """Action to transfer stock between agents."""
    action: Literal["transfer_stock"] = "transfer_stock"
    from_agent: str = Field(..., description="Source agent ID")
    to_agent: str = Field(..., description="Target agent ID")
    sku: str = Field(..., description="Stock keeping unit identifier")
    quantity: int = Field(..., description="Quantity to transfer")
    
    @field_validator("quantity")
    @classmethod
    def quantity_positive(cls, v):
        if v <= 0:
            raise ValueError("Quantity must be positive")
        return v


class CreateDeliveryObligation(BaseModel):
    """Action to create a delivery obligation."""
    action: Literal["create_delivery_obligation"] = "create_delivery_obligation"
    from_agent: str = Field(..., description="Delivering agent ID", alias="from")
    to_agent: str = Field(..., description="Receiving agent ID", alias="to")
    sku: str = Field(..., description="Stock keeping unit identifier")
    quantity: int = Field(..., description="Quantity to deliver")
    unit_price: Decimal = Field(..., description="Price per unit")
    due_day: int = Field(..., description="Day when delivery is due")
    alias: Optional[str] = Field(
        None,
        description="Optional alias to reference the created delivery obligation later"
    )
    
    @field_validator("quantity")
    @classmethod
    def quantity_positive(cls, v):
        if v <= 0:
            raise ValueError("Quantity must be positive")
        return v
    
    @field_validator("unit_price")
    @classmethod
    def price_non_negative(cls, v):
        if v < 0:
            raise ValueError("Unit price cannot be negative")
        return v
    
    @field_validator("due_day")
    @classmethod
    def due_day_non_negative(cls, v):
        if v < 0:
            raise ValueError("Due day cannot be negative")
        return v


class CreatePayable(BaseModel):
    """Action to create a payable obligation."""
    action: Literal["create_payable"] = "create_payable"
    from_agent: str = Field(..., description="Debtor agent ID", alias="from")
    to_agent: str = Field(..., description="Creditor agent ID", alias="to")
    amount: Decimal = Field(..., description="Amount to pay")
    due_day: int = Field(..., description="Day when payment is due")
    alias: Optional[str] = Field(
        None,
        description="Optional alias to reference the created payable later"
    )
    maturity_distance: Optional[int] = Field(
        None,
        description="Original maturity distance (ΔT) for rollover. If not set, defaults to due_day."
    )

    @field_validator("amount")
    @classmethod
    def amount_positive(cls, v):
        if v <= 0:
            raise ValueError("Amount must be positive")
        return v

    @field_validator("due_day")
    @classmethod
    def due_day_non_negative(cls, v):
        if v < 0:
            raise ValueError("Due day cannot be negative")
        return v


# Union type for all actions
class TransferClaim(BaseModel):
    """Action to transfer (assign) a claim to a new creditor.

    References a specific contract by alias or by ID. Both may be provided, but
    if both are present they must refer to the same contract.
    """
    action: Literal["transfer_claim"] = "transfer_claim"
    contract_alias: Optional[str] = Field(None, description="Alias of the contract to transfer")
    contract_id: Optional[str] = Field(None, description="Explicit contract ID to transfer")
    to_agent: str = Field(..., description="New creditor (asset holder) agent ID")

    @field_validator("to_agent")
    @classmethod
    def non_empty_agent(cls, v):
        if not v:
            raise ValueError("to_agent is required")
        return v

    @model_validator(mode="after")
    def validate_reference(self):
        if not self.contract_alias and not self.contract_id:
            raise ValueError("Either contract_alias or contract_id must be provided")
        return self


class ScheduledAction(BaseModel):
    """A user-scheduled action to run at a specific day (Phase B1)."""
    day: int = Field(..., description="Day index (>= 1) to execute this action")
    action: Dict[str, Any] = Field(..., description="Single action dictionary to execute on that day")

    @field_validator("day")
    @classmethod
    def day_positive(cls, v):
        if v < 1:
            raise ValueError("Scheduled action day must be >= 1")
        return v


Action = Union[
    MintReserves,
    MintCash,
    TransferReserves,
    TransferCash,
    DepositCash,
    WithdrawCash,
    ClientPayment,
    CreateStock,
    TransferStock,
    CreateDeliveryObligation,
    CreatePayable,
    TransferClaim,
]


class ShowConfig(BaseModel):
    """Display configuration for the run."""
    balances: Optional[List[str]] = Field(
        None,
        description="Agent IDs to show balances for"
    )
    events: Literal["summary", "detailed", "table"] = Field(
        "detailed",
        description="Event display mode"
    )


class ExportConfig(BaseModel):
    """Export configuration for simulation results."""
    balances_csv: Optional[str] = Field(
        None,
        description="Path to export balances CSV"
    )
    events_jsonl: Optional[str] = Field(
        None,
        description="Path to export events JSONL"
    )


class RunConfig(BaseModel):
    """Run configuration for the simulation."""
    mode: Literal["step", "until_stable"] = Field(
        "until_stable",
        description="Simulation run mode"
    )
    max_days: int = Field(90, description="Maximum days to simulate")
    quiet_days: int = Field(2, description="Required quiet days for stable state")
    default_handling: Literal["fail-fast", "expel-agent"] = Field(
        "fail-fast",
        description="How the engine reacts when an agent defaults"
    )
    rollover_enabled: bool = Field(
        False,
        description="Enable continuous rollover of settled payables (Plan 024)"
    )
    show: ShowConfig = Field(default_factory=ShowConfig)
    export: ExportConfig = Field(default_factory=ExportConfig)

    @field_validator("max_days")
    @classmethod
    def max_days_positive(cls, v):
        if v <= 0:
            raise ValueError("Max days must be positive")
        return v
    
    @field_validator("quiet_days")
    @classmethod
    def quiet_days_non_negative(cls, v):
        if v < 0:
            raise ValueError("Quiet days cannot be negative")
        return v


class DealerBucketConfig(BaseModel):
    """Configuration for a dealer ring bucket."""
    tau_min: int = Field(..., description="Minimum remaining maturity (inclusive)")
    tau_max: int = Field(..., description="Maximum remaining maturity (inclusive), use 999 for unbounded")
    M: Decimal = Field(Decimal("1.0"), description="Mid anchor price")
    O: Decimal = Field(Decimal("0.30"), description="Spread")

    @field_validator("tau_min", "tau_max")
    @classmethod
    def maturity_positive(cls, v):
        if v < 1:
            raise ValueError("Maturity bounds must be positive")
        return v

    @field_validator("M")
    @classmethod
    def mid_price_positive(cls, v):
        if v <= 0:
            raise ValueError("Mid price M must be positive")
        return v

    @field_validator("O")
    @classmethod
    def spread_positive(cls, v):
        if v <= 0:
            raise ValueError("Spread O must be positive")
        return v

    @model_validator(mode="after")
    def validate_maturity_range(self):
        if self.tau_min > self.tau_max:
            raise ValueError("tau_min must be <= tau_max")
        return self


class DealerOrderFlowConfig(BaseModel):
    """Configuration for dealer order flow arrival process."""
    pi_sell: Decimal = Field(Decimal("0.5"), description="Probability of SELL vs BUY (0-1)")
    N_max: int = Field(3, description="Max trades per arrival")

    @field_validator("pi_sell")
    @classmethod
    def pi_sell_valid(cls, v):
        if not (0 <= v <= 1):
            raise ValueError("pi_sell must be between 0 and 1")
        return v

    @field_validator("N_max")
    @classmethod
    def n_max_positive(cls, v):
        if v < 1:
            raise ValueError("N_max must be positive")
        return v


class DealerTraderPolicyConfig(BaseModel):
    """Configuration for dealer trader policy parameters."""
    horizon_H: int = Field(3, description="Trading horizon (days ahead to consider shortfall)")
    buffer_B: Decimal = Field(Decimal("1.0"), description="Liquidity buffer multiplier")

    @field_validator("horizon_H")
    @classmethod
    def horizon_positive(cls, v):
        if v < 1:
            raise ValueError("horizon_H must be positive")
        return v

    @field_validator("buffer_B")
    @classmethod
    def buffer_positive(cls, v):
        if v < 0:
            raise ValueError("buffer_B cannot be negative")
        return v


class DealerConfig(BaseModel):
    """Configuration for dealer subsystem."""
    enabled: bool = Field(False, description="Whether dealer subsystem is active")
    ticket_size: Decimal = Field(Decimal("1"), description="Face value of tickets")
    buckets: Optional[Dict[str, DealerBucketConfig]] = Field(
        None,
        description="Bucket configurations by name (short, mid, long)"
    )
    dealer_share: Decimal = Field(Decimal("0.25"), description="Fraction of system value for dealer capital")
    vbt_share: Decimal = Field(Decimal("0.50"), description="Fraction for VBT capital")
    order_flow: DealerOrderFlowConfig = Field(
        default_factory=DealerOrderFlowConfig,
        description="Order flow arrival configuration"
    )
    trader_policy: DealerTraderPolicyConfig = Field(
        default_factory=DealerTraderPolicyConfig,
        description="Trader policy configuration"
    )

    @field_validator("ticket_size")
    @classmethod
    def ticket_size_positive(cls, v):
        if v <= 0:
            raise ValueError("ticket_size must be positive")
        return v

    @field_validator("dealer_share", "vbt_share")
    @classmethod
    def share_valid(cls, v):
        if not (0 <= v <= 1):
            raise ValueError("Share values must be between 0 and 1")
        return v

    @model_validator(mode="after")
    def set_default_buckets(self):
        if self.buckets is None:
            self.buckets = {
                "short": DealerBucketConfig(
                    tau_min=1,
                    tau_max=3,
                    M=Decimal("1.0"),
                    O=Decimal("0.20")
                ),
                "mid": DealerBucketConfig(
                    tau_min=4,
                    tau_max=8,
                    M=Decimal("1.0"),
                    O=Decimal("0.30")
                ),
                "long": DealerBucketConfig(
                    tau_min=9,
                    tau_max=999,
                    M=Decimal("1.0"),
                    O=Decimal("0.40")
                ),
            }
        return self


class BalancedDealerConfig(BaseModel):
    """Configuration for balanced dealer/mimic scenarios (C & D).

    This enables fair comparison between passive holders and active dealers
    by ensuring identical starting balance sheets.

    Key concepts:
    - face_value (S): Cashflow at maturity, default 20
    - outside_mid_ratio (ρ): M/S ratio where M is the outside mid price
    - vbt_share_per_bucket: VBT holds 25% of claims per maturity bucket
    - dealer_share_per_bucket: Dealer holds 12.5% of claims per maturity bucket
    - mode: "passive" for mimics (C), "active" for dealers (D)

    Per PDF specification (Plan 024):
    - VBT-like passive holder: ~25% of total claims per maturity + equal cash
    - Dealer-like passive holder: ~12.5% of total claims per maturity + equal cash
    """

    enabled: bool = Field(default=False, description="Whether balanced mode is active")
    face_value: Decimal = Field(
        default=Decimal("20"),
        description="Face value S - cashflow at maturity"
    )
    outside_mid_ratio: Decimal = Field(
        default=Decimal("0.75"),
        description="M/S ratio - outside mid as fraction of face value (0.5 to 1.0)"
    )
    big_entity_share: Decimal = Field(
        default=Decimal("0.25"),
        description="Fraction of trader debt allocated to big entities (β) - DEPRECATED, use vbt/dealer shares"
    )
    vbt_share_per_bucket: Decimal = Field(
        default=Decimal("0.25"),
        description="VBT holds 25% of claims per maturity bucket"
    )
    dealer_share_per_bucket: Decimal = Field(
        default=Decimal("0.125"),
        description="Dealer holds 12.5% of claims per maturity bucket"
    )
    rollover_enabled: bool = Field(
        default=True,
        description="Enable continuous rollover of matured claims"
    )
    mode: Literal["passive", "active"] = Field(
        default="active",
        description="passive = C (mimics don't trade), active = D (dealers can trade)"
    )

    @field_validator("face_value")
    @classmethod
    def face_value_positive(cls, v):
        if v <= 0:
            raise ValueError("face_value must be positive")
        return v

    @field_validator("outside_mid_ratio")
    @classmethod
    def outside_mid_ratio_valid(cls, v):
        if not (Decimal("0") < v <= Decimal("1")):
            raise ValueError("outside_mid_ratio must be between 0 (exclusive) and 1 (inclusive)")
        return v

    @field_validator("big_entity_share")
    @classmethod
    def big_entity_share_valid(cls, v):
        if not (Decimal("0") < v < Decimal("1")):
            raise ValueError("big_entity_share must be between 0 and 1 (exclusive)")
        return v

    @field_validator("vbt_share_per_bucket")
    @classmethod
    def vbt_share_valid(cls, v):
        if not (Decimal("0") < v < Decimal("1")):
            raise ValueError("vbt_share_per_bucket must be between 0 and 1 (exclusive)")
        return v

    @field_validator("dealer_share_per_bucket")
    @classmethod
    def dealer_share_valid(cls, v):
        if not (Decimal("0") < v < Decimal("1")):
            raise ValueError("dealer_share_per_bucket must be between 0 and 1 (exclusive)")
        return v


class ScenarioConfig(BaseModel):
    """Complete scenario configuration."""
    version: int = Field(1, description="Configuration version")
    name: str = Field(..., description="Scenario name")
    description: Optional[str] = Field(None, description="Scenario description")
    policy_overrides: Optional[PolicyOverrides] = Field(
        None,
        description="Policy engine overrides"
    )
    dealer: Optional[DealerConfig] = Field(
        None,
        description="Dealer subsystem configuration"
    )
    balanced_dealer: Optional[BalancedDealerConfig] = Field(
        None,
        description="Balanced dealer/mimic configuration for C vs D comparison"
    )
    agents: List[AgentSpec] = Field(..., description="Agents in the scenario")
    initial_actions: List[Dict[str, Any]] = Field(
        default_factory=list,
        description="Actions to execute during setup"
    )
    scheduled_actions: List[ScheduledAction] = Field(
        default_factory=list,
        description="Actions to execute during simulation (Phase B1) by day"
    )
    run: RunConfig = Field(default_factory=RunConfig)
    
    @field_validator("version")
    @classmethod
    def version_supported(cls, v):
        if v != 1:
            raise ValueError(f"Unsupported configuration version: {v}")
        return v
    
    @field_validator("agents")
    @classmethod
    def agents_unique_ids(cls, v):
        ids = [agent.id for agent in v]
        if len(ids) != len(set(ids)):
            raise ValueError("Agent IDs must be unique")
        return v


class RingExplorerLiquidityAllocation(BaseModel):
    """Liquidity seeding strategy for ring explorer generator."""

    mode: Literal["single_at", "uniform", "vector"] = Field(
        "uniform",
        description="Distribution mode for initial liquidity"
    )
    agent: Optional[str] = Field(
        None,
        description="Target agent for single_at mode"
    )
    vector: Optional[List[Decimal]] = Field(
        None,
        description="Explicit per-agent liquidity shares (length = n_agents)"
    )

    @model_validator(mode="after")
    def validate_allocation(self):
        if self.mode == "single_at" and not self.agent:
            raise ValueError("liquidity.allocation.agent is required for single_at mode")
        if self.mode == "vector":
            if not self.vector:
                raise ValueError("liquidity.allocation.vector is required for vector mode")
            if any(v <= 0 for v in self.vector):
                raise ValueError("liquidity.allocation.vector must contain positive values")
        return self


class RingExplorerLiquidityConfig(BaseModel):
    """Liquidity configuration for ring explorer generator."""

    total: Optional[Decimal] = Field(
        None,
        description="Total initial liquidity to seed",
    )
    allocation: RingExplorerLiquidityAllocation = Field(
        default_factory=RingExplorerLiquidityAllocation,
        description="Allocation strategy for initial liquidity",
    )

    @field_validator("total")
    @classmethod
    def total_positive(cls, v):
        if v is not None and v <= 0:
            raise ValueError("liquidity.total must be positive when provided")
        return v


class RingExplorerInequalityConfig(BaseModel):
    """Dirichlet-based inequality controls."""

    scheme: Literal["dirichlet"] = Field(
        "dirichlet",
        description="Payable size distribution scheme"
    )
    concentration: Decimal = Field(
        Decimal("1"),
        description="Dirichlet concentration parameter (c > 0)"
    )
    monotonicity: Decimal = Field(
        Decimal("0"),
        ge=Decimal("-1"),
        le=Decimal("1"),
        description="Ordering control (-1 asc, 0 random, 1 desc)"
    )

    @field_validator("concentration")
    @classmethod
    def concentration_positive(cls, v):
        if v <= 0:
            raise ValueError("inequality.concentration must be positive")
        return v


class RingExplorerMaturityConfig(BaseModel):
    """Maturity misalignment controls."""

    days: int = Field(
        1,
        ge=1,
        description="Horizon of due days (max due_day)"
    )
    mode: Literal["lead_lag"] = Field(
        "lead_lag",
        description="Maturity offset mode"
    )
    mu: Decimal = Field(
        Decimal("0"),
        ge=Decimal("0"),
        le=Decimal("1"),
        description="Normalized lead-lag misalignment (0 <= mu <= 1)"
    )


class RingExplorerParamsModel(BaseModel):
    """Parameter block for ring explorer generator."""

    n_agents: int = Field(5, ge=3, description="Number of agents in the ring")
    seed: int = Field(42, description="PRNG seed for reproducibility")
    kappa: Decimal = Field(..., gt=0, description="Debt-to-liquidity ratio target")
    liquidity: RingExplorerLiquidityConfig = Field(
        default_factory=RingExplorerLiquidityConfig,
        description="Liquidity seeding controls"
    )
    inequality: RingExplorerInequalityConfig = Field(
        default_factory=RingExplorerInequalityConfig,
        description="Payable distribution controls"
    )
    maturity: RingExplorerMaturityConfig = Field(
        default_factory=RingExplorerMaturityConfig,
        description="Maturity misalignment controls"
    )
    currency: str = Field("USD", description="Currency label for descriptions")
    Q_total: Optional[Decimal] = Field(
        None,
        description="Total dues on day 1 (S1). Overrides derivation from liquidity when provided"
    )
    policy_overrides: Optional[PolicyOverrides] = Field(
        None,
        description="Policy overrides to apply to generated scenario"
    )


class GeneratorCompileConfig(BaseModel):
    """Common compile-time options for generators."""

    out_dir: Optional[str] = Field(
        None,
        description="Directory to emit compiled scenarios"
    )
    emit_yaml: bool = Field(
        True,
        description="Whether to write the compiled scenario to disk"
    )


class RingExplorerGeneratorConfig(BaseModel):
    """Generator definition for ring explorer sweeps."""

    version: int = Field(1, description="Configuration version")
    generator: Literal["ring_explorer_v1"] = Field(
        "ring_explorer_v1",
        description="Generator identifier"
    )
    name_prefix: str = Field(..., description="Human-readable prefix for scenario names")
    params: RingExplorerParamsModel = Field(..., description="Generator parameters")
    compile: GeneratorCompileConfig = Field(
        default_factory=GeneratorCompileConfig,
        description="Compiler output controls"
    )

    @field_validator("version")
    @classmethod
    def version_supported(cls, v):
        if v != 1:
            raise ValueError(f"Unsupported generator version: {v}")
        return v


GeneratorConfig = Annotated[
    Union[
        RingExplorerGeneratorConfig,
    ],
    Field(discriminator="generator")
]

```

---

### 📄 src/bilancio/core/__init__.py

```python

```

---

### 📄 src/bilancio/core/atomic.py

```python
"""Atomic value types for bilancio."""

from dataclasses import dataclass
from decimal import Decimal
from typing import Protocol


class AtomicValue(Protocol):
    """Protocol for atomic values that have a value property."""

    @property
    def value(self) -> object:
        """Return the atomic value."""
        ...


@dataclass
class Money:
    """Represents a monetary amount with currency."""
    amount: Decimal
    currency: str

    @property
    def value(self) -> Decimal:
        """Return the monetary amount as the atomic value."""
        return self.amount


@dataclass
class Quantity:
    """Represents a quantity with a unit."""
    value: float
    unit: str


@dataclass
class Rate:
    """Represents a rate with a basis."""
    value: Decimal
    basis: str

```

---

### 📄 src/bilancio/core/atomic_tx.py

```python
import copy
from contextlib import contextmanager


@contextmanager
def atomic(system):
    """Context manager for atomic operations - rollback on failure"""
    snapshot = copy.deepcopy(system.state)
    try:
        yield
    except Exception:
        system.state = snapshot
        raise

```

---

### 📄 src/bilancio/core/errors.py

```python
"""Exception classes for bilancio."""


class BilancioError(Exception):
    """Base exception class for bilancio-related errors."""
    pass


class ValidationError(BilancioError):
    """Raised when data validation fails."""
    pass


class CalculationError(BilancioError):
    """Raised when calculation operations fail."""
    pass


class ConfigurationError(BilancioError):
    """Raised when configuration is invalid or missing."""
    pass


class DefaultError(BilancioError):
    """Raised when a debtor cannot settle their obligations."""
    pass

```

---

### 📄 src/bilancio/core/ids.py

```python
import uuid


def new_id(prefix: str = "x") -> str:
    # short, sortable-ish id; fine for MVP
    return f"{prefix}_{uuid.uuid4().hex[:12]}"

AgentId = str
InstrId = str
OpId = str

```

---

### 📄 src/bilancio/core/invariants.py

```python
def assert_cb_cash_matches_outstanding(system):
    total = sum(c.amount for c in system.state.contracts.values() if c.kind == "cash")
    assert total == system.state.cb_cash_outstanding, "CB cash mismatch"

def assert_no_negative_balances(system):
    for c in system.state.contracts.values():
        if c.kind in ("bank_deposit", "cash", "reserve_deposit") and c.amount < 0:
            raise AssertionError("negative balance detected")

def assert_cb_reserves_match(system):
    total = sum(c.amount for c in system.state.contracts.values() if c.kind == "reserve_deposit")
    assert total == system.state.cb_reserves_outstanding, "CB reserves mismatch"

def assert_double_entry_numeric(system):
    for c in system.state.contracts.values():
        if hasattr(c, 'amount') and c.amount < 0:
            raise AssertionError("negative amount detected")

def assert_no_duplicate_refs(system):
    """No duplicate contract IDs in any agent's asset/liability lists."""
    for aid, a in system.state.agents.items():
        assets_seen = set()
        for cid in a.asset_ids:
            if cid in assets_seen:
                raise AssertionError(f"duplicate asset ref {cid} on {aid}")
            assets_seen.add(cid)
        liabilities_seen = set()
        for cid in a.liability_ids:
            if cid in liabilities_seen:
                raise AssertionError(f"duplicate liability ref {cid} on {aid}")
            liabilities_seen.add(cid)


def assert_all_stock_ids_owned(system):
    """Every StockLot id found in exactly one agent's stock_ids and stocks registry."""
    # Check that every stock in the registry is owned by exactly one agent
    stock_owners = {}
    for aid, agent in system.state.agents.items():
        for stock_id in agent.stock_ids:
            if stock_id in stock_owners:
                raise AssertionError(f"Stock {stock_id} owned by multiple agents: {stock_owners[stock_id]} and {aid}")
            stock_owners[stock_id] = aid
    
    # Check that every stock in the registry has an owner
    for stock_id, stock in system.state.stocks.items():
        if stock_id not in stock_owners:
            raise AssertionError(f"Stock {stock_id} in registry but no agent owns it")
        
        # Check that the stock's owner_id matches the owning agent
        if stock.owner_id != stock_owners[stock_id]:
            raise AssertionError(f"Stock {stock_id} owner_id {stock.owner_id} doesn't match owning agent {stock_owners[stock_id]}")


def assert_no_negative_stocks(system):
    """All stock quantities must be non-negative."""
    for stock_id, stock in system.state.stocks.items():
        if stock.quantity < 0:
            raise AssertionError(f"Stock {stock_id} has negative quantity: {stock.quantity}")


def assert_no_duplicate_stock_refs(system):
    """No duplicate stock IDs in any agent's stock_ids."""
    for aid, agent in system.state.agents.items():
        stocks_seen = set()
        for stock_id in agent.stock_ids:
            if stock_id in stocks_seen:
                raise AssertionError(f"duplicate stock ref {stock_id} on {aid}")
            stocks_seen.add(stock_id)

```

---

### 📄 src/bilancio/core/time.py

```python
"""Time handling utilities for bilancio."""

from dataclasses import dataclass


@dataclass
class TimeCoordinate:
    """Represents a point in time."""
    t: float


@dataclass
class TimeInterval:
    """Represents an interval of time with start and end coordinates."""
    start: TimeCoordinate
    end: TimeCoordinate


def now() -> TimeCoordinate:
    """Return the current time coordinate."""
    return TimeCoordinate(0.0)

```

---

### 📄 src/bilancio/dealer/__init__.py

```python
"""
Dealer module for the Kalecki ring simulation.

This module implements a secondary market dealer system that provides liquidity
to ring agents through market-making. The dealer quotes bid/ask prices and
absorbs customer flow, routing to VBTs (value-based traders) when capacity
is exhausted.

Components:
- models: Data models (Ticket, DealerState, VBTState, TraderState)
- kernel: L1 dealer pricing kernel
- assertions: C1-C6 programmatic invariant checks
- events: Event logging system
- trading: Trade execution logic (Events 1-2, 9-10)
- simulation: Dealer ring event loop orchestrator

References:
- Specification of the Dealer Module for the Kalecki Ring (Bilancio Simulation)
- Examples Document with programmatic assertions
"""

from .models import (
    TicketId,
    BucketConfig,
    DEFAULT_BUCKETS,
    Ticket,
    DealerState,
    VBTState,
    TraderState,
)

from .kernel import (
    M_MIN,
    KernelParams,
    ExecutionResult,
    recompute_dealer_state,
    can_interior_buy,
    can_interior_sell,
)

from .assertions import (
    EPSILON_CASH,
    EPSILON_QTY,
    assert_c1_double_entry,
    assert_c2_quote_bounds,
    assert_c3_feasibility,
    assert_c4_passthrough_invariant,
    assert_c5_equity_basis,
    assert_c6_anchor_timing,
    run_all_assertions,
)

from .events import EventLog

from .trading import TradeExecutor

from .simulation import (
    DaySnapshot,
    DealerRingConfig,
    DealerRingSimulation,
)

from .report import (
    generate_dealer_ring_html,
    export_dealer_ring_html,
)

__all__ = [
    # Models
    "TicketId",
    "BucketConfig",
    "DEFAULT_BUCKETS",
    "Ticket",
    "DealerState",
    "VBTState",
    "TraderState",
    # Kernel
    "M_MIN",
    "KernelParams",
    "ExecutionResult",
    "recompute_dealer_state",
    "can_interior_buy",
    "can_interior_sell",
    # Assertions
    "EPSILON_CASH",
    "EPSILON_QTY",
    "assert_c1_double_entry",
    "assert_c2_quote_bounds",
    "assert_c3_feasibility",
    "assert_c4_passthrough_invariant",
    "assert_c5_equity_basis",
    "assert_c6_anchor_timing",
    "run_all_assertions",
    # Events
    "EventLog",
    # Trading
    "TradeExecutor",
    # Simulation
    "DaySnapshot",
    "DealerRingConfig",
    "DealerRingSimulation",
    # Report
    "generate_dealer_ring_html",
    "export_dealer_ring_html",
]

```

---

### 📄 src/bilancio/dealer/assertions.py

```python
"""
Programmatic assertions for dealer ring simulation (C1-C6).

These assertions implement the "fail loudly" checks from the specification's
examples document. They verify invariants after every event (trade, settlement,
rebucketing) to catch bugs early.

References:
- Specification Section 6 (Events)
- Specification Section 7 (Kernel and Quotes)
- Specification Section 9 (VBT Anchors)
- Examples Document Section 1 (Programmatic Assertions)
"""

from decimal import Decimal
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from .models import DealerState, VBTState
    from .kernel import KernelParams


# Tolerance constants for floating-point and integer comparisons
EPSILON_CASH = Decimal("1e-10")  # Tolerance for cash comparisons
EPSILON_QTY = 0  # Tolerance for ticket counts (integer)


def assert_c1_double_entry(
    cash_changes: dict[str, Decimal],
    qty_changes: dict[str, int],
) -> None:
    """
    C1: Conservation - sum of cash/qty changes is zero.

    For every executed event (trade, settlement, rebucketing), the sum of all
    cash changes across parties must be zero, and the sum of all ticket quantity
    changes must be zero. This enforces double-entry bookkeeping.

    Args:
        cash_changes: Dictionary mapping party ID to cash change for this event.
                     Positive = cash received, negative = cash paid.
        qty_changes: Dictionary mapping party ID to ticket count change.
                    Positive = tickets received, negative = tickets given.

    Raises:
        AssertionError: If cash or quantity is not conserved within tolerance.

    Example:
        # Customer sells ticket to dealer at price 0.95
        assert_c1_double_entry(
            cash_changes={"customer": Decimal("0.95"), "dealer": Decimal("-0.95")},
            qty_changes={"customer": -1, "dealer": 1}
        )

    References:
        - Examples Doc Section 1.1 (C1. Double-entry and conservation)
        - Specification Section 6 (Event tables with mirrored entries)
    """
    total_cash = sum(cash_changes.values())
    total_qty = sum(qty_changes.values())

    assert abs(total_cash) <= EPSILON_CASH, (
        f"C1 VIOLATION: Cash not conserved across parties. "
        f"Total cash change: {total_cash} (tolerance: {EPSILON_CASH}). "
        f"Cash changes by party: {cash_changes}"
    )

    assert abs(total_qty) <= EPSILON_QTY, (
        f"C1 VIOLATION: Ticket quantities not conserved across parties. "
        f"Total qty change: {total_qty} (tolerance: {EPSILON_QTY}). "
        f"Quantity changes by party: {qty_changes}"
    )


def assert_c2_quote_bounds(dealer: "DealerState", vbt: "VBTState") -> None:
    """
    C2: Quotes within outside bounds.

    Verifies that dealer interior quotes remain within VBT outside bounds:
    - b_c(x) >= B (dealer bid >= outside bid)
    - a_c(x) <= A (dealer ask <= outside ask)

    Also verifies pin detection consistency:
    - (dealer.ask == A) if and only if dealer.is_pinned_ask
    - (dealer.bid == B) if and only if dealer.is_pinned_bid

    Args:
        dealer: Current dealer state with computed quotes.
        vbt: VBT state with outside quotes A, B.

    Raises:
        AssertionError: If quotes violate bounds or pin flags are inconsistent.

    References:
        - Examples Doc Section 1.2 (C2. Quote bounds and pin detection)
        - Specification Section 7.5 (Interior quotes and clipping)
    """
    # Check bid bound
    assert dealer.bid >= vbt.B, (
        f"C2 VIOLATION: Dealer bid {dealer.bid} < outside bid {vbt.B}. "
        f"Bucket: {dealer.bucket_id}, Inventory x: {dealer.x}"
    )

    # Check ask bound
    assert dealer.ask <= vbt.A, (
        f"C2 VIOLATION: Dealer ask {dealer.ask} > outside ask {vbt.A}. "
        f"Bucket: {dealer.bucket_id}, Inventory x: {dealer.x}"
    )

    # Check pin detection consistency (ask)
    ask_at_outside = (dealer.ask == vbt.A)
    assert ask_at_outside == dealer.is_pinned_ask, (
        f"C2 VIOLATION: Ask pin detection inconsistent. "
        f"Dealer ask {dealer.ask} == VBT ask {vbt.A}: {ask_at_outside}, "
        f"but is_pinned_ask: {dealer.is_pinned_ask}. "
        f"Bucket: {dealer.bucket_id}"
    )

    # Check pin detection consistency (bid)
    bid_at_outside = (dealer.bid == vbt.B)
    assert bid_at_outside == dealer.is_pinned_bid, (
        f"C2 VIOLATION: Bid pin detection inconsistent. "
        f"Dealer bid {dealer.bid} == VBT bid {vbt.B}: {bid_at_outside}, "
        f"but is_pinned_bid: {dealer.is_pinned_bid}. "
        f"Bucket: {dealer.bucket_id}"
    )


def assert_c3_feasibility(
    dealer: "DealerState",
    side: str,
    params: "KernelParams",
) -> None:
    """
    C3: Pre-check feasibility before interior execution.

    Before applying an interior fill, verify the dealer can execute:
    - Customer SELL (dealer BUY): x + S <= X* and C >= b_c(x)
    - Customer BUY (dealer SELL): x >= S

    This prevents the dealer from over-extending capacity or selling inventory
    they don't have.

    Args:
        dealer: Current dealer state before execution.
        side: "BUY" (dealer buys from customer) or "SELL" (dealer sells to customer).
        params: Kernel parameters including ticket size S.

    Raises:
        AssertionError: If interior execution is not feasible.

    References:
        - Examples Doc Section 1.3 (C3. Feasibility pre-checks)
        - Specification Section 7.6 (Commit-to-quote feasibility)
    """
    S = params.S

    if side == "BUY":
        # Dealer buys from customer (customer SELL)
        # Check capacity constraint
        assert dealer.x + S <= dealer.X_star, (
            f"C3 VIOLATION: Dealer BUY capacity exceeded. "
            f"Current inventory x: {dealer.x}, ticket size S: {S}, "
            f"capacity X*: {dealer.X_star}. "
            f"x + S = {dealer.x + S} > {dealer.X_star}. "
            f"Bucket: {dealer.bucket_id}"
        )

        # Check cash constraint
        assert dealer.cash >= dealer.bid, (
            f"C3 VIOLATION: Dealer BUY cash insufficient. "
            f"Cash: {dealer.cash}, required bid: {dealer.bid}. "
            f"Bucket: {dealer.bucket_id}"
        )

    elif side == "SELL":
        # Dealer sells to customer (customer BUY)
        # Check inventory constraint
        assert dealer.x >= S, (
            f"C3 VIOLATION: Dealer SELL inventory insufficient. "
            f"Current inventory x: {dealer.x}, ticket size S: {S}. "
            f"Bucket: {dealer.bucket_id}"
        )

    else:
        raise ValueError(f"Invalid side: {side}. Must be 'BUY' or 'SELL'.")


def assert_c4_passthrough_invariant(
    dealer_before: "DealerState",
    dealer_after: "DealerState",
) -> None:
    """
    C4: Passthrough leaves dealer state unchanged.

    If the event is executed via pass-through to the VBT at a pin (ask pinned
    at A or bid pinned at B), the dealer's (x, C) must be exactly unchanged.

    This ensures that when the dealer routes an order to the VBT, the dealer's
    own balance sheet is not affected.

    Args:
        dealer_before: Dealer state snapshot before the passthrough event.
        dealer_after: Dealer state snapshot after the passthrough event.

    Raises:
        AssertionError: If dealer inventory or cash changed during passthrough.

    References:
        - Examples Doc Section 1.4 (C4. Pass-through invariants)
        - Specification Events 9-10 (Passthrough at pins)
    """
    # Check inventory unchanged
    assert dealer_after.x == dealer_before.x, (
        f"C4 VIOLATION: Dealer inventory changed during passthrough. "
        f"Before: x={dealer_before.x}, After: x={dealer_after.x}. "
        f"Bucket: {dealer_after.bucket_id}"
    )

    # Check cash unchanged
    assert dealer_after.cash == dealer_before.cash, (
        f"C4 VIOLATION: Dealer cash changed during passthrough. "
        f"Before: C={dealer_before.cash}, After: C={dealer_after.cash}. "
        f"Bucket: {dealer_after.bucket_id}"
    )


def assert_c5_equity_basis(
    dealer: "DealerState",
    vbt: "VBTState",
) -> None:
    """
    C5: Equity = C + M*a at VBT mid.

    Dealer/VBT equity is measured at VBT mid M. The accounting identity
    V = C + M*a must hold, where:
    - V is the dealer's mid-valued equity
    - C is cash holdings
    - M is the VBT mid price
    - a is the number of tickets held

    Args:
        dealer: Current dealer state.
        vbt: VBT state with current mid M.

    Raises:
        AssertionError: If equity identity is violated beyond tolerance.

    References:
        - Examples Doc Section 1.5 (C5. Equity basis by role)
        - Specification Section 5.2 (Equity conventions)
    """
    # Compute equity at VBT mid
    equity_computed = dealer.cash + vbt.M * dealer.a

    assert abs(equity_computed - dealer.V) <= EPSILON_CASH, (
        f"C5 VIOLATION: Equity identity failed. "
        f"Computed E = C + M*a = {dealer.cash} + {vbt.M}*{dealer.a} = {equity_computed}, "
        f"but dealer.V = {dealer.V}. "
        f"Difference: {abs(equity_computed - dealer.V)} (tolerance: {EPSILON_CASH}). "
        f"Bucket: {dealer.bucket_id}"
    )


def assert_c6_anchor_timing(
    vbt_before: "VBTState",
    vbt_after: "VBTState",
    during_order_flow: bool,
) -> None:
    """
    C6: Anchors don't change during order flow.

    At the end of period t, compute loss rate and update (M, O). During period
    t+1 order flow, do NOT mutate anchors. This enforces the timing discipline
    that anchors are only updated based on realized losses, not contemporaneous
    order flow.

    Args:
        vbt_before: VBT state snapshot before order flow.
        vbt_after: VBT state snapshot after order flow.
        during_order_flow: True if checking within an order flow phase, False otherwise.

    Raises:
        AssertionError: If anchors changed during order flow.

    References:
        - Examples Doc Section 1.6 (C6. Anchor-update timing discipline)
        - Specification Section 9 (Loss-based anchor updates)
        - Specification Section 11 (Event loop timing)
    """
    if during_order_flow:
        # During order flow, anchors must not change
        assert vbt_after.M == vbt_before.M, (
            f"C6 VIOLATION: VBT mid M changed during order flow. "
            f"Before: M={vbt_before.M}, After: M={vbt_after.M}. "
            f"Bucket: {vbt_after.bucket_id}"
        )

        assert vbt_after.O == vbt_before.O, (
            f"C6 VIOLATION: VBT spread O changed during order flow. "
            f"Before: O={vbt_before.O}, After: O={vbt_after.O}. "
            f"Bucket: {vbt_after.bucket_id}"
        )


def run_all_assertions(
    dealer: "DealerState",
    vbt: "VBTState",
    params: "KernelParams",
) -> None:
    """
    Run C2 and C5 assertions (state checks).

    This is a convenience wrapper for running the assertions that check
    current state invariants (not event-specific). Use this after dealer
    state recomputation to verify the kernel produced valid results.

    Args:
        dealer: Current dealer state.
        vbt: Current VBT state.
        params: Kernel parameters.

    Raises:
        AssertionError: If any invariant is violated.

    Example:
        # After recomputing dealer state
        recompute_dealer_state(dealer, vbt, params)
        run_all_assertions(dealer, vbt, params)
    """
    assert_c2_quote_bounds(dealer, vbt)
    assert_c5_equity_basis(dealer, vbt)

```

---

### 📄 src/bilancio/dealer/bridge.py

```python
"""
Bridge between main Bilancio system and dealer module.

This module provides conversion functions between the main system's Payable
contracts and the dealer module's Ticket instruments. It enables:

- Converting Payable contracts to tradeable Tickets
- Mapping ticket ownership back to Payable holders
- Applying trade results to update contract ownership

The bridge maintains consistency between the two representations while keeping
the systems decoupled.
"""

from decimal import Decimal
from typing import Dict, List, Tuple, Set, Optional

from bilancio.dealer.models import Ticket, TicketId, BucketConfig, DEFAULT_BUCKETS
from bilancio.domain.instruments.credit import Payable
from bilancio.core.ids import new_id


def assign_bucket(remaining_tau: int, bucket_configs: List[BucketConfig]) -> str:
    """
    Determine which maturity bucket a ticket belongs to based on remaining maturity.

    Buckets partition tickets by remaining days to maturity τ (tau). Each bucket
    defines an inclusive range [tau_min, tau_max], with tau_max=None representing
    unbounded (τ ≥ tau_min).

    Args:
        remaining_tau: Remaining days until maturity (due_day - current_day)
        bucket_configs: List of bucket configurations to check

    Returns:
        bucket_id: The name of the matching bucket (e.g., "short", "mid", "long")

    Raises:
        ValueError: If remaining_tau doesn't match any bucket

    Examples:
        >>> assign_bucket(2, DEFAULT_BUCKETS)
        'short'
        >>> assign_bucket(5, DEFAULT_BUCKETS)
        'mid'
        >>> assign_bucket(15, DEFAULT_BUCKETS)
        'long'
    """
    for bucket in bucket_configs:
        if remaining_tau < bucket.tau_min:
            continue
        if bucket.tau_max is None or remaining_tau <= bucket.tau_max:
            return bucket.name

    raise ValueError(
        f"No bucket found for remaining_tau={remaining_tau}. "
        f"Available buckets: {[b.name for b in bucket_configs]}"
    )


def payables_to_tickets(
    payables: Dict[str, Payable],
    current_day: int,
    bucket_configs: List[BucketConfig],
    ticket_size: Decimal = Decimal(1),
) -> Tuple[Dict[TicketId, Ticket], Dict[str, List[str]]]:
    """
    Convert outstanding Payable contracts to tradeable Tickets.

    Each payable is "ticketized" into (face_value / ticket_size) tickets.
    Tickets are assigned to maturity buckets based on remaining days to maturity.

    Args:
        payables: Dictionary mapping payable_id to Payable contracts
        current_day: Current simulation day
        bucket_configs: Maturity bucket configurations
        ticket_size: Face value per ticket (default: 1)

    Returns:
        Tuple of:
        - ticket_registry: Dict mapping ticket_id to Ticket objects
        - payable_to_tickets: Dict mapping payable_id to list of ticket_ids

    Raises:
        ValueError: If payable amount is not divisible by ticket_size
        ValueError: If payable has already matured (due_day <= current_day)

    Notes:
        - Ticket IDs are generated using new_id() for uniqueness
        - Serial numbers are assigned sequentially for deterministic tie-breaking
        - Amount is converted from minor units to major units by dividing by 100
    """
    ticket_registry: Dict[TicketId, Ticket] = {}
    payable_to_tickets: Dict[str, List[str]] = {}

    for payable_id, payable in payables.items():
        # Validate payable hasn't matured
        if payable.due_day is None:
            raise ValueError(f"Payable {payable_id} has no due_day")

        if payable.due_day <= current_day:
            raise ValueError(
                f"Payable {payable_id} has already matured "
                f"(due_day={payable.due_day}, current_day={current_day})"
            )

        # Convert amount from minor units to major units (cents to dollars)
        # Payable.amount is in minor units (cents), tickets use major units (dollars)
        face_value = Decimal(payable.amount) / Decimal(100)

        # Calculate number of tickets
        num_tickets = face_value / ticket_size
        if num_tickets != int(num_tickets):
            raise ValueError(
                f"Payable {payable_id} face value {face_value} is not divisible "
                f"by ticket size {ticket_size}"
            )
        num_tickets = int(num_tickets)

        # Calculate remaining maturity and assign bucket
        remaining_tau = payable.due_day - current_day
        bucket_id = assign_bucket(remaining_tau, bucket_configs)

        # Create tickets for this payable
        ticket_ids: List[str] = []
        for serial in range(num_tickets):
            ticket_id = new_id()
            ticket = Ticket(
                id=ticket_id,
                issuer_id=payable.liability_issuer_id,
                owner_id=payable.asset_holder_id,
                face=ticket_size,
                maturity_day=payable.due_day,
                remaining_tau=remaining_tau,
                bucket_id=bucket_id,
                serial=serial,
            )
            ticket_registry[ticket_id] = ticket
            ticket_ids.append(ticket_id)

        payable_to_tickets[payable_id] = ticket_ids

    return ticket_registry, payable_to_tickets


def tickets_to_trader_holdings(
    tickets: Dict[TicketId, Ticket],
    agent_ids: Set[str],
) -> Dict[str, List[Ticket]]:
    """
    Group tickets by their owner for agents that are traders.

    This function filters tickets owned by specific agents and groups them
    by owner. Useful for initializing trader holdings from a ticket registry.

    Args:
        tickets: Dictionary mapping ticket_id to Ticket objects
        agent_ids: Set of agent IDs to include (typically ring traders)

    Returns:
        Dict mapping agent_id to list of tickets they hold as assets

    Notes:
        - Only includes tickets owned by agents in agent_ids
        - Returns empty list for agents with no tickets
        - Tickets are references to original objects (not copies)
    """
    holdings: Dict[str, List[Ticket]] = {agent_id: [] for agent_id in agent_ids}

    for ticket in tickets.values():
        if ticket.owner_id in agent_ids:
            holdings[ticket.owner_id].append(ticket)

    return holdings


def apply_trade_results_to_payables(
    payables: Dict[str, Payable],
    ticket_to_payable: Dict[str, str],
    trade_results: List[dict],
) -> None:
    """
    Apply dealer trade results back to main system by updating Payable holders.

    After trading in the dealer system, ticket ownership may change. This function
    propagates those changes back to the original Payable contracts by updating
    the asset_holder_id field.

    Args:
        payables: Dictionary mapping payable_id to Payable contracts (mutated in-place)
        ticket_to_payable: Dictionary mapping ticket_id to payable_id
        trade_results: List of trade result dicts with structure:
            {
                'ticket_id': str,
                'old_owner': str,
                'new_owner': str,
                'price': Decimal,
                ...
            }

    Notes:
        - Payables are modified in-place
        - Only tickets that map to payables are processed
        - If multiple tickets from same payable are traded, updates holder multiple times
        - Assumes all tickets from a payable have same owner (enforced by ticketization)

    Raises:
        KeyError: If ticket_id or payable_id not found in mappings
    """
    for result in trade_results:
        ticket_id = result['ticket_id']
        new_owner = result['new_owner']

        # Find the corresponding payable
        if ticket_id not in ticket_to_payable:
            # Ticket may not correspond to a payable (e.g., dealer-created)
            continue

        payable_id = ticket_to_payable[ticket_id]
        if payable_id not in payables:
            raise KeyError(f"Payable {payable_id} not found in payables dict")

        # Update the payable's secondary market holder (not asset_holder_id)
        # holder_id tracks the current owner after secondary market transfers
        # asset_holder_id should remain the original creditor
        payable = payables[payable_id]
        payable.holder_id = new_owner

```

---

### 📄 src/bilancio/dealer/events.py

```python
"""
Event logging system for dealer ring simulation.

Records all events during simulation for observability:
- Trades (interior and passthrough)
- Settlements (full and partial recovery)
- Defaults
- Rebucketing (dealer-to-dealer and VBT-to-VBT)
- Quote updates
- VBT anchor updates
"""

import json
from dataclasses import dataclass, field
from decimal import Decimal
from pathlib import Path
from typing import Any


@dataclass
class EventLog:
    """
    Structured event log for dealer ring simulation.

    Records all events during simulation for observability:
    - Trades (interior and passthrough)
    - Settlements (full and partial recovery)
    - Defaults
    - Rebucketing (dealer-to-dealer and VBT-to-VBT)
    - Quote updates
    - VBT anchor updates
    """

    events: list[dict] = field(default_factory=list)

    # Indexed structures for efficient lookup
    defaults_by_day: dict[int, list[dict]] = field(default_factory=dict)
    trades_by_day: dict[int, list[dict]] = field(default_factory=dict)
    settlements_by_day: dict[int, list[dict]] = field(default_factory=dict)

    def _serialize_value(self, value: Any) -> Any:
        """
        Convert value to JSON-serializable format.

        Decimals are stored as strings to preserve precision.
        """
        if isinstance(value, Decimal):
            return str(value)
        elif isinstance(value, dict):
            return {k: self._serialize_value(v) for k, v in value.items()}
        elif isinstance(value, (list, tuple)):
            return [self._serialize_value(v) for v in value]
        return value

    def log(self, kind: str, day: int, **payload) -> None:
        """
        Append event to log with kind, day, and arbitrary payload.

        Args:
            kind: Event type identifier
            day: Simulation day when event occurred
            **payload: Additional event data
        """
        event = {
            "kind": kind,
            "day": day,
            **self._serialize_value(payload),
        }
        self.events.append(event)

        # Update indices for specific event types
        if kind == "default":
            if day not in self.defaults_by_day:
                self.defaults_by_day[day] = []
            self.defaults_by_day[day].append(event)
        elif kind == "trade":
            if day not in self.trades_by_day:
                self.trades_by_day[day] = []
            self.trades_by_day[day].append(event)
        elif kind == "settlement":
            if day not in self.settlements_by_day:
                self.settlements_by_day[day] = []
            self.settlements_by_day[day].append(event)

    def log_day_start(self, day: int) -> None:
        """
        Log start of a simulation day.

        Args:
            day: Day number
        """
        self.log("day_start", day)

    def log_trade(
        self,
        day: int,
        side: str,
        trader_id: str,
        ticket_id: str,
        bucket: str,
        price: Decimal,
        is_passthrough: bool,
    ) -> None:
        """
        Log a trade event (Events 1-2 or 9-10).

        Args:
            day: Simulation day
            side: "BUY" or "SELL" (from customer's perspective)
            trader_id: Agent ID of the trader
            ticket_id: ID of the ticket being traded
            bucket: Maturity bucket
            price: Trade price
            is_passthrough: True if this is a dealer-to-VBT passthrough trade
        """
        self.log(
            "trade",
            day,
            side=side,
            trader_id=trader_id,
            ticket_id=ticket_id,
            bucket=bucket,
            price=price,
            is_passthrough=is_passthrough,
        )

    def log_quote(
        self,
        day: int,
        bucket: str,
        dealer_bid: Decimal,
        dealer_ask: Decimal,
        vbt_bid: Decimal,
        vbt_ask: Decimal,
        inventory: int,
        capacity: Decimal,
        is_pinned_bid: bool,
        is_pinned_ask: bool,
    ) -> None:
        """
        Log dealer quote state after recomputation.

        Args:
            day: Simulation day
            bucket: Maturity bucket
            dealer_bid: Dealer's bid price
            dealer_ask: Dealer's ask price
            vbt_bid: VBT's bid price
            vbt_ask: VBT's ask price
            inventory: Number of tickets in dealer inventory
            capacity: One-sided capacity in face units
            is_pinned_bid: True if dealer bid is pinned at VBT bid
            is_pinned_ask: True if dealer ask is pinned at VBT ask
        """
        self.log(
            "quote",
            day,
            bucket=bucket,
            dealer_bid=dealer_bid,
            dealer_ask=dealer_ask,
            vbt_bid=vbt_bid,
            vbt_ask=vbt_ask,
            inventory=inventory,
            capacity=capacity,
            is_pinned_bid=is_pinned_bid,
            is_pinned_ask=is_pinned_ask,
        )

    def log_settlement(
        self,
        day: int,
        issuer_id: str,
        total_paid: Decimal,
        n_tickets: int,
    ) -> None:
        """
        Log full settlement (recovery_rate = 1).

        Args:
            day: Simulation day
            issuer_id: Agent ID of the issuer who settled
            total_paid: Total amount paid
            n_tickets: Number of tickets settled
        """
        self.log(
            "settlement",
            day,
            issuer_id=issuer_id,
            total_paid=total_paid,
            n_tickets=n_tickets,
            recovery_rate=Decimal(1),
        )

    def log_default(
        self,
        day: int,
        issuer_id: str,
        recovery_rate: Decimal,
        total_due: Decimal,
        total_paid: Decimal,
        n_tickets: int,
        bucket: str,
    ) -> None:
        """
        Log default event with partial recovery (Events 6-8).

        Args:
            day: Simulation day
            issuer_id: Agent ID of the issuer who defaulted
            recovery_rate: Recovery rate R (0 <= R < 1)
            total_due: Total face value due
            total_paid: Total amount actually paid
            n_tickets: Number of tickets involved
            bucket: Maturity bucket of the defaulted tickets
        """
        self.log(
            "default",
            day,
            issuer_id=issuer_id,
            recovery_rate=recovery_rate,
            total_due=total_due,
            total_paid=total_paid,
            n_tickets=n_tickets,
            bucket=bucket,
        )

    def log_rebucket(
        self,
        day: int,
        ticket_id: str,
        old_bucket: str,
        new_bucket: str,
        price: Decimal,
        holder_type: str,
    ) -> None:
        """
        Log rebucketing event (Events 11-12).

        Args:
            day: Simulation day
            ticket_id: ID of the ticket being rebucketed
            old_bucket: Previous bucket
            new_bucket: New bucket
            price: Price at which ticket is transferred
            holder_type: "dealer" or "vbt" - who holds the ticket
        """
        self.log(
            "rebucket",
            day,
            ticket_id=ticket_id,
            old_bucket=old_bucket,
            new_bucket=new_bucket,
            price=price,
            holder_type=holder_type,
        )

    def log_vbt_anchor_update(
        self,
        day: int,
        bucket: str,
        M_old: Decimal,
        M_new: Decimal,
        O_old: Decimal,
        O_new: Decimal,
        loss_rate: Decimal,
    ) -> None:
        """
        Log VBT anchor update after defaults.

        Args:
            day: Simulation day
            bucket: Maturity bucket
            M_old: Previous mid price anchor
            M_new: New mid price anchor
            O_old: Previous spread anchor
            O_new: New spread anchor
            loss_rate: Loss rate that triggered the update
        """
        self.log(
            "vbt_anchor_update",
            day,
            bucket=bucket,
            M_old=M_old,
            M_new=M_new,
            O_old=O_old,
            O_new=O_new,
            loss_rate=loss_rate,
        )

    def get_bucket_loss_rate(self, day: int, bucket_id: str) -> Decimal:
        """
        Compute loss rate for bucket from today's defaults.

        l_t = sum(face * (1 - R)) / sum(face) for maturing tickets.

        Returns Decimal(0) if no defaults in this bucket today.

        Args:
            day: Simulation day
            bucket_id: Bucket identifier

        Returns:
            Loss rate as Decimal
        """
        if day not in self.defaults_by_day:
            return Decimal(0)

        total_loss = Decimal(0)
        total_face = Decimal(0)

        for event in self.defaults_by_day[day]:
            if event.get("bucket") == bucket_id:
                # Parse Decimal values from string
                total_due = Decimal(event["total_due"])
                total_paid = Decimal(event["total_paid"])

                total_face += total_due
                total_loss += total_due - total_paid

        if total_face == 0:
            return Decimal(0)

        return total_loss / total_face

    def get_trades_for_day(self, day: int) -> list[dict]:
        """
        Get all trades that occurred on a given day.

        Args:
            day: Simulation day

        Returns:
            List of trade events
        """
        return self.trades_by_day.get(day, [])

    def get_defaults_for_day(self, day: int) -> list[dict]:
        """
        Get all defaults that occurred on a given day.

        Args:
            day: Simulation day

        Returns:
            List of default events
        """
        return self.defaults_by_day.get(day, [])

    def get_settlements_for_day(self, day: int) -> list[dict]:
        """
        Get all settlements that occurred on a given day.

        Args:
            day: Simulation day

        Returns:
            List of settlement events
        """
        return self.settlements_by_day.get(day, [])

    def get_events_for_day(self, day: int) -> list[dict]:
        """
        Get all events that occurred on a given day.

        Args:
            day: Simulation day

        Returns:
            List of events
        """
        return [event for event in self.events if event.get("day") == day]

    def get_all_events(self) -> list[dict]:
        """
        Get all events in chronological order.

        Returns:
            List of all events
        """
        return self.events.copy()

    def to_jsonl(self, path: str) -> None:
        """
        Export events to JSONL file (one JSON object per line).

        Args:
            path: File path to write to
        """
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        with open(path_obj, "w") as f:
            for event in self.events:
                f.write(json.dumps(event) + "\n")

    def to_dataframe(self) -> "pd.DataFrame":
        """
        Convert events to pandas DataFrame for analysis.

        Returns:
            DataFrame with one row per event

        Raises:
            ImportError: If pandas is not installed
        """
        try:
            import pandas as pd
        except ImportError:
            raise ImportError(
                "pandas is required for DataFrame export. "
                "Install with: uv add pandas"
            )

        return pd.DataFrame(self.events)

```

---

### 📄 src/bilancio/dealer/kernel.py

```python
"""
L1 dealer pricing kernel.

This module implements the core L1 dealer pricing formulas from Section 8
of the specification. It computes all derived dealer quantities from the
current inventory and VBT anchor prices.

The kernel is the mathematical heart of the dealer system, computing:
- Capacity: Maximum fundable buy tickets (K*, X*)
- Layoff probability: Risk-neutral hedging probability (λ)
- Inside width: Competitive equilibrium spread (I)
- Midline: Inventory-sensitive mid price p(x)
- Clipped quotes: Final bid/ask quotes b_c(x), a_c(x)

All arithmetic uses Decimal for precision - never float.
"""

from dataclasses import dataclass
from decimal import Decimal, ROUND_FLOOR

from .models import DealerState, VBTState, Ticket

# Guard threshold - when M <= M_MIN, dealer pins to outside quotes
M_MIN = Decimal("0.02")


@dataclass
class KernelParams:
    """
    Parameters for dealer kernel computation.

    Attributes:
        S: Standard ticket size (face value)
    """
    S: Decimal = Decimal(1)


def recompute_dealer_state(
    dealer: DealerState,
    vbt: VBTState,
    params: KernelParams,
) -> None:
    """
    Recompute all derived dealer quantities from current (inventory, cash).

    This is the core L1 kernel from specification Section 8. It updates
    all derived dealer quantities in-place based on:
    - Current inventory and cash (dealer balance sheet)
    - VBT anchor prices M, O (and derived A, B)
    - Ticket size S

    The kernel implements the complete pricing formula hierarchy:
    1. Compute current inventory (a, x)
    2. Check guard regime (M <= M_MIN) and pin if needed
    3. Compute capacity (K*, X*) and ladder parameters (N, λ)
    4. Compute inside width (I) from layoff probability
    5. Compute inventory-sensitive midline p(x)
    6. Compute interior quotes a(x), b(x)
    7. Clip to outside bounds and detect pins

    Args:
        dealer: DealerState to update (modified in-place)
        vbt: VBTState providing anchor prices
        params: KernelParams with ticket size S

    References:
        - Section 8: L1 Dealer Pricing Formulas
        - Section 8.4: Midline Formula
        - Section 8.5: Interior Quote Formulas
    """
    S = params.S
    M = vbt.M
    O = vbt.O
    A = vbt.A
    B = vbt.B

    # Step 1: Compute current inventory
    # a = number of tickets held
    # x = face inventory = a * S
    dealer.a = len(dealer.inventory)
    dealer.x = S * dealer.a

    # Step 2: Guard regime check
    # If M <= M_MIN, collapse to outside-only (no interior market)
    if M <= M_MIN:
        dealer.V = dealer.cash
        dealer.K_star = 0
        dealer.X_star = Decimal(0)
        dealer.N = 1
        dealer.lambda_ = Decimal(1)
        dealer.I = O  # Not used when pinned, but set for completeness
        dealer.midline = M
        dealer.bid = B
        dealer.ask = A
        dealer.is_pinned_bid = True
        dealer.is_pinned_ask = True
        return

    # Step 3: Normal computation (M > M_MIN)

    # V = Mid-valued inventory = M * a + C
    # This is the dealer's "equity" valued at VBT mid
    dealer.V = M * dealer.a + dealer.cash

    # K* = floor(V / M)
    # Maximum number of tickets dealer can buy without borrowing
    # Uses ROUND_FLOOR to ensure integer result
    K_star_decimal = (dealer.V / M).quantize(Decimal(1), rounding=ROUND_FLOOR)
    dealer.K_star = int(K_star_decimal)

    # X* = S * K*
    # One-sided capacity in face units (max buyable face value)
    dealer.X_star = S * dealer.K_star

    # N = K* + 1
    # Number of ladder rungs (including zero inventory)
    dealer.N = dealer.K_star + 1

    # λ = S / (X* + S)
    # Layoff probability (reflecting random walk boundary condition)
    # This is the risk-neutral probability of hitting the upper capacity bound
    if dealer.X_star + S > 0:
        dealer.lambda_ = S / (dealer.X_star + S)
    else:
        # Degenerate case: zero capacity
        dealer.lambda_ = Decimal(1)

    # I = λ * O
    # Inside width (competitive equilibrium spread)
    # Dealer spread is compressed by layoff probability
    dealer.I = dealer.lambda_ * O

    # Step 4: Inventory-sensitive midline (Section 8.4)
    # p(x) = M - (O / (X* + 2S)) * (x - X*/2)
    #
    # This formula makes the midline:
    # - Decrease as inventory increases (dealer wants to sell)
    # - Increase as inventory decreases (dealer wants to buy)
    # - Centered at balanced inventory x = X*/2
    if dealer.X_star + 2 * S > 0:
        slope = O / (dealer.X_star + 2 * S)
        dealer.midline = M - slope * (dealer.x - dealer.X_star / 2)
    else:
        # Degenerate case: zero capacity
        dealer.midline = M

    # Step 5: Interior quotes (Section 8.5)
    # a(x) = p(x) + I/2  (interior ask)
    # b(x) = p(x) - I/2  (interior bid)
    half_inside = dealer.I / 2
    a_interior = dealer.midline + half_inside
    b_interior = dealer.midline - half_inside

    # Step 6: Clipped quotes
    # a_c(x) = min(A, a(x))  (clip ask at outside ask)
    # b_c(x) = max(B, b(x))  (clip bid at outside bid)
    dealer.ask = min(A, a_interior)
    dealer.bid = max(B, b_interior)

    # Step 7: Pin detection
    # Dealer is "pinned" when its quote equals the outside quote
    # This signals that the dealer wants to route to VBT
    dealer.is_pinned_ask = (dealer.ask == A)
    dealer.is_pinned_bid = (dealer.bid == B)


def can_interior_buy(dealer: DealerState, params: KernelParams) -> bool:
    """
    Check if dealer can execute interior BUY (dealer buys ticket from customer).

    Interior buy is feasible if and only if:
    1. x + S <= X* (capacity constraint: has room for one more ticket)
    2. C >= b_c(x) (cash constraint: can pay the bid price)

    Args:
        dealer: DealerState to check
        params: KernelParams with ticket size S

    Returns:
        True if dealer can execute interior buy, False if must route to VBT

    References:
        - Section 8.6: Feasibility Checks
    """
    S = params.S
    has_capacity = (dealer.x + S <= dealer.X_star)
    has_cash = (dealer.cash >= dealer.bid)
    return has_capacity and has_cash


def can_interior_sell(dealer: DealerState, params: KernelParams) -> bool:
    """
    Check if dealer can execute interior SELL (dealer sells ticket to customer).

    Interior sell is feasible if and only if:
    - x >= S (inventory constraint: has at least one ticket to sell)
    - X* > 0 (not in Guard mode)

    Under Guard mode (M <= M_MIN), X* = 0 and all trades route to VBT
    regardless of dealer inventory. This is an "operational freeze of
    interior execution."

    Args:
        dealer: DealerState to check
        params: KernelParams with ticket size S

    Returns:
        True if dealer can execute interior sell, False if must route to VBT

    References:
        - Section 8.6: Feasibility Checks
        - Section 7.2: Guard regime when M <= M_MIN
    """
    S = params.S
    has_inventory = (dealer.x >= S)
    not_in_guard = (dealer.X_star > 0)
    return has_inventory and not_in_guard


@dataclass
class ExecutionResult:
    """
    Result of a trade execution.

    Attributes:
        executed: True if trade was executed
        price: Execution price (bid or ask)
        is_passthrough: True if trade was routed to VBT (outside market)
        ticket: Ticket that was transferred (for BUYs), None for failed trades
    """
    executed: bool
    price: Decimal
    is_passthrough: bool
    ticket: Ticket | None = None

```

---

### 📄 src/bilancio/dealer/metrics.py

```python
"""
Metrics data structures and computation for functional dealer analysis.

This module implements the measurement framework defined in Section 8 of the
"New Kalecki Ring with Dealers" specification. It provides comprehensive
metrics to evaluate whether the dealer satisfies functional dealer criteria.

Key metrics tracked:
1. Trade log with pre/post state (8.1)
2. Dealer P&L and profitability (8.2)
3. Trader investment returns and liquidity use (8.3)
4. Repayment-priority diagnostics (8.4)

References:
    - Section 8: "Measurement and data collection for functional dealer properties"
    - D1-D3: Functional dealer and trader behaviour definitions
    - R1-R6: Requirements for simulation analysis
"""

from dataclasses import dataclass, field
from decimal import Decimal
from typing import Dict, List, Optional, Any
import json
from pathlib import Path


@dataclass
class TradeRecord:
    """
    Record of a single dealer trade with full state information.

    Implements Section 8.1 trade log requirements:
    - time t, bucket b, side, agent i, price p, issuer, maturity

    Extended with pre/post state for diagnostics:
    - Dealer state before/after
    - Trader safety margin before/after (Section 8.4)
    - Liquidity-driven flag (Section 8.3)

    Plan 022 extensions:
    - run_id/regime for experiment tracking
    - hit_inventory_limit flag for VBT routing analysis
    """
    # Core trade identifiers
    day: int
    bucket: str
    side: str  # "BUY" or "SELL" (from customer perspective)
    trader_id: str
    ticket_id: str

    # Ticket details
    issuer_id: str
    maturity_day: int
    face_value: Decimal
    price: Decimal
    unit_price: Decimal  # price / face_value
    is_passthrough: bool

    # === Fields with defaults below ===

    # Run context (Plan 022 - Phase 1)
    run_id: str = ""              # e.g., "grid_abc123"
    regime: str = ""              # "passive" or "active"

    # Pre-trade state
    dealer_inventory_before: int = 0
    dealer_cash_before: Decimal = Decimal(0)
    dealer_bid_before: Decimal = Decimal(0)
    dealer_ask_before: Decimal = Decimal(0)
    vbt_mid_before: Decimal = Decimal(0)
    trader_cash_before: Decimal = Decimal(0)
    trader_safety_margin_before: Decimal = Decimal(0)

    # Post-trade state
    dealer_inventory_after: int = 0
    dealer_cash_after: Decimal = Decimal(0)
    dealer_bid_after: Decimal = Decimal(0)
    dealer_ask_after: Decimal = Decimal(0)
    trader_cash_after: Decimal = Decimal(0)
    trader_safety_margin_after: Decimal = Decimal(0)

    # Flags
    is_liquidity_driven: bool = False  # Seller had shortfall (Section 8.3)
    reduces_margin_below_zero: bool = False  # BUY reduced margin < 0 (Section 8.4)

    # VBT routing analysis (Plan 022 - Phase 1)
    # hit_inventory_limit is different from is_passthrough:
    # - is_passthrough=True means trade went to VBT
    # - hit_inventory_limit=True means VBT was used *because* dealer was at capacity
    #   (side=SELL and dealer at max_capacity, or side=BUY and dealer at 0 inventory)
    hit_inventory_limit: bool = False

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            # Run context (Plan 022)
            "run_id": self.run_id,
            "regime": self.regime,
            # Core trade identifiers
            "day": self.day,
            "bucket": self.bucket,
            "side": self.side,
            "trader_id": self.trader_id,
            "ticket_id": self.ticket_id,
            "issuer_id": self.issuer_id,
            "maturity_day": self.maturity_day,
            "face_value": str(self.face_value),
            "price": str(self.price),
            "unit_price": str(self.unit_price),
            "is_passthrough": self.is_passthrough,
            "dealer_inventory_before": self.dealer_inventory_before,
            "dealer_cash_before": str(self.dealer_cash_before),
            "dealer_bid_before": str(self.dealer_bid_before),
            "dealer_ask_before": str(self.dealer_ask_before),
            "vbt_mid_before": str(self.vbt_mid_before),
            "trader_cash_before": str(self.trader_cash_before),
            "trader_safety_margin_before": str(self.trader_safety_margin_before),
            "dealer_inventory_after": self.dealer_inventory_after,
            "dealer_cash_after": str(self.dealer_cash_after),
            "dealer_bid_after": str(self.dealer_bid_after),
            "dealer_ask_after": str(self.dealer_ask_after),
            "trader_cash_after": str(self.trader_cash_after),
            "trader_safety_margin_after": str(self.trader_safety_margin_after),
            "is_liquidity_driven": self.is_liquidity_driven,
            "reduces_margin_below_zero": self.reduces_margin_below_zero,
            # VBT routing analysis (Plan 022)
            "hit_inventory_limit": self.hit_inventory_limit,
        }


@dataclass
class DealerSnapshot:
    """
    Snapshot of dealer state at a point in time.

    Implements Section 8.1 dealer state requirements:
    - Inventory a_t^(b), cash C_t^(b)
    - Outside mid M_t^(b), spread O_t^(b)
    - Bid/ask quotes
    - Mark-to-mid equity E_t^(b) = C_t^(b) + M_t^(b) * a_t^(b) * S

    Plan 022 extensions (Phase 3 - inventory timeseries):
    - max_capacity, capacity_pct for utilization tracking
    - is_at_zero, hit_vbt_this_step for VBT routing analysis
    - total_system_face, dealer_share_pct for system-level context
    """
    day: int
    bucket: str
    inventory: int  # a_t^(b) - number of tickets
    cash: Decimal
    bid: Decimal
    ask: Decimal
    midline: Decimal
    vbt_mid: Decimal  # M_t^(b)
    vbt_spread: Decimal  # O_t^(b)
    ticket_size: Decimal  # S

    # Plan 022 - Phase 3: Inventory timeseries fields
    run_id: str = ""              # Run identifier for tracking
    regime: str = ""              # "passive" or "active"
    max_capacity: int = 0         # K* - max dealer inventory capacity
    is_at_zero: bool = False      # inventory == 0?
    hit_vbt_this_step: bool = False  # Did we route to VBT this step?
    total_system_face: Decimal = Decimal(0)  # Total face value in system for this bucket
    dealer_share_pct: Decimal = Decimal(0)   # % of bucket's face held by dealer

    @property
    def mark_to_mid_equity(self) -> Decimal:
        """
        Mark-to-mid equity: E_t^(b) = C_t^(b) + M_t^(b) * a_t^(b) * S

        This is the equity valuation using VBT mid price.
        """
        return self.cash + self.vbt_mid * self.inventory * self.ticket_size

    @property
    def capacity_pct(self) -> Decimal:
        """
        Capacity utilization as percentage (Plan 022).

        inventory / max_capacity * 100, or 0 if max_capacity is 0.
        """
        if self.max_capacity == 0:
            return Decimal(0)
        return (Decimal(self.inventory) / Decimal(self.max_capacity)) * 100

    @property
    def spread(self) -> Decimal:
        """Current bid-ask spread."""
        return self.ask - self.bid

    @property
    def dealer_premium_vs_face(self) -> Decimal:
        """
        Dealer midline premium/discount vs face value (par = 1).

        Returns (midline - 1).
        Positive = premium, Negative = discount.
        """
        return self.midline - Decimal(1)

    @property
    def dealer_premium_pct(self) -> Decimal:
        """
        Dealer premium/discount as percentage.

        ((midline - 1) / 1) * 100
        """
        return (self.midline - Decimal(1)) * 100

    @property
    def vbt_premium_vs_face(self) -> Decimal:
        """
        VBT mid premium/discount vs face value (par = 1).

        Returns (M - 1).
        """
        return self.vbt_mid - Decimal(1)

    @property
    def vbt_premium_pct(self) -> Decimal:
        """
        VBT premium/discount as percentage.

        ((M - 1) / 1) * 100
        """
        return (self.vbt_mid - Decimal(1)) * 100

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            # Run context (Plan 022)
            "run_id": self.run_id,
            "regime": self.regime,
            # Core fields
            "day": self.day,
            "bucket": self.bucket,
            "inventory": self.inventory,
            "cash": str(self.cash),
            "bid": str(self.bid),
            "ask": str(self.ask),
            "midline": str(self.midline),
            "vbt_mid": str(self.vbt_mid),
            "vbt_spread": str(self.vbt_spread),
            "ticket_size": str(self.ticket_size),
            "mark_to_mid_equity": str(self.mark_to_mid_equity),
            "spread": str(self.spread),
            "dealer_premium_pct": str(self.dealer_premium_pct),
            "vbt_premium_pct": str(self.vbt_premium_pct),
            # Plan 022 - Phase 3: Inventory timeseries
            "max_capacity": self.max_capacity,
            "capacity_pct": str(self.capacity_pct),
            "is_at_zero": self.is_at_zero,
            "hit_vbt_this_step": self.hit_vbt_this_step,
            "total_system_face": str(self.total_system_face),
            "dealer_share_pct": str(self.dealer_share_pct),
        }


@dataclass
class TraderSnapshot:
    """
    Snapshot of trader state at a point in time.

    Implements Section 8.1 trader state requirements:
    - Cash C_i(t)
    - Set of tickets held
    - Schedule of future obligations
    - Safety margin m_i(t) (Section 8.4)
    """
    day: int
    trader_id: str
    cash: Decimal
    tickets_held_count: int
    tickets_held_ids: List[str]
    total_face_held: Decimal
    obligations_remaining: Decimal  # D_i(t) - future obligations
    saleable_value: Decimal  # Value of tickets at dealer bid prices
    safety_margin: Decimal  # m_i(t) = A_i(t) - D_i(t)
    defaulted: bool = False

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            "day": self.day,
            "trader_id": self.trader_id,
            "cash": str(self.cash),
            "tickets_held_count": self.tickets_held_count,
            "tickets_held_ids": self.tickets_held_ids,
            "total_face_held": str(self.total_face_held),
            "obligations_remaining": str(self.obligations_remaining),
            "saleable_value": str(self.saleable_value),
            "safety_margin": str(self.safety_margin),
            "defaulted": self.defaulted,
        }


@dataclass
class TicketOutcome:
    """
    Final outcome of a ticket for return calculation.

    Implements Section 8.3 ticket-level realized return:
    R_τ = (X_τ - p_buy) / p_buy

    Where X_τ is:
    - Settlement amount at maturity (if held)
    - Resale price if sold to dealer
    - Coupon payments (future extension)
    """
    ticket_id: str
    issuer_id: str
    maturity_day: int
    face_value: Decimal

    # Purchase from dealer (if applicable)
    purchased_from_dealer: bool = False
    purchase_day: Optional[int] = None
    purchase_price: Optional[Decimal] = None
    purchaser_id: Optional[str] = None

    # Sale to dealer (if applicable)
    sold_to_dealer: bool = False
    sale_day: Optional[int] = None
    sale_price: Optional[Decimal] = None
    seller_id: Optional[str] = None

    # Settlement outcome
    settled: bool = False
    settlement_day: Optional[int] = None
    recovery_rate: Optional[Decimal] = None
    settlement_amount: Optional[Decimal] = None

    def realized_return(self) -> Optional[Decimal]:
        """
        Calculate realized return R_τ for ticket purchased from dealer.

        Returns:
            R_τ = (X_τ - p_buy) / p_buy, or None if not purchased from dealer
        """
        if not self.purchased_from_dealer or self.purchase_price is None:
            return None

        p_buy = self.purchase_price

        # Determine total payoff X_τ
        x_tau = Decimal(0)

        if self.sold_to_dealer and self.sale_price is not None:
            # Resold to dealer
            x_tau = self.sale_price
        elif self.settled and self.settlement_amount is not None:
            # Held to maturity
            x_tau = self.settlement_amount
        else:
            # Still held or defaulted with no recovery
            return None

        if p_buy == 0:
            return None

        return (x_tau - p_buy) / p_buy

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            "ticket_id": self.ticket_id,
            "issuer_id": self.issuer_id,
            "maturity_day": self.maturity_day,
            "face_value": str(self.face_value),
            "purchased_from_dealer": self.purchased_from_dealer,
            "purchase_day": self.purchase_day,
            "purchase_price": str(self.purchase_price) if self.purchase_price else None,
            "purchaser_id": self.purchaser_id,
            "sold_to_dealer": self.sold_to_dealer,
            "sale_day": self.sale_day,
            "sale_price": str(self.sale_price) if self.sale_price else None,
            "seller_id": self.seller_id,
            "settled": self.settled,
            "settlement_day": self.settlement_day,
            "recovery_rate": str(self.recovery_rate) if self.recovery_rate else None,
            "settlement_amount": str(self.settlement_amount) if self.settlement_amount else None,
            "realized_return": str(self.realized_return()) if self.realized_return() is not None else None,
        }


@dataclass
class SystemStateSnapshot:
    """
    System-level state at a point in time (Plan 022 - Phase 4).

    Tracks how total debt/money evolves over time to understand
    the "winding down" dynamics of the system.

    Fields:
    - run_id, regime: Run context for experiment tracking
    - day: Simulation day
    - total_face_value: Sum of all outstanding ticket face values
    - face_by_bucket: Face value breakdown by maturity bucket
    - total_cash: Sum of all agent cash holdings
    - debt_to_money: Current debt/money ratio
    """
    run_id: str
    regime: str
    day: int

    # Total face value outstanding
    total_face_value: Decimal        # All maturities
    face_bucket_short: Decimal = Decimal(0)
    face_bucket_mid: Decimal = Decimal(0)
    face_bucket_long: Decimal = Decimal(0)

    # Total cash in system
    total_cash: Decimal = Decimal(0)

    @property
    def debt_to_money(self) -> Decimal:
        """Current debt-to-money ratio."""
        if self.total_cash > 0:
            return self.total_face_value / self.total_cash
        return Decimal(0)

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            "run_id": self.run_id,
            "regime": self.regime,
            "day": self.day,
            "total_face_value": str(self.total_face_value),
            "face_bucket_short": str(self.face_bucket_short),
            "face_bucket_mid": str(self.face_bucket_mid),
            "face_bucket_long": str(self.face_bucket_long),
            "total_cash": str(self.total_cash),
            "debt_to_money": str(self.debt_to_money),
        }


@dataclass
class RepaymentEvent:
    """
    Track how a trader managed a specific liability (Plan 022 - Phase 2).

    For each (trader, liability) pair, records:
    - Outcome: did they repay or default?
    - Trading activity: buys/sells before maturity
    - Strategy classification: no_trade, hold_to_maturity, sell_before, round_trip

    This enables analysis of whether trading helped traders avoid defaults.
    """
    run_id: str
    regime: str
    trader_id: str
    liability_id: str      # The contract/ticket ID representing their debt
    maturity_day: int
    face_value: Decimal

    # Outcome
    outcome: str           # "repaid" or "defaulted"

    # Trading activity BEFORE this maturity
    buy_count: int = 0
    sell_count: int = 0
    net_cash_pnl: Decimal = Decimal(0)  # Net cash from trading (sells - buys)

    # Strategy classification
    strategy: str = ""     # "no_trade", "hold_to_maturity", "sell_before", "round_trip"

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary with serialized Decimals."""
        return {
            "run_id": self.run_id,
            "regime": self.regime,
            "trader_id": self.trader_id,
            "liability_id": self.liability_id,
            "maturity_day": self.maturity_day,
            "face_value": str(self.face_value),
            "outcome": self.outcome,
            "buy_count": self.buy_count,
            "sell_count": self.sell_count,
            "net_cash_pnl": str(self.net_cash_pnl),
            "strategy": self.strategy,
        }


def classify_trading_strategy(buy_count: int, sell_count: int) -> str:
    """
    Classify a trader's strategy based on their trading activity.

    Returns:
        - "no_trade": Never traded with the dealer
        - "hold_to_maturity": Bought but never sold (holding for maturity payment)
        - "sell_before": Sold tickets to get cash (liquidity-seeking)
        - "round_trip": Both bought and sold (active trading)
    """
    if buy_count == 0 and sell_count == 0:
        return "no_trade"
    elif buy_count > 0 and sell_count > 0:
        return "round_trip"
    elif sell_count > 0:
        return "sell_before"
    else:  # buy_count > 0, sell_count == 0
        return "hold_to_maturity"


@dataclass
class RunMetrics:
    """
    All metrics for a single simulation run.

    This is the main container for Section 8 metrics, aggregating:
    - Trade log (8.1)
    - Daily dealer/trader snapshots (8.1)
    - Ticket outcomes for return calculation (8.3)

    Provides computed metrics for:
    - Dealer P&L and profitability (8.2)
    - Trader investment returns (8.3)
    - Repayment-priority diagnostics (8.4)
    """
    # Trade log (Section 8.1)
    trades: List[TradeRecord] = field(default_factory=list)

    # Daily snapshots (Section 8.1)
    dealer_snapshots: List[DealerSnapshot] = field(default_factory=list)
    trader_snapshots: List[TraderSnapshot] = field(default_factory=list)

    # System state timeseries (Plan 022 - Phase 4)
    system_state_snapshots: List[SystemStateSnapshot] = field(default_factory=list)

    # Repayment events (Plan 022 - Phase 2)
    repayment_events: List[RepaymentEvent] = field(default_factory=list)

    # Ticket outcomes (Section 8.3)
    ticket_outcomes: Dict[str, TicketOutcome] = field(default_factory=dict)

    # Initial equity by bucket (for P&L calculation)
    initial_equity_by_bucket: Dict[str, Decimal] = field(default_factory=dict)

    # System-level initial state (debt-to-money ratio control variable)
    initial_total_debt: Decimal = Decimal(0)    # Sum of all payable amounts at t=0
    initial_total_money: Decimal = Decimal(0)   # Sum of all cash holdings at t=0

    # Run context (Plan 022 - for tracking)
    run_id: str = ""
    regime: str = ""

    @property
    def debt_to_money_ratio(self) -> Decimal:
        """
        Debt-to-money ratio at simulation start.

        This is a key control variable: results only make sense
        given the same ratio. More money = fewer expected defaults.

        Returns:
            total_debt / total_money (or 0 if no money)
        """
        if self.initial_total_money > 0:
            return self.initial_total_debt / self.initial_total_money
        return Decimal(0)

    # =========================================================================
    # Section 8.2: Dealer and VBT Profitability
    # =========================================================================

    def dealer_pnl_by_bucket(self) -> Dict[str, Decimal]:
        """
        Compute dealer P&L by bucket: Π_r^(b) = E_T^(b) - E_0^(b)

        Returns:
            Dictionary mapping bucket_id to P&L in currency units
        """
        pnl = {}
        for bucket_id, initial_equity in self.initial_equity_by_bucket.items():
            # Find final equity for this bucket
            final_snapshots = [
                s for s in self.dealer_snapshots
                if s.bucket == bucket_id
            ]
            if final_snapshots:
                # Take the last snapshot
                final_equity = max(final_snapshots, key=lambda s: s.day).mark_to_mid_equity
                pnl[bucket_id] = final_equity - initial_equity
            else:
                pnl[bucket_id] = Decimal(0)
        return pnl

    def dealer_return_by_bucket(self) -> Dict[str, Decimal]:
        """
        Compute dealer return by bucket: π_r^(b) = Π_r^(b) / E_0^(b)

        Returns:
            Dictionary mapping bucket_id to return (as fraction)
        """
        pnl = self.dealer_pnl_by_bucket()
        returns = {}
        for bucket_id, profit in pnl.items():
            initial = self.initial_equity_by_bucket.get(bucket_id, Decimal(0))
            if initial > 0:
                returns[bucket_id] = profit / initial
            else:
                returns[bucket_id] = Decimal(0)
        return returns

    def total_dealer_pnl(self) -> Decimal:
        """Total P&L across all buckets."""
        return sum(self.dealer_pnl_by_bucket().values())

    def total_dealer_return(self) -> Decimal:
        """
        Total dealer return weighted by initial equity.

        Returns:
            Π_total / E_0_total
        """
        total_pnl = self.total_dealer_pnl()
        total_initial = sum(self.initial_equity_by_bucket.values())
        if total_initial > 0:
            return total_pnl / total_initial
        return Decimal(0)

    def is_dealer_profitable(self) -> bool:
        """Check if dealer is profitable (Π >= 0)."""
        return self.total_dealer_pnl() >= 0

    def spread_income_total(self) -> Decimal:
        """
        Total spread income from interior trades.

        For SELL: income = dealer_ask - dealer_bid (customer gets bid, dealer marks at mid)
        For BUY: income = dealer_ask - dealer_bid (customer pays ask)

        Simplified: count trades where dealer made the spread.
        """
        income = Decimal(0)
        for trade in self.trades:
            if not trade.is_passthrough:
                # Interior trade - dealer earns spread
                if trade.side == "SELL":
                    # Customer sold to dealer at bid
                    # Spread income = midline - bid
                    midline = (trade.dealer_bid_before + trade.dealer_ask_before) / 2
                    income += (midline - trade.dealer_bid_before) * trade.face_value
                else:  # BUY
                    # Customer bought from dealer at ask
                    # Spread income = ask - midline
                    midline = (trade.dealer_bid_before + trade.dealer_ask_before) / 2
                    income += (trade.dealer_ask_before - midline) * trade.face_value
        return income

    def passthrough_count(self) -> int:
        """Count of passthrough trades (dealer to VBT)."""
        return sum(1 for t in self.trades if t.is_passthrough)

    def interior_count(self) -> int:
        """Count of interior trades (dealer only)."""
        return sum(1 for t in self.trades if not t.is_passthrough)

    # =========================================================================
    # Section 8.3: Trader Investment Returns and Liquidity Use
    # =========================================================================

    def trader_returns(self) -> Dict[str, Decimal]:
        """
        Compute investment return R_i for each trader.

        R_i = (1/|T_i|) * Σ R_τ for all tickets τ purchased by trader i

        Returns:
            Dictionary mapping trader_id to mean return
        """
        # Group outcomes by purchaser
        returns_by_trader: Dict[str, List[Decimal]] = {}

        for outcome in self.ticket_outcomes.values():
            if outcome.purchased_from_dealer and outcome.purchaser_id:
                r_tau = outcome.realized_return()
                if r_tau is not None:
                    if outcome.purchaser_id not in returns_by_trader:
                        returns_by_trader[outcome.purchaser_id] = []
                    returns_by_trader[outcome.purchaser_id].append(r_tau)

        # Compute mean return per trader
        trader_returns = {}
        for trader_id, returns in returns_by_trader.items():
            if returns:
                trader_returns[trader_id] = sum(returns) / len(returns)
            else:
                trader_returns[trader_id] = Decimal(0)

        return trader_returns

    def mean_trader_return(self) -> Decimal:
        """Mean return across all traders who bought from dealer."""
        returns = list(self.trader_returns().values())
        if returns:
            return sum(returns) / len(returns)
        return Decimal(0)

    def fraction_profitable_traders(self) -> Decimal:
        """Fraction of traders with positive return (R_i > 0)."""
        returns = self.trader_returns()
        if not returns:
            return Decimal(0)
        profitable = sum(1 for r in returns.values() if r > 0)
        return Decimal(profitable) / len(returns)

    def liquidity_driven_sales(self) -> int:
        """
        Count of liquidity-driven sales.

        A sale is liquidity-driven when seller had shortfall in obligations.
        """
        return sum(1 for t in self.trades if t.side == "SELL" and t.is_liquidity_driven)

    def rescue_events(self) -> int:
        """
        Count of rescue events.

        A rescue event occurs when a liquidity-driven sale enables the seller
        to meet an obligation that would otherwise have defaulted.

        Note: This is approximated by counting liquidity-driven sales where
        the trader's safety margin improved to positive after the trade.
        """
        rescues = 0
        for trade in self.trades:
            if trade.side == "SELL" and trade.is_liquidity_driven:
                # Check if trade moved margin from negative to positive
                if (trade.trader_safety_margin_before < 0 and
                    trade.trader_safety_margin_after >= 0):
                    rescues += 1
        return rescues

    # =========================================================================
    # Section 8.4: Repayment-Priority Diagnostics
    # =========================================================================

    def unsafe_buy_count(self) -> int:
        """Count of BUY trades that reduced safety margin below zero."""
        return sum(1 for t in self.trades if t.reduces_margin_below_zero)

    def fraction_unsafe_buys(self) -> Decimal:
        """Fraction of BUY trades that reduced margin below zero."""
        buys = [t for t in self.trades if t.side == "BUY"]
        if not buys:
            return Decimal(0)
        unsafe = sum(1 for t in buys if t.reduces_margin_below_zero)
        return Decimal(unsafe) / len(buys)

    def margin_at_default_distribution(self) -> List[Decimal]:
        """
        Distribution of safety margins at time of default.

        Returns list of m_i(t) values for agents that defaulted.
        """
        margins = []
        for snapshot in self.trader_snapshots:
            if snapshot.defaulted:
                margins.append(snapshot.safety_margin)
        return margins

    def mean_margin_at_default(self) -> Optional[Decimal]:
        """Mean safety margin at default time."""
        margins = self.margin_at_default_distribution()
        if margins:
            return sum(margins) / len(margins)
        return None

    # =========================================================================
    # Mid Price Time Series (Plan 020)
    # =========================================================================

    def dealer_mid_timeseries(self) -> Dict[int, Dict[str, Decimal]]:
        """
        Extract dealer midline time series by bucket.

        Returns:
            {day: {bucket_id: midline_value}}
        """
        result: Dict[int, Dict[str, Decimal]] = {}
        for snap in self.dealer_snapshots:
            if snap.day not in result:
                result[snap.day] = {}
            result[snap.day][snap.bucket] = snap.midline
        return result

    def vbt_mid_timeseries(self) -> Dict[int, Dict[str, Decimal]]:
        """
        Extract VBT mid (M) time series by bucket.

        Returns:
            {day: {bucket_id: M_value}}
        """
        result: Dict[int, Dict[str, Decimal]] = {}
        for snap in self.dealer_snapshots:
            if snap.day not in result:
                result[snap.day] = {}
            result[snap.day][snap.bucket] = snap.vbt_mid
        return result

    def dealer_premium_timeseries(self) -> Dict[int, Dict[str, Decimal]]:
        """
        Extract dealer premium/discount vs face time series.

        Returns:
            {day: {bucket_id: premium_pct}}
        """
        result: Dict[int, Dict[str, Decimal]] = {}
        for snap in self.dealer_snapshots:
            if snap.day not in result:
                result[snap.day] = {}
            result[snap.day][snap.bucket] = snap.dealer_premium_pct
        return result

    def vbt_premium_timeseries(self) -> Dict[int, Dict[str, Decimal]]:
        """
        Extract VBT premium/discount vs face time series.

        Returns:
            {day: {bucket_id: premium_pct}}
        """
        result: Dict[int, Dict[str, Decimal]] = {}
        for snap in self.dealer_snapshots:
            if snap.day not in result:
                result[snap.day] = {}
            result[snap.day][snap.bucket] = snap.vbt_premium_pct
        return result

    def _final_dealer_mids(self) -> Dict[str, float]:
        """Get final dealer midline by bucket."""
        result = {}
        for bucket_id in set(s.bucket for s in self.dealer_snapshots):
            bucket_snaps = [s for s in self.dealer_snapshots if s.bucket == bucket_id]
            if bucket_snaps:
                final = max(bucket_snaps, key=lambda s: s.day)
                result[bucket_id] = float(final.midline)
        return result

    def _final_vbt_mids(self) -> Dict[str, float]:
        """Get final VBT mid by bucket."""
        result = {}
        for bucket_id in set(s.bucket for s in self.dealer_snapshots):
            bucket_snaps = [s for s in self.dealer_snapshots if s.bucket == bucket_id]
            if bucket_snaps:
                final = max(bucket_snaps, key=lambda s: s.day)
                result[bucket_id] = float(final.vbt_mid)
        return result

    def _final_dealer_premiums(self) -> Dict[str, float]:
        """Get final dealer premium % by bucket."""
        result = {}
        for bucket_id in set(s.bucket for s in self.dealer_snapshots):
            bucket_snaps = [s for s in self.dealer_snapshots if s.bucket == bucket_id]
            if bucket_snaps:
                final = max(bucket_snaps, key=lambda s: s.day)
                result[bucket_id] = float(final.dealer_premium_pct)
        return result

    def _final_vbt_premiums(self) -> Dict[str, float]:
        """Get final VBT premium % by bucket."""
        result = {}
        for bucket_id in set(s.bucket for s in self.dealer_snapshots):
            bucket_snaps = [s for s in self.dealer_snapshots if s.bucket == bucket_id]
            if bucket_snaps:
                final = max(bucket_snaps, key=lambda s: s.day)
                result[bucket_id] = float(final.vbt_premium_pct)
        return result

    # =========================================================================
    # Section 8.5: Experiment-Level Summary Statistics
    # =========================================================================

    def summary(self) -> Dict[str, Any]:
        """
        Generate summary statistics for experiment-level aggregation.

        Returns dictionary suitable for comparison across runs.
        """
        return {
            # Dealer profitability (8.2)
            "dealer_total_pnl": float(self.total_dealer_pnl()),
            "dealer_total_return": float(self.total_dealer_return()),
            "dealer_profitable": self.is_dealer_profitable(),
            "dealer_pnl_by_bucket": {k: float(v) for k, v in self.dealer_pnl_by_bucket().items()},
            "dealer_return_by_bucket": {k: float(v) for k, v in self.dealer_return_by_bucket().items()},
            "spread_income_total": float(self.spread_income_total()),
            "interior_trades": self.interior_count(),
            "passthrough_trades": self.passthrough_count(),

            # Trader returns (8.3)
            "mean_trader_return": float(self.mean_trader_return()),
            "fraction_profitable_traders": float(self.fraction_profitable_traders()),
            "liquidity_driven_sales": self.liquidity_driven_sales(),
            "rescue_events": self.rescue_events(),

            # Repayment priority (8.4)
            "unsafe_buy_count": self.unsafe_buy_count(),
            "fraction_unsafe_buys": float(self.fraction_unsafe_buys()),
            "mean_margin_at_default": float(self.mean_margin_at_default()) if self.mean_margin_at_default() is not None else None,

            # Trade counts
            "total_trades": len(self.trades),
            "total_sell_trades": sum(1 for t in self.trades if t.side == "SELL"),
            "total_buy_trades": sum(1 for t in self.trades if t.side == "BUY"),

            # System-level control variable (Plan 020 - Phase B)
            "initial_total_debt": float(self.initial_total_debt),
            "initial_total_money": float(self.initial_total_money),
            "debt_to_money_ratio": float(self.debt_to_money_ratio),

            # Mid price summary stats (Plan 020 - Phase A.2, A.3)
            "dealer_mid_final": self._final_dealer_mids(),
            "vbt_mid_final": self._final_vbt_mids(),
            "dealer_premium_final_pct": self._final_dealer_premiums(),
            "vbt_premium_final_pct": self._final_vbt_premiums(),
        }

    # =========================================================================
    # Export Methods
    # =========================================================================

    def to_trade_log_csv(self, path: str) -> None:
        """Export trade log to CSV file."""
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.trades:
            return

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=self.trades[0].to_dict().keys())
            writer.writeheader()
            for trade in self.trades:
                writer.writerow(trade.to_dict())

    def to_dealer_snapshots_csv(self, path: str) -> None:
        """Export dealer snapshots to CSV file."""
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.dealer_snapshots:
            return

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=self.dealer_snapshots[0].to_dict().keys())
            writer.writeheader()
            for snapshot in self.dealer_snapshots:
                writer.writerow(snapshot.to_dict())

    def to_trader_snapshots_csv(self, path: str) -> None:
        """Export trader snapshots to CSV file."""
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.trader_snapshots:
            return

        # Filter out tickets_held_ids for CSV (too verbose)
        fieldnames = [k for k in self.trader_snapshots[0].to_dict().keys() if k != "tickets_held_ids"]

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            writer.writeheader()
            for snapshot in self.trader_snapshots:
                row = {k: v for k, v in snapshot.to_dict().items() if k != "tickets_held_ids"}
                writer.writerow(row)

    def to_ticket_outcomes_csv(self, path: str) -> None:
        """Export ticket outcomes to CSV file."""
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.ticket_outcomes:
            return

        outcomes = list(self.ticket_outcomes.values())
        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=outcomes[0].to_dict().keys())
            writer.writeheader()
            for outcome in outcomes:
                writer.writerow(outcome.to_dict())

    def to_summary_json(self, path: str) -> None:
        """Export summary statistics to JSON file."""
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        with open(path_obj, "w") as f:
            json.dump(self.summary(), f, indent=2)

    def to_mid_timeseries_csv(self, path: str) -> None:
        """
        Export mid price time series to CSV.

        Columns: day, bucket, dealer_midline, vbt_mid, dealer_premium_pct, vbt_premium_pct
        """
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.dealer_snapshots:
            return

        fieldnames = [
            "day", "bucket",
            "dealer_midline", "vbt_mid",
            "dealer_premium_pct", "vbt_premium_pct"
        ]

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            writer.writeheader()
            for snap in sorted(self.dealer_snapshots, key=lambda s: (s.day, s.bucket)):
                writer.writerow({
                    "day": snap.day,
                    "bucket": snap.bucket,
                    "dealer_midline": str(snap.midline),
                    "vbt_mid": str(snap.vbt_mid),
                    "dealer_premium_pct": str(snap.dealer_premium_pct),
                    "vbt_premium_pct": str(snap.vbt_premium_pct),
                })

    def to_inventory_timeseries_csv(self, path: str) -> None:
        """
        Export inventory timeseries to CSV (Plan 022 - Phase 3).

        Tracks dealer capacity utilization over time.

        Columns: run_id, regime, day, bucket, dealer_inventory, max_capacity,
                 capacity_pct, is_at_zero, hit_vbt_this_step, total_system_face,
                 dealer_share_pct
        """
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.dealer_snapshots:
            return

        fieldnames = [
            "run_id", "regime", "day", "bucket",
            "dealer_inventory", "max_capacity", "capacity_pct",
            "is_at_zero", "hit_vbt_this_step",
            "total_system_face", "dealer_share_pct"
        ]

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            writer.writeheader()
            for snap in sorted(self.dealer_snapshots, key=lambda s: (s.day, s.bucket)):
                writer.writerow({
                    "run_id": snap.run_id,
                    "regime": snap.regime,
                    "day": snap.day,
                    "bucket": snap.bucket,
                    "dealer_inventory": snap.inventory,
                    "max_capacity": snap.max_capacity,
                    "capacity_pct": str(snap.capacity_pct),
                    "is_at_zero": snap.is_at_zero,
                    "hit_vbt_this_step": snap.hit_vbt_this_step,
                    "total_system_face": str(snap.total_system_face),
                    "dealer_share_pct": str(snap.dealer_share_pct),
                })

    def to_system_state_csv(self, path: str) -> None:
        """
        Export system state timeseries to CSV (Plan 022 - Phase 4).

        Tracks how total debt/money evolves over time.

        Columns: run_id, regime, day, total_face_value, face_bucket_short,
                 face_bucket_mid, face_bucket_long, total_cash, debt_to_money
        """
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.system_state_snapshots:
            return

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(
                f,
                fieldnames=self.system_state_snapshots[0].to_dict().keys()
            )
            writer.writeheader()
            for snapshot in sorted(self.system_state_snapshots, key=lambda s: s.day):
                writer.writerow(snapshot.to_dict())

    def to_repayment_events_csv(self, path: str) -> None:
        """
        Export repayment events to CSV (Plan 022 - Phase 2).

        Tracks how each trader managed each liability - did they repay or default,
        and what trading strategy did they use?

        Columns: run_id, regime, trader_id, liability_id, maturity_day, face_value,
                 outcome, buy_count, sell_count, net_cash_pnl, strategy
        """
        import csv
        path_obj = Path(path)
        path_obj.parent.mkdir(parents=True, exist_ok=True)

        if not self.repayment_events:
            return

        with open(path_obj, "w", newline="") as f:
            writer = csv.DictWriter(
                f,
                fieldnames=self.repayment_events[0].to_dict().keys()
            )
            writer.writeheader()
            for event in sorted(self.repayment_events, key=lambda e: (e.maturity_day, e.trader_id)):
                writer.writerow(event.to_dict())


# =============================================================================
# Helper Functions for Safety Margin Computation
# =============================================================================

def compute_safety_margin(
    cash: Decimal,
    tickets_held: list,  # List of Ticket objects
    obligations: list,   # List of Ticket objects (where trader is issuer)
    dealers: dict,       # bucket_id -> DealerState
    ticket_size: Decimal
) -> Decimal:
    """
    Compute deterministic safety margin m_i(t) for a trader.

    m_i(t) = A_i(t) - D_i(t)

    Where:
    - A_i(t) = cash + Σ (bid_price * face) for held tickets
    - D_i(t) = Σ face for remaining obligations

    Args:
        cash: Trader's cash holdings
        tickets_held: Tickets owned by trader
        obligations: Trader's outstanding obligations
        dealers: Dealer states by bucket (for bid prices)
        ticket_size: Standard ticket size S

    Returns:
        Safety margin m_i(t)
    """
    # A_i(t): Cash plus saleable value of tickets at dealer bid
    a_i = cash
    for ticket in tickets_held:
        bucket_id = ticket.bucket_id
        dealer = dealers.get(bucket_id)
        if dealer:
            # Value at dealer bid price
            a_i += dealer.bid * ticket.face
        else:
            # Fallback: use face value
            a_i += ticket.face

    # D_i(t): Sum of remaining obligations
    d_i = sum(ticket.face for ticket in obligations)

    return a_i - d_i


def compute_saleable_value(
    tickets_held: list,
    dealers: dict,
) -> Decimal:
    """
    Compute total saleable value of tickets at dealer bid prices.

    Args:
        tickets_held: Tickets owned by trader
        dealers: Dealer states by bucket

    Returns:
        Total value if all tickets sold at bid
    """
    total = Decimal(0)
    for ticket in tickets_held:
        bucket_id = ticket.bucket_id
        dealer = dealers.get(bucket_id)
        if dealer:
            total += dealer.bid * ticket.face
        else:
            total += ticket.face
    return total


# =============================================================================
# Liability Tracking (Plan 023 - Default-Aware Instrumentation)
# =============================================================================

@dataclass
class LiabilityInfo:
    """
    Information about a single liability from events.jsonl.

    Used by build_liability_map() to track all created payables
    and their settlement status.
    """
    trader_id: str          # Debtor agent ID
    liability_id: str       # Payable ID (e.g., "PAY_xyz789")
    maturity_day: int       # Due day of the liability
    face_value: Decimal     # Amount owed
    settled: bool = False   # Whether it was settled
    settled_day: Optional[int] = None  # Day it was settled (if settled)


def build_liability_map(events: List[Dict[str, Any]]) -> tuple[Dict[str, LiabilityInfo], int]:
    """
    Build a map of all liabilities and their settlement status.

    Scans events for:
    - PayableCreated: Register liability with debtor, maturity, face value
    - PayableSettled: Mark liability as settled

    This approach captures ALL liabilities, including those that default
    without an explicit ObligationDefaulted event.

    Args:
        events: List of event dictionaries from system.state.events or events.jsonl

    Returns:
        (liabilities_map, final_day) where:
        - liabilities_map: {liability_id -> LiabilityInfo}
        - final_day: Last day seen in events
    """
    liabilities: Dict[str, LiabilityInfo] = {}
    final_day = 0

    for event in events:
        day = event.get("day", 0)
        final_day = max(final_day, day)
        kind = event.get("kind", "") or event.get("event", "")

        if kind == "PayableCreated":
            lid = event.get("payable_id", "")
            if lid:
                liabilities[lid] = LiabilityInfo(
                    trader_id=event.get("debtor", ""),
                    liability_id=lid,
                    maturity_day=event.get("due_day", 0),
                    face_value=Decimal(str(event.get("amount", 0))),
                )
        elif kind == "PayableSettled":
            # Try multiple field names for the payable ID
            lid = event.get("pid") or event.get("contract_id") or event.get("payable_id", "")
            if lid and lid in liabilities:
                liabilities[lid].settled = True
                liabilities[lid].settled_day = day

    return liabilities, final_day


def compute_trading_stats_by_trader(
    trades: List[TradeRecord]
) -> Dict[str, List[Dict[str, Any]]]:
    """
    Group trades by trader_id with trade details.

    Args:
        trades: List of TradeRecord objects

    Returns:
        {trader_id: [{"day": d, "side": s, "price": p}, ...]}
    """
    by_trader: Dict[str, List[Dict[str, Any]]] = {}

    for trade in trades:
        trader_id = trade.trader_id
        if trader_id not in by_trader:
            by_trader[trader_id] = []
        by_trader[trader_id].append({
            "day": trade.day,
            "side": trade.side,
            "price": trade.price,
        })

    return by_trader


def get_trades_before_day(
    trader_trades: List[Dict[str, Any]],
    maturity_day: int
) -> Dict[str, Any]:
    """
    Compute trading stats for trades BEFORE a given maturity day.

    Args:
        trader_trades: List of trade dicts from compute_trading_stats_by_trader()
        maturity_day: The maturity day to filter against

    Returns:
        {"buy_count": N, "sell_count": N, "net_cash_pnl": Decimal}
    """
    buy_count = 0
    sell_count = 0
    net_cash_pnl = Decimal(0)

    for t in trader_trades:
        if t["day"] < maturity_day:
            if t["side"] == "BUY":
                buy_count += 1
                net_cash_pnl -= Decimal(str(t["price"]))
            elif t["side"] == "SELL":
                sell_count += 1
                net_cash_pnl += Decimal(str(t["price"]))

    return {
        "buy_count": buy_count,
        "sell_count": sell_count,
        "net_cash_pnl": net_cash_pnl,
    }


# =============================================================================
# Repayment Event Builder (Plan 022 - Phase 2, enhanced by Plan 023)
# =============================================================================

def build_repayment_events(
    event_log: List[Dict[str, Any]],
    trades: List[TradeRecord],
    run_id: str = "",
    regime: str = "",
) -> List[RepaymentEvent]:
    """
    Build RepaymentEvent objects for ALL liabilities that matured.

    Plan 023 enhancement: Uses liability map approach to capture BOTH
    repaid AND defaulted liabilities, even when no explicit default event exists.

    Algorithm:
    1. Build map of all PayableCreated liabilities
    2. Mark settled liabilities from PayableSettled events
    3. For each liability that matured by final_day:
       - Compute trading stats from trades
       - Classify strategy
       - Set outcome based on settled status

    Args:
        event_log: List of event dictionaries from system.events or events.jsonl
        trades: List of TradeRecord objects from metrics.trades
        run_id: Run identifier for tracking
        regime: "passive" or "active"

    Returns:
        List of RepaymentEvent objects (one per matured liability)
    """
    # Build liability map from events
    liabilities, final_day = build_liability_map(event_log)

    # Build trading stats indexed by trader
    trading_stats = compute_trading_stats_by_trader(trades)

    repayment_events: List[RepaymentEvent] = []

    for lid, info in liabilities.items():
        # Only include liabilities that have matured by the final simulation day
        if info.maturity_day > final_day:
            continue

        # Skip if we don't have a valid trader_id
        if not info.trader_id:
            continue

        # Get trading stats for this trader BEFORE this maturity
        trader_trades = trading_stats.get(info.trader_id, [])
        stats = get_trades_before_day(trader_trades, info.maturity_day)

        buy_count = stats["buy_count"]
        sell_count = stats["sell_count"]
        net_cash_pnl = stats["net_cash_pnl"]

        # Classify strategy
        strategy = classify_trading_strategy(buy_count, sell_count)

        # Determine outcome: settled = repaid, not settled = defaulted
        outcome = "repaid" if info.settled else "defaulted"

        # Create RepaymentEvent
        repayment_event = RepaymentEvent(
            run_id=run_id,
            regime=regime,
            trader_id=info.trader_id,
            liability_id=lid,
            maturity_day=info.maturity_day,
            face_value=info.face_value,
            outcome=outcome,
            buy_count=buy_count,
            sell_count=sell_count,
            net_cash_pnl=net_cash_pnl,
            strategy=strategy,
        )
        repayment_events.append(repayment_event)

    return repayment_events

```

---

### 📄 src/bilancio/dealer/models.py

```python
"""
Data models for the dealer ring simulation.

This module defines the core data structures used in the dealer ring model:
- Tickets: Tradable debt instruments with face value and maturity
- Buckets: Maturity-based groupings of tickets
- DealerState: Per-bucket dealer market-making state
- VBTState: Per-bucket value-based trader state
- TraderState: Ring trader state with single-issuer constraint
"""

from dataclasses import dataclass, field
from decimal import Decimal

from bilancio.core.ids import AgentId

# Type alias for ticket identifiers
TicketId = str


@dataclass
class BucketConfig:
    """
    Configuration for a maturity bucket.

    Buckets partition tickets by remaining maturity τ (tau).
    Each bucket defines an inclusive range [tau_min, tau_max].
    tau_max=None means unbounded (τ ≥ tau_min).

    Attributes:
        name: Human-readable bucket identifier (e.g., "short", "mid", "long")
        tau_min: Minimum remaining maturity (inclusive)
        tau_max: Maximum remaining maturity (inclusive), None for unbounded
    """
    name: str
    tau_min: int
    tau_max: int | None


# Default three-bucket configuration
DEFAULT_BUCKETS = [
    BucketConfig("short", 1, 3),      # τ ∈ {1, 2, 3}
    BucketConfig("mid", 4, 8),        # τ ∈ {4, ..., 8}
    BucketConfig("long", 9, None),    # τ ≥ 9
]


@dataclass
class Ticket:
    """
    A tradable debt instrument (ticket).

    Represents a promise by issuer_id to pay face value on maturity_day.
    Currently held by owner_id (the creditor).

    Attributes:
        id: Unique ticket identifier
        issuer_id: Agent who owes this debt (the debtor)
        owner_id: Current holder of the ticket (the creditor)
        face: Face value S (typically 1)
        maturity_day: Absolute day when ticket matures
        remaining_tau: Remaining days to maturity (updated each day)
        bucket_id: Maturity bucket assignment ("short" | "mid" | "long")
        serial: Serial number for deterministic tie-breaking
    """
    id: TicketId
    issuer_id: AgentId
    owner_id: AgentId
    face: Decimal
    maturity_day: int
    remaining_tau: int = 0
    bucket_id: str = ""
    serial: int = 0


@dataclass
class DealerState:
    """
    Per-bucket dealer market-making state.

    Tracks inventory, cash, and derived quoting parameters for a single
    maturity bucket. The dealer provides two-sided liquidity using a
    value-based pricing function.

    Attributes:
        bucket_id: Maturity bucket identifier
        agent_id: Dealer's agent ID
        inventory: List of tickets currently held
        cash: Cash holdings

    Derived quantities (recomputed after each trade):
        a: Number of tickets held = len(inventory)
        x: Face inventory = a * S
        V: Mid-valued inventory = M*a + C
        K_star: Maximum buy tickets fundable
        X_star: One-sided capacity in face units
        N: Number of ladder rungs
        lambda_: Layoff probability
        I: Inside width (spread parameter)

    Current quotes:
        bid: Current bid price b_c(x)
        ask: Current ask price a_c(x)
        midline: Current midline p(x)

    Pin flags:
        is_pinned_bid: True if bid == B (at outside bid)
        is_pinned_ask: True if ask == A (at outside ask)
    """
    bucket_id: str
    agent_id: AgentId = ""
    inventory: list[Ticket] = field(default_factory=list)
    cash: Decimal = Decimal(0)

    # Derived quantities
    a: int = 0
    x: Decimal = Decimal(0)
    V: Decimal = Decimal(0)
    K_star: int = 0
    X_star: Decimal = Decimal(0)
    N: int = 1
    lambda_: Decimal = Decimal(1)
    I: Decimal = Decimal(0)

    # Quotes
    bid: Decimal = Decimal(0)
    ask: Decimal = Decimal(0)
    midline: Decimal = Decimal(0)

    # Pin flags
    is_pinned_bid: bool = False
    is_pinned_ask: bool = False

    def ticket_ids_by_issuer(self) -> dict[AgentId, list[TicketId]]:
        """
        Group inventory tickets by issuer.

        Returns:
            Dictionary mapping issuer_id to list of ticket IDs
        """
        result: dict[AgentId, list[TicketId]] = {}
        for ticket in self.inventory:
            if ticket.issuer_id not in result:
                result[ticket.issuer_id] = []
            result[ticket.issuer_id].append(ticket.id)
        return result


@dataclass
class VBTState:
    """
    Per-bucket value-based trader state.

    VBTs provide outside liquidity with adaptive anchors based on
    realized losses from defaults. Each bucket has independent anchors.

    Attributes:
        bucket_id: Maturity bucket identifier
        agent_id: VBT agent ID

    Anchors:
        M: Outside mid price
        O: Outside spread

    Derived outside quotes:
        A: Ask price = M + O/2
        B: Bid price = M - O/2

    Sensitivity parameters:
        phi_M: Mid sensitivity to loss (default 1.0)
        phi_O: Spread sensitivity to loss (default 0.6)

    Optional clipping:
        O_min: Minimum spread (default 0)
        clip_nonneg_B: Clip bid to be non-negative (default True)

    Balance sheet:
        inventory: List of tickets held
        cash: Cash holdings
    """
    bucket_id: str
    agent_id: AgentId = ""

    # Anchors
    M: Decimal = Decimal(1)
    O: Decimal = Decimal("0.30")

    # Derived outside quotes
    A: Decimal = Decimal(0)
    B: Decimal = Decimal(0)

    # Sensitivity parameters
    phi_M: Decimal = Decimal(1)
    phi_O: Decimal = Decimal("0.6")

    # Optional clipping
    O_min: Decimal = Decimal(0)
    clip_nonneg_B: bool = True

    # Balance sheet
    inventory: list[Ticket] = field(default_factory=list)
    cash: Decimal = Decimal(0)

    def recompute_quotes(self) -> None:
        """
        Update A and B from M and O with optional clipping.

        Computes:
            A = M + O/2
            B = M - O/2

        Applies clipping:
            - O >= O_min (minimum spread)
            - B >= 0 if clip_nonneg_B is True
        """
        # Ensure minimum spread
        O_effective = max(self.O, self.O_min)

        # Compute quotes
        half_spread = O_effective / 2
        self.A = self.M + half_spread
        self.B = self.M - half_spread

        # Apply non-negative bid clipping if enabled
        if self.clip_nonneg_B:
            self.B = max(self.B, Decimal(0))

    def update_from_loss(self, loss_rate: Decimal) -> None:
        """
        Apply loss-based anchor update rule.

        Updates anchors based on realized loss rate:
            M_{t+1} = M_t - phi_M * l_t
            O_{t+1} = max(O_min, O_t + phi_O * l_t)

        Then recomputes quotes A and B.

        Args:
            loss_rate: Realized loss rate l_t (fraction of face value lost)
        """
        # Update mid (decreases with loss)
        self.M = self.M - self.phi_M * loss_rate

        # Update spread (increases with loss, subject to minimum)
        self.O = max(self.O_min, self.O + self.phi_O * loss_rate)

        # Recompute derived quotes
        self.recompute_quotes()


@dataclass
class TraderState:
    """
    State for a ring trader.

    Ring traders buy and sell tickets subject to a single-issuer constraint:
    each trader can only hold tickets from one issuer at a time.

    Attributes:
        agent_id: Trader's agent ID
        cash: Cash holdings
        tickets_owned: List of tickets owned (assets)
        obligations: List of tickets this agent issued (liabilities)
        asset_issuer_id: Issuer of currently held tickets (single-issuer constraint)
        defaulted: True if agent has defaulted
    """
    agent_id: AgentId
    cash: Decimal = Decimal(0)
    tickets_owned: list[Ticket] = field(default_factory=list)
    obligations: list[Ticket] = field(default_factory=list)
    asset_issuer_id: AgentId | None = None
    defaulted: bool = False

    def payment_due(self, day: int) -> Decimal:
        """
        Calculate total payment obligations due on a given day.

        Args:
            day: Day to check for maturity obligations

        Returns:
            Total face value of tickets maturing on this day
        """
        return sum(
            ticket.face
            for ticket in self.obligations
            if ticket.maturity_day == day
        )

    def shortfall(self, day: int) -> Decimal:
        """
        Calculate payment shortfall on a given day.

        Args:
            day: Day to check for shortfall

        Returns:
            max(0, payment_due - cash)
        """
        due = self.payment_due(day)
        return max(Decimal(0), due - self.cash)

    def earliest_liability_day(self, after_day: int) -> int | None:
        """
        Find the earliest liability date after the given day.

        Args:
            after_day: Find liabilities strictly after this day

        Returns:
            Earliest maturity day > after_day, or None if no future liabilities
        """
        future_days = [
            ticket.maturity_day
            for ticket in self.obligations
            if ticket.maturity_day > after_day
        ]
        return min(future_days) if future_days else None

```

---

### 📄 src/bilancio/dealer/report.py

```python
"""HTML report generation for dealer ring simulations."""

from dataclasses import dataclass
from decimal import Decimal
from pathlib import Path
from typing import Any, TYPE_CHECKING
import html

if TYPE_CHECKING:
    from .simulation import DealerRingConfig, DaySnapshot


def _load_base_css() -> str:
    """Load CSS from assets/export.css."""
    css_path = Path(__file__).parent.parent / "ui" / "assets" / "export.css"
    return css_path.read_text()


def _get_dealer_css() -> str:
    """Return dealer-specific CSS extensions."""
    return """
/* Dealer card styling */
.dealer-card {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.dealer-card h3 {
  color: #1e40af;
  margin-bottom: 16px;
  border-bottom: 2px solid #dbeafe;
  padding-bottom: 8px;
}
.params-table {
  width: 100%;
  border-collapse: collapse;
}
.params-table th {
  text-align: left;
  padding: 6px 12px;
  color: #64748b;
  font-weight: 500;
  width: 40%;
}
.params-table td {
  text-align: right;
  padding: 6px 12px;
  font-family: 'SF Mono', Monaco, monospace;
  color: #1f2937;
}
.params-table tr.section-header th {
  color: #374151;
  font-weight: 600;
  padding-top: 12px;
  border-bottom: 1px solid #e5e7eb;
}
/* VBT card */
.vbt-card {
  background: linear-gradient(135deg, #f0fdf4, #fff);
  border-left: 4px solid #16a34a;
}
.vbt-card h3 {
  color: #16a34a;
  border-bottom-color: #bbf7d0;
}
/* Event type colors */
.event-trade { color: #3b82f6; }
.event-passthrough { color: #8b5cf6; }
.event-rebucket { color: #f59e0b; }
.event-settlement { color: #16a34a; }
.event-default { color: #dc2626; }
.event-quote { color: #64748b; }
.event-vbt-anchor-update { color: #14b8a6; }
/* Pin indicators */
.pin-indicator {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-left: 4px;
}
.pin-indicator.pinned { background: #f59e0b; }
.pin-indicator.not-pinned { background: #d1d5db; }
/* Grid layouts */
.dealers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-bottom: 24px;
}
.traders-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 20px;
}
/* Inventory list */
.inventory-list {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #e5e7eb;
}
.inventory-list h4 {
  color: #64748b;
  font-size: 14px;
  margin-bottom: 8px;
}
.inventory-list ul {
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 13px;
}
.inventory-list li {
  padding: 4px 0;
  color: #4b5563;
  font-family: 'SF Mono', Monaco, monospace;
}
"""


def _html_escape(value: Any) -> str:
    """HTML escape for safe display."""
    return html.escape(str(value))


def _fmt_decimal(d: Decimal | float | int | str | None, precision: int = 4) -> str:
    """Format Decimal trimming trailing zeros."""
    if d is None:
        return "—"
    if isinstance(d, str):
        try:
            d = Decimal(d)
        except Exception:
            return d
    if isinstance(d, (int, float)):
        d = Decimal(str(d))
    # Format with requested precision, then strip trailing zeros
    formatted = f"{d:.{precision}f}".rstrip('0').rstrip('.')
    return formatted


def _render_header(config: "DealerRingConfig", snapshots: list, title: str, subtitle: str) -> str:
    """Render header with config summary."""
    num_days = len(snapshots) - 1 if snapshots else 0  # -1 because Day 0 is setup
    num_buckets = len(config.buckets)
    num_traders = len(snapshots[0].traders) if snapshots else 0

    # Count total tickets
    total_tickets = len(snapshots[0].tickets) if snapshots else 0

    # Get bucket names
    bucket_names = ", ".join(b.name for b in config.buckets)

    # Ticket size
    ticket_size = _fmt_decimal(config.ticket_size)

    return f"""
<header>
  <h1>{_html_escape(title)}</h1>
  <p class="description">{_html_escape(subtitle)}</p>
  <div class="meta">
    <span><strong>Days:</strong> {num_days}</span>
    <span><strong>Buckets:</strong> {bucket_names}</span>
    <span><strong>Traders:</strong> {num_traders}</span>
    <span><strong>Tickets:</strong> {total_tickets}</span>
    <span><strong>Ticket Size (S):</strong> {ticket_size}</span>
  </div>
</header>
"""


def _render_events_table(events: list[dict], table_title: str) -> str:
    """Render events table for a day."""
    # Filter out day_start events
    display_events = [e for e in events if e.get('kind') != 'day_start']

    if not display_events:
        return f"""
<div class="events-table">
  <h3>{_html_escape(table_title)}</h3>
  <p style="color: #9ca3af; font-style: italic;">No events for this day</p>
</div>
"""

    rows = []
    for event in display_events:
        kind = event.get('kind', 'unknown')

        # Determine CSS class for event type
        css_class = f"event-{kind.replace('_', '-')}"

        # Check for passthrough trades
        if kind == 'trade' and event.get('is_passthrough'):
            css_class = "event-passthrough"

        # Format details based on event kind
        if kind == 'trade':
            side = event.get('side', '')
            price = _fmt_decimal(event.get('price'))
            bucket = event.get('bucket', '')
            is_passthrough = event.get('is_passthrough', False)
            trader_id = event.get('trader_id', '')[:20]
            ticket_id = event.get('ticket_id', '')
            details = f"{side} @ {price} [{bucket}]"
            notes = f"trader: {trader_id}, ticket: {ticket_id}"
            if is_passthrough:
                notes += " (passthrough to VBT)"
        elif kind == 'rebucket':
            old_bucket = event.get('old_bucket', '')
            new_bucket = event.get('new_bucket', '')
            price = _fmt_decimal(event.get('price'))
            holder_type = event.get('holder_type', '')
            ticket_id = event.get('ticket_id', '')
            details = f"{old_bucket} → {new_bucket} @ {price}"
            notes = f"{holder_type} ticket {ticket_id}"
        elif kind == 'settlement':
            issuer = event.get('issuer_id', '')[:20]
            total_paid = _fmt_decimal(event.get('total_paid'), 2)
            n_tickets = event.get('n_tickets', 0)
            details = f"Paid {total_paid} on {n_tickets} tickets"
            notes = f"issuer: {issuer}"
        elif kind == 'default':
            issuer = event.get('issuer_id', '')[:20]
            recovery_rate = _fmt_decimal(event.get('recovery_rate'), 2)
            total_due = _fmt_decimal(event.get('total_due'), 2)
            total_paid = _fmt_decimal(event.get('total_paid'), 2)
            bucket = event.get('bucket', '')
            details = f"Recovery {recovery_rate} (due: {total_due}, paid: {total_paid})"
            notes = f"issuer: {issuer}, bucket: {bucket}"
        elif kind == 'quote':
            bucket = event.get('bucket', '')
            dealer_bid = _fmt_decimal(event.get('dealer_bid'))
            dealer_ask = _fmt_decimal(event.get('dealer_ask'))
            vbt_bid = _fmt_decimal(event.get('vbt_bid'))
            vbt_ask = _fmt_decimal(event.get('vbt_ask'))
            inventory = event.get('inventory', 0)
            capacity = _fmt_decimal(event.get('capacity'))
            details = f"[{bucket}] D: {dealer_bid}/{dealer_ask}, VBT: {vbt_bid}/{vbt_ask}"
            notes = f"inv={inventory}, cap={capacity}"
        elif kind == 'vbt_anchor_update':
            bucket = event.get('bucket', '')
            M_old = _fmt_decimal(event.get('M_old'))
            M_new = _fmt_decimal(event.get('M_new'))
            O_old = _fmt_decimal(event.get('O_old'))
            O_new = _fmt_decimal(event.get('O_new'))
            loss_rate = _fmt_decimal(event.get('loss_rate'), 4)
            details = f"[{bucket}] M: {M_old}→{M_new}, O: {O_old}→{O_new}"
            notes = f"loss rate: {loss_rate}"
        else:
            details = str(event)
            notes = ''

        rows.append(f"""
          <tr>
            <td class="{css_class}">{_html_escape(kind)}</td>
            <td>{_html_escape(details)}</td>
            <td class="notes">{_html_escape(notes)}</td>
          </tr>
        """)

    return f"""
<div class="events-table">
  <h3>{_html_escape(table_title)}</h3>
  <table>
    <thead>
      <tr>
        <th style="width: 120px;">Kind</th>
        <th>Details</th>
        <th style="width: 200px;">Notes</th>
      </tr>
    </thead>
    <tbody>
      {''.join(rows)}
    </tbody>
  </table>
</div>
"""


def _render_dealer_card(dealer_dict: dict, vbt_dict: dict) -> str:
    """Render dealer state card with kernel params."""
    bucket_id = dealer_dict.get('bucket_id', 'unknown')

    # Inventory
    a = dealer_dict.get('a', 0)
    x = _fmt_decimal(dealer_dict.get('x'))
    cash = _fmt_decimal(dealer_dict.get('cash'))
    V = _fmt_decimal(dealer_dict.get('V'))

    # Capacity
    K_star = dealer_dict.get('K_star', 0)
    X_star = _fmt_decimal(dealer_dict.get('X_star'))
    N = dealer_dict.get('N', 0)
    lambda_ = _fmt_decimal(dealer_dict.get('lambda_'))

    # Quotes
    I = _fmt_decimal(dealer_dict.get('I'))
    midline = _fmt_decimal(dealer_dict.get('midline'))
    bid = _fmt_decimal(dealer_dict.get('bid'))
    ask = _fmt_decimal(dealer_dict.get('ask'))

    # Pin flags
    is_pinned_bid = dealer_dict.get('is_pinned_bid', False)
    is_pinned_ask = dealer_dict.get('is_pinned_ask', False)
    pin_bid_class = "pinned" if is_pinned_bid else "not-pinned"
    pin_ask_class = "pinned" if is_pinned_ask else "not-pinned"

    # Inventory list
    inventory = dealer_dict.get('inventory', [])
    inventory_items = []
    for t in inventory:
        tid = t.get('id', '?')
        issuer = t.get('issuer_id', '?')[:15]
        face = _fmt_decimal(t.get('face'), 2)
        tau = t.get('remaining_tau', '?')
        inventory_items.append(f"<li>{tid} (issuer: {issuer}, face: {face}, τ: {tau})</li>")

    inventory_html = ""
    if inventory_items:
        inventory_html = f"""
  <div class="inventory-list">
    <h4>Inventory ({len(inventory)} tickets)</h4>
    <ul>
      {''.join(inventory_items)}
    </ul>
  </div>
"""

    return f"""
<div class="dealer-card">
  <h3>Dealer: {_html_escape(bucket_id.upper())}</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>{a}</td></tr>
      <tr><th>Face inventory (x)</th><td>{x}</td></tr>
      <tr><th>Cash (C)</th><td>{cash}</td></tr>
      <tr><th>Mid-valued (V)</th><td>{V}</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>{K_star}</td></tr>
      <tr><th>One-sided cap (X*)</th><td>{X_star}</td></tr>
      <tr><th>Ladder rungs (N)</th><td>{N}</td></tr>
      <tr><th>Layoff prob (λ)</th><td>{lambda_}</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>{I}</td></tr>
      <tr><th>Midline p(x)</th><td>{midline}</td></tr>
      <tr><th>Bid <span class="pin-indicator {pin_bid_class}" title="{'Pinned at VBT bid' if is_pinned_bid else 'Not pinned'}"></span></th><td>{bid}</td></tr>
      <tr><th>Ask <span class="pin-indicator {pin_ask_class}" title="{'Pinned at VBT ask' if is_pinned_ask else 'Not pinned'}"></span></th><td>{ask}</td></tr>
    </tbody>
  </table>
  {inventory_html}
</div>
"""


def _render_vbt_card(vbt_dict: dict) -> str:
    """Render VBT state card."""
    bucket_id = vbt_dict.get('bucket_id', 'unknown')
    M = _fmt_decimal(vbt_dict.get('M'))
    O = _fmt_decimal(vbt_dict.get('O'))
    A = _fmt_decimal(vbt_dict.get('A'))
    B = _fmt_decimal(vbt_dict.get('B'))
    cash = _fmt_decimal(vbt_dict.get('cash'))

    # Inventory
    inventory = vbt_dict.get('inventory', [])
    inv_count = len(inventory)

    return f"""
<div class="dealer-card vbt-card">
  <h3>VBT: {_html_escape(bucket_id.upper())}</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>{M}</td></tr>
      <tr><th>Spread anchor (O)</th><td>{O}</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>{A}</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>{B}</td></tr>
      <tr><th>Cash</th><td>{cash}</td></tr>
      <tr><th>Inventory</th><td>{inv_count} tickets</td></tr>
    </tbody>
  </table>
</div>
"""


def _render_trader_balance(trader_dict: dict) -> str:
    """Render trader T-account balance sheet."""
    agent_id = trader_dict.get('agent_id', 'unknown')
    cash = trader_dict.get('cash', 0)
    defaulted = trader_dict.get('defaulted', False)

    # Status indicator
    status_badge = ""
    if defaulted:
        status_badge = '<span style="color: #dc2626; font-weight: 600;"> [DEFAULTED]</span>'

    # Build assets side (Cash + Tickets owned)
    tickets_owned = trader_dict.get('tickets_owned', [])
    assets_rows = [f"""
      <tr>
        <td class="name">Cash</td>
        <td class="val">{_fmt_decimal(cash, 2)}</td>
      </tr>
    """]

    total_ticket_face = Decimal(0)
    for ticket in tickets_owned:
        face = ticket.get('face', 0)
        if isinstance(face, str):
            face = Decimal(face)
        total_ticket_face += face
        tid = ticket.get('id', '?')
        issuer = _html_escape(ticket.get('issuer_id', '?')[:12])
        bucket = _html_escape(ticket.get('bucket_id', '?'))
        tau = ticket.get('remaining_tau', '?')
        assets_rows.append(f"""
      <tr>
        <td class="name">{_html_escape(tid)}</td>
        <td class="val">{_fmt_decimal(face, 2)} <span style="color: #9ca3af; font-size: 12px;">({issuer}, τ={tau})</span></td>
      </tr>
        """)

    if not tickets_owned:
        assets_rows.append("""
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        """)

    # Build liabilities side (Obligations)
    obligations = trader_dict.get('obligations', [])
    liabilities_rows = []

    total_obligations = Decimal(0)
    for obligation in obligations:
        face = obligation.get('face', 0)
        if isinstance(face, str):
            face = Decimal(face)
        total_obligations += face
        tid = obligation.get('id', '?')
        owner = _html_escape(obligation.get('owner_id', '?')[:12])
        maturity = obligation.get('maturity_day', '?')
        liabilities_rows.append(f"""
      <tr>
        <td class="name">{_html_escape(tid)}</td>
        <td class="val">{_fmt_decimal(face, 2)} <span style="color: #9ca3af; font-size: 12px;">(to {owner}, mat={maturity})</span></td>
      </tr>
        """)

    if not obligations:
        liabilities_rows.append("""
      <tr>
        <td colspan="2" class="empty">No obligations</td>
      </tr>
        """)

    # Calculate totals
    if isinstance(cash, str):
        cash = Decimal(cash)
    total_assets = cash + total_ticket_face

    return f"""
<div class="t-account">
  <h3>{_html_escape(agent_id)}{status_badge}</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets ({_fmt_decimal(total_assets, 2)})</h4>
      <table class="side">
        <tbody>
          {''.join(assets_rows)}
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities ({_fmt_decimal(total_obligations, 2)})</h4>
      <table class="side">
        <tbody>
          {''.join(liabilities_rows)}
        </tbody>
      </table>
    </div>
  </div>
</div>
"""


def _render_day_section(snapshot: "DaySnapshot", is_setup: bool = False) -> str:
    """Render complete day section."""
    day = snapshot.day

    # Day header
    if is_setup:
        day_title = "Day 0 (Setup)"
        day_emoji = "🏁"
    else:
        day_title = f"Day {day}"
        day_emoji = "📅"

    # Events table
    events_html = _render_events_table(snapshot.events, f"{day_title} Events")

    # Dealers and VBTs grid
    dealer_cards = []
    vbt_cards = []
    # Sort by bucket order: short, mid, long
    bucket_order = {"short": 0, "mid": 1, "long": 2}
    sorted_buckets = sorted(snapshot.dealers.keys(), key=lambda x: bucket_order.get(x, 99))

    for bucket_id in sorted_buckets:
        dealer_dict = snapshot.dealers[bucket_id]
        vbt_dict = snapshot.vbts.get(bucket_id, {})
        dealer_cards.append(_render_dealer_card(dealer_dict, vbt_dict))
        vbt_cards.append(_render_vbt_card(vbt_dict))

    # Traders grid
    trader_cards = []
    for agent_id in sorted(snapshot.traders.keys()):
        trader_dict = snapshot.traders[agent_id]
        trader_cards.append(_render_trader_balance(trader_dict))

    # Only show trader section if there are traders
    traders_html = ""
    if trader_cards:
        traders_html = f"""
  <div class="balances-section">
    <h3>Trader Balances</h3>
    <div class="traders-grid">
      {''.join(trader_cards)}
    </div>
  </div>
"""

    return f"""
<section class="day-section">
  <h2 class="day-header">{day_emoji} {day_title}</h2>

  {events_html}

  <div class="balances-section">
    <h3>Market State</h3>
    <div class="dealers-grid">
      {''.join(dealer_cards)}
    </div>
    <div class="dealers-grid">
      {''.join(vbt_cards)}
    </div>
  </div>

  {traders_html}
</section>
"""


def generate_dealer_ring_html(
    snapshots: list["DaySnapshot"],
    config: "DealerRingConfig",
    title: str | None = None,
    subtitle: str | None = None,
) -> str:
    """Generate complete HTML report for dealer ring simulation.

    Args:
        snapshots: List of DaySnapshot objects, one per day (Day 0 = setup)
        config: DealerRingConfig with simulation parameters
        title: Report title (default: "Dealer Ring Simulation")
        subtitle: Report subtitle (default: simulation description)

    Returns:
        Complete HTML document as string
    """
    if title is None:
        title = "Dealer Ring Simulation"
    if subtitle is None:
        subtitle = "Market making with virtual balance table anchors"

    base_css = _load_base_css()
    dealer_css = _get_dealer_css()
    header_html = _render_header(config, snapshots, title, subtitle)

    # Render each day
    day_sections = []
    for i, snapshot in enumerate(snapshots):
        is_setup = (i == 0 and snapshot.day == 0)
        day_sections.append(_render_day_section(snapshot, is_setup=is_setup))

    return f"""<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{_html_escape(title)}</title>
  <style>
{base_css}
{dealer_css}
  </style>
</head>
<body>
  <div class="container">
    {header_html}

    <main>
      {''.join(day_sections)}
    </main>

    <footer>
      Generated by bilancio dealer ring simulation
    </footer>
  </div>
</body>
</html>
"""


def export_dealer_ring_html(
    snapshots: list["DaySnapshot"],
    config: "DealerRingConfig",
    path: str | Path,
    title: str | None = None,
    subtitle: str | None = None,
) -> None:
    """Export dealer ring simulation to HTML file.

    Args:
        snapshots: List of DaySnapshot objects, one per day
        config: DealerRingConfig with simulation parameters
        path: Output file path
        title: Report title
        subtitle: Report subtitle
    """
    html_content = generate_dealer_ring_html(snapshots, config, title, subtitle)
    path = Path(path)
    path.parent.mkdir(parents=True, exist_ok=True)
    path.write_text(html_content)

```

---

### 📄 src/bilancio/dealer/simulation.py

```python
"""
Dealer ring simulation orchestrator.

This module implements the full dealer ring event loop per Section 11 of the
specification. It coordinates all components of the dealer system:

- Ticket maturity updates and rebucketing (Phase 1)
- Dealer pre-computation (Phase 2)
- Trading eligibility sets (Phase 3)
- Randomized order flow (Phase 4)
- Settlement with proportional recovery (Phase 5)
- VBT anchor updates (Phase 6)

The simulation uses Decimal throughout for precision and implements all
programmatic assertions (C1-C6) to ensure correctness.

References:
- Specification Section 11: Full Event Loop
- Specification Section 10: Ring Trader Policies
"""

from dataclasses import dataclass, field
from decimal import Decimal, ROUND_HALF_UP
import random
from copy import deepcopy

# Cash precision for settlement calculations to avoid floating-point accumulation errors
# Uses 6 decimal places which is standard for financial calculations
CASH_PRECISION = Decimal("0.000001")

from bilancio.core.ids import AgentId, new_id
from .models import (
    Ticket, DealerState, VBTState, TraderState,
    BucketConfig, DEFAULT_BUCKETS, TicketId,
)
from .kernel import KernelParams, recompute_dealer_state
from .trading import TradeExecutor
from .events import EventLog
from .assertions import run_all_assertions, assert_c6_anchor_timing


@dataclass
class DaySnapshot:
    """
    Snapshot of simulation state at end of day.

    Captures deep copies of all mutable state for reporting.

    Attributes:
        day: Day number (0 for initial setup, 1+ for each run_day)
        dealers: Per-bucket dealer states as serializable dicts
        vbts: Per-bucket VBT states as serializable dicts
        traders: Trader states as serializable dicts
        tickets: All tickets as serializable dicts
        events: Events that occurred on this day
    """
    day: int
    dealers: dict[str, dict]  # bucket_id -> dealer state dict
    vbts: dict[str, dict]      # bucket_id -> VBT state dict
    traders: dict[str, dict]   # agent_id -> trader state dict
    tickets: dict[str, dict]   # ticket_id -> ticket dict
    events: list[dict]         # Events for this day only


@dataclass
class DealerRingConfig:
    """
    Configuration for dealer ring simulation.

    Attributes:
        ticket_size: Standard ticket size S (face value)
        buckets: List of maturity bucket configurations
        vbt_anchors: VBT anchors per bucket {bucket_name: (M, O)}
        phi_M: VBT mid sensitivity to loss
        phi_O: VBT spread sensitivity to loss
        M_min: Guard threshold for dealer collapse
        clip_nonneg_B: Clip VBT bid to be non-negative
        pi_sell: Probability that next arrival is SELL (vs BUY)
        N_max: Maximum arrivals per period
        horizon_H: Minimum days to liability for buy eligibility
        buffer_B: Cash buffer for buy eligibility
        dealer_share: Initial ticket allocation to dealers (0-1)
        vbt_share: Initial ticket allocation to VBTs (0-1)
        seed: Random seed for reproducibility
        max_days: Default simulation duration
        enable_vbt_anchor_updates: Whether to update VBT anchors based on losses

    References:
        - Section 8: Kernel parameters (ticket_size, M_min)
        - Section 9: VBT anchor parameters (phi_M, phi_O)
        - Section 10: Trading policies (horizon_H, buffer_B)
        - Section 11: Order flow (pi_sell, N_max)
    """
    # Tickets
    ticket_size: Decimal = Decimal(1)  # S

    # Buckets
    buckets: list[BucketConfig] = field(default_factory=lambda: list(DEFAULT_BUCKETS))

    # VBT anchors per bucket: {bucket_name: (M, O)}
    vbt_anchors: dict[str, tuple[Decimal, Decimal]] = field(default_factory=lambda: {
        "short": (Decimal(1), Decimal("0.20")),
        "mid": (Decimal(1), Decimal("0.30")),
        "long": (Decimal(1), Decimal("0.40")),
    })

    # VBT sensitivity
    phi_M: Decimal = Decimal(1)
    phi_O: Decimal = Decimal("0.6")

    # Guard threshold
    M_min: Decimal = Decimal("0.02")
    clip_nonneg_B: bool = True

    # Order flow
    pi_sell: Decimal = Decimal("0.5")  # P(next arrival is SELL)
    N_max: int = 3  # Max arrivals per period

    # Trader policies
    horizon_H: int = 3  # Min days to liability for investment
    buffer_B: Decimal = Decimal(1)  # Cash buffer for investment eligibility

    # Initial allocation (for setup)
    dealer_share: Decimal = Decimal("0.25")
    vbt_share: Decimal = Decimal("0.50")

    # RNG
    seed: int = 42

    # Simulation control
    max_days: int = 30
    enable_vbt_anchor_updates: bool = True


class DealerRingSimulation:
    """
    Main simulation orchestrator for the dealer ring.

    Event loop per specification Section 11:
    1. Update maturities and buckets
    2. Dealer pre-computation (per bucket)
    3. Compute trading eligibility sets
    4. Randomized one-ticket order flow
    5. Settlement with proportional recovery
    6. VBT anchor update (if enabled)

    The simulation maintains:
    - Per-bucket dealers and VBTs (market makers)
    - Ring traders with single-issuer constraint
    - Global ticket registry
    - Event log for observability

    Attributes:
        config: Simulation configuration
        rng: Random number generator
        day: Current simulation day
        dealers: Per-bucket dealer states
        vbts: Per-bucket VBT states
        traders: Ring trader states
        all_tickets: Global ticket registry by ID
        events: Event log for observability
        params: Kernel parameters
        executor: Trade executor

    References:
        - Section 11: Full Event Loop
        - Section 10: Ring Trader Policies
    """

    def __init__(self, config: DealerRingConfig):
        """
        Initialize simulation orchestrator.

        Args:
            config: Simulation configuration
        """
        self.config = config
        self.rng = random.Random(config.seed)

        # State
        self.day: int = 0
        self.dealers: dict[str, DealerState] = {}  # bucket -> dealer
        self.vbts: dict[str, VBTState] = {}        # bucket -> VBT
        self.traders: dict[AgentId, TraderState] = {}
        self.all_tickets: dict[TicketId, Ticket] = {}  # Global ticket registry

        # Event log
        self.events = EventLog()

        # Snapshots for reporting
        self.snapshots: list[DaySnapshot] = []

        # Kernel params
        self.params = KernelParams(S=config.ticket_size)
        self.executor = TradeExecutor(self.params, self.rng)

        # Initialize dealers and VBTs
        self._init_market_makers()

    def _init_market_makers(self) -> None:
        """
        Initialize dealers and VBTs for each bucket.

        Creates one dealer and one VBT per bucket, with anchors from config.

        References:
            - Section 8: Dealer state initialization
            - Section 9: VBT anchor initialization
        """
        for bucket in self.config.buckets:
            bucket_id = bucket.name

            # Create dealer
            dealer = DealerState(
                bucket_id=bucket_id,
                agent_id=new_id(f"dealer_{bucket_id}"),
            )
            self.dealers[bucket_id] = dealer

            # Create VBT with configured anchors
            M, O = self.config.vbt_anchors.get(bucket_id, (Decimal(1), Decimal("0.30")))
            vbt = VBTState(
                bucket_id=bucket_id,
                agent_id=new_id(f"vbt_{bucket_id}"),
                M=M,
                O=O,
                phi_M=self.config.phi_M,
                phi_O=self.config.phi_O,
                O_min=Decimal(0),
                clip_nonneg_B=self.config.clip_nonneg_B,
            )
            vbt.recompute_quotes()
            self.vbts[bucket_id] = vbt

    def _capture_snapshot(self) -> None:
        """
        Capture deep copy of current state for reporting.

        Creates serializable dicts from all state objects.
        Called at end of setup and after each day.
        """
        # Serialize dealer states
        dealers_dict = {}
        for bucket_id, dealer in self.dealers.items():
            dealers_dict[bucket_id] = {
                "bucket_id": dealer.bucket_id,
                "agent_id": dealer.agent_id,
                "cash": dealer.cash,
                "a": dealer.a,
                "x": dealer.x,
                "V": dealer.V,
                "K_star": dealer.K_star,
                "X_star": dealer.X_star,
                "N": dealer.N,
                "lambda_": dealer.lambda_,
                "I": dealer.I,
                "midline": dealer.midline,
                "bid": dealer.bid,
                "ask": dealer.ask,
                "is_pinned_bid": dealer.is_pinned_bid,
                "is_pinned_ask": dealer.is_pinned_ask,
                "inventory": [
                    {"id": t.id, "issuer_id": t.issuer_id, "face": t.face, "remaining_tau": t.remaining_tau}
                    for t in dealer.inventory
                ],
            }

        # Serialize VBT states
        vbts_dict = {}
        for bucket_id, vbt in self.vbts.items():
            vbts_dict[bucket_id] = {
                "bucket_id": vbt.bucket_id,
                "agent_id": vbt.agent_id,
                "M": vbt.M,
                "O": vbt.O,
                "A": vbt.A,
                "B": vbt.B,
                "cash": vbt.cash,
                "inventory": [
                    {"id": t.id, "issuer_id": t.issuer_id, "face": t.face, "remaining_tau": t.remaining_tau}
                    for t in vbt.inventory
                ],
            }

        # Serialize trader states
        traders_dict = {}
        for agent_id, trader in self.traders.items():
            traders_dict[agent_id] = {
                "agent_id": trader.agent_id,
                "cash": trader.cash,
                "defaulted": trader.defaulted,
                "asset_issuer_id": trader.asset_issuer_id,
                "tickets_owned": [
                    {"id": t.id, "issuer_id": t.issuer_id, "face": t.face, "remaining_tau": t.remaining_tau, "bucket_id": t.bucket_id}
                    for t in trader.tickets_owned
                ],
                "obligations": [
                    {"id": t.id, "owner_id": t.owner_id, "face": t.face, "maturity_day": t.maturity_day}
                    for t in trader.obligations
                ],
            }

        # Serialize all tickets
        tickets_dict = {}
        for ticket_id, ticket in self.all_tickets.items():
            tickets_dict[ticket_id] = {
                "id": ticket.id,
                "issuer_id": ticket.issuer_id,
                "owner_id": ticket.owner_id,
                "face": ticket.face,
                "maturity_day": ticket.maturity_day,
                "remaining_tau": ticket.remaining_tau,
                "bucket_id": ticket.bucket_id,
            }

        # Get events for this day only
        day_events = [e for e in self.events.events if e.get("day") == self.day]

        snapshot = DaySnapshot(
            day=self.day,
            dealers=dealers_dict,
            vbts=vbts_dict,
            traders=traders_dict,
            tickets=tickets_dict,
            events=day_events,
        )
        self.snapshots.append(snapshot)

    def setup_ring(
        self,
        traders: list[TraderState],
        tickets: list[Ticket],
    ) -> None:
        """
        Set up the ring with traders and initial tickets.

        Allocates tickets to dealers/VBTs/traders per dealer_share/vbt_share.
        All tickets must have maturity_day and remaining_tau set.

        Allocation strategy:
        - dealer_share fraction goes to dealers (by bucket)
        - vbt_share fraction goes to VBTs (by bucket)
        - Remainder goes to traders (owners = issuers' assets)

        Args:
            traders: List of trader states (registers them in the simulation)
            tickets: List of tickets to allocate (must be bucketed)

        References:
            - Section 11: Initial setup before event loop
        """
        # Register traders
        for trader in traders:
            self.traders[trader.agent_id] = trader

        # Register tickets and assign buckets
        for ticket in tickets:
            self.all_tickets[ticket.id] = ticket

            # Determine bucket based on remaining maturity
            ticket.bucket_id = self._compute_bucket(ticket.remaining_tau)

            if ticket.bucket_id is None:
                raise ValueError(
                    f"Ticket {ticket.id} has remaining_tau={ticket.remaining_tau} "
                    f"which does not fit any configured bucket. "
                    f"Buckets: {[(b.name, b.tau_min, b.tau_max) for b in self.config.buckets]}"
                )

        # Sort tickets by bucket for allocation
        tickets_by_bucket: dict[str, list[Ticket]] = {}
        for ticket in tickets:
            bucket_id = ticket.bucket_id
            if bucket_id not in tickets_by_bucket:
                tickets_by_bucket[bucket_id] = []
            tickets_by_bucket[bucket_id].append(ticket)

        # Allocate tickets to dealers, VBTs, and traders
        for bucket_id, bucket_tickets in tickets_by_bucket.items():
            n_total = len(bucket_tickets)

            # Compute allocation counts
            n_dealer = int(n_total * self.config.dealer_share)
            n_vbt = int(n_total * self.config.vbt_share)
            n_trader = n_total - n_dealer - n_vbt  # Remainder to traders

            # Allocate to dealer
            dealer = self.dealers[bucket_id]
            for i in range(n_dealer):
                ticket = bucket_tickets[i]
                ticket.owner_id = dealer.agent_id
                dealer.inventory.append(ticket)

            # Allocate to VBT
            vbt = self.vbts[bucket_id]
            for i in range(n_dealer, n_dealer + n_vbt):
                ticket = bucket_tickets[i]
                ticket.owner_id = vbt.agent_id
                vbt.inventory.append(ticket)

            # Allocate to traders (owner = issuer for initial distribution)
            for i in range(n_dealer + n_vbt, n_total):
                ticket = bucket_tickets[i]
                issuer_id = ticket.issuer_id

                if issuer_id not in self.traders:
                    raise ValueError(
                        f"Ticket {ticket.id} has issuer_id {issuer_id} "
                        f"which is not a registered trader."
                    )

                trader = self.traders[issuer_id]
                ticket.owner_id = issuer_id
                trader.tickets_owned.append(ticket)

                # Set asset issuer constraint
                if trader.asset_issuer_id is None:
                    trader.asset_issuer_id = issuer_id

        # Recompute dealer states after initial allocation
        for bucket_id in self.dealers:
            recompute_dealer_state(
                self.dealers[bucket_id],
                self.vbts[bucket_id],
                self.params,
            )

        # Capture initial state snapshot (Day 0)
        self._capture_snapshot()

    def run_day(self) -> None:
        """
        Execute one simulation day (Section 11 event loop).

        Event loop phases:
        1. Update maturities and buckets
        2. Dealer pre-computation (per bucket)
        3. Compute trading eligibility sets
        4. Randomized order flow
        5. Settlement with proportional recovery
        6. VBT anchor update (if enabled)

        References:
            - Section 11: Full Event Loop
        """
        self.day += 1
        self.events.log_day_start(self.day)

        # Phase 1: Update maturities and buckets
        self._update_maturities()
        self._rebucket_tickets()

        # Phase 2: Dealer pre-computation
        for bucket_id in self.dealers:
            recompute_dealer_state(
                self.dealers[bucket_id],
                self.vbts[bucket_id],
                self.params,
            )
            # Log quotes for observability
            self._log_quotes(bucket_id)

        # Phase 3: Compute eligibility sets
        sell_eligible = self._compute_sell_eligible()
        buy_eligible = self._compute_buy_eligible()

        # Phase 4: Randomized order flow
        self._process_order_flow(sell_eligible, buy_eligible)

        # Phase 5: Settlement
        self._settle_maturing_debt()

        # Phase 6: VBT anchor update
        if self.config.enable_vbt_anchor_updates:
            self._update_vbt_anchors()

        # Capture end-of-day snapshot
        self._capture_snapshot()

    def run(self, max_days: int | None = None) -> None:
        """
        Run simulation for specified days.

        Args:
            max_days: Number of days to simulate (defaults to config.max_days)
        """
        days = max_days or self.config.max_days
        for _ in range(days):
            self.run_day()

    # =====================================================================
    # Phase 1: Update maturities and rebucket
    # =====================================================================

    def _update_maturities(self) -> None:
        """
        Decrement remaining_tau for all tickets.

        This reflects the passage of one day. Tickets with remaining_tau
        reaching 0 will mature during settlement (Phase 5).

        References:
            - Section 11.1: Maturity updates
        """
        for ticket in self.all_tickets.values():
            if ticket.remaining_tau > 0:
                ticket.remaining_tau -= 1

    def _rebucket_tickets(self) -> None:
        """
        Reassign bucket_id based on remaining_tau.

        If dealer/VBT holds migrating ticket, execute internal sale:
        - Event 11: Dealer-to-dealer internal sale at old-bucket ask
        - Event 12: VBT-to-VBT internal sale at VBT mid M

        References:
            - Section 11.1: Rebucketing logic
            - Section 6.11: Internal dealer sale
            - Section 6.12: Internal VBT sale
        """
        for ticket in self.all_tickets.values():
            old_bucket = ticket.bucket_id
            new_bucket = self._compute_bucket(ticket.remaining_tau)

            # Skip if bucket unchanged or ticket matured
            if new_bucket is None or new_bucket == old_bucket:
                continue

            # Check if dealer holds this ticket
            old_dealer = self.dealers.get(old_bucket)
            if old_dealer and ticket.owner_id == old_dealer.agent_id:
                self._rebucket_dealer_ticket(ticket, old_bucket, new_bucket)
                continue

            # Check if VBT holds this ticket
            old_vbt = self.vbts.get(old_bucket)
            if old_vbt and ticket.owner_id == old_vbt.agent_id:
                self._rebucket_vbt_ticket(ticket, old_bucket, new_bucket)
                continue

            # Trader-held ticket: just update bucket_id
            ticket.bucket_id = new_bucket

    def _compute_bucket(self, remaining_tau: int) -> str | None:
        """
        Determine bucket for given remaining maturity.

        Args:
            remaining_tau: Remaining days to maturity

        Returns:
            Bucket name, or None if ticket has matured (tau <= 0)

        References:
            - Section 11.1: Bucket assignment rules
        """
        if remaining_tau <= 0:
            return None

        for bucket in self.config.buckets:
            if bucket.tau_max is None:
                # Unbounded upper range
                if remaining_tau >= bucket.tau_min:
                    return bucket.name
            else:
                # Bounded range
                if bucket.tau_min <= remaining_tau <= bucket.tau_max:
                    return bucket.name

        # No bucket found - configuration error
        return None

    def _rebucket_dealer_ticket(
        self,
        ticket: Ticket,
        old_bucket: str,
        new_bucket: str,
    ) -> None:
        """
        Event 11: Internal sale from old-bucket dealer to new-bucket dealer.

        Transfer occurs at the receiving bucket's VBT mid anchor M. This
        preserves equity for both dealers (E = C + M*a is unchanged).

        Args:
            ticket: Ticket to transfer
            old_bucket: Source bucket
            new_bucket: Destination bucket

        References:
            - Section 6.11: Internal dealer sale
            - PDF spec: "internal sale at the Mid bucket mid M_M"
        """
        old_dealer = self.dealers[old_bucket]
        new_dealer = self.dealers[new_bucket]

        # Execute at receiving bucket's VBT mid anchor (preserves equity)
        price = self.vbts[new_bucket].M

        # Update balance sheets
        old_dealer.inventory.remove(ticket)
        old_dealer.cash += price

        new_dealer.inventory.append(ticket)
        new_dealer.cash -= price

        # Transfer ownership
        ticket.owner_id = new_dealer.agent_id
        ticket.bucket_id = new_bucket

        # Recompute both dealers
        recompute_dealer_state(old_dealer, self.vbts[old_bucket], self.params)
        recompute_dealer_state(new_dealer, self.vbts[new_bucket], self.params)

        # Log event
        self.events.log_rebucket(
            day=self.day,
            ticket_id=ticket.id,
            old_bucket=old_bucket,
            new_bucket=new_bucket,
            price=price,
            holder_type="dealer",
        )

    def _rebucket_vbt_ticket(
        self,
        ticket: Ticket,
        old_bucket: str,
        new_bucket: str,
    ) -> None:
        """
        Event 12: Internal sale from old-bucket VBT to new-bucket VBT.

        Transfer occurs at old-bucket VBT mid M. This implements VBT-to-VBT
        internal liquidity provision.

        Args:
            ticket: Ticket to transfer
            old_bucket: Source bucket
            new_bucket: Destination bucket

        References:
            - Section 6.12: Internal VBT sale
        """
        old_vbt = self.vbts[old_bucket]
        new_vbt = self.vbts[new_bucket]

        # Execute at old-bucket VBT mid
        price = old_vbt.M

        # Update balance sheets
        old_vbt.inventory.remove(ticket)
        old_vbt.cash += price

        new_vbt.inventory.append(ticket)
        new_vbt.cash -= price

        # Transfer ownership
        ticket.owner_id = new_vbt.agent_id
        ticket.bucket_id = new_bucket

        # Log event
        self.events.log_rebucket(
            day=self.day,
            ticket_id=ticket.id,
            old_bucket=old_bucket,
            new_bucket=new_bucket,
            price=price,
            holder_type="vbt",
        )

    # =====================================================================
    # Phase 2: Dealer pre-computation
    # =====================================================================

    def _log_quotes(self, bucket_id: str) -> None:
        """
        Log dealer quote state for observability.

        Args:
            bucket_id: Bucket identifier
        """
        dealer = self.dealers[bucket_id]
        vbt = self.vbts[bucket_id]

        self.events.log_quote(
            day=self.day,
            bucket=bucket_id,
            dealer_bid=dealer.bid,
            dealer_ask=dealer.ask,
            vbt_bid=vbt.B,
            vbt_ask=vbt.A,
            inventory=dealer.a,
            capacity=dealer.X_star,
            is_pinned_bid=dealer.is_pinned_bid,
            is_pinned_ask=dealer.is_pinned_ask,
        )

    # =====================================================================
    # Phase 3: Compute eligibility sets
    # =====================================================================

    def _compute_sell_eligible(self) -> set[AgentId]:
        """
        Traders with shortfall > 0 and at least one ticket owned.

        Sell eligibility reflects liquidity pressure: traders who face
        payment obligations today and own tickets they can sell.

        Returns:
            Set of agent IDs eligible to sell

        References:
            - Section 10.3: Sell eligibility rule
            - Section 11.3: Eligibility computation
        """
        eligible = set()
        for trader in self.traders.values():
            has_shortfall = trader.shortfall(self.day) > 0
            has_tickets = len(trader.tickets_owned) > 0

            if has_shortfall and has_tickets:
                eligible.add(trader.agent_id)

        return eligible

    def _compute_buy_eligible(self) -> set[AgentId]:
        """
        Traders with horizon >= H and cash > buffer.

        Buy eligibility reflects investment capacity: traders with sufficient
        cash buffer and distant enough liabilities to invest safely.

        The horizon H is defined as the number of days until the trader's
        next liability. If no future liabilities exist, horizon is infinite.

        Returns:
            Set of agent IDs eligible to buy

        References:
            - Section 10.4: Buy eligibility rule
            - Section 11.3: Eligibility computation
        """
        eligible = set()
        for trader in self.traders.values():
            # Check cash buffer
            has_buffer = trader.cash > self.config.buffer_B

            # Check horizon (days to next liability)
            next_liability_day = trader.earliest_liability_day(self.day)
            if next_liability_day is None:
                # No future liabilities - infinite horizon
                has_horizon = True
            else:
                horizon = next_liability_day - self.day
                has_horizon = horizon >= self.config.horizon_H

            if has_buffer and has_horizon:
                eligible.add(trader.agent_id)

        return eligible

    # =====================================================================
    # Phase 4: Randomized order flow
    # =====================================================================

    def _process_order_flow(
        self,
        sell_eligible: set[AgentId],
        buy_eligible: set[AgentId],
    ) -> None:
        """
        Randomized one-ticket order flow (Section 11, Step 4).

        For each arrival:
        1. Draw direction: SELL with probability pi_sell, BUY otherwise
        2. Sample uniformly from eligible set
        3. Execute one-ticket trade

        Number of arrivals is random up to N_max.

        Args:
            sell_eligible: Set of agents eligible to sell
            buy_eligible: Set of agents eligible to buy

        References:
            - Section 11.4: Order flow generation
        """
        # Determine number of arrivals (1 to N_max)
        if self.config.N_max <= 0:
            return  # No order flow
        n_arrivals = self.rng.randint(1, self.config.N_max)

        for _ in range(n_arrivals):
            # Draw direction
            is_sell = self.rng.random() < float(self.config.pi_sell)

            if is_sell:
                self._process_sell(sell_eligible)
            else:
                self._process_buy(buy_eligible)

    def _process_sell(self, eligible: set[AgentId]) -> None:
        """
        Process a SELL order from a randomly selected eligible trader.

        Args:
            eligible: Set of agent IDs eligible to sell

        References:
            - Section 11.4: SELL order processing
        """
        if not eligible:
            return  # No eligible sellers

        # Sample uniformly from eligible
        agent_id = self.rng.choice(list(eligible))
        trader = self.traders[agent_id]

        # Select ticket to sell (shortest maturity first)
        ticket = self._select_ticket_to_sell(trader)
        if ticket is None:
            return  # No ticket available (should not happen if eligible)

        # Determine bucket and execute trade
        bucket_id = ticket.bucket_id
        dealer = self.dealers[bucket_id]
        vbt = self.vbts[bucket_id]

        # Execute customer sell (trader sells to dealer)
        result = self.executor.execute_customer_sell(
            dealer=dealer,
            vbt=vbt,
            ticket=ticket,
            check_assertions=True,
        )

        # Update trader state
        trader.tickets_owned.remove(ticket)
        trader.cash += result.price

        # Update asset issuer constraint if no more tickets
        if len(trader.tickets_owned) == 0:
            trader.asset_issuer_id = None

        # Log trade
        self.events.log_trade(
            day=self.day,
            side="SELL",
            trader_id=agent_id,
            ticket_id=ticket.id,
            bucket=bucket_id,
            price=result.price,
            is_passthrough=result.is_passthrough,
        )

        # Remove from eligible set if no longer eligible
        if trader.shortfall(self.day) <= 0 or len(trader.tickets_owned) == 0:
            eligible.discard(agent_id)

    def _process_buy(self, eligible: set[AgentId]) -> None:
        """
        Process a BUY order from a randomly selected eligible trader.

        Args:
            eligible: Set of agent IDs eligible to buy

        References:
            - Section 11.4: BUY order processing
        """
        if not eligible:
            return  # No eligible buyers

        # Sample uniformly from eligible
        agent_id = self.rng.choice(list(eligible))
        trader = self.traders[agent_id]

        # Select bucket to buy from (Short -> Mid -> Long preference)
        bucket_id = self._select_bucket_to_buy(trader)
        if bucket_id is None:
            return  # No bucket available

        dealer = self.dealers[bucket_id]
        vbt = self.vbts[bucket_id]

        # Execute customer buy (trader buys from dealer)
        # Note: May fail if issuer preference cannot be satisfied
        try:
            result = self.executor.execute_customer_buy(
                dealer=dealer,
                vbt=vbt,
                buyer_id=agent_id,
                issuer_preference=trader.asset_issuer_id,
                check_assertions=True,
            )
        except ValueError as e:
            # Cannot satisfy single-issuer constraint - skip this trade
            # This happens when trader has asset_issuer_id set but neither
            # dealer nor VBT has tickets from that issuer
            return

        # Update trader state
        if result.ticket:
            trader.tickets_owned.append(result.ticket)
            trader.cash -= result.price

            # Set asset issuer constraint
            if trader.asset_issuer_id is None:
                trader.asset_issuer_id = result.ticket.issuer_id

        # Log trade
        if result.ticket:
            self.events.log_trade(
                day=self.day,
                side="BUY",
                trader_id=agent_id,
                ticket_id=result.ticket.id,
                bucket=bucket_id,
                price=result.price,
                is_passthrough=result.is_passthrough,
            )

        # Remove from eligible set if no longer eligible
        if trader.cash <= self.config.buffer_B:
            eligible.discard(agent_id)

    def _select_ticket_to_sell(self, trader: TraderState) -> Ticket | None:
        """
        Select ticket for trader to sell (shortest maturity first).

        Priority:
        1. Lowest remaining_tau (sell soonest-to-mature first)
        2. Lowest serial (deterministic tie-breaker)

        Args:
            trader: Trader state

        Returns:
            Selected ticket, or None if no tickets available

        References:
            - Section 10.3: Sell policy (shortest maturity first)
        """
        if not trader.tickets_owned:
            return None

        # Sort by (remaining_tau, serial) and return first
        return min(trader.tickets_owned, key=lambda t: (t.remaining_tau, t.serial))

    def _select_bucket_to_buy(self, trader: TraderState) -> str | None:
        """
        Select bucket to buy from (Short -> Mid -> Long preference).

        This implements a maturity preference: traders prefer shorter-maturity
        tickets for faster turnover and liquidity.

        Args:
            trader: Trader state

        Returns:
            Bucket name, or None if no buckets available

        References:
            - Section 10.4: Buy policy (maturity preference)
        """
        # Try buckets in order of preference
        for bucket in self.config.buckets:
            bucket_id = bucket.name

            # Check if dealer or VBT has inventory in this bucket
            dealer = self.dealers[bucket_id]
            vbt = self.vbts[bucket_id]

            if len(dealer.inventory) > 0 or len(vbt.inventory) > 0:
                return bucket_id

        return None

    # =====================================================================
    # Phase 5: Settlement with proportional recovery
    # =====================================================================

    def _settle_maturing_debt(self) -> None:
        """
        Settlement with proportional recovery (Section 11, Step 5).

        For each issuer with maturing tickets:
        1. Compute total obligations due
        2. Compute recovery rate R = min(1, cash / obligations)
        3. Pay proportional recovery to all holders
        4. Mark issuer as defaulted if R < 1

        References:
            - Section 11.5: Settlement phase
            - Section 6.6-6.8: Settlement events
        """
        # Group maturing tickets by issuer
        maturing_by_issuer: dict[AgentId, list[Ticket]] = {}

        for ticket in self.all_tickets.values():
            if ticket.maturity_day == self.day:
                issuer_id = ticket.issuer_id
                if issuer_id not in maturing_by_issuer:
                    maturing_by_issuer[issuer_id] = []
                maturing_by_issuer[issuer_id].append(ticket)

        # Settle each issuer
        for issuer_id, tickets in maturing_by_issuer.items():
            self._settle_issuer(issuer_id, tickets)

    def _settle_issuer(self, issuer_id: AgentId, tickets: list[Ticket]) -> None:
        """
        Settle all maturing tickets for one issuer.

        Implements proportional recovery:
        - R = min(1, cash / total_due)
        - Payment to each holder = R * face

        Args:
            issuer_id: Agent ID of issuer
            tickets: List of maturing tickets issued by this agent

        References:
            - Section 6.6: Full settlement (R = 1)
            - Section 6.7-6.8: Partial settlement (R < 1)
        """
        if issuer_id not in self.traders:
            raise ValueError(f"Issuer {issuer_id} is not a registered trader")

        issuer = self.traders[issuer_id]

        # Compute total obligations
        total_due = sum(ticket.face for ticket in tickets)

        # Compute recovery rate
        if total_due == 0:
            return  # No obligations

        recovery_rate = min(Decimal(1), issuer.cash / total_due)

        # Compute total payment - use exact value to avoid precision issues
        # When R < 1, total_paid equals issuer.cash exactly
        if recovery_rate < Decimal(1):
            total_paid = issuer.cash
        else:
            total_paid = total_due

        # Deduct from issuer cash
        issuer.cash -= total_paid

        # Distribute payments to holders using remainder-based allocation
        # to ensure total distributed equals total_paid exactly
        remaining = total_paid
        for i, ticket in enumerate(tickets):
            if i < len(tickets) - 1:
                # For all but last ticket: compute proportional payment and quantize
                payment = (recovery_rate * ticket.face).quantize(
                    CASH_PRECISION, rounding=ROUND_HALF_UP
                )
                remaining -= payment
            else:
                # Last ticket gets remainder to ensure exact balance
                payment = remaining
            self._pay_holder(ticket.owner_id, payment, ticket)

        # Log settlement or default
        if recovery_rate >= Decimal(1):
            # Full settlement
            self.events.log_settlement(
                day=self.day,
                issuer_id=issuer_id,
                total_paid=total_paid,
                n_tickets=len(tickets),
            )
        else:
            # Default with partial recovery
            issuer.defaulted = True

            # Group tickets by bucket for loss rate computation
            tickets_by_bucket: dict[str, list[Ticket]] = {}
            for ticket in tickets:
                bucket_id = ticket.bucket_id
                if bucket_id not in tickets_by_bucket:
                    tickets_by_bucket[bucket_id] = []
                tickets_by_bucket[bucket_id].append(ticket)

            # Log default per bucket
            for bucket_id, bucket_tickets in tickets_by_bucket.items():
                bucket_due = sum(t.face for t in bucket_tickets)
                bucket_paid = recovery_rate * bucket_due

                self.events.log_default(
                    day=self.day,
                    issuer_id=issuer_id,
                    recovery_rate=recovery_rate,
                    total_due=bucket_due,
                    total_paid=bucket_paid,
                    n_tickets=len(bucket_tickets),
                    bucket=bucket_id,
                )

        # Remove tickets from issuer's obligations
        for ticket in tickets:
            if ticket in issuer.obligations:
                issuer.obligations.remove(ticket)

    def _pay_holder(
        self,
        holder_id: AgentId,
        amount: Decimal,
        ticket: Ticket,
    ) -> None:
        """
        Credit payment to holder (trader, dealer, or VBT).

        Args:
            holder_id: Agent ID of ticket holder
            amount: Payment amount (may be partial if R < 1)
            ticket: Ticket being settled
        """
        # Check if holder is a trader
        if holder_id in self.traders:
            self.traders[holder_id].cash += amount
            # Quantize to avoid floating-point accumulation (e.g., 1/3 + 1/3 + 1/3 != 1)
            self.traders[holder_id].cash = self.traders[holder_id].cash.quantize(
                CASH_PRECISION, rounding=ROUND_HALF_UP
            )
            # Remove ticket from trader's owned tickets
            if ticket in self.traders[holder_id].tickets_owned:
                self.traders[holder_id].tickets_owned.remove(ticket)
            return

        # Check if holder is a dealer
        for dealer in self.dealers.values():
            if dealer.agent_id == holder_id:
                dealer.cash += amount
                # Quantize to avoid floating-point accumulation
                dealer.cash = dealer.cash.quantize(CASH_PRECISION, rounding=ROUND_HALF_UP)
                # Remove ticket from dealer inventory
                if ticket in dealer.inventory:
                    dealer.inventory.remove(ticket)
                return

        # Check if holder is a VBT
        for vbt in self.vbts.values():
            if vbt.agent_id == holder_id:
                vbt.cash += amount
                # Quantize to avoid floating-point accumulation
                vbt.cash = vbt.cash.quantize(CASH_PRECISION, rounding=ROUND_HALF_UP)
                # Remove ticket from VBT inventory
                if ticket in vbt.inventory:
                    vbt.inventory.remove(ticket)
                return

        raise ValueError(f"Holder {holder_id} not found in traders, dealers, or VBTs")

    # =====================================================================
    # Phase 6: VBT anchor updates
    # =====================================================================

    def _update_vbt_anchors(self) -> None:
        """
        Update VBT anchors based on bucket loss rates (Section 10).

        For each bucket:
        1. Compute loss rate from today's defaults
        2. Apply update rule: M -= phi_M * loss, O += phi_O * loss
        3. Recompute VBT quotes and dealer states

        References:
            - Section 9: Loss-based anchor updates
            - Section 11.6: Anchor update phase
        """
        for bucket_id in self.vbts:
            vbt = self.vbts[bucket_id]

            # Snapshot for C6 assertion
            M_old = vbt.M
            O_old = vbt.O

            # Compute loss rate from today's defaults
            loss_rate = self.events.get_bucket_loss_rate(self.day, bucket_id)

            if loss_rate > 0:
                # Apply update rule
                vbt.update_from_loss(loss_rate)

                # Log anchor update
                self.events.log_vbt_anchor_update(
                    day=self.day,
                    bucket=bucket_id,
                    M_old=M_old,
                    M_new=vbt.M,
                    O_old=O_old,
                    O_new=vbt.O,
                    loss_rate=loss_rate,
                )

                # Recompute dealer state with new anchors
                dealer = self.dealers[bucket_id]
                recompute_dealer_state(dealer, vbt, self.params)

    def to_html(
        self,
        path: "Path | str",
        title: str | None = None,
        subtitle: str | None = None,
    ) -> None:
        """
        Export simulation to HTML report.

        Args:
            path: Output file path
            title: Report title (default: "Dealer Ring Simulation")
            subtitle: Report subtitle (optional)
        """
        from .report import export_dealer_ring_html
        export_dealer_ring_html(
            snapshots=self.snapshots,
            config=self.config,
            path=path,
            title=title,
            subtitle=subtitle,
        )

```

---

### 📄 src/bilancio/dealer/trading.py

```python
"""
Trade execution logic for the dealer ring.

This module implements the TradeExecutor class, which handles customer trades
with dealers in the dealer ring model. It implements:

- Event 1: Customer SELL (interior) - Customer sells ticket to dealer
- Event 2: Customer BUY (interior) - Customer buys ticket from dealer
- Event 9: Customer SELL (passthrough) - Routed to VBT at outside bid B
- Event 10: Customer BUY (passthrough) - Routed to VBT at outside ask A

The executor determines whether trades can be executed by the dealer (interior)
or must be routed to the VBT (passthrough), executes balance sheet updates,
and enforces programmatic assertions C1, C3, and C4.

All arithmetic uses Decimal for precision - never float.

References:
- Specification Section 6: Event specifications
- Specification Section 8.6: Feasibility checks
- Examples Doc Section 1: Programmatic Assertions
"""

import random
from decimal import Decimal
from copy import deepcopy

from bilancio.core.ids import AgentId
from .models import DealerState, VBTState, Ticket
from .kernel import (
    recompute_dealer_state,
    can_interior_buy,
    can_interior_sell,
    KernelParams,
    ExecutionResult,
)
from .assertions import (
    assert_c1_double_entry,
    assert_c3_feasibility,
    assert_c4_passthrough_invariant,
)


class TradeExecutor:
    """
    Executes trades between customers and dealers.

    Implements Events 1-2 (interior trades) and Events 9-10 (passthrough)
    from the specification Section 6.

    The executor handles:
    1. Feasibility determination (interior vs passthrough)
    2. Balance sheet updates for dealers and VBT
    3. Ticket ownership transfers
    4. Quote recomputation after trades
    5. Programmatic assertion checking

    Attributes:
        params: Kernel parameters including ticket size S
        rng: Random number generator (currently unused, reserved for future stochastic features)

    References:
        - Specification Section 6.1-6.2: Interior trades (Events 1-2)
        - Specification Section 6.9-6.10: Passthrough trades (Events 9-10)
        - Specification Section 8.6: Feasibility checks
    """

    def __init__(self, params: KernelParams, rng: random.Random | None = None):
        """
        Initialize trade executor.

        Args:
            params: Kernel parameters including ticket size S
            rng: Optional random number generator (default: new Random instance)
        """
        self.params = params
        self.rng = rng or random.Random()

    def execute_customer_sell(
        self,
        dealer: DealerState,
        vbt: VBTState,
        ticket: Ticket,
        check_assertions: bool = True,
    ) -> ExecutionResult:
        """
        Customer sells ticket to dealer (dealer buys).

        Implements Event 1 (interior) or Event 9 (passthrough at outside bid).

        Flow:
        1. Check if interior BUY is feasible (can_interior_buy)
        2. If feasible: Execute at dealer bid b_c(x)
           - Dealer inventory increases by 1
           - Dealer cash decreases by price
           - Ticket ownership transfers to dealer
        3. If not feasible: Passthrough at outside bid B
           - VBT absorbs the ticket
           - Dealer state unchanged (C4 assertion)
        4. Recompute dealer quotes after trade
        5. Run C1 double-entry assertion

        Args:
            dealer: Dealer state (modified in-place)
            vbt: VBT state (modified in-place if passthrough)
            ticket: Ticket being sold by customer
            check_assertions: Whether to run assertions (default True)

        Returns:
            ExecutionResult with price, passthrough flag, and ticket

        References:
            - Event 1: Interior customer sell at b_c(x) (Section 6.1)
            - Event 9: Passthrough customer sell at B (Section 6.9)
            - Feasibility: Section 8.6
        """
        # Store customer ID before modifying ticket
        customer_id = ticket.owner_id

        # Determine if interior execution is feasible
        is_interior = can_interior_buy(dealer, self.params)

        if is_interior:
            # Event 1: Interior execution at dealer bid
            execution_price = dealer.bid

            # Pre-check feasibility (C3 assertion)
            if check_assertions:
                assert_c3_feasibility(dealer, side="BUY", params=self.params)

            # Update dealer balance sheet
            dealer.inventory.append(ticket)
            dealer.cash -= execution_price

            # Transfer ownership
            ticket.owner_id = dealer.agent_id

            # Recompute dealer state after trade
            recompute_dealer_state(dealer, vbt, self.params)

            # C1: Double-entry assertion
            if check_assertions:
                assert_c1_double_entry(
                    cash_changes={
                        customer_id: execution_price,    # Customer receives cash
                        dealer.agent_id: -execution_price,  # Dealer pays cash
                    },
                    qty_changes={
                        customer_id: -1,  # Customer gives ticket
                        dealer.agent_id: 1,  # Dealer receives ticket
                    }
                )

            return ExecutionResult(
                executed=True,
                price=execution_price,
                is_passthrough=False,
                ticket=ticket,
            )

        else:
            # Event 9: Passthrough to VBT at outside bid
            execution_price = vbt.B

            # Snapshot dealer state for C4 assertion
            if check_assertions:
                dealer_snapshot = deepcopy(dealer)

            # VBT absorbs the ticket
            vbt.inventory.append(ticket)
            vbt.cash -= execution_price

            # Transfer ownership to VBT
            ticket.owner_id = vbt.agent_id

            # Dealer state unchanged - recompute to update quotes based on VBT state
            # (VBT anchors may have changed, affecting dealer quotes)
            recompute_dealer_state(dealer, vbt, self.params)

            # C4: Verify dealer balance sheet unchanged
            if check_assertions:
                assert_c4_passthrough_invariant(dealer_snapshot, dealer)

            # C1: Double-entry assertion (dealer not involved in passthrough)
            if check_assertions:
                assert_c1_double_entry(
                    cash_changes={
                        customer_id: execution_price,  # Customer receives cash
                        vbt.agent_id: -execution_price,  # VBT pays cash
                    },
                    qty_changes={
                        customer_id: -1,  # Customer gives ticket
                        vbt.agent_id: 1,  # VBT receives ticket
                    }
                )

            return ExecutionResult(
                executed=True,
                price=execution_price,
                is_passthrough=True,
                ticket=ticket,
            )

    def execute_customer_buy(
        self,
        dealer: DealerState,
        vbt: VBTState,
        buyer_id: AgentId,
        issuer_preference: AgentId | None = None,
        check_assertions: bool = True,
    ) -> ExecutionResult:
        """
        Customer buys ticket from dealer (dealer sells).

        Implements Event 2 (interior) or Event 10 (passthrough at outside ask).

        Flow:
        1. Check if interior SELL is feasible (can_interior_sell - dealer has inventory)
        2. If feasible: Execute at dealer ask a_c(x)
           - Select ticket from dealer inventory (deterministic tie-breaker)
           - Dealer inventory decreases by 1
           - Dealer cash increases by price
           - Ticket ownership transfers to buyer
        3. If not feasible: Passthrough at outside ask A
           - VBT provides ticket
           - Dealer state unchanged (C4 assertion)
        4. Recompute dealer quotes after trade
        5. Run C1 double-entry assertion

        Ticket selection (deterministic tie-breaker):
        - Prefer issuer_preference if specified
        - Then lowest maturity_day
        - Then lowest serial number

        Args:
            dealer: Dealer state (modified in-place)
            vbt: VBT state (modified in-place if passthrough)
            buyer_id: Agent ID of the buyer
            issuer_preference: Optional preferred issuer (for single-issuer constraint)
            check_assertions: Whether to run assertions (default True)

        Returns:
            ExecutionResult with price, passthrough flag, and ticket

        References:
            - Event 2: Interior customer buy at a_c(x) (Section 6.2)
            - Event 10: Passthrough customer buy at A (Section 6.10)
            - Feasibility: Section 8.6
            - Tie-breaker: Section 6.2 (deterministic selection)
        """
        # Determine if interior execution is feasible
        is_interior = can_interior_sell(dealer, self.params)

        if is_interior:
            # Event 2: Interior execution at dealer ask
            execution_price = dealer.ask

            # Pre-check feasibility (C3 assertion)
            if check_assertions:
                assert_c3_feasibility(dealer, side="SELL", params=self.params)

            # Select ticket to sell using deterministic tie-breaker
            ticket = self._select_ticket_to_sell(dealer.inventory, issuer_preference)

            # Update dealer balance sheet
            dealer.inventory.remove(ticket)
            dealer.cash += execution_price

            # Transfer ownership
            ticket.owner_id = buyer_id

            # Recompute dealer state after trade
            recompute_dealer_state(dealer, vbt, self.params)

            # C1: Double-entry assertion
            if check_assertions:
                assert_c1_double_entry(
                    cash_changes={
                        buyer_id: -execution_price,  # Buyer pays cash
                        dealer.agent_id: execution_price,  # Dealer receives cash
                    },
                    qty_changes={
                        buyer_id: 1,  # Buyer receives ticket
                        dealer.agent_id: -1,  # Dealer gives ticket
                    }
                )

            return ExecutionResult(
                executed=True,
                price=execution_price,
                is_passthrough=False,
                ticket=ticket,
            )

        else:
            # Event 10: Passthrough to VBT at outside ask
            execution_price = vbt.A

            # Snapshot dealer state for C4 assertion
            if check_assertions:
                dealer_snapshot = deepcopy(dealer)

            # Select ticket from VBT inventory
            # VBT must have inventory to provide - if not, this is a configuration error
            if not vbt.inventory:
                raise ValueError(
                    f"VBT has no inventory to provide for passthrough buy. "
                    f"Bucket: {vbt.bucket_id}. "
                    f"This indicates insufficient VBT capitalization or configuration error."
                )

            ticket = self._select_ticket_to_sell(vbt.inventory, issuer_preference)

            # VBT provides the ticket
            vbt.inventory.remove(ticket)
            vbt.cash += execution_price

            # Transfer ownership to buyer
            ticket.owner_id = buyer_id

            # Dealer state unchanged - recompute to update quotes based on VBT state
            recompute_dealer_state(dealer, vbt, self.params)

            # C4: Verify dealer balance sheet unchanged
            if check_assertions:
                assert_c4_passthrough_invariant(dealer_snapshot, dealer)

            # C1: Double-entry assertion (dealer not involved in passthrough)
            if check_assertions:
                assert_c1_double_entry(
                    cash_changes={
                        buyer_id: -execution_price,  # Buyer pays cash
                        vbt.agent_id: execution_price,  # VBT receives cash
                    },
                    qty_changes={
                        buyer_id: 1,  # Buyer receives ticket
                        vbt.agent_id: -1,  # VBT gives ticket
                    }
                )

            return ExecutionResult(
                executed=True,
                price=execution_price,
                is_passthrough=True,
                ticket=ticket,
            )

    def _select_ticket_to_sell(
        self,
        inventory: list[Ticket],
        issuer_preference: AgentId | None,
    ) -> Ticket:
        """
        Select ticket to sell from inventory using deterministic tie-breaker.

        Priority:
        1. Match issuer_preference if specified
        2. Lowest maturity_day
        3. Lowest serial number

        This ensures reproducible behavior across runs and respects the
        single-issuer constraint when specified.

        Args:
            inventory: List of tickets available for sale
            issuer_preference: Optional preferred issuer ID

        Returns:
            Selected ticket

        Raises:
            ValueError: If inventory is empty or no matching ticket found

        References:
            - Specification Section 6.2: Deterministic tie-breaker for Event 2
            - Specification Section 10.4: Single-issuer constraint for ring traders
        """
        if not inventory:
            raise ValueError("Cannot select ticket from empty inventory")

        # Filter by issuer preference if specified
        if issuer_preference is not None:
            candidates = [t for t in inventory if t.issuer_id == issuer_preference]
            if not candidates:
                raise ValueError(
                    f"No tickets from preferred issuer {issuer_preference} in inventory. "
                    f"Available issuers: {set(t.issuer_id for t in inventory)}"
                )
        else:
            candidates = inventory

        # Sort by (maturity_day, serial) and return first
        # This implements the deterministic tie-breaker:
        # 1. Lowest maturity_day (soonest to mature)
        # 2. Lowest serial number (stable ordering)
        selected = min(candidates, key=lambda t: (t.maturity_day, t.serial))

        return selected

```

---

### 📄 src/bilancio/domain/__init__.py

```python
# Empty package file

```

---

### 📄 src/bilancio/domain/agent.py

```python
from __future__ import annotations

from dataclasses import dataclass, field
from enum import Enum

from bilancio.core.ids import AgentId, InstrId


class AgentKind(Enum):
    """Enumeration of agent types in the financial system."""
    CENTRAL_BANK = "central_bank"
    BANK = "bank"
    HOUSEHOLD = "household"
    TREASURY = "treasury"
    FIRM = "firm"
    INVESTMENT_FUND = "investment_fund"
    INSURANCE_COMPANY = "insurance_company"
    DEALER = "dealer"
    VBT = "vbt"
    
    def __str__(self) -> str:
        return self.value


@dataclass
class Agent:
    id: AgentId
    name: str
    kind: str  # Still accepts str for backward compatibility
    asset_ids: list[InstrId] = field(default_factory=list)
    liability_ids: list[InstrId] = field(default_factory=list)
    stock_ids: list[InstrId] = field(default_factory=list)
    defaulted: bool = False

```

---

### 📄 src/bilancio/domain/agents/__init__.py

```python
from .bank import Bank
from .central_bank import CentralBank
from .dealer import Dealer
from .firm import Firm
from .household import Household
from .treasury import Treasury
from .vbt import VBT

__all__ = [
    "Bank",
    "CentralBank",
    "Dealer",
    "Firm",
    "Household",
    "Treasury",
    "VBT",
]

```

---

### 📄 src/bilancio/domain/agents/bank.py

```python
from dataclasses import dataclass

from bilancio.domain.agent import Agent


@dataclass
class Bank(Agent):
    def __post_init__(self):
        self.kind = "bank"

```

---

### 📄 src/bilancio/domain/agents/central_bank.py

```python
from dataclasses import dataclass

from bilancio.domain.agent import Agent


@dataclass
class CentralBank(Agent):
    def __post_init__(self):
        self.kind = "central_bank"

```

---

### 📄 src/bilancio/domain/agents/dealer.py

```python
"""
Dealer agent for secondary market trading.

A Dealer is a market maker in the dealer ring subsystem that provides
liquidity by maintaining bid/ask quotes for claims in a specific
maturity bucket. Dealers hold inventory and trade with both customers
(traders) and the VBT (Value-Based Trader).
"""
from dataclasses import dataclass, field

from bilancio.domain.agent import Agent


@dataclass
class Dealer(Agent):
    """
    Market maker agent for a maturity bucket in the dealer ring.

    Dealers provide two-sided markets (bid/ask) for claims within their
    assigned maturity bucket. They maintain inventory and cash positions,
    adjusting quotes based on inventory levels via the kernel formula.

    Attributes inherited from Agent:
        id: Unique identifier (e.g., "dealer_short", "dealer_mid")
        name: Display name (e.g., "Dealer (short)")
        kind: Always "dealer"
        asset_ids: Claims owned (bought from sellers)
        liability_ids: Currently unused for dealers
        stock_ids: Currently unused for dealers
        defaulted: Whether dealer has failed

    Note:
        The detailed trading state (inventory list, quotes, cash) is
        maintained in DealerState within the dealer subsystem. This
        Agent class provides the main system representation for
        ownership tracking during claim transfers.
    """

    kind: str = field(default="dealer", init=False)

```

---

### 📄 src/bilancio/domain/agents/firm.py

```python
"""Firm agent representing companies, manufacturers, and other business entities."""

from dataclasses import dataclass

from bilancio.domain.agent import Agent


@dataclass
class Firm(Agent):
    """
    A firm/company agent that can:
    - Hold and transfer cash
    - Issue and receive payables
    - Own and transfer stock inventory
    - Create and settle delivery obligations
    - Participate in economic transactions
    
    This represents any business entity that isn't a bank or financial institution.
    Examples: manufacturers, trading companies, service providers.
    """
    
    def __post_init__(self):
        """Ensure the agent kind is set to 'firm'."""
        if self.kind != "firm":
            self.kind = "firm"
```

---

### 📄 src/bilancio/domain/agents/household.py

```python
from dataclasses import dataclass

from bilancio.domain.agent import Agent


@dataclass
class Household(Agent):
    def __post_init__(self):
        self.kind = "household"

```

---

### 📄 src/bilancio/domain/agents/treasury.py

```python
from dataclasses import dataclass

from bilancio.domain.agent import Agent


@dataclass
class Treasury(Agent):
    def __post_init__(self):
        self.kind = "treasury"

```

---

### 📄 src/bilancio/domain/agents/vbt.py

```python
"""
Value-Based Trader (VBT) agent for outside liquidity.

A VBT is an outside liquidity provider in the dealer ring subsystem that
trades based on a fundamental value model (M, O anchors). VBTs provide
liquidity when dealer inventory is exhausted, allowing the market to
continue functioning even under stress.
"""
from dataclasses import dataclass, field

from bilancio.domain.agent import Agent


@dataclass
class VBT(Agent):
    """
    Value-Based Trader providing outside liquidity to the dealer ring.

    VBTs represent external market participants who trade based on
    fundamental value assessments rather than inventory management.
    They have unlimited capacity to absorb or provide claims at their
    quoted prices, ensuring market continuity.

    Attributes inherited from Agent:
        id: Unique identifier (e.g., "vbt_short", "vbt_mid")
        name: Display name (e.g., "VBT (short)")
        kind: Always "vbt"
        asset_ids: Claims owned (bought from dealers or sellers)
        liability_ids: Currently unused for VBTs
        stock_ids: Currently unused for VBTs
        defaulted: Whether VBT has failed (typically never)

    Note:
        The detailed trading state (inventory list, M/O anchors, quotes)
        is maintained in VBTState within the dealer subsystem. This
        Agent class provides the main system representation for
        ownership tracking during claim transfers.
    """

    kind: str = field(default="vbt", init=False)

```

---

### 📄 src/bilancio/domain/goods.py

```python
# non-financial; not a liability of anyone
from dataclasses import dataclass
from decimal import Decimal
from bilancio.core.ids import InstrId, AgentId

StockId = InstrId  # reuse ID machinery

@dataclass
class StockLot:
    id: StockId
    kind: str          # fixed: "stock_lot"
    sku: str
    quantity: int
    unit_price: Decimal
    owner_id: AgentId
    divisible: bool = True

    def __post_init__(self):
        self.kind = "stock_lot"
        # Ensure unit_price is a Decimal
        if not isinstance(self.unit_price, Decimal):
            self.unit_price = Decimal(str(self.unit_price))

    @property
    def value(self) -> Decimal:
        return Decimal(str(self.quantity)) * self.unit_price
```

---

### 📄 src/bilancio/domain/instruments/__init__.py

```python
from .base import Instrument
from .credit import Payable
from .means_of_payment import BankDeposit, Cash, ReserveDeposit

__all__ = [
    "Instrument",
    "Cash",
    "BankDeposit",
    "ReserveDeposit",
    "Payable",
]

```

---

### 📄 src/bilancio/domain/instruments/base.py

```python
from __future__ import annotations

from dataclasses import dataclass

from bilancio.core.ids import AgentId, InstrId


@dataclass
class Instrument:
    id: InstrId
    kind: str
    amount: int                    # minor units
    denom: str
    asset_holder_id: AgentId
    liability_issuer_id: AgentId

    def is_financial(self) -> bool:  # override if needed
        return True

    def validate_type_invariants(self) -> None:
        assert self.amount >= 0, "amount must be non-negative"
        assert self.asset_holder_id != self.liability_issuer_id, "self-counterparty forbidden"

```

---

### 📄 src/bilancio/domain/instruments/contract.py

```python
from abc import ABC
from typing import Any, Protocol

from ..agent import Agent


class Contract(Protocol):
    """Protocol defining the interface for contracts."""

    @property
    def id(self) -> str:
        """Unique identifier for the contract."""
        ...

    @property
    def parties(self) -> list[Agent]:
        """List of agents that are parties to this contract."""
        ...

    @property
    def terms(self) -> dict[str, Any]:
        """Dictionary containing the contract terms."""
        ...


class BaseContract(ABC):
    """Abstract base class implementing the Contract protocol."""

    def __init__(self, id: str, parties: list[Agent], terms: dict[str, Any]):
        self._id = id
        self._parties = parties
        self._terms = terms

    @property
    def id(self) -> str:
        """Unique identifier for the contract."""
        return self._id

    @property
    def parties(self) -> list[Agent]:
        """List of agents that are parties to this contract."""
        return self._parties

    @property
    def terms(self) -> dict[str, Any]:
        """Dictionary containing the contract terms."""
        return self._terms

```

---

### 📄 src/bilancio/domain/instruments/credit.py

```python
from dataclasses import dataclass

from .base import Instrument


@dataclass
class Payable(Instrument):
    """A payable instrument representing a credit obligation.

    Fields:
        due_day: The day when the payable is due for settlement
        holder_id: Optional secondary market holder. If set, this agent currently
                   holds the payable and should receive settlement payment.
                   If None, the original creditor (asset_holder_id) receives payment.
        maturity_distance: Original maturity distance (ΔT) in days. Used for rollover
                          to create new payables with same ΔT after settlement.

    Properties:
        effective_creditor: Returns the agent ID who should receive settlement
                           payment - either the secondary market holder_id or the
                           original asset_holder_id.
    """
    due_day: int | None = None
    holder_id: str | None = None
    maturity_distance: int | None = None  # Plan 024: for continuous rollover

    @property
    def effective_creditor(self) -> str:
        """Return the agent who should receive settlement payment.

        Returns holder_id if transferred in secondary market, otherwise
        returns the original asset_holder_id.
        """
        return self.holder_id if self.holder_id else self.asset_holder_id

    def __post_init__(self):
        self.kind = "payable"

    def validate_type_invariants(self) -> None:
        super().validate_type_invariants()
        assert self.due_day is not None and self.due_day >= 0, "payable must have due_day"

```

---

### 📄 src/bilancio/domain/instruments/delivery.py

```python
from dataclasses import dataclass
from decimal import Decimal
from bilancio.domain.instruments.base import Instrument

@dataclass
class DeliveryObligation(Instrument):
    # amount = quantity promised (rename for clarity at call sites)
    sku: str
    unit_price: Decimal
    due_day: int

    def __post_init__(self):
        self.kind = "delivery_obligation"
        # Ensure unit_price is a Decimal
        if not isinstance(self.unit_price, Decimal):
            self.unit_price = Decimal(str(self.unit_price))

    def is_financial(self) -> bool:
        # Shows up in balance analysis as non-financial (valued) obligation
        return False

    @property
    def valued_amount(self) -> Decimal:
        from decimal import Decimal as D
        return D(str(self.amount)) * self.unit_price
        
    def validate_type_invariants(self) -> None:
        # Standard bilateral instrument validation (holder != issuer)
        super().validate_type_invariants()
        assert self.unit_price >= 0, "unit_price must be non-negative"
        assert self.due_day >= 0, "due_day must be non-negative"
```

---

### 📄 src/bilancio/domain/instruments/means_of_payment.py

```python
from dataclasses import dataclass

from .base import Instrument


@dataclass
class Cash(Instrument):
    # bearer CB liability; issuer is CB; holder can be anyone per policy
    def __post_init__(self):
        self.kind = "cash"

@dataclass
class BankDeposit(Instrument):
    # liability of a commercial bank; holder is typically household/firm
    def __post_init__(self):
        self.kind = "bank_deposit"

@dataclass
class ReserveDeposit(Instrument):
    # liability of the central bank; holders are banks/treasury per policy
    def __post_init__(self):
        self.kind = "reserve_deposit"

```

---

### 📄 src/bilancio/domain/instruments/policy.py

```python
from abc import ABC, abstractmethod
from typing import Any, Protocol


class Policy(Protocol):
    """Protocol defining the interface for policies."""

    def evaluate(self, context: dict[str, Any]) -> Any:
        """Evaluate the policy given the provided context."""
        ...


class BasePolicy(ABC):
    """Abstract base class implementing the Policy protocol."""

    @abstractmethod
    def evaluate(self, context: dict[str, Any]) -> Any:
        """Evaluate the policy given the provided context."""
        pass

```

---

### 📄 src/bilancio/domain/policy.py

```python
from __future__ import annotations

from collections.abc import Sequence
from dataclasses import dataclass

from bilancio.domain.agent import Agent
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.firm import Firm
from bilancio.domain.agents.household import Household
from bilancio.domain.agents.treasury import Treasury
from bilancio.domain.instruments.base import Instrument
from bilancio.domain.instruments.credit import Payable
from bilancio.domain.instruments.means_of_payment import BankDeposit, Cash, ReserveDeposit
from bilancio.domain.instruments.delivery import DeliveryObligation

AgentType = type[Agent]
InstrType = type[Instrument]

@dataclass
class PolicyEngine:
    # who may issue / hold each instrument type (MVP: static sets)
    issuers: dict[InstrType, Sequence[AgentType]]
    holders: dict[InstrType, Sequence[AgentType]]
    # means-of-payment ranking per agent kind (least-preferred to keep first)
    mop_rank: dict[str, list[str]]

    @classmethod
    def default(cls) -> PolicyEngine:
        return cls(
            issuers={
                Cash:        (CentralBank,),
                BankDeposit: (Bank,),
                ReserveDeposit: (CentralBank,),
                Payable:     (Agent,),            # any agent can issue a payable
                DeliveryObligation: (Agent,),     # any agent can promise to deliver
            },
            holders={
                Cash:            (Agent,),
                BankDeposit:     (Household, Firm, Treasury, Bank),  # banks may hold but not for interbank settlement
                ReserveDeposit:  (Bank, Treasury),
                Payable:         (Agent,),
                DeliveryObligation: (Agent,),         # any agent can hold a delivery claim
            },
            mop_rank={
                "household":     ["bank_deposit", "cash"],     # use deposit first, then cash
                "firm":          ["cash", "bank_deposit"],     # firms prefer cash for simplicity
                "bank":          ["reserve_deposit"],          # banks settle in reserves
                "treasury":      ["reserve_deposit"],
                "central_bank":  ["reserve_deposit"],
            },
        )

    def can_issue(self, agent: Agent, instr: Instrument) -> bool:
        return any(isinstance(agent, t) for t in self.issuers.get(type(instr), ()))

    def can_hold(self, agent: Agent, instr: Instrument) -> bool:
        return any(isinstance(agent, t) for t in self.holders.get(type(instr), ()))

    def settlement_order(self, agent: Agent) -> Sequence[str]:
        return self.mop_rank.get(agent.kind, [])

```

---

### 📄 src/bilancio/engines/__init__.py

```python

```

---

### 📄 src/bilancio/engines/clearing.py

```python
"""Clearing engine (Phase C) for intraday netting and settlement."""

from collections import defaultdict

from bilancio.core.atomic_tx import atomic
from bilancio.core.errors import ValidationError
from bilancio.domain.instruments.credit import Payable


def compute_intraday_nets(system, day: int) -> dict[tuple[str, str], int]:
    """
    Compute net amounts between banks from today's ClientPayment events.
    
    Scans events for ClientPayment events from today and calculates net amounts 
    between each bank pair. Uses lexical ordering for bank pairs (a, b where a < b).
    
    Convention: nets[(a,b)] > 0 means bank a owes bank b
    
    Args:
        system: System instance
        day: Day to compute nets for
        
    Returns:
        Dict mapping bank pairs to net amounts
    """
    nets = defaultdict(int)

    # Scan events for ClientPayment events from today
    for event in system.state.events:
        if event.get("kind") == "ClientPayment" and event.get("day") == day:
            debtor_bank = event.get("payer_bank")
            creditor_bank = event.get("payee_bank")
            amount = event.get("amount", 0)

            if debtor_bank and creditor_bank and debtor_bank != creditor_bank:
                # Use lexical ordering: ensure a < b
                if debtor_bank < creditor_bank:
                    # debtor_bank owes creditor_bank
                    nets[(debtor_bank, creditor_bank)] += amount
                else:
                    # creditor_bank is owed by debtor_bank, so subtract from the reverse pair
                    nets[(creditor_bank, debtor_bank)] -= amount

    return dict(nets)


def settle_intraday_nets(system, day: int):
    """
    Settle intraday nets between banks using reserves or creating overnight payables.
    
    For each net amount between banks:
    - Try to transfer reserves if sufficient
    - If insufficient reserves, create overnight payable due tomorrow
    - Log InterbankCleared or InterbankOvernightCreated events
    
    Args:
        system: System instance  
        day: Current day
    """
    nets = compute_intraday_nets(system, day)

    for (bank_a, bank_b), net_amount in nets.items():
        if net_amount == 0:
            continue

        if net_amount > 0:
            # bank_a owes bank_b
            debtor_bank = bank_a
            creditor_bank = bank_b
            amount = net_amount
        else:
            # bank_b owes bank_a
            debtor_bank = bank_b
            creditor_bank = bank_a
            amount = -net_amount

        # Try to transfer reserves
        try:
            with atomic(system):
                # Find available reserves for debtor bank
                debtor_reserve_ids = []
                for cid in system.state.agents[debtor_bank].asset_ids:
                    contract = system.state.contracts[cid]
                    if contract.kind == "reserve_deposit":
                        debtor_reserve_ids.append(cid)

                if not debtor_reserve_ids:
                    available_reserves = 0
                else:
                    available_reserves = sum(system.state.contracts[cid].amount for cid in debtor_reserve_ids)

                if available_reserves >= amount:
                    # Sufficient reserves - transfer them
                    system.transfer_reserves(debtor_bank, creditor_bank, amount)
                    system.log("InterbankCleared",
                              debtor_bank=debtor_bank,
                              creditor_bank=creditor_bank,
                              amount=amount)
                else:
                    # Insufficient reserves - create overnight payable
                    payable_id = system.new_contract_id("P")
                    overnight_payable = Payable(
                        id=payable_id,
                        kind="payable",
                        amount=amount,
                        denom="X",
                        asset_holder_id=creditor_bank,
                        liability_issuer_id=debtor_bank,
                        due_day=day + 1
                    )

                    system.add_contract(overnight_payable)
                    system.log("InterbankOvernightCreated",
                              debtor_bank=debtor_bank,
                              creditor_bank=creditor_bank,
                              amount=amount,
                              payable_id=payable_id,
                              due_day=day + 1)

        except ValidationError:
            # If transfer fails, create overnight payable as fallback
            payable_id = system.new_contract_id("P")
            overnight_payable = Payable(
                id=payable_id,
                kind="payable",
                amount=amount,
                denom="X",
                asset_holder_id=creditor_bank,
                liability_issuer_id=debtor_bank,
                due_day=day + 1
            )

            system.add_contract(overnight_payable)
            system.log("InterbankOvernightCreated",
                      debtor_bank=debtor_bank,
                      creditor_bank=creditor_bank,
                      amount=amount,
                      payable_id=payable_id,
                      due_day=day + 1)

```

---

### 📄 src/bilancio/engines/dealer_integration.py

```python
"""
Dealer subsystem integration for the main simulation engine.

This module provides a bridge between the main bilancio simulation engine
(System/Payables) and the dealer module (Tickets/States). It wraps the dealer
module's components to provide a clean interface for:

1. Converting Payables to Tickets for trading
2. Running dealer trading phases within the main simulation loop
3. Syncing trade results back to the main system

Architecture:
    Main System (Payables) <--> DealerSubsystem <--> Dealer Module (Tickets)

    - DealerSubsystem: Maintains parallel state (tickets, trader states)
    - Bridge functions: Convert between Payable and Ticket representations
    - Integration functions: Initialize, run trading, sync results

The dealer subsystem operates as a secondary market where agents can trade
their existing claims (Payables) to manage liquidity needs. Trades are
executed at market-determined prices through a dealer ring with value-based
traders (VBTs) providing outside liquidity.

References:
    - Dealer module docs: docs/dealer_ring.md
    - Dealer specification: Full specification document
"""

from dataclasses import dataclass, field
from decimal import Decimal
from typing import Dict, List, Optional, Any
import random

from bilancio.core.ids import AgentId, InstrId
from bilancio.dealer.models import (
    DealerState,
    VBTState,
    TraderState,
    Ticket,
    BucketConfig,
    DEFAULT_BUCKETS,
    TicketId,
)
from bilancio.dealer.kernel import KernelParams, recompute_dealer_state
from bilancio.dealer.trading import TradeExecutor
from bilancio.dealer.simulation import DealerRingConfig
from bilancio.dealer.metrics import (
    RunMetrics,
    TradeRecord,
    DealerSnapshot,
    TraderSnapshot,
    TicketOutcome,
    SystemStateSnapshot,  # Plan 022
    compute_safety_margin,
    compute_saleable_value,
)


@dataclass
class DealerSubsystem:
    """
    Wrapper that adapts dealer module for main simulation engine.

    This dataclass maintains all state needed for dealer trading operations,
    providing a clean boundary between the main simulation and the dealer
    subsystem.

    State Management:
        - Tickets: Tradable representations of Payables
        - Dealers: Per-bucket market makers with inventory and quotes
        - VBTs: Per-bucket outside liquidity providers
        - Traders: Per-agent trading states with single-issuer constraint

    Mapping Tables:
        - ticket_to_payable: Links tickets back to their source Payables
        - payable_to_ticket: Links Payables to their tradable tickets

    Trading Infrastructure:
        - executor: Handles trade execution and balance sheet updates
        - params: Kernel parameters for pricing computations
        - bucket_configs: Maturity-based grouping definitions

    Attributes:
        dealers: Per-bucket dealer states (bucket_id -> DealerState)
        vbts: Per-bucket VBT states (bucket_id -> VBTState)
        traders: Per-agent trader states (agent_id -> TraderState)
        tickets: All tradable tickets (ticket_id -> Ticket)
        ticket_to_payable: Mapping from ticket IDs to Payable contract IDs
        payable_to_ticket: Mapping from Payable contract IDs to ticket IDs
        bucket_configs: Maturity bucket configurations
        params: Kernel parameters for dealer pricing
        executor: Trade execution engine
        enabled: Whether dealer trading is active
        rng: Random number generator for order flow
    """

    dealers: Dict[str, DealerState] = field(default_factory=dict)
    vbts: Dict[str, VBTState] = field(default_factory=dict)
    traders: Dict[AgentId, TraderState] = field(default_factory=dict)
    tickets: Dict[TicketId, Ticket] = field(default_factory=dict)
    ticket_to_payable: Dict[TicketId, InstrId] = field(default_factory=dict)
    payable_to_ticket: Dict[InstrId, TicketId] = field(default_factory=dict)
    bucket_configs: List[BucketConfig] = field(default_factory=lambda: list(DEFAULT_BUCKETS))
    params: KernelParams = field(default_factory=lambda: KernelParams())
    executor: Optional[TradeExecutor] = None
    enabled: bool = True
    rng: random.Random = field(default_factory=lambda: random.Random(42))

    # Section 8 Metrics (functional dealer analysis)
    metrics: RunMetrics = field(default_factory=RunMetrics)


def initialize_dealer_subsystem(
    system,
    dealer_config: DealerRingConfig,
    current_day: int = 0
) -> DealerSubsystem:
    """
    Initialize dealer subsystem from system state and configuration.

    This function performs the initial setup of the dealer subsystem:

    1. Create dealer/VBT agents in main system:
       - Add actual Household agents for each dealer and VBT
       - This allows proper ownership tracking in the main system

    2. Convert existing Payables to Tickets:
       - Extract all payables from system contracts
       - Create corresponding Ticket objects with maturity info
       - Assign tickets to maturity buckets
       - Build bidirectional mappings

    3. Initialize market makers:
       - Create DealerState for each bucket with initial capital
       - Create VBTState for each bucket with anchors
       - Allocate initial ticket inventory based on dealer_share/vbt_share

    4. Initialize traders:
       - Create TraderState for each household agent
       - Set initial cash from agent balance sheets
       - Link tickets to trader ownership

    5. Compute initial quotes:
       - Run kernel computation for each dealer
       - Generate initial bid/ask spreads

    Capital Allocation (NEW OUTSIDE MONEY):
        dealer_share: Fraction of system cash injected as dealer capital (e.g., 0.25)
        vbt_share: Fraction of system cash injected as VBT capital (e.g., 0.50)
        NOTE: Traders keep 100% of their tickets. Dealer/VBT start with EMPTY
              inventory and build it by BUYING from traders who want to sell.
              This is NEW MONEY from outside the system, not taken from traders.

    Args:
        system: Main System instance with agents and contracts
        dealer_config: Configuration for dealer subsystem
        current_day: Current simulation day for maturity calculations

    Returns:
        Initialized DealerSubsystem ready for trading

    Raises:
        ValueError: If configuration is invalid or system state inconsistent

    Example:
        >>> system = System()
        >>> # ... set up agents and create payables ...
        >>> config = DealerRingConfig(
        ...     ticket_size=Decimal(1),
        ...     dealer_share=Decimal("0.25"),
        ...     vbt_share=Decimal("0.50"),
        ... )
        >>> subsystem = initialize_dealer_subsystem(system, config)
        >>> # Now ready for run_dealer_trading_phase()
    """
    from bilancio.domain.agents import Dealer, VBT

    subsystem = DealerSubsystem(
        bucket_configs=dealer_config.buckets,
        params=KernelParams(S=dealer_config.ticket_size),
        rng=random.Random(dealer_config.seed),
    )

    # Step 0: Create dealer/VBT agents in main system
    # These agents allow proper ownership tracking when claims transfer to dealers
    for bucket_config in dealer_config.buckets:
        bucket_id = bucket_config.name
        dealer_agent_id = f"dealer_{bucket_id}"
        vbt_agent_id = f"vbt_{bucket_id}"

        # Create dealer agent if not exists
        if dealer_agent_id not in system.state.agents:
            dealer_agent = Dealer(
                id=dealer_agent_id,
                name=f"Dealer ({bucket_id})",
            )
            system.state.agents[dealer_agent_id] = dealer_agent

        # Create VBT agent if not exists
        if vbt_agent_id not in system.state.agents:
            vbt_agent = VBT(
                id=vbt_agent_id,
                name=f"VBT ({bucket_id})",
            )
            system.state.agents[vbt_agent_id] = vbt_agent

    # Initialize trade executor
    subsystem.executor = TradeExecutor(subsystem.params, subsystem.rng)

    # Step 1: Convert Payables to Tickets
    from bilancio.domain.instruments.credit import Payable

    serial_counter = 0
    for contract_id, contract in system.state.contracts.items():
        if not isinstance(contract, Payable):
            continue

        # Create ticket from payable
        ticket_id = f"TKT_{contract_id}"
        remaining_tau = max(0, contract.due_day - current_day)

        ticket = Ticket(
            id=ticket_id,
            issuer_id=contract.liability_issuer_id,  # Debtor
            owner_id=contract.effective_creditor,    # Current creditor
            face=Decimal(contract.amount),
            maturity_day=contract.due_day,
            remaining_tau=remaining_tau,
            bucket_id="",  # Will be assigned below
            serial=serial_counter,
        )
        serial_counter += 1

        # Assign to bucket
        ticket.bucket_id = _assign_bucket(ticket.remaining_tau, subsystem.bucket_configs)

        # Register ticket
        subsystem.tickets[ticket_id] = ticket
        subsystem.ticket_to_payable[ticket_id] = contract_id
        subsystem.payable_to_ticket[contract_id] = ticket_id

    # Step 2: Calculate total system cash for capital allocation
    # Dealer and VBT get NEW CASH from outside the system (not taken from traders)
    total_system_cash = Decimal(0)
    for agent_id, agent in system.state.agents.items():
        # Skip dealer/VBT agents we just created
        if agent.kind in ("dealer", "vbt"):
            continue
        total_system_cash += _get_agent_cash(system, agent_id)

    # Calculate dealer and VBT capital (NEW outside money)
    # Split evenly across buckets
    num_buckets = len(subsystem.bucket_configs)
    dealer_capital_per_bucket = (total_system_cash * dealer_config.dealer_share) / num_buckets
    vbt_capital_per_bucket = (total_system_cash * dealer_config.vbt_share) / num_buckets

    # Step 3: Initialize market makers
    for bucket_config in subsystem.bucket_configs:
        bucket_id = bucket_config.name

        # Get anchor prices from config
        M, O = dealer_config.vbt_anchors.get(
            bucket_id,
            (Decimal(1), Decimal("0.30"))
        )

        # Create dealer state with NEW capital (no inventory yet)
        dealer = DealerState(
            bucket_id=bucket_id,
            agent_id=f"dealer_{bucket_id}",
            inventory=[],  # Empty! Dealers build inventory by buying from traders
            cash=dealer_capital_per_bucket,  # NEW outside money
        )
        subsystem.dealers[bucket_id] = dealer

        # Create VBT state with NEW capital (no inventory yet)
        vbt = VBTState(
            bucket_id=bucket_id,
            agent_id=f"vbt_{bucket_id}",
            M=M,
            O=O,
            phi_M=dealer_config.phi_M,
            phi_O=dealer_config.phi_O,
            clip_nonneg_B=dealer_config.clip_nonneg_B,
            inventory=[],  # Empty! VBTs build inventory by buying from traders
            cash=vbt_capital_per_bucket,  # NEW outside money
        )
        vbt.recompute_quotes()
        subsystem.vbts[bucket_id] = vbt

        # NOTE: Traders keep 100% of their tickets (no allocation to dealer/VBT)
        # Dealer/VBT will acquire inventory by buying from traders during trading

        # Run kernel to compute initial quotes
        recompute_dealer_state(dealer, vbt, subsystem.params)

        # Capture initial equity for P&L calculation (Section 8.2)
        # E_0^(b) = C_0^(b) + M * a_0^(b) * S
        initial_equity = dealer.cash + vbt.M * dealer.a * subsystem.params.S
        subsystem.metrics.initial_equity_by_bucket[bucket_id] = initial_equity

    # Step 3: Initialize traders (households only for now)
    for agent_id, agent in system.state.agents.items():
        if agent.kind != "household":
            continue

        # Calculate trader's cash from their cash holdings in main system
        trader_cash = _get_agent_cash(system, agent_id)

        trader = TraderState(
            agent_id=agent_id,
            cash=trader_cash,
            tickets_owned=[],
            obligations=[],
            asset_issuer_id=None,
        )

        # Link trader to their tickets
        for ticket in subsystem.tickets.values():
            if ticket.owner_id == agent_id:
                trader.tickets_owned.append(ticket)
                # Set asset_issuer_id based on first ticket held
                if trader.asset_issuer_id is None:
                    trader.asset_issuer_id = ticket.issuer_id

            if ticket.issuer_id == agent_id:
                trader.obligations.append(ticket)

        subsystem.traders[agent_id] = trader

    # Step 4: Capture initial debt-to-money ratio (Plan 020 - Phase B)
    # This is a key control variable - results only make sense given this ratio
    from bilancio.domain.instruments.credit import Payable as PayableClass

    # Sum all payable amounts (total debt in system)
    total_debt = Decimal(0)
    for contract in system.state.contracts.values():
        if isinstance(contract, PayableClass):
            total_debt += Decimal(contract.amount)

    # Sum all cash holdings (total money in system, excluding dealer/VBT)
    total_money = Decimal(0)
    for agent_id_iter, agent in system.state.agents.items():
        if agent.kind not in ("dealer", "vbt"):
            total_money += _get_agent_cash(system, agent_id_iter)

    # Store in metrics
    subsystem.metrics.initial_total_debt = total_debt
    subsystem.metrics.initial_total_money = total_money

    return subsystem


def initialize_balanced_dealer_subsystem(
    system,
    dealer_config: DealerRingConfig,
    face_value: Decimal = Decimal("20"),
    outside_mid_ratio: Decimal = Decimal("0.75"),
    big_entity_share: Decimal = Decimal("0.25"),  # DEPRECATED
    vbt_share_per_bucket: Decimal = Decimal("0.25"),
    dealer_share_per_bucket: Decimal = Decimal("0.125"),
    mode: str = "active",
    current_day: int = 0
) -> DealerSubsystem:
    """
    Initialize dealer subsystem for balanced scenarios (C vs D comparison).

    Per PDF specification (Plan 024):
    - VBT agents START with 25% of claims per maturity bucket + matching cash
    - Dealer agents START with 12.5% of claims per maturity bucket + matching cash
    - For mode="passive": trading is disabled (entities just hold)
    - For mode="active": trading is enabled as normal

    The scenario generator (compile_ring_explorer_balanced) creates payables to:
    - vbt_short, vbt_mid, vbt_long agents
    - dealer_short, dealer_mid, dealer_long agents

    This function:
    1. Converts those payables to tickets
    2. Assigns tickets to VBT/Dealer inventory based on who holds them
    3. Sets up proper cash balances (already minted in scenario)

    Args:
        system: Main System instance with agents and contracts
        dealer_config: Configuration for dealer subsystem
        face_value: Face value S (cashflow at maturity)
        outside_mid_ratio: M/S ratio (outside mid as fraction of face)
        big_entity_share: DEPRECATED - use vbt_share_per_bucket and dealer_share_per_bucket
        vbt_share_per_bucket: VBT holds 25% of claims per maturity bucket
        dealer_share_per_bucket: Dealer holds 12.5% of claims per maturity bucket
        mode: "passive" (no trading) or "active" (trading enabled)
        current_day: Current simulation day

    Returns:
        Initialized DealerSubsystem ready for trading (or holding if passive)
    """
    from bilancio.domain.agents import Dealer, VBT
    from bilancio.domain.instruments.credit import Payable

    # Calculate outside mid M from ratio and face value
    outside_mid = outside_mid_ratio * face_value

    subsystem = DealerSubsystem(
        bucket_configs=dealer_config.buckets,
        params=KernelParams(S=face_value),  # Use face_value as ticket size
        rng=random.Random(dealer_config.seed),
        enabled=(mode == "active"),  # Disable trading for passive mode
    )

    # Step 0: Ensure dealer/VBT agents exist in main system
    for bucket_config in dealer_config.buckets:
        bucket_id = bucket_config.name
        dealer_agent_id = f"dealer_{bucket_id}"
        vbt_agent_id = f"vbt_{bucket_id}"

        if dealer_agent_id not in system.state.agents:
            dealer_agent = Dealer(
                id=dealer_agent_id,
                name=f"Dealer ({bucket_id})",
            )
            system.state.agents[dealer_agent_id] = dealer_agent

        if vbt_agent_id not in system.state.agents:
            vbt_agent = VBT(
                id=vbt_agent_id,
                name=f"VBT ({bucket_id})",
            )
            system.state.agents[vbt_agent_id] = vbt_agent

    # Initialize trade executor
    subsystem.executor = TradeExecutor(subsystem.params, subsystem.rng)

    # Step 1: Convert Payables to Tickets and categorize by holder
    serial_counter = 0
    vbt_tickets: Dict[str, List[Ticket]] = {bc.name: [] for bc in dealer_config.buckets}
    dealer_tickets: Dict[str, List[Ticket]] = {bc.name: [] for bc in dealer_config.buckets}
    trader_tickets: Dict[str, List[Ticket]] = {}

    for contract_id, contract in system.state.contracts.items():
        if not isinstance(contract, Payable):
            continue

        ticket_id = f"TKT_{contract_id}"
        remaining_tau = max(0, contract.due_day - current_day)

        ticket = Ticket(
            id=ticket_id,
            issuer_id=contract.liability_issuer_id,
            owner_id=contract.effective_creditor,
            face=Decimal(contract.amount),
            maturity_day=contract.due_day,
            remaining_tau=remaining_tau,
            bucket_id="",
            serial=serial_counter,
        )
        serial_counter += 1

        ticket.bucket_id = _assign_bucket(ticket.remaining_tau, subsystem.bucket_configs)

        subsystem.tickets[ticket_id] = ticket
        subsystem.ticket_to_payable[ticket_id] = contract_id
        subsystem.payable_to_ticket[contract_id] = ticket_id

        # Categorize by holder
        owner = ticket.owner_id
        if owner.startswith("vbt_"):
            # VBT holds this ticket - extract bucket from agent id (vbt_short -> short)
            bucket_name = owner.replace("vbt_", "")
            if bucket_name in vbt_tickets:
                vbt_tickets[bucket_name].append(ticket)
        elif owner.startswith("dealer_"):
            # Dealer holds this ticket
            bucket_name = owner.replace("dealer_", "")
            if bucket_name in dealer_tickets:
                dealer_tickets[bucket_name].append(ticket)
        elif owner.startswith("big_"):
            # DEPRECATED: old big_ entities - assign to dealer
            bucket_name = owner.replace("big_", "")
            if bucket_name in dealer_tickets:
                dealer_tickets[bucket_name].append(ticket)
        else:
            # Regular trader holds this ticket
            if owner not in trader_tickets:
                trader_tickets[owner] = []
            trader_tickets[owner].append(ticket)

    # Step 2: Initialize VBT and Dealer states per bucket
    for bucket_config in subsystem.bucket_configs:
        bucket_id = bucket_config.name

        # Get VBT's tickets for this bucket
        vbt_bucket_tickets = vbt_tickets.get(bucket_id, [])
        vbt_face_value = sum(t.face for t in vbt_bucket_tickets)

        # Get Dealer's tickets for this bucket
        dealer_bucket_tickets = dealer_tickets.get(bucket_id, [])
        dealer_face_value = sum(t.face for t in dealer_bucket_tickets)

        # Get cash for VBT and Dealer from main system
        vbt_cash = _get_agent_cash(system, f"vbt_{bucket_id}")
        dealer_cash = _get_agent_cash(system, f"dealer_{bucket_id}")

        # Create VBT state WITH inventory
        # VBT anchors based on outside_mid
        M = outside_mid
        O = Decimal("0.30")  # Default spread

        vbt = VBTState(
            bucket_id=bucket_id,
            agent_id=f"vbt_{bucket_id}",
            M=M,
            O=O,
            phi_M=dealer_config.phi_M,
            phi_O=dealer_config.phi_O,
            clip_nonneg_B=dealer_config.clip_nonneg_B,
            inventory=list(vbt_bucket_tickets),  # VBT starts WITH inventory!
            cash=vbt_cash,
        )
        vbt.recompute_quotes()
        subsystem.vbts[bucket_id] = vbt

        # Create Dealer state WITH inventory
        dealer = DealerState(
            bucket_id=bucket_id,
            agent_id=f"dealer_{bucket_id}",
            inventory=list(dealer_bucket_tickets),  # Dealer starts WITH inventory!
            cash=dealer_cash,
        )
        subsystem.dealers[bucket_id] = dealer

        # Compute dealer quotes
        recompute_dealer_state(dealer, vbt, subsystem.params)

        # Capture initial equity (dealer cash + VBT mid × dealer inventory × S)
        initial_equity = dealer.cash + vbt.M * dealer.a * subsystem.params.S
        subsystem.metrics.initial_equity_by_bucket[bucket_id] = initial_equity

    # Step 3: Initialize traders (regular household agents)
    for agent_id, agent in system.state.agents.items():
        if agent.kind != "household":
            continue
        # Skip VBT/Dealer/big entity agents
        if agent_id.startswith("vbt_") or agent_id.startswith("dealer_") or agent_id.startswith("big_"):
            continue

        trader_cash = _get_agent_cash(system, agent_id)

        trader = TraderState(
            agent_id=agent_id,
            cash=trader_cash,
            tickets_owned=[],
            obligations=[],
            asset_issuer_id=None,
        )

        # Link trader to their tickets (tickets they own as assets)
        for ticket in subsystem.tickets.values():
            if ticket.owner_id == agent_id:
                trader.tickets_owned.append(ticket)
                if trader.asset_issuer_id is None:
                    trader.asset_issuer_id = ticket.issuer_id

            # Tickets where trader is the debtor
            if ticket.issuer_id == agent_id:
                trader.obligations.append(ticket)

        subsystem.traders[agent_id] = trader

    # Step 4: Capture initial debt-to-money ratio
    total_debt = Decimal(0)
    for contract in system.state.contracts.values():
        if isinstance(contract, Payable):
            total_debt += Decimal(contract.amount)

    # Total money held by traders only (not VBT/Dealer)
    total_money = Decimal(0)
    for agent_id_iter, agent in system.state.agents.items():
        if agent.kind == "household" and not (
            agent_id_iter.startswith("vbt_") or
            agent_id_iter.startswith("dealer_") or
            agent_id_iter.startswith("big_")
        ):
            total_money += _get_agent_cash(system, agent_id_iter)

    subsystem.metrics.initial_total_debt = total_debt
    subsystem.metrics.initial_total_money = total_money

    return subsystem


def _get_agent_cash(system, agent_id: str) -> Decimal:
    """
    Get total cash balance for an agent from the main system.

    Sums all cash contracts where the agent is the asset holder.

    Args:
        system: Main System instance
        agent_id: Agent ID to get cash for

    Returns:
        Total cash balance as Decimal
    """
    agent = system.state.agents.get(agent_id)
    if not agent:
        return Decimal(0)

    total_cash = Decimal(0)
    for contract_id in agent.asset_ids:
        contract = system.state.contracts.get(contract_id)
        if contract and contract.kind == "cash":
            total_cash += Decimal(contract.amount)

    return total_cash


def run_dealer_trading_phase(
    subsystem: DealerSubsystem,
    system,
    current_day: int
) -> List[dict]:
    """
    Execute one dealer trading phase for the current day.

    This function orchestrates a complete trading period:

    Phase 1: Update maturities
        - Increment day counters
        - Update remaining_tau for all tickets
        - Reassign tickets to buckets based on new maturities

    Phase 2: Recompute dealer quotes
        - Run kernel for each dealer based on new inventory
        - Update bid/ask prices

    Phase 3: Build eligibility sets
        - Identify traders with shortfalls (need cash)
        - Identify traders with surplus (can invest)
        - Apply policy constraints (single-issuer, horizon)

    Phase 4: Randomized order flow
        - Generate random order of eligible traders
        - Process sell orders (traders need cash)
        - Process buy orders (traders want to invest)
        - Execute trades through dealers or VBTs

    Phase 5: Record events
        - Log all trades with prices and counterparties
        - Track interior vs passthrough execution
        - Record dealer quote evolution

    Note: This is a simplified implementation. The full dealer simulation
    includes settlement, default handling, and VBT anchor updates which
    may be added in future iterations.

    Args:
        subsystem: Dealer subsystem state
        system: Main System instance (for accessing agent cash balances)
        current_day: Current simulation day

    Returns:
        List of trade event dictionaries for logging

    Example:
        >>> events = run_dealer_trading_phase(subsystem, system, day=5)
        >>> for event in events:
        ...     print(f"Trade: {event['trader']} {event['side']} at {event['price']}")
    """
    if not subsystem.enabled:
        return []

    events = []

    # Phase 0: Sync trader cash from main system
    # This ensures traders have up-to-date cash balances for eligibility checks
    for trader_id, trader in subsystem.traders.items():
        trader.cash = _get_agent_cash(system, trader_id)

    # Phase 0.5: Clean up tickets whose payables were removed
    # This can happen when agents default and get expelled (expel-agent mode)
    from bilancio.domain.instruments.credit import Payable
    orphaned_ticket_ids = []
    for ticket_id, payable_id in subsystem.ticket_to_payable.items():
        payable = system.state.contracts.get(payable_id)
        if payable is None or not isinstance(payable, Payable):
            orphaned_ticket_ids.append(ticket_id)

    for ticket_id in orphaned_ticket_ids:
        ticket = subsystem.tickets.get(ticket_id)
        if ticket:
            # Remove from inventories
            bucket = ticket.bucket_id
            dealer = subsystem.dealers.get(bucket)
            vbt = subsystem.vbts.get(bucket)
            if dealer and ticket in dealer.inventory:
                dealer.inventory.remove(ticket)
            if vbt and ticket in vbt.inventory:
                vbt.inventory.remove(ticket)
            # Remove from trader holdings
            for trader in subsystem.traders.values():
                if ticket in trader.tickets_owned:
                    trader.tickets_owned.remove(ticket)
                if ticket in trader.obligations:
                    trader.obligations.remove(ticket)
            # Remove ticket
            del subsystem.tickets[ticket_id]

        # Clean up mappings
        payable_id = subsystem.ticket_to_payable.pop(ticket_id, None)
        if payable_id:
            subsystem.payable_to_ticket.pop(payable_id, None)

    # Phase 1: Update ticket maturities and buckets
    # Collect matured tickets to remove after iteration
    matured_ticket_ids = []

    for ticket in subsystem.tickets.values():
        # Update remaining maturity
        old_bucket = ticket.bucket_id
        ticket.remaining_tau = max(0, ticket.maturity_day - current_day)

        # Mark matured tickets for cleanup (remaining_tau = 0 means due today or past)
        if ticket.remaining_tau == 0:
            matured_ticket_ids.append(ticket.id)
            # Remove from inventories before deletion
            old_dealer = subsystem.dealers.get(old_bucket)
            old_vbt = subsystem.vbts.get(old_bucket)
            if old_dealer and ticket in old_dealer.inventory:
                old_dealer.inventory.remove(ticket)
            if old_vbt and ticket in old_vbt.inventory:
                old_vbt.inventory.remove(ticket)
            # Remove from trader holdings
            for trader in subsystem.traders.values():
                if ticket in trader.tickets_owned:
                    trader.tickets_owned.remove(ticket)
                if ticket in trader.obligations:
                    trader.obligations.remove(ticket)
            continue

        new_bucket = _assign_bucket(ticket.remaining_tau, subsystem.bucket_configs)

        # If bucket changed, move ticket to new dealer/VBT inventory
        if new_bucket != old_bucket:
            # Remove from old bucket's inventories
            old_dealer = subsystem.dealers.get(old_bucket)
            old_vbt = subsystem.vbts.get(old_bucket)
            if old_dealer and ticket in old_dealer.inventory:
                old_dealer.inventory.remove(ticket)
            if old_vbt and ticket in old_vbt.inventory:
                old_vbt.inventory.remove(ticket)

            # Add to new bucket's appropriate inventory
            ticket.bucket_id = new_bucket
            new_dealer = subsystem.dealers.get(new_bucket)
            new_vbt = subsystem.vbts.get(new_bucket)

            # Assign to dealer or VBT based on current owner
            if new_dealer and ticket.owner_id == f"dealer_{old_bucket}":
                ticket.owner_id = f"dealer_{new_bucket}"
                new_dealer.inventory.append(ticket)
            elif new_vbt and ticket.owner_id == f"vbt_{old_bucket}":
                ticket.owner_id = f"vbt_{new_bucket}"
                new_vbt.inventory.append(ticket)

    # Clean up matured tickets to prevent unbounded memory growth
    for ticket_id in matured_ticket_ids:
        del subsystem.tickets[ticket_id]

    # Phase 2: Recompute dealer quotes for all buckets
    for bucket_id, dealer in subsystem.dealers.items():
        vbt = subsystem.vbts[bucket_id]
        recompute_dealer_state(dealer, vbt, subsystem.params)

    # Capture daily snapshots for metrics (Section 8.1)
    _capture_dealer_snapshots(subsystem, current_day)
    _capture_trader_snapshots(subsystem, current_day)
    _capture_system_state_snapshot(subsystem, current_day)  # Plan 022

    # Phase 3: Build eligibility sets (simplified)
    # Traders who need cash (have shortfall coming in next few days)
    eligible_sellers = []
    horizon = 10  # Look ahead this many days for upcoming obligations
    for trader_id, trader in subsystem.traders.items():
        # Check for shortfall on any of the next 'horizon' days
        upcoming_shortfall = Decimal(0)
        for day_offset in range(horizon + 1):
            upcoming_shortfall = max(upcoming_shortfall, trader.shortfall(current_day + day_offset))
        if upcoming_shortfall > 0 and trader.tickets_owned:
            eligible_sellers.append(trader_id)

    # Traders who can buy (have surplus cash beyond needs)
    # Re-enabled per spec Section 11.2: Investment policy (buying tickets)
    eligible_buyers = []
    # Only allow buying if trader has significant surplus above obligations
    for trader_id, trader in subsystem.traders.items():
        max_upcoming_dues = Decimal(0)
        for day_offset in range(horizon + 1):
            max_upcoming_dues = max(max_upcoming_dues, trader.payment_due(current_day + day_offset))
        surplus = trader.cash - max_upcoming_dues
        if surplus > Decimal(500):  # Only if significant surplus
            eligible_buyers.append(trader_id)

    # Phase 4: Randomized order flow (simplified)
    # Process sellers first (they have urgent needs)
    subsystem.rng.shuffle(eligible_sellers)
    for trader_id in eligible_sellers[:10]:  # Process up to 10 sellers per phase
        trader = subsystem.traders[trader_id]
        if not trader.tickets_owned:
            continue

        # Select ticket to sell (first in list for simplicity)
        ticket = trader.tickets_owned[0]
        bucket_id = ticket.bucket_id
        dealer = subsystem.dealers[bucket_id]
        vbt = subsystem.vbts[bucket_id]

        # Capture pre-trade state for metrics (Section 8.1, 8.4)
        pre_dealer_inventory = dealer.a
        pre_dealer_cash = dealer.cash
        pre_dealer_bid = dealer.bid
        pre_dealer_ask = dealer.ask
        pre_trader_cash = trader.cash
        pre_safety_margin = _compute_trader_safety_margin(subsystem, trader_id)

        # Check if liquidity-driven (Section 8.3)
        is_liquidity_driven = trader.shortfall(current_day) > 0

        # Execute customer sell
        result = subsystem.executor.execute_customer_sell(
            dealer, vbt, ticket, check_assertions=False
        )

        if result.executed:
            # Scale price by ticket face value
            # The dealer module returns unit price (per S=1), but our tickets have actual face values
            scaled_price = result.price * ticket.face

            # Update trader state
            trader.tickets_owned.remove(ticket)
            trader.cash += scaled_price

            # Capture post-trade state
            post_safety_margin = _compute_trader_safety_margin(subsystem, trader_id)

            # Create detailed trade record for metrics (Section 8)
            trade_record = TradeRecord(
                day=current_day,
                bucket=bucket_id,
                side="SELL",
                trader_id=trader_id,
                ticket_id=ticket.id,
                issuer_id=ticket.issuer_id,
                maturity_day=ticket.maturity_day,
                face_value=ticket.face,
                price=scaled_price,
                unit_price=result.price,
                is_passthrough=result.is_passthrough,
                dealer_inventory_before=pre_dealer_inventory,
                dealer_cash_before=pre_dealer_cash,
                dealer_bid_before=pre_dealer_bid,
                dealer_ask_before=pre_dealer_ask,
                vbt_mid_before=vbt.M,
                trader_cash_before=pre_trader_cash,
                trader_safety_margin_before=pre_safety_margin,
                dealer_inventory_after=dealer.a,
                dealer_cash_after=dealer.cash,
                dealer_bid_after=dealer.bid,
                dealer_ask_after=dealer.ask,
                trader_cash_after=trader.cash,
                trader_safety_margin_after=post_safety_margin,
                is_liquidity_driven=is_liquidity_driven,
                reduces_margin_below_zero=False,  # Only for BUYs
            )
            subsystem.metrics.trades.append(trade_record)

            # Update ticket outcome for return tracking (Section 8.3)
            if ticket.id not in subsystem.metrics.ticket_outcomes:
                subsystem.metrics.ticket_outcomes[ticket.id] = TicketOutcome(
                    ticket_id=ticket.id,
                    issuer_id=ticket.issuer_id,
                    maturity_day=ticket.maturity_day,
                    face_value=ticket.face,
                )
            subsystem.metrics.ticket_outcomes[ticket.id].sold_to_dealer = True
            subsystem.metrics.ticket_outcomes[ticket.id].sale_day = current_day
            subsystem.metrics.ticket_outcomes[ticket.id].sale_price = scaled_price
            subsystem.metrics.ticket_outcomes[ticket.id].seller_id = trader_id

            events.append({
                "kind": "dealer_trade",
                "day": current_day,
                "phase": "simulation",
                "trader": trader_id,
                "side": "sell",
                "ticket_id": ticket.id,
                "bucket": bucket_id,
                "price": float(scaled_price),
                "unit_price": float(result.price),
                "face": float(ticket.face),
                "is_passthrough": result.is_passthrough,
                "is_liquidity_driven": is_liquidity_driven,
            })

    # Process buyers (simplified: fewer trades)
    subsystem.rng.shuffle(eligible_buyers)
    for trader_id in eligible_buyers[:1]:  # Very limited buying for now
        trader = subsystem.traders[trader_id]

        # Try to buy from first available bucket
        for bucket_id, dealer in subsystem.dealers.items():
            vbt = subsystem.vbts[bucket_id]

            # Check if dealer or VBT has inventory
            if not dealer.inventory and not vbt.inventory:
                continue

            # Capture pre-trade state for metrics (Section 8.1, 8.4)
            pre_dealer_inventory = dealer.a
            pre_dealer_cash = dealer.cash
            pre_dealer_bid = dealer.bid
            pre_dealer_ask = dealer.ask
            pre_trader_cash = trader.cash
            pre_safety_margin = _compute_trader_safety_margin(subsystem, trader_id)

            # Execute customer buy
            result = subsystem.executor.execute_customer_buy(
                dealer, vbt, trader_id, check_assertions=False
            )

            if result.executed and result.ticket:
                # Scale price by ticket face value
                scaled_price = result.price * result.ticket.face

                # Update trader state
                trader.tickets_owned.append(result.ticket)
                trader.cash -= scaled_price

                # Update asset issuer if first ticket
                if trader.asset_issuer_id is None:
                    trader.asset_issuer_id = result.ticket.issuer_id

                # Capture post-trade state
                post_safety_margin = _compute_trader_safety_margin(subsystem, trader_id)

                # Check if BUY reduced margin below zero (Section 8.4)
                reduces_margin_below_zero = (
                    pre_safety_margin >= 0 and post_safety_margin < 0
                )

                # Create detailed trade record for metrics (Section 8)
                trade_record = TradeRecord(
                    day=current_day,
                    bucket=bucket_id,
                    side="BUY",
                    trader_id=trader_id,
                    ticket_id=result.ticket.id,
                    issuer_id=result.ticket.issuer_id,
                    maturity_day=result.ticket.maturity_day,
                    face_value=result.ticket.face,
                    price=scaled_price,
                    unit_price=result.price,
                    is_passthrough=result.is_passthrough,
                    dealer_inventory_before=pre_dealer_inventory,
                    dealer_cash_before=pre_dealer_cash,
                    dealer_bid_before=pre_dealer_bid,
                    dealer_ask_before=pre_dealer_ask,
                    vbt_mid_before=vbt.M,
                    trader_cash_before=pre_trader_cash,
                    trader_safety_margin_before=pre_safety_margin,
                    dealer_inventory_after=dealer.a,
                    dealer_cash_after=dealer.cash,
                    dealer_bid_after=dealer.bid,
                    dealer_ask_after=dealer.ask,
                    trader_cash_after=trader.cash,
                    trader_safety_margin_after=post_safety_margin,
                    is_liquidity_driven=False,  # BUYs are never liquidity-driven
                    reduces_margin_below_zero=reduces_margin_below_zero,
                )
                subsystem.metrics.trades.append(trade_record)

                # Update ticket outcome for return tracking (Section 8.3)
                ticket = result.ticket
                if ticket.id not in subsystem.metrics.ticket_outcomes:
                    subsystem.metrics.ticket_outcomes[ticket.id] = TicketOutcome(
                        ticket_id=ticket.id,
                        issuer_id=ticket.issuer_id,
                        maturity_day=ticket.maturity_day,
                        face_value=ticket.face,
                    )
                subsystem.metrics.ticket_outcomes[ticket.id].purchased_from_dealer = True
                subsystem.metrics.ticket_outcomes[ticket.id].purchase_day = current_day
                subsystem.metrics.ticket_outcomes[ticket.id].purchase_price = scaled_price
                subsystem.metrics.ticket_outcomes[ticket.id].purchaser_id = trader_id

                events.append({
                    "kind": "dealer_trade",
                    "day": current_day,
                    "phase": "simulation",
                    "trader": trader_id,
                    "side": "buy",
                    "ticket_id": result.ticket.id,
                    "bucket": bucket_id,
                    "price": float(scaled_price),
                    "unit_price": float(result.price),
                    "face": float(result.ticket.face),
                    "is_passthrough": result.is_passthrough,
                    "reduces_margin_below_zero": reduces_margin_below_zero,
                })
                break  # One buy per trader per phase

    return events


def sync_dealer_to_system(
    subsystem: DealerSubsystem,
    system
) -> None:
    """
    Sync dealer trade results back to main system state.

    This function bridges the dealer subsystem state back to the main
    simulation system, updating:

    1. Payable ownership:
       - Update Payable.asset_holder_id for transferred claims
       - Update agent.asset_ids lists (remove from old holder, add to new)
       - Maintain double-entry consistency

    2. Agent cash balances:
       - Apply cash changes from trader.cash to agent balance sheets
       - Update Cash contract amounts in system.state.contracts

    3. Consistency checks:
       - Verify ticket ownership matches payable asset_holder_id
       - Ensure cash changes sum to zero (closed system)

    Implementation approach:
        - Use ticket_to_payable mapping to find contracts
        - Update asset_holder_id based on ticket.owner_id
        - Calculate cash deltas by comparing trader.cash to agent balance

    Note: This is a simplified implementation. A full version would:
        - Handle cash contract splits/merges atomically
        - Track exact cash changes through trade history
        - Support rollback on validation failures
        - Log all sync operations for audit trail

    Args:
        subsystem: Dealer subsystem with updated state
        system: Main System instance to update

    Raises:
        ValidationError: If sync would violate system invariants

    Example:
        >>> # After trading phase
        >>> events = run_dealer_trading_phase(subsystem, system, day=5)
        >>> # Sync results back to main system
        >>> sync_dealer_to_system(subsystem, system)
        >>> # Now system.state reflects all trades
    """
    from bilancio.domain.instruments.credit import Payable

    # Step 1: Update Payable ownership for transferred claims
    # Note: Payable has two holder fields:
    # - asset_holder_id: original creditor (from base Instrument class)
    # - holder_id: secondary market holder (specific to Payable)
    # Settlement uses effective_creditor which returns holder_id if set, else asset_holder_id
    for ticket_id, ticket in subsystem.tickets.items():
        # Get corresponding payable
        payable_id = subsystem.ticket_to_payable.get(ticket_id)
        if not payable_id:
            continue

        payable = system.state.contracts.get(payable_id)
        if not isinstance(payable, Payable):
            continue

        # Check if ownership changed (compare with effective_creditor)
        current_holder = payable.effective_creditor
        new_holder = ticket.owner_id

        if current_holder != new_holder:
            # Update agent asset_ids lists
            old_holder_agent = system.state.agents.get(current_holder)
            new_holder_agent = system.state.agents.get(new_holder)

            if old_holder_agent and payable_id in old_holder_agent.asset_ids:
                old_holder_agent.asset_ids.remove(payable_id)

            if new_holder_agent and payable_id not in new_holder_agent.asset_ids:
                new_holder_agent.asset_ids.append(payable_id)

            # Update payable's holder_id (secondary market holder)
            # Keep asset_holder_id as the original creditor
            payable.holder_id = new_holder

            # Log the transfer
            system.log(
                "ClaimTransferredDealer",
                payable_id=payable_id,
                from_holder=current_holder,
                to_holder=new_holder,
                amount=payable.amount,
                due_day=payable.due_day
            )

    # Step 2: Sync trader cash balances
    # Compare trader.cash in dealer subsystem to actual cash in main system
    # and apply the delta as minting (if trader gained) or burning (if trader paid)
    for trader_id, trader in subsystem.traders.items():
        main_system_cash = _get_agent_cash(system, trader_id)
        dealer_cash = trader.cash
        delta = dealer_cash - main_system_cash

        if delta > 0:
            # Trader gained cash from selling tickets - mint cash to them
            # This represents money coming from outside the system (dealer/VBT)
            system.mint_cash(to_agent_id=trader_id, amount=round(delta))
        elif delta < 0:
            # Trader spent cash buying tickets - need to reduce their cash
            # Find and reduce their cash contracts
            agent = system.state.agents.get(trader_id)
            if agent:
                remaining_to_burn = abs(delta)
                for contract_id in list(agent.asset_ids):
                    if remaining_to_burn <= 0:
                        break
                    contract = system.state.contracts.get(contract_id)
                    if contract and contract.kind == "cash":
                        if contract.amount <= remaining_to_burn:
                            # Remove entire contract
                            remaining_to_burn -= contract.amount
                            agent.asset_ids.remove(contract_id)
                            del system.state.contracts[contract_id]
                        else:
                            # Reduce contract amount
                            contract.amount -= round(remaining_to_burn)
                            remaining_to_burn = 0


def _capture_dealer_snapshots(
    subsystem: DealerSubsystem,
    current_day: int
) -> None:
    """
    Capture dealer state snapshots for metrics (Section 8.1).

    Records inventory, cash, quotes, and mark-to-mid equity for each bucket.

    Plan 022 extensions:
    - max_capacity, is_at_zero for capacity tracking
    - hit_vbt_this_step from trade records
    - total_system_face, dealer_share_pct for system context
    """
    # Check if any VBT trades happened this step (for hit_vbt_this_step flag)
    # Look at trades from today that are passthroughs
    vbt_used_buckets = set()
    for trade in subsystem.metrics.trades:
        if trade.day == current_day and trade.is_passthrough:
            vbt_used_buckets.add(trade.bucket)

    for bucket_id, dealer in subsystem.dealers.items():
        vbt = subsystem.vbts[bucket_id]

        # Calculate total system face value for this bucket
        total_face = Decimal(0)
        dealer_face = Decimal(0)
        for trader in subsystem.traders.values():
            for ticket in trader.tickets_owned:
                if ticket.bucket_id == bucket_id:
                    total_face += subsystem.params.S
        # Dealer inventory contribution
        dealer_face = Decimal(dealer.a) * subsystem.params.S

        # Dealer share percentage
        dealer_share = (dealer_face / total_face * 100) if total_face > 0 else Decimal(0)

        snapshot = DealerSnapshot(
            day=current_day,
            bucket=bucket_id,
            inventory=dealer.a,
            cash=dealer.cash,
            bid=dealer.bid,
            ask=dealer.ask,
            midline=dealer.midline,
            vbt_mid=vbt.M,
            vbt_spread=vbt.O,
            ticket_size=subsystem.params.S,
            # Plan 022 extensions
            max_capacity=dealer.X_star,
            is_at_zero=(dealer.a == 0),
            hit_vbt_this_step=(bucket_id in vbt_used_buckets),
            total_system_face=total_face,
            dealer_share_pct=dealer_share,
        )
        subsystem.metrics.dealer_snapshots.append(snapshot)


def _capture_trader_snapshots(
    subsystem: DealerSubsystem,
    current_day: int
) -> None:
    """
    Capture trader state snapshots for metrics (Section 8.1).

    Records cash, tickets, obligations, and safety margins.
    """
    for trader_id, trader in subsystem.traders.items():
        # Calculate safety margin
        safety_margin = compute_safety_margin(
            cash=trader.cash,
            tickets_held=trader.tickets_owned,
            obligations=trader.obligations,
            dealers=subsystem.dealers,
            ticket_size=subsystem.params.S
        )

        # Calculate saleable value
        saleable = compute_saleable_value(trader.tickets_owned, subsystem.dealers)

        # Calculate remaining obligations
        obligations_remaining = sum(t.face for t in trader.obligations)

        snapshot = TraderSnapshot(
            day=current_day,
            trader_id=trader_id,
            cash=trader.cash,
            tickets_held_count=len(trader.tickets_owned),
            tickets_held_ids=[t.id for t in trader.tickets_owned],
            total_face_held=sum(t.face for t in trader.tickets_owned),
            obligations_remaining=obligations_remaining,
            saleable_value=saleable,
            safety_margin=safety_margin,
            defaulted=trader.defaulted,
        )
        subsystem.metrics.trader_snapshots.append(snapshot)


def _capture_system_state_snapshot(
    subsystem: DealerSubsystem,
    current_day: int
) -> None:
    """
    Capture system-level state snapshot for metrics (Plan 022 - Phase 4).

    Records total face value, cash, and debt-to-money ratio across the system.
    """
    # Calculate total face value by bucket
    face_by_bucket: Dict[str, Decimal] = {}
    total_face = Decimal(0)

    for bucket_id in subsystem.dealers.keys():
        face_by_bucket[bucket_id] = Decimal(0)

    # Sum face value from all tickets held by traders
    for trader in subsystem.traders.values():
        for ticket in trader.tickets_owned:
            bucket = ticket.bucket_id
            face = subsystem.params.S
            face_by_bucket[bucket] = face_by_bucket.get(bucket, Decimal(0)) + face
            total_face += face

    # Also add dealer inventory
    for bucket_id, dealer in subsystem.dealers.items():
        dealer_face = Decimal(dealer.a) * subsystem.params.S
        face_by_bucket[bucket_id] = face_by_bucket.get(bucket_id, Decimal(0)) + dealer_face
        total_face += dealer_face

    # Calculate total cash in system
    total_cash = Decimal(0)
    for trader in subsystem.traders.values():
        total_cash += trader.cash
    for dealer in subsystem.dealers.values():
        total_cash += dealer.cash
    for vbt in subsystem.vbts.values():
        total_cash += vbt.cash

    # Create snapshot
    snapshot = SystemStateSnapshot(
        run_id="",  # Will be set at export time
        regime="",  # Will be set at export time
        day=current_day,
        total_face_value=total_face,
        face_bucket_short=face_by_bucket.get("short", Decimal(0)),
        face_bucket_mid=face_by_bucket.get("mid", Decimal(0)),
        face_bucket_long=face_by_bucket.get("long", Decimal(0)),
        total_cash=total_cash,
    )
    subsystem.metrics.system_state_snapshots.append(snapshot)


def _compute_trader_safety_margin(
    subsystem: DealerSubsystem,
    trader_id: str
) -> Decimal:
    """Compute safety margin for a specific trader."""
    trader = subsystem.traders.get(trader_id)
    if not trader:
        return Decimal(0)

    return compute_safety_margin(
        cash=trader.cash,
        tickets_held=trader.tickets_owned,
        obligations=trader.obligations,
        dealers=subsystem.dealers,
        ticket_size=subsystem.params.S
    )


def _assign_bucket(remaining_tau: int, bucket_configs: List[BucketConfig]) -> str:
    """
    Assign a ticket to a maturity bucket based on remaining tau.

    Args:
        remaining_tau: Days remaining until maturity
        bucket_configs: List of bucket definitions

    Returns:
        Bucket name (e.g., "short", "mid", "long")

    Example:
        >>> _assign_bucket(2, DEFAULT_BUCKETS)
        'short'
        >>> _assign_bucket(15, DEFAULT_BUCKETS)
        'long'
    """
    for bucket in bucket_configs:
        if remaining_tau < bucket.tau_min:
            continue
        if bucket.tau_max is None or remaining_tau <= bucket.tau_max:
            return bucket.name

    # Default to last bucket (usually "long")
    return bucket_configs[-1].name if bucket_configs else "default"

```

---

### 📄 src/bilancio/engines/settlement.py

```python
"""Settlement engine (Phase B) for settling payables due today."""

from __future__ import annotations

from typing import List, Tuple

from bilancio.core.atomic_tx import atomic
from bilancio.core.errors import DefaultError, ValidationError
from bilancio.ops.banking import client_payment
from bilancio.ops.aliases import get_alias_for_id

DEFAULT_MODE_FAIL_FAST = "fail-fast"
DEFAULT_MODE_EXPEL = "expel-agent"

# Plan 024: Track settled payables for rollover
_settled_payables_for_rollover: List[Tuple[str, str, int, int, int]] = []
# List of (debtor_id, creditor_id, amount, maturity_distance, current_day)

_ACTION_AGENT_FIELDS = {
    "mint_reserves": ("to",),
    "mint_cash": ("to",),
    "transfer_reserves": ("from_bank", "to_bank"),
    "transfer_cash": ("from_agent", "to_agent"),
    "deposit_cash": ("customer", "bank"),
    "withdraw_cash": ("customer", "bank"),
    "client_payment": ("payer", "payee"),
    "create_stock": ("owner",),
    "transfer_stock": ("from_agent", "to_agent"),
    "create_delivery_obligation": ("from", "from_agent", "to", "to_agent"),
    "create_payable": ("from", "from_agent", "to", "to_agent"),
    "transfer_claim": ("to_agent",),
}

_ACTION_CONTRACT_FIELDS = {
    "transfer_claim": ("contract_id", "contract_alias"),
    "mint_cash": ("alias",),
    "mint_reserves": ("alias",),
    "create_delivery_obligation": ("alias",),
    "create_payable": ("alias",),
}


def _get_default_mode(system) -> str:
    """Return the configured default-handling mode for the system."""
    return getattr(system, "default_mode", DEFAULT_MODE_FAIL_FAST)


def due_payables(system, day: int):
    """Scan contracts for payables with due_day == day."""
    for c in system.state.contracts.values():
        if c.kind == "payable" and getattr(c, "due_day", None) == day:
            yield c


def due_delivery_obligations(system, day: int):
    """Scan contracts for delivery obligations with due_day == day."""
    for c in system.state.contracts.values():
        if c.kind == "delivery_obligation" and getattr(c, "due_day", None) == day:
            yield c


def _pay_with_deposits(system, debtor_id, creditor_id, amount) -> int:
    """Pay using bank deposits. Returns amount actually paid."""
    debtor_deposit_ids = []
    for cid in system.state.agents[debtor_id].asset_ids:
        contract = system.state.contracts[cid]
        if contract.kind == "bank_deposit":
            debtor_deposit_ids.append(cid)

    if not debtor_deposit_ids:
        return 0

    available = sum(system.state.contracts[cid].amount for cid in debtor_deposit_ids)
    if available == 0:
        return 0

    pay_amount = min(amount, available)

    debtor_bank_id = None
    creditor_bank_id = None

    if debtor_deposit_ids:
        debtor_bank_id = system.state.contracts[debtor_deposit_ids[0]].liability_issuer_id

    creditor_deposit_ids = []
    for cid in system.state.agents[creditor_id].asset_ids:
        contract = system.state.contracts[cid]
        if contract.kind == "bank_deposit":
            creditor_deposit_ids.append(cid)

    if creditor_deposit_ids:
        creditor_bank_id = system.state.contracts[creditor_deposit_ids[0]].liability_issuer_id
    else:
        creditor_bank_id = debtor_bank_id

    if not debtor_bank_id or not creditor_bank_id:
        return 0

    try:
        client_payment(system, debtor_id, debtor_bank_id, creditor_id, creditor_bank_id, pay_amount)
        return pay_amount
    except ValidationError:
        return 0


def _pay_with_cash(system, debtor_id, creditor_id, amount) -> int:
    """Pay using cash. Returns amount actually paid."""
    debtor_cash_ids = []
    for cid in system.state.agents[debtor_id].asset_ids:
        contract = system.state.contracts[cid]
        if contract.kind == "cash":
            debtor_cash_ids.append(cid)

    if not debtor_cash_ids:
        return 0

    available = sum(system.state.contracts[cid].amount for cid in debtor_cash_ids)
    if available == 0:
        return 0

    pay_amount = min(amount, available)

    try:
        system.transfer_cash(debtor_id, creditor_id, pay_amount)
        return pay_amount
    except ValidationError:
        return 0


def _pay_bank_to_bank_with_reserves(system, debtor_bank_id, creditor_bank_id, amount) -> int:
    """Pay using reserves between banks. Returns amount actually paid."""
    if debtor_bank_id == creditor_bank_id:
        return 0

    debtor_reserve_ids = []
    for cid in system.state.agents[debtor_bank_id].asset_ids:
        contract = system.state.contracts[cid]
        if contract.kind == "reserve_deposit":
            debtor_reserve_ids.append(cid)

    if not debtor_reserve_ids:
        return 0

    available = sum(system.state.contracts[cid].amount for cid in debtor_reserve_ids)
    if available == 0:
        return 0

    pay_amount = min(amount, available)

    try:
        system.transfer_reserves(debtor_bank_id, creditor_bank_id, pay_amount)
        return pay_amount
    except ValidationError:
        return 0


def _deliver_stock(system, debtor_id, creditor_id, sku: str, required_quantity: int) -> int:
    """Transfer stock lots from debtor to creditor by SKU using FIFO allocation."""
    available_stocks = []
    for stock_id in system.state.agents[debtor_id].stock_ids:
        stock = system.state.stocks[stock_id]
        if stock.sku == sku:
            available_stocks.append((stock_id, stock.quantity))

    if not available_stocks:
        return 0

    total_available = sum(quantity for _, quantity in available_stocks)
    if total_available == 0:
        return 0

    deliver_quantity = min(required_quantity, total_available)
    remaining_to_deliver = deliver_quantity

    available_stocks.sort(key=lambda x: x[0])

    try:
        for stock_id, stock_quantity in available_stocks:
            if remaining_to_deliver == 0:
                break

            transfer_qty = min(remaining_to_deliver, stock_quantity)
            system._transfer_stock_internal(stock_id, debtor_id, creditor_id, transfer_qty)
            remaining_to_deliver -= transfer_qty

        return deliver_quantity
    except ValidationError:
        return 0


def _remove_contract(system, contract_id):
    """Remove contract from system and update agent registries."""
    contract = system.state.contracts[contract_id]
    contract_kind = contract.kind
    contract_amount = getattr(contract, "amount", 0)

    # For secondary market transfers (e.g., payables sold to dealers),
    # remove from the effective holder, not the original asset_holder_id
    effective_holder_id = getattr(contract, 'effective_creditor', None) or contract.asset_holder_id
    effective_holder = system.state.agents.get(effective_holder_id)
    if effective_holder and contract_id in effective_holder.asset_ids:
        effective_holder.asset_ids.remove(contract_id)

    # Also check original asset_holder in case it wasn't transferred properly
    if effective_holder_id != contract.asset_holder_id:
        original_holder = system.state.agents.get(contract.asset_holder_id)
        if original_holder and contract_id in original_holder.asset_ids:
            original_holder.asset_ids.remove(contract_id)

    liability_issuer = system.state.agents[contract.liability_issuer_id]
    if contract_id in liability_issuer.liability_ids:
        liability_issuer.liability_ids.remove(contract_id)

    del system.state.contracts[contract_id]

    if contract_kind == "cash":
        system.state.cb_cash_outstanding -= contract_amount
    elif contract_kind == "reserve_deposit":
        system.state.cb_reserves_outstanding -= contract_amount


def _action_references_agent(action_dict, agent_id: str) -> bool:
    """Return True if the scheduled action references the given agent."""
    if not isinstance(action_dict, dict) or len(action_dict) != 1:
        return False

    action_name, payload = next(iter(action_dict.items()))
    if not isinstance(payload, dict):
        return False

    for field in _ACTION_AGENT_FIELDS.get(action_name, ()): 
        value = payload.get(field)
        if isinstance(value, str) and value == agent_id:
            return True
        if isinstance(value, list) and agent_id in value:
            return True
    return False


def _cancel_scheduled_actions_for_agent(
    system,
    agent_id: str,
    cancelled_contract_ids: set[str] | None = None,
    cancelled_aliases: set[str] | None = None,
) -> None:
    """Remove and log scheduled actions that involve a defaulted agent or cancelled contracts."""
    cancelled_contract_ids = cancelled_contract_ids or set()
    cancelled_aliases = cancelled_aliases or set()
    if not system.state.scheduled_actions_by_day:
        return

    for day, actions in list(system.state.scheduled_actions_by_day.items()):
        remaining = []
        for action_dict in actions:
            if _action_references_agent(action_dict, agent_id) or _action_references_contract(action_dict, cancelled_contract_ids, cancelled_aliases):
                action_name = next(iter(action_dict.keys()), "unknown") if isinstance(action_dict, dict) else "unknown"
                system.log(
                    "ScheduledActionCancelled",
                    agent=agent_id,
                    scheduled_day=day,
                    action=action_name,
                    mode=_get_default_mode(system),
                )
                continue
            remaining.append(action_dict)
        if remaining:
            system.state.scheduled_actions_by_day[day] = remaining
        else:
            del system.state.scheduled_actions_by_day[day]


def _action_references_contract(action_dict, contract_ids: set[str], aliases: set[str]) -> bool:
    if not isinstance(action_dict, dict) or len(action_dict) != 1:
        return False
    if not contract_ids and not aliases:
        return False

    action_name, payload = next(iter(action_dict.items()))
    if not isinstance(payload, dict):
        return False

    for field in _ACTION_CONTRACT_FIELDS.get(action_name, ("contract_id", "contract_alias", "alias")):
        value = payload.get(field)
        if isinstance(value, str) and (value in contract_ids or value in aliases):
            return True

    # common fallbacks
    for key in ("contract_id", "contract_alias", "alias"):
        value = payload.get(key)
        if isinstance(value, str) and (value in contract_ids or value in aliases):
            return True

    return False


def _expel_agent(
    system,
    agent_id: str,
    *,
    trigger_contract_id: str | None = None,
    trigger_kind: str | None = None,
    trigger_shortfall: int | None = None,
    cancelled_contract_ids: set[str] | None = None,
    cancelled_aliases: set[str] | None = None,
) -> None:
    """Mark an agent as defaulted, write off obligations, and cancel future actions."""
    if _get_default_mode(system) != DEFAULT_MODE_EXPEL:
        return

    if agent_id in system.state.defaulted_agent_ids:
        return

    agent = system.state.agents.get(agent_id)
    if agent is None:
        return

    if agent.kind == "central_bank":
        raise DefaultError("Central bank cannot default")

    agent.defaulted = True
    system.state.defaulted_agent_ids.add(agent_id)

    system.log(
        "AgentDefaulted",
        agent=agent_id,
        frm=agent_id,
        trigger_contract=trigger_contract_id,
        contract_kind=trigger_kind,
        shortfall=trigger_shortfall,
        mode=_get_default_mode(system),
    )

    cancelled_contract_ids = set(cancelled_contract_ids or [])
    cancelled_aliases = set(cancelled_aliases or [])

    # Remove any aliases provided for already-cancelled contracts
    for alias in list(cancelled_aliases):
        system.state.aliases.pop(alias, None)

    for cid, contract in list(system.state.contracts.items()):
        if contract.liability_issuer_id != agent_id:
            continue
        if trigger_contract_id and cid == trigger_contract_id:
            continue

        alias = get_alias_for_id(system, cid)
        if alias:
            cancelled_aliases.add(alias)
        payload = {
            "contract_id": cid,
            "alias": alias,
            "debtor": contract.liability_issuer_id,
            "creditor": contract.asset_holder_id,
            "contract_kind": contract.kind,
            "amount": getattr(contract, "amount", None),
            "due_day": getattr(contract, "due_day", None),
        }
        if hasattr(contract, "sku"):
            payload["sku"] = getattr(contract, "sku")
        if payload.get("due_day") is None:
            payload.pop("due_day", None)

        system.log("ObligationWrittenOff", **payload)
        _remove_contract(system, cid)
        cancelled_contract_ids.add(cid)
        if alias:
            system.state.aliases.pop(alias, None)

    _cancel_scheduled_actions_for_agent(system, agent_id, cancelled_contract_ids, cancelled_aliases)

    # If every non-central-bank agent has defaulted, halt the simulation with a DefaultError.
    if all(
        (ag.kind == "central_bank") or getattr(ag, "defaulted", False)
        for ag in system.state.agents.values()
    ):
        raise DefaultError("All non-central-bank agents have defaulted")


def settle_due_delivery_obligations(system, day: int):
    """Settle all delivery obligations due today using stock operations."""
    for obligation in list(due_delivery_obligations(system, day)):
        if obligation.id not in system.state.contracts:
            continue

        debtor = system.state.agents[obligation.liability_issuer_id]
        if getattr(debtor, "defaulted", False):
            continue

        creditor = system.state.agents[obligation.asset_holder_id]
        required_sku = obligation.sku
        required_quantity = obligation.amount

        with atomic(system):
            delivered_quantity = _deliver_stock(system, debtor.id, creditor.id, required_sku, required_quantity)

            if delivered_quantity != required_quantity:
                shortage = required_quantity - delivered_quantity
                if _get_default_mode(system) == DEFAULT_MODE_FAIL_FAST:
                    raise DefaultError(
                        f"Insufficient stock to settle delivery obligation {obligation.id}: {shortage} units of {required_sku} still owed"
                    )

                alias = get_alias_for_id(system, obligation.id)
                cancelled_contract_ids = {obligation.id}
                cancelled_aliases = {alias} if alias else set()
                if delivered_quantity > 0:
                    system.log(
                        "PartialSettlement",
                        contract_id=obligation.id,
                        alias=alias,
                        debtor=debtor.id,
                        creditor=creditor.id,
                        contract_kind=obligation.kind,
                        settlement_kind="delivery",
                        delivered_quantity=delivered_quantity,
                        required_quantity=required_quantity,
                        shortfall=shortage,
                        sku=required_sku,
                    )

                system.log(
                    "ObligationDefaulted",
                    contract_id=obligation.id,
                    alias=alias,
                    debtor=debtor.id,
                    creditor=creditor.id,
                    contract_kind=obligation.kind,
                    shortfall=shortage,
                    delivered_quantity=delivered_quantity,
                    required_quantity=required_quantity,
                    sku=required_sku,
                    qty=shortage,
                )

                _remove_contract(system, obligation.id)
                _expel_agent(
                    system,
                    debtor.id,
                    trigger_contract_id=obligation.id,
                    trigger_kind=obligation.kind,
                    trigger_shortfall=shortage,
                    cancelled_contract_ids=cancelled_contract_ids,
                    cancelled_aliases=cancelled_aliases,
                )
                continue

            system._cancel_delivery_obligation_internal(obligation.id)
            alias = get_alias_for_id(system, obligation.id)
            system.log(
                "DeliveryObligationSettled",
                obligation_id=obligation.id,
                contract_id=obligation.id,
                alias=alias,
                debtor=debtor.id,
                creditor=creditor.id,
                sku=required_sku,
                qty=required_quantity,
            )


def settle_due(system, day: int, *, rollover_enabled: bool = False):
    """Settle all obligations due today (payables and delivery obligations).

    Args:
        system: The system to settle
        day: Current simulation day
        rollover_enabled: If True, create new payables for successfully settled ones (Plan 024)

    Returns:
        List of settled payable info for rollover: [(debtor_id, creditor_id, amount, maturity_distance)]
    """
    settled_for_rollover = []

    for payable in list(due_payables(system, day)):
        if payable.id not in system.state.contracts:
            continue

        debtor = system.state.agents[payable.liability_issuer_id]
        if getattr(debtor, "defaulted", False):
            continue

        # Use effective_creditor to handle secondary market transfers
        # (holder_id if transferred, otherwise original asset_holder_id)
        creditor_id = payable.effective_creditor
        creditor = system.state.agents[creditor_id]
        order = system.policy.settlement_order(debtor)

        remaining = payable.amount
        payments_summary: list[dict] = []

        # Save payable info before potential removal
        payable_amount = payable.amount
        payable_maturity_distance = getattr(payable, 'maturity_distance', None)
        original_creditor = payable.asset_holder_id  # Original creditor for rollover

        with atomic(system):
            for method in order:
                if remaining == 0:
                    break

                if method == "bank_deposit":
                    paid_now = _pay_with_deposits(system, debtor.id, creditor.id, remaining)
                elif method == "cash":
                    paid_now = _pay_with_cash(system, debtor.id, creditor.id, remaining)
                elif method == "reserve_deposit":
                    paid_now = _pay_bank_to_bank_with_reserves(system, debtor.id, creditor.id, remaining)
                else:
                    raise ValidationError(f"unknown payment method {method}")

                remaining -= paid_now
                if paid_now > 0:
                    payments_summary.append({"method": method, "amount": paid_now})

            if remaining != 0:
                if _get_default_mode(system) == DEFAULT_MODE_FAIL_FAST:
                    raise DefaultError(f"Insufficient funds to settle payable {payable.id}: {remaining} still owed")

                alias = get_alias_for_id(system, payable.id)
                cancelled_contract_ids = {payable.id}
                cancelled_aliases = {alias} if alias else set()
                amount_paid = payable.amount - remaining

                if amount_paid > 0:
                    payload = {
                        "contract_id": payable.id,
                        "alias": alias,
                        "debtor": debtor.id,
                        "creditor": creditor.id,
                        "contract_kind": payable.kind,
                        "settlement_kind": "payable",
                        "amount_paid": amount_paid,
                        "shortfall": remaining,
                        "original_amount": payable.amount,
                    }
                    if payments_summary:
                        payload["distribution"] = payments_summary
                    system.log("PartialSettlement", **payload)

                system.log(
                    "ObligationDefaulted",
                    contract_id=payable.id,
                    alias=alias,
                    debtor=debtor.id,
                    creditor=creditor.id,
                    contract_kind=payable.kind,
                    shortfall=remaining,
                    amount_paid=amount_paid,
                    original_amount=payable.amount,
                    amount=remaining,
                )

                _remove_contract(system, payable.id)
                _expel_agent(
                    system,
                    debtor.id,
                    trigger_contract_id=payable.id,
                    trigger_kind=payable.kind,
                    trigger_shortfall=remaining,
                    cancelled_contract_ids=cancelled_contract_ids,
                    cancelled_aliases=cancelled_aliases,
                )
                # Defaulted - no rollover
                continue

            _remove_contract(system, payable.id)
            alias = get_alias_for_id(system, payable.id)
            system.log(
                "PayableSettled",
                pid=payable.id,
                contract_id=payable.id,
                alias=alias,
                debtor=debtor.id,
                creditor=creditor.id,
                amount=payable_amount,
            )

            # Plan 024: Track for rollover (only if successfully settled AND rollover enabled)
            if rollover_enabled and payable_maturity_distance is not None:
                # Use original creditor for rollover, not secondary market holder
                settled_for_rollover.append((
                    debtor.id,
                    original_creditor,
                    payable_amount,
                    payable_maturity_distance,
                ))

    settle_due_delivery_obligations(system, day)

    return settled_for_rollover


def rollover_settled_payables(system, day: int, settled_payables: list):
    """Create new payables for successfully settled ones (continuous issuance via rollover).

    Per PDF specification (Plan 024):
    - Each liability records its original maturity distance ΔT
    - When a claim is repaid, borrower immediately issues new claim of same size/ΔT
    - Due date = current_day + ΔT
    - Cash moves from lender (creditor) to borrower (debtor) as part of new issuance

    Args:
        system: The system
        day: Current simulation day
        settled_payables: List of (debtor_id, creditor_id, amount, maturity_distance)
    """
    from bilancio.domain.instruments.credit import Payable

    for debtor_id, creditor_id, amount, maturity_distance in settled_payables:
        # Skip if either party has defaulted
        debtor = system.state.agents.get(debtor_id)
        creditor = system.state.agents.get(creditor_id)

        if debtor is None or getattr(debtor, "defaulted", False):
            continue
        if creditor is None or getattr(creditor, "defaulted", False):
            continue

        new_due_day = day + maturity_distance

        with atomic(system):
            # 1. Create new payable with same amount and ΔT
            new_payable = Payable(
                id=system.new_contract_id("PAY"),
                kind="payable",
                amount=amount,
                denom="X",
                asset_holder_id=creditor_id,  # creditor holds the asset
                liability_issuer_id=debtor_id,  # debtor issues the liability
                due_day=new_due_day,
                maturity_distance=maturity_distance,
            )
            system.add_contract(new_payable)

            # 2. Transfer cash from creditor to debtor (new issuance)
            # This represents the creditor re-lending the money they just received
            cash_transferred = _pay_with_cash(system, creditor_id, debtor_id, amount)

            if cash_transferred != amount:
                # Creditor doesn't have enough cash - this shouldn't happen in normal rollover
                # but handle gracefully
                system.log(
                    "RolloverPartial",
                    debtor=debtor_id,
                    creditor=creditor_id,
                    amount=amount,
                    cash_transferred=cash_transferred,
                    new_due_day=new_due_day,
                    payable_id=new_payable.id,
                )
            else:
                system.log(
                    "PayableRolledOver",
                    debtor=debtor_id,
                    creditor=creditor_id,
                    amount=amount,
                    new_due_day=new_due_day,
                    maturity_distance=maturity_distance,
                    payable_id=new_payable.id,
                )

```

---

### 📄 src/bilancio/engines/simulation.py

```python
"""Simulation engines for financial scenario analysis."""

import random
from dataclasses import dataclass
from typing import Any, Protocol

from bilancio.engines.clearing import settle_intraday_nets
from bilancio.engines.settlement import settle_due, rollover_settled_payables


IMPACT_EVENTS = {
    "PayableSettled",
    "DeliveryObligationSettled",
    "InterbankCleared",
    "InterbankOvernightCreated",
}


@dataclass
class DayReport:
    day: int
    impacted: int
    notes: str = ""


def _impacted_today(system, day: int) -> int:
    return sum(1 for e in system.state.events if e.get("day") == day and e.get("kind") in IMPACT_EVENTS)


def _has_open_obligations(system) -> bool:
    for c in system.state.contracts.values():
        if c.kind in ("payable", "delivery_obligation"):
            return True
    return False


class SimulationEngine(Protocol):
    """Protocol for simulation engines that can run financial scenarios."""

    def run(self, scenario: Any) -> Any:
        """
        Run a simulation for a given scenario.
        
        Args:
            scenario: The scenario to simulate
            
        Returns:
            Simulation results
        """
        ...


class MonteCarloEngine:
    """Monte Carlo simulation engine for financial scenarios."""

    def __init__(self, num_simulations: int = 1000, n_simulations: int | None = None, random_seed: int | None = None):
        """
        Initialize the Monte Carlo engine.
        
        Args:
            num_simulations: Number of simulation runs to perform
            n_simulations: Alternative parameter name for num_simulations (for compatibility)
            random_seed: Optional seed for reproducible results
        """
        # Support both parameter names for compatibility
        if n_simulations is not None:
            self.num_simulations = n_simulations
            self.n_simulations = n_simulations
        else:
            self.num_simulations = num_simulations
            self.n_simulations = num_simulations

        if random_seed is not None:
            random.seed(random_seed)

    def run(self, scenario: Any) -> dict[str, Any]:
        """
        Run Monte Carlo simulation for a scenario.
        
        This is a placeholder implementation. A real implementation would:
        1. Extract parameters and distributions from the scenario
        2. Generate random samples according to those distributions
        3. Run the scenario multiple times with different random inputs
        4. Aggregate and return statistical results
        
        Args:
            scenario: The scenario to simulate
            
        Returns:
            Dictionary containing simulation results and statistics
        """
        # Placeholder implementation
        results = []

        for i in range(self.num_simulations):
            # In a real implementation, this would:
            # - Sample from probability distributions
            # - Apply scenario logic with sampled values
            # - Calculate outcome metrics

            # For now, just generate dummy results
            result = {
                'run_id': i,
                'outcome': random.gauss(100, 20),  # Placeholder random outcome
                'scenario': scenario
            }
            results.append(result)

        # Calculate summary statistics
        outcomes = [r['outcome'] for r in results]
        summary = {
            'num_simulations': self.num_simulations,
            'mean': sum(outcomes) / len(outcomes),
            'min': min(outcomes),
            'max': max(outcomes),
            'results': results
        }

        return summary

    def set_num_simulations(self, num_simulations: int) -> None:
        """Update the number of simulations to run."""
        self.num_simulations = num_simulations


def run_day(system, enable_dealer: bool = False):
    """
    Run a single day's simulation with three phases.

    Phase A: Log PhaseA event (noop for now)
    Phase B: Settle obligations due on the current day using settle_due
    Phase C: Clear intraday nets for the current day using settle_intraday_nets

    Finally, increment the system day counter.

    Args:
        system: System instance to run the day for
        enable_dealer: If True, run dealer trading phase between scheduled actions and settlements

    Note: Rollover is controlled by system.state.rollover_enabled (Plan 024)
    """
    current_day = system.state.day
    rollover_enabled = getattr(system.state, 'rollover_enabled', False)

    # Phase A: Log PhaseA event (reserved)
    system.log("PhaseA")

    # Phase B: two subphases — B1 scheduled actions, B2 settlements
    system.log("PhaseB")  # Phase B bucket marker
    # B1: Execute scheduled actions for this day (if any)
    system.log("SubphaseB1")
    try:
        actions_today = system.state.scheduled_actions_by_day.get(current_day, [])
        if actions_today:
            # Lazy import to avoid heavy imports at module load
            from bilancio.config.apply import apply_action
            agents = system.state.agents
            for action_dict in actions_today:
                apply_action(system, action_dict, agents)
    except Exception:
        # Allow scheduled-action errors to bubble via apply_action's own error handling
        # but keep guard to ensure the simulation loop stability
        raise

    # SubphaseB_Dealer: Run dealer trading phase (optional)
    if enable_dealer and hasattr(system.state, 'dealer_subsystem') and system.state.dealer_subsystem is not None:
        system.log("SubphaseB_Dealer")
        # Lazy import to avoid circular dependencies
        from bilancio.engines.dealer_integration import run_dealer_trading_phase, sync_dealer_to_system

        # Run dealer trading and collect events
        dealer_events = run_dealer_trading_phase(system.state.dealer_subsystem, system, current_day)
        system.state.events.extend(dealer_events)

        # Sync dealer state back to main system
        sync_dealer_to_system(system.state.dealer_subsystem, system)

    # B2: Automated settlements due today
    system.log("SubphaseB2")
    settled_for_rollover = settle_due(system, current_day, rollover_enabled=rollover_enabled)

    # Plan 024: Rollover - create new payables for settled ones
    if rollover_enabled and settled_for_rollover:
        system.log("SubphaseB_Rollover")
        rollover_settled_payables(system, current_day, settled_for_rollover)

    # Phase C: Clear intraday nets for the current day
    system.log("PhaseC")  # optional: helps timeline
    settle_intraday_nets(system, current_day)

    # Increment system day
    system.state.day += 1


def run_until_stable(system, max_days: int = 365, quiet_days: int = 2, enable_dealer: bool = False) -> list[DayReport]:
    """
    Advance day by day until the system is stable:
    - No impactful events happen for `quiet_days` consecutive days, AND
    - No outstanding payables or delivery obligations remain.

    Args:
        system: System instance to run
        max_days: Maximum number of days to run
        quiet_days: Number of consecutive quiet days needed for stability
        enable_dealer: If True, run dealer trading phase each day

    Note: Rollover is controlled by system.state.rollover_enabled (Plan 024)
    """
    reports = []
    consecutive_quiet = 0
    start_day = system.state.day
    rollover_enabled = getattr(system.state, 'rollover_enabled', False)

    for _ in range(max_days):
        day_before = system.state.day
        run_day(system, enable_dealer=enable_dealer)
        impacted = _impacted_today(system, day_before)
        reports.append(DayReport(day=day_before, impacted=impacted))

        if impacted == 0:
            consecutive_quiet += 1
        else:
            consecutive_quiet = 0

        # With rollover enabled, we can never have no open obligations - always have debt rolling
        # So we only check for stability without obligations when rollover is disabled
        stability_condition = consecutive_quiet >= quiet_days
        if not rollover_enabled:
            stability_condition = stability_condition and not _has_open_obligations(system)

        if stability_condition:
            break

    return reports

```

---

### 📄 src/bilancio/engines/system.py

```python
from __future__ import annotations

from contextlib import contextmanager
from dataclasses import dataclass, field
from decimal import Decimal

from bilancio.core.atomic_tx import atomic
from bilancio.core.errors import ValidationError
from bilancio.core.ids import AgentId, InstrId, new_id
from bilancio.domain.agent import Agent
from bilancio.domain.instruments.base import Instrument
from bilancio.domain.instruments.means_of_payment import Cash, ReserveDeposit
from bilancio.domain.instruments.delivery import DeliveryObligation
from bilancio.domain.goods import StockLot
from bilancio.domain.policy import PolicyEngine
from bilancio.ops.primitives import consume, merge, split
from bilancio.ops.primitives_stock import split_stock, merge_stock


@dataclass
class State:
    agents: dict[AgentId, Agent] = field(default_factory=dict)
    contracts: dict[InstrId, Instrument] = field(default_factory=dict)
    stocks: dict[InstrId, StockLot] = field(default_factory=dict)
    events: list[dict] = field(default_factory=list)
    day: int = 0
    cb_cash_outstanding: int = 0
    cb_reserves_outstanding: int = 0
    phase: str = "simulation"
    # Aliases for created contracts (alias -> contract_id)
    aliases: dict[str, str] = field(default_factory=dict)
    # Scheduled actions to run at Phase B1 by day (day -> list of action dicts)
    scheduled_actions_by_day: dict[int, list[dict]] = field(default_factory=dict)
    # Track agents that have defaulted and been expelled from future activity
    defaulted_agent_ids: set[AgentId] = field(default_factory=set)
    # Plan 024: Enable continuous rollover of settled payables
    rollover_enabled: bool = False

class System:
    def __init__(self, policy: PolicyEngine | None = None, default_mode: str = "fail-fast"):
        self.policy = policy or PolicyEngine.default()
        self.state = State()
        self.default_mode = default_mode

    # ---- ID helpers
    def new_agent_id(self, prefix="A") -> AgentId: return new_id(prefix)
    def new_contract_id(self, prefix="C") -> InstrId: return new_id(prefix)

    # ---- phase management
    @contextmanager
    def setup(self):
        """Context manager to temporarily set phase to 'setup'."""
        old_phase = self.state.phase
        self.state.phase = "setup"
        try:
            yield
        finally:
            self.state.phase = old_phase

    # ---- registry gateway
    def add_agent(self, agent: Agent) -> None:
        self.state.agents[agent.id] = agent

    def add_contract(self, c: Instrument) -> None:
        # type invariants
        c.validate_type_invariants()
        # policy checks
        holder = self.state.agents[c.asset_holder_id]
        issuer = self.state.agents[c.liability_issuer_id]
        if not self.policy.can_hold(holder, c):
            raise ValidationError(f"{holder.kind} cannot hold {c.kind}")
        if not self.policy.can_issue(issuer, c):
            raise ValidationError(f"{issuer.kind} cannot issue {c.kind}")

        self.state.contracts[c.id] = c
        holder.asset_ids.append(c.id)
        issuer.liability_ids.append(c.id)

    # ---- events
    def log(self, kind: str, **payload) -> None:
        self.state.events.append({"kind": kind, "day": self.state.day, "phase": self.state.phase, **payload})

    # ---- invariants (MVP)
    def assert_invariants(self) -> None:
        from bilancio.core.invariants import (
            assert_cb_cash_matches_outstanding,
            assert_cb_reserves_match,
            assert_double_entry_numeric,
            assert_no_negative_balances,
            assert_no_duplicate_refs,
            assert_all_stock_ids_owned,
            assert_no_negative_stocks,
            assert_no_duplicate_stock_refs,
        )
        for cid, c in self.state.contracts.items():
            # For secondary market transfers (e.g., payables sold to dealers),
            # check the effective holder, not the original asset_holder_id
            effective_holder_id = getattr(c, 'effective_creditor', None) or c.asset_holder_id
            assert cid in self.state.agents[effective_holder_id].asset_ids, f"{cid} missing on asset holder {effective_holder_id}"
            assert cid in self.state.agents[c.liability_issuer_id].liability_ids, f"{cid} missing on issuer"
        assert_no_duplicate_refs(self)
        assert_cb_cash_matches_outstanding(self)
        assert_cb_reserves_match(self)
        assert_no_negative_balances(self)
        assert_double_entry_numeric(self)
        # Stock-related invariants
        assert_all_stock_ids_owned(self)
        assert_no_negative_stocks(self)
        assert_no_duplicate_stock_refs(self)

    # ---- bootstrap helper
    def bootstrap_cb(self, cb: Agent) -> None:
        self.add_agent(cb)
        self.log("BootstrapCB", cb_id=cb.id)
    
    def add_agents(self, agents: list[Agent]) -> None:
        """Add multiple agents to the system at once."""
        for agent in agents:
            self.add_agent(agent)

    # ---- cash operations
    def mint_cash(self, to_agent_id: AgentId, amount: int, denom="X", alias: str | None = None) -> str:
        cb_id = next((aid for aid,a in self.state.agents.items() if a.kind == "central_bank"), None)
        assert cb_id, "CentralBank must exist"
        instr_id = self.new_contract_id("C")
        c = Cash(
            id=instr_id, kind="cash", amount=amount, denom=denom,
            asset_holder_id=to_agent_id, liability_issuer_id=cb_id
        )
        with atomic(self):
            self.add_contract(c)
            self.state.cb_cash_outstanding += amount
            # Include alias if provided (for UI linking)
            if alias is not None:
                self.log("CashMinted", to=to_agent_id, amount=amount, instr_id=instr_id, alias=alias)
            else:
                self.log("CashMinted", to=to_agent_id, amount=amount, instr_id=instr_id)
        return instr_id

    def retire_cash(self, from_agent_id: AgentId, amount: int) -> None:
        # pull from holder's cash instruments (simple greedy)
        with atomic(self):
            remaining = amount
            cash_ids = [cid for cid in self.state.agents[from_agent_id].asset_ids
                        if self.state.contracts[cid].kind == "cash"]
            for cid in list(cash_ids):
                instr = self.state.contracts[cid]
                take = min(instr.amount, remaining)
                consume(self, cid, take)
                remaining -= take
                if remaining == 0: break
            if remaining != 0:
                raise ValidationError("insufficient cash to retire")
            self.state.cb_cash_outstanding -= amount
            self.log("CashRetired", frm=from_agent_id, amount=amount)

    def transfer_cash(self, from_agent_id: AgentId, to_agent_id: AgentId, amount: int) -> str:
        if from_agent_id == to_agent_id:
            raise ValidationError("no-op transfer")
        with atomic(self):
            remaining = amount
            # collect cash pieces and split as needed
            for cid in list(self.state.agents[from_agent_id].asset_ids):
                instr = self.state.contracts.get(cid)
                if not instr or instr.kind != "cash": continue
                piece_id = cid
                if instr.amount > remaining:
                    piece_id = split(self, cid, remaining)
                piece = self.state.contracts[piece_id]
                # move holder
                self.state.agents[from_agent_id].asset_ids.remove(piece_id)
                self.state.agents[to_agent_id].asset_ids.append(piece_id)
                piece.asset_holder_id = to_agent_id
                self.log("CashTransferred", frm=from_agent_id, to=to_agent_id, amount=min(remaining, piece.amount), instr_id=piece_id)
                remaining -= piece.amount
                if remaining == 0: break
            if remaining != 0:
                raise ValidationError("insufficient cash")
            # optional coalesce at receiver (merge duplicates)
            rx_ids = [cid for cid in self.state.agents[to_agent_id].asset_ids
                      if self.state.contracts[cid].kind == "cash"]
            # naive coalesce: pairwise merge same-key
            seen = {}
            for cid in rx_ids:
                k = (self.state.contracts[cid].denom, self.state.contracts[cid].liability_issuer_id)
                keep = seen.get(k)
                if keep and keep != cid:
                    merge(self, keep, cid)
                else:
                    seen[k] = cid
        return "ok"

    # ---- reserve operations
    def _central_bank_id(self) -> str:
        """Find and return the central bank agent ID"""
        cb_id = next((aid for aid, a in self.state.agents.items() if a.kind == "central_bank"), None)
        if not cb_id:
            raise ValidationError("CentralBank must exist")
        return cb_id

    def mint_reserves(self, to_bank_id: str, amount: int, denom="X", alias: str | None = None) -> str:
        """Mint reserves to a bank"""
        cb_id = self._central_bank_id()
        instr_id = self.new_contract_id("R")
        c = ReserveDeposit(
            id=instr_id, kind="reserve_deposit", amount=amount, denom=denom,
            asset_holder_id=to_bank_id, liability_issuer_id=cb_id
        )
        with atomic(self):
            self.add_contract(c)
            self.state.cb_reserves_outstanding += amount
            if alias is not None:
                self.log("ReservesMinted", to=to_bank_id, amount=amount, instr_id=instr_id, alias=alias)
            else:
                self.log("ReservesMinted", to=to_bank_id, amount=amount, instr_id=instr_id)
        return instr_id

    def transfer_reserves(self, from_bank_id: str, to_bank_id: str, amount: int) -> None:
        """Transfer reserves between banks"""
        if from_bank_id == to_bank_id:
            raise ValidationError("no-op transfer")
        with atomic(self):
            remaining = amount
            # collect reserve pieces and split as needed
            for cid in list(self.state.agents[from_bank_id].asset_ids):
                instr = self.state.contracts.get(cid)
                if not instr or instr.kind != "reserve_deposit": continue
                piece_id = cid
                if instr.amount > remaining:
                    piece_id = split(self, cid, remaining)
                piece = self.state.contracts[piece_id]
                # move holder
                self.state.agents[from_bank_id].asset_ids.remove(piece_id)
                self.state.agents[to_bank_id].asset_ids.append(piece_id)
                piece.asset_holder_id = to_bank_id
                self.log("ReservesTransferred", frm=from_bank_id, to=to_bank_id, amount=min(remaining, piece.amount), instr_id=piece_id)
                remaining -= piece.amount
                if remaining == 0: break
            if remaining != 0:
                raise ValidationError("insufficient reserves")
            # optional coalesce at receiver (merge duplicates)
            rx_ids = [cid for cid in self.state.agents[to_bank_id].asset_ids
                      if self.state.contracts[cid].kind == "reserve_deposit"]
            # naive coalesce: pairwise merge same-key
            seen = {}
            for cid in rx_ids:
                k = (self.state.contracts[cid].denom, self.state.contracts[cid].liability_issuer_id)
                keep = seen.get(k)
                if keep and keep != cid:
                    merge(self, keep, cid)
                else:
                    seen[k] = cid

    def convert_reserves_to_cash(self, bank_id: str, amount: int) -> None:
        """Convert reserves to cash"""
        with atomic(self):
            # consume reserves
            remaining = amount
            reserve_ids = [cid for cid in self.state.agents[bank_id].asset_ids
                          if self.state.contracts[cid].kind == "reserve_deposit"]
            for cid in list(reserve_ids):
                instr = self.state.contracts[cid]
                take = min(instr.amount, remaining)
                consume(self, cid, take)
                remaining -= take
                if remaining == 0: break
            if remaining != 0:
                raise ValidationError("insufficient reserves to convert")
            # update outstanding reserves
            self.state.cb_reserves_outstanding -= amount
            # mint equivalent cash
            self.state.cb_cash_outstanding += amount
            cb_id = self._central_bank_id()
            instr_id = self.new_contract_id("C")
            c = Cash(
                id=instr_id, kind="cash", amount=amount, denom="X",
                asset_holder_id=bank_id, liability_issuer_id=cb_id
            )
            self.add_contract(c)
            self.log("ReservesToCash", bank_id=bank_id, amount=amount, instr_id=instr_id)

    def convert_cash_to_reserves(self, bank_id: str, amount: int) -> None:
        """Convert cash to reserves"""
        with atomic(self):
            # consume cash
            remaining = amount
            cash_ids = [cid for cid in self.state.agents[bank_id].asset_ids
                       if self.state.contracts[cid].kind == "cash"]
            for cid in list(cash_ids):
                instr = self.state.contracts[cid]
                take = min(instr.amount, remaining)
                consume(self, cid, take)
                remaining -= take
                if remaining == 0: break
            if remaining != 0:
                raise ValidationError("insufficient cash to convert")
            # update outstanding cash
            self.state.cb_cash_outstanding -= amount
            # mint equivalent reserves
            self.state.cb_reserves_outstanding += amount
            cb_id = self._central_bank_id()
            instr_id = self.new_contract_id("R")
            c = ReserveDeposit(
                id=instr_id, kind="reserve_deposit", amount=amount, denom="X",
                asset_holder_id=bank_id, liability_issuer_id=cb_id
            )
            self.add_contract(c)
            self.log("CashToReserves", bank_id=bank_id, amount=amount, instr_id=instr_id)

    # ---- deposit helpers
    def deposit_ids(self, customer_id: str, bank_id: str) -> list[str]:
        """Filter customer assets for bank_deposit issued by bank_id"""
        out = []
        for cid in self.state.agents[customer_id].asset_ids:
            c = self.state.contracts[cid]
            if c.kind == "bank_deposit" and c.liability_issuer_id == bank_id:
                out.append(cid)
        return out

    def total_deposit(self, customer_id: str, bank_id: str) -> int:
        """Calculate total deposit amount for customer at bank"""
        return sum(self.state.contracts[cid].amount for cid in self.deposit_ids(customer_id, bank_id))

    # ---- obligation settlement

    def settle_obligation(self, contract_id: InstrId) -> None:
        """
        Settle and extinguish a bilateral obligation.
        
        This removes a matched asset-liability pair when the obligation has been fulfilled,
        such as after delivering goods or services that were promised.
        
        Args:
            contract_id: The ID of the contract to settle
            
        Raises:
            ValidationError: If the contract doesn't exist
        """
        with atomic(self):
            # Validate contract exists
            if contract_id not in self.state.contracts:
                raise ValidationError(f"Contract {contract_id} not found")
            
            contract = self.state.contracts[contract_id]
            
            # Remove from holder's assets
            holder = self.state.agents[contract.asset_holder_id]
            if contract_id not in holder.asset_ids:
                raise ValidationError(f"Contract {contract_id} not in holder's assets")
            holder.asset_ids.remove(contract_id)
            
            # Remove from issuer's liabilities
            issuer = self.state.agents[contract.liability_issuer_id]
            if contract_id not in issuer.liability_ids:
                raise ValidationError(f"Contract {contract_id} not in issuer's liabilities")
            issuer.liability_ids.remove(contract_id)
            
            # Remove contract from registry
            del self.state.contracts[contract_id]
            
            # Log the settlement
            self.log("ObligationSettled",
                    contract_id=contract_id,
                    holder_id=contract.asset_holder_id,
                    issuer_id=contract.liability_issuer_id,
                    contract_kind=contract.kind,
                    amount=contract.amount)

    # ---- stock operations (inventory)
    def create_stock(self, owner_id: AgentId, sku: str, quantity: int, unit_price: Decimal, divisible: bool=True) -> InstrId:
        """Create a new stock lot (inventory)."""
        stock_id = new_id("S")
        stock = StockLot(
            id=stock_id,
            kind="stock_lot",
            sku=sku,
            quantity=quantity,
            unit_price=unit_price,
            owner_id=owner_id,
            divisible=divisible
        )
        with atomic(self):
            self.state.stocks[stock_id] = stock
            self.state.agents[owner_id].stock_ids.append(stock_id)
            self.log("StockCreated", owner=owner_id, sku=sku, qty=quantity, unit_price=unit_price, stock_id=stock_id)
        return stock_id

    def split_stock(self, stock_id: InstrId, quantity: int) -> InstrId:
        """Split a stock lot. Returns ID of the new split piece."""
        with atomic(self):
            return split_stock(self, stock_id, quantity)

    def merge_stock(self, stock_id_keep: InstrId, stock_id_into: InstrId) -> InstrId:
        """Merge two stock lots. Returns the ID of the kept lot."""
        with atomic(self):
            return merge_stock(self, stock_id_keep, stock_id_into)

    def _transfer_stock_internal(self, stock_id: InstrId, from_owner: AgentId, to_owner: AgentId, quantity: int = None) -> InstrId:
        """Internal helper for stock transfer without atomic wrapper."""
        stock = self.state.stocks[stock_id]
        if stock.owner_id != from_owner:
            raise ValidationError("Stock owner mismatch")
        
        moving_id = stock_id
        if quantity is not None:
            if not stock.divisible:
                raise ValidationError("Stock lot is not divisible")
            if quantity <= 0 or quantity > stock.quantity:
                raise ValidationError("Invalid transfer quantity")
            if quantity < stock.quantity:
                moving_id = split_stock(self, stock_id, quantity)
        
        # Transfer ownership
        moving_stock = self.state.stocks[moving_id]
        self.state.agents[from_owner].stock_ids.remove(moving_id)
        self.state.agents[to_owner].stock_ids.append(moving_id)
        moving_stock.owner_id = to_owner
        
        self.log("StockTransferred", 
                frm=from_owner, 
                to=to_owner, 
                stock_id=moving_id, 
                sku=moving_stock.sku,
                qty=moving_stock.quantity)
        return moving_id

    def transfer_stock(self, stock_id: InstrId, from_owner: AgentId, to_owner: AgentId, quantity: int = None) -> InstrId:
        """Transfer stock from one owner to another."""
        with atomic(self):
            return self._transfer_stock_internal(stock_id, from_owner, to_owner, quantity)

    # ---- delivery obligation operations
    def create_delivery_obligation(self, from_agent: AgentId, to_agent: AgentId, sku: str, quantity: int, unit_price: Decimal, due_day: int, alias: str | None = None) -> InstrId:
        """Create a delivery obligation (bilateral promise to deliver goods)."""
        obligation_id = self.new_contract_id("D")
        obligation = DeliveryObligation(
            id=obligation_id,
            kind="delivery_obligation",
            amount=quantity,
            denom="N/A",
            asset_holder_id=to_agent,
            liability_issuer_id=from_agent,
            sku=sku,
            unit_price=unit_price,
            due_day=due_day
        )
        with atomic(self):
            self.add_contract(obligation)
            if alias is not None:
                self.log("DeliveryObligationCreated", 
                        id=obligation_id, 
                        frm=from_agent, 
                        to=to_agent, 
                        sku=sku, 
                        qty=quantity, 
                        due_day=due_day, 
                        unit_price=unit_price,
                        alias=alias)
            else:
                self.log("DeliveryObligationCreated", 
                        id=obligation_id, 
                        frm=from_agent, 
                        to=to_agent, 
                        sku=sku, 
                        qty=quantity, 
                        due_day=due_day, 
                        unit_price=unit_price)
        return obligation_id

    def _cancel_delivery_obligation_internal(self, obligation_id: InstrId) -> None:
        """Internal helper for cancelling delivery obligation without atomic wrapper."""
        # Validate contract exists and is a delivery obligation
        if obligation_id not in self.state.contracts:
            raise ValidationError(f"Contract {obligation_id} not found")
        
        contract = self.state.contracts[obligation_id]
        if contract.kind != "delivery_obligation":
            raise ValidationError(f"Contract {obligation_id} is not a delivery obligation")
        
        # Remove from holder's assets
        holder = self.state.agents[contract.asset_holder_id]
        if obligation_id not in holder.asset_ids:
            raise ValidationError(f"Contract {obligation_id} not in holder's assets")
        holder.asset_ids.remove(obligation_id)
        
        # Remove from issuer's liabilities
        issuer = self.state.agents[contract.liability_issuer_id]
        if obligation_id not in issuer.liability_ids:
            raise ValidationError(f"Contract {obligation_id} not in issuer's liabilities")
        issuer.liability_ids.remove(obligation_id)
        
        # Remove contract from registry
        del self.state.contracts[obligation_id]
        
        # Log the cancellation with alias (if any) and contract_id for UI consistency
        from bilancio.ops.aliases import get_alias_for_id
        alias = get_alias_for_id(self, obligation_id)
        self.log("DeliveryObligationCancelled",
                obligation_id=obligation_id,
                contract_id=obligation_id,
                alias=alias,
                debtor=contract.liability_issuer_id,
                creditor=contract.asset_holder_id,
                sku=contract.sku,
                qty=contract.amount)

    def cancel_delivery_obligation(self, obligation_id: InstrId) -> None:
        """Cancel (extinguish) a delivery obligation. Used by settlement engine after fulfillment."""
        with atomic(self):
            self._cancel_delivery_obligation_internal(obligation_id)

```

---

### 📄 src/bilancio/engines/valuation.py

```python
"""Valuation engines for financial instruments."""

from decimal import Decimal
from typing import Any, Protocol

# Placeholder type - this should be replaced with actual implementation from the domain layer
Money = Decimal


class ValuationEngine(Protocol):
    """Protocol for valuation engines that can price financial instruments."""

    def value(self, instrument: Any, context: dict[str, Any]) -> Money:
        """
        Calculate the value of a financial instrument.
        
        Args:
            instrument: The financial instrument to value
            context: Additional context needed for valuation (e.g., market data, parameters)
            
        Returns:
            The calculated value as Money
        """
        ...


class SimpleValuationEngine:
    """Basic valuation engine implementing present value calculation."""

    def __init__(self, discount_rate: float = 0.05):
        """
        Initialize the valuation engine.
        
        Args:
            discount_rate: Default discount rate for present value calculations
        """
        self.discount_rate = discount_rate

    def value(self, instrument: Any, context: dict[str, Any]) -> Money:
        """
        Calculate present value of an instrument.
        
        This is a basic implementation that assumes the instrument has a simple
        cash flow structure. More sophisticated instruments would require
        specialized valuation logic.
        
        Args:
            instrument: The financial instrument to value
            context: Valuation context containing discount rate, market data, etc.
            
        Returns:
            Present value as Money
        """
        # Get discount rate from context or use default
        rate = context.get('discount_rate', self.discount_rate)

        # This is a placeholder implementation
        # Real implementation would depend on the instrument type and its cash flows
        if hasattr(instrument, 'face_value'):
            return Money(str(instrument.face_value))

        # Default to zero if we can't determine value
        return Money('0.0')

    def set_discount_rate(self, rate: float) -> None:
        """Update the default discount rate."""
        self.discount_rate = rate

```

---

### 📄 src/bilancio/experiments/__init__.py

```python
"""Experiment orchestration helpers."""

from .ring import RingSweepRunner, RingRunSummary

__all__ = ["RingSweepRunner", "RingRunSummary"]

```

---

### 📄 src/bilancio/experiments/balanced_comparison.py

```python
"""Utilities for running balanced C vs D comparison experiments.

This module provides infrastructure for running paired passive/active
experiments comparing Kalecki ring simulations with:
- C (Passive): Big entities hold securities + cash but DON'T trade
- D (Active): Big entities hold securities + cash and CAN trade

The key output is the delta in defaults between conditions, measuring
the effect of market-making by dealers.

Reference: Plan 021 and Section 9.3 of the specification.
"""

from __future__ import annotations

import csv
import json
import logging
import time
from dataclasses import dataclass, field
from decimal import Decimal
from pathlib import Path
from typing import Any, Callable, Dict, List, Optional, Sequence, Set, Tuple

from pydantic import BaseModel, Field

from bilancio.experiments.ring import RingSweepRunner, RingRunSummary, PreparedRun
from bilancio.runners import SimulationExecutor, LocalExecutor, RunOptions

logger = logging.getLogger(__name__)


@dataclass
class BalancedComparisonResult:
    """Result of a single C vs D comparison."""

    # Parameters
    kappa: Decimal
    concentration: Decimal
    mu: Decimal
    monotonicity: Decimal
    seed: int

    # Balanced mode parameters
    face_value: Decimal
    outside_mid_ratio: Decimal
    big_entity_share: Decimal  # DEPRECATED

    # C (Passive) metrics
    delta_passive: Optional[Decimal]
    phi_passive: Optional[Decimal]
    passive_run_id: str
    passive_status: str

    # D (Active) metrics
    delta_active: Optional[Decimal]
    phi_active: Optional[Decimal]
    active_run_id: str
    active_status: str

    # Balanced mode parameters with defaults (Plan 024)
    vbt_share_per_bucket: Decimal = Decimal("0.25")
    dealer_share_per_bucket: Decimal = Decimal("0.125")

    # Dealer metrics from active run
    dealer_total_pnl: Optional[float] = None
    dealer_total_return: Optional[float] = None
    total_trades: Optional[int] = None

    # Big entity loss metrics
    big_entity_loss_passive: Optional[float] = None
    big_entity_pnl_active: Optional[float] = None

    # Modal call IDs for cloud execution debugging
    passive_modal_call_id: Optional[str] = None
    active_modal_call_id: Optional[str] = None

    @property
    def trading_effect(self) -> Optional[Decimal]:
        """Effect of trading = delta_passive - delta_active.

        Positive means trading reduced defaults.
        """
        if self.delta_passive is None or self.delta_active is None:
            return None
        return self.delta_passive - self.delta_active

    @property
    def trading_relief_ratio(self) -> Optional[Decimal]:
        """Percentage reduction in defaults from trading."""
        if self.delta_passive is None or self.delta_active is None:
            return None
        if self.delta_passive == 0:
            return Decimal("0")  # No defaults to reduce
        return self.trading_effect / self.delta_passive


class BalancedComparisonConfig(BaseModel):
    """Configuration for C vs D balanced comparison experiments."""

    # Ring parameters
    n_agents: int = Field(default=100, description="Number of agents in ring")
    maturity_days: int = Field(default=10, description="Maturity horizon in days")
    max_simulation_days: int = Field(default=15, description="Max days to run simulation")
    Q_total: Decimal = Field(default=Decimal("10000"), description="Total debt amount")
    liquidity_mode: str = Field(default="uniform", description="Liquidity allocation mode")
    base_seed: int = Field(default=42, description="Base random seed")
    name_prefix: str = Field(default="Balanced Comparison", description="Scenario name prefix")
    default_handling: str = Field(default="fail-fast", description="Default handling mode")

    # Detailed logging (Plan 022)
    detailed_logging: bool = Field(
        default=False,
        description="Enable detailed CSV logging (trades.csv, inventory_timeseries.csv, system_state_timeseries.csv)"
    )

    # Grid parameters
    kappas: List[Decimal] = Field(
        default_factory=lambda: [Decimal("0.25"), Decimal("0.5"), Decimal("1"), Decimal("2"), Decimal("4")]
    )
    concentrations: List[Decimal] = Field(
        default_factory=lambda: [Decimal("0.2"), Decimal("0.5"), Decimal("1"), Decimal("2"), Decimal("5")]
    )
    mus: List[Decimal] = Field(
        default_factory=lambda: [Decimal("0"), Decimal("0.25"), Decimal("0.5"), Decimal("0.75"), Decimal("1")]
    )
    monotonicities: List[Decimal] = Field(default_factory=lambda: [Decimal("0")])

    # Balanced dealer parameters (Plan 024)
    face_value: Decimal = Field(default=Decimal("20"), description="Face value S (cashflow at maturity)")
    outside_mid_ratios: List[Decimal] = Field(
        default_factory=lambda: [Decimal("1.0"), Decimal("0.9"), Decimal("0.8"), Decimal("0.75"), Decimal("0.5")],
        description="M/S ratios to sweep"
    )
    big_entity_share: Decimal = Field(default=Decimal("0.25"), description="DEPRECATED - use vbt/dealer shares")
    vbt_share_per_bucket: Decimal = Field(
        default=Decimal("0.25"),
        description="VBT holds 25% of claims per maturity bucket"
    )
    dealer_share_per_bucket: Decimal = Field(
        default=Decimal("0.125"),
        description="Dealer holds 12.5% of claims per maturity bucket"
    )
    rollover_enabled: bool = Field(
        default=True,
        description="Enable continuous rollover of matured claims"
    )

    # Plan 030: Quiet mode for faster sweeps
    quiet: bool = Field(
        default=True,
        description="Suppress verbose console output during sweeps"
    )

    # VBT configuration (for active mode)
    vbt_share: Decimal = Field(default=Decimal("0.50"), description="VBT capital as fraction of system cash")


class BalancedComparisonRunner:
    """
    Runs C vs D comparison experiments.

    For each parameter combination (κ, c, μ, ρ):
    1. Run C (passive): Big entities hold but don't trade
    2. Run D (active): Big entities can trade
    3. Compute comparison metrics

    Outputs:
    - passive/: All passive holder runs
    - active/: All active dealer runs
    - aggregate/comparison.csv: C vs D metrics
    - aggregate/summary.json: Aggregate statistics
    """

    COMPARISON_FIELDS = [
        "kappa",
        "concentration",
        "mu",
        "monotonicity",
        "seed",
        "face_value",
        "outside_mid_ratio",
        "big_entity_share",
        "delta_passive",
        "delta_active",
        "trading_effect",
        "trading_relief_ratio",
        "phi_passive",
        "phi_active",
        "passive_run_id",
        "passive_status",
        "active_run_id",
        "active_status",
        "dealer_total_pnl",
        "dealer_total_return",
        "total_trades",
    ]

    def __init__(
        self,
        config: BalancedComparisonConfig,
        out_dir: Path,
        executor: Optional[SimulationExecutor] = None,
    ) -> None:
        self.config = config
        self.base_dir = out_dir
        self.executor: SimulationExecutor = executor or LocalExecutor()
        self.passive_dir = self.base_dir / "passive"
        self.active_dir = self.base_dir / "active"
        self.aggregate_dir = self.base_dir / "aggregate"

        self.passive_dir.mkdir(parents=True, exist_ok=True)
        self.active_dir.mkdir(parents=True, exist_ok=True)
        self.aggregate_dir.mkdir(parents=True, exist_ok=True)

        self.comparison_results: List[BalancedComparisonResult] = []
        self.comparison_path = self.aggregate_dir / "comparison.csv"
        self.summary_path = self.aggregate_dir / "summary.json"

        self._passive_runner: Optional[RingSweepRunner] = None
        self._active_runner: Optional[RingSweepRunner] = None
        self.seed_counter = config.base_seed

        # For progress tracking
        self._start_time: Optional[float] = None
        self._completed_keys: Set[Tuple[str, str, str, str, str]] = set()

        # Load existing results for resumption
        self._load_existing_results()

    def _load_existing_results(self) -> None:
        """Load existing results from CSV for resumption."""
        if not self.comparison_path.exists():
            return

        try:
            with self.comparison_path.open("r") as fh:
                reader = csv.DictReader(fh)
                for row in reader:
                    # Create key from parameters
                    key = (
                        row["kappa"],
                        row["concentration"],
                        row["mu"],
                        row["monotonicity"],
                        row["outside_mid_ratio"],
                    )
                    self._completed_keys.add(key)

                    # Also track the seed to resume from correct position
                    seed = int(row["seed"])
                    if seed >= self.seed_counter:
                        self.seed_counter = seed + 1

            if self._completed_keys:
                logger.info(
                    "Resuming sweep: found %d completed pairs, starting from seed %d",
                    len(self._completed_keys),
                    self.seed_counter,
                )
        except Exception as e:
            logger.warning("Could not load existing results: %s", e)

    def _make_key(
        self,
        kappa: Decimal,
        concentration: Decimal,
        mu: Decimal,
        monotonicity: Decimal,
        outside_mid_ratio: Decimal,
    ) -> Tuple[str, str, str, str, str]:
        """Create a key for tracking completed pairs."""
        return (str(kappa), str(concentration), str(mu), str(monotonicity), str(outside_mid_ratio))

    def _format_time(self, seconds: float) -> str:
        """Format seconds as human-readable time."""
        if seconds < 60:
            return f"{seconds:.0f}s"
        elif seconds < 3600:
            return f"{seconds / 60:.1f}m"
        else:
            hours = int(seconds // 3600)
            minutes = int((seconds % 3600) // 60)
            return f"{hours}h {minutes}m"

    def _next_seed(self) -> int:
        """Get next seed and increment counter."""
        seed = self.seed_counter
        self.seed_counter += 1
        return seed

    def _get_passive_runner(self, outside_mid_ratio: Decimal) -> RingSweepRunner:
        """Get or create passive runner (no dealer trading)."""
        # For passive mode, we use the balanced scenario but with dealers disabled
        # In balanced mode, VBT/Dealer have inventory but don't trade
        return RingSweepRunner(
            out_dir=self.passive_dir,
            name_prefix=f"{self.config.name_prefix} (Passive)",
            n_agents=self.config.n_agents,
            maturity_days=self.config.maturity_days,
            Q_total=self.config.Q_total,
            liquidity_mode=self.config.liquidity_mode,
            liquidity_agent=None,  # Not used with uniform mode
            base_seed=self.config.base_seed,
            default_handling=self.config.default_handling,
            dealer_enabled=False,  # No dealer trading in passive mode
            dealer_config=None,
            # Pass balanced mode config (Plan 024)
            balanced_mode=True,
            face_value=self.config.face_value,
            outside_mid_ratio=outside_mid_ratio,
            big_entity_share=self.config.big_entity_share,  # DEPRECATED
            vbt_share_per_bucket=self.config.vbt_share_per_bucket,
            dealer_share_per_bucket=self.config.dealer_share_per_bucket,
            rollover_enabled=self.config.rollover_enabled,
            detailed_dealer_logging=self.config.detailed_logging,  # Plan 022
            executor=self.executor,  # Plan 028 cloud support
            quiet=self.config.quiet,  # Plan 030
        )

    def _get_active_runner(self, outside_mid_ratio: Decimal) -> RingSweepRunner:
        """Get or create active runner (with dealer trading)."""
        dealer_config = {
            "ticket_size": int(self.config.face_value),
            "dealer_share": str(Decimal("0")),  # Dealers already have inventory from scenario
            "vbt_share": str(self.config.vbt_share),
        }

        return RingSweepRunner(
            out_dir=self.active_dir,
            name_prefix=f"{self.config.name_prefix} (Active)",
            n_agents=self.config.n_agents,
            maturity_days=self.config.maturity_days,
            Q_total=self.config.Q_total,
            liquidity_mode=self.config.liquidity_mode,
            liquidity_agent=None,  # Not used with uniform mode
            base_seed=self.config.base_seed,
            default_handling=self.config.default_handling,
            dealer_enabled=True,  # Dealer trading enabled
            dealer_config=dealer_config,
            # Pass balanced mode config (Plan 024)
            balanced_mode=True,
            face_value=self.config.face_value,
            outside_mid_ratio=outside_mid_ratio,
            big_entity_share=self.config.big_entity_share,  # DEPRECATED
            vbt_share_per_bucket=self.config.vbt_share_per_bucket,
            dealer_share_per_bucket=self.config.dealer_share_per_bucket,
            rollover_enabled=self.config.rollover_enabled,
            detailed_dealer_logging=self.config.detailed_logging,  # Plan 022
            executor=self.executor,  # Plan 028 cloud support
            quiet=self.config.quiet,  # Plan 030
        )

    def run_all(self) -> List[BalancedComparisonResult]:
        """Execute all passive/active pairs and return comparison results.

        Uses batch execution if the executor supports it (CloudExecutor),
        otherwise falls back to sequential execution (LocalExecutor).
        """
        # Check if executor supports batch execution
        if hasattr(self.executor, 'execute_batch'):
            return self._run_all_batch()
        else:
            return self._run_all_sequential()

    def _run_all_batch(self) -> List[BalancedComparisonResult]:
        """Execute all pairs using batch execution (parallel on Modal)."""
        total_pairs = (
            len(self.config.kappas)
            * len(self.config.concentrations)
            * len(self.config.mus)
            * len(self.config.monotonicities)
            * len(self.config.outside_mid_ratios)
        )

        skipped = len(self._completed_keys)
        remaining = total_pairs - skipped

        logger.info(
            "Starting BATCH balanced comparison sweep: %d kappas × %d concentrations × %d mus × %d ρ = %d pairs",
            len(self.config.kappas),
            len(self.config.concentrations),
            len(self.config.mus),
            len(self.config.outside_mid_ratios),
            total_pairs,
        )

        if skipped > 0:
            print(f"Resuming: {skipped} pairs already completed, {remaining} remaining", flush=True)

        self._start_time = time.time()

        # Phase 1: Prepare all runs
        print(f"Preparing {remaining * 2} runs...", flush=True)
        prepared_runs: List[Tuple[PreparedRun, PreparedRun, Decimal, Decimal, Decimal, Decimal, Decimal, int]] = []

        for outside_mid_ratio in self.config.outside_mid_ratios:
            passive_runner = self._get_passive_runner(outside_mid_ratio)
            active_runner = self._get_active_runner(outside_mid_ratio)

            for kappa in self.config.kappas:
                for concentration in self.config.concentrations:
                    for mu in self.config.mus:
                        for monotonicity in self.config.monotonicities:
                            key = self._make_key(kappa, concentration, mu, monotonicity, outside_mid_ratio)
                            if key in self._completed_keys:
                                continue

                            seed = self._next_seed()

                            # Prepare passive run
                            passive_prep = passive_runner._prepare_run(
                                phase="balanced_passive",
                                kappa=kappa,
                                concentration=concentration,
                                mu=mu,
                                monotonicity=monotonicity,
                                seed=seed,
                            )

                            # Prepare active run
                            active_prep = active_runner._prepare_run(
                                phase="balanced_active",
                                kappa=kappa,
                                concentration=concentration,
                                mu=mu,
                                monotonicity=monotonicity,
                                seed=seed,
                            )

                            prepared_runs.append((
                                passive_prep, active_prep,
                                kappa, concentration, mu, monotonicity, outside_mid_ratio, seed
                            ))

        if not prepared_runs:
            print("All pairs already completed!", flush=True)
            return self.comparison_results

        # Phase 2: Build batch and execute
        print(f"Submitting {len(prepared_runs) * 2} runs to Modal (parallel execution)...", flush=True)

        # Build flat list for batch execution
        batch_runs: List[Tuple[Dict[str, Any], str, RunOptions, Path]] = []
        run_index_map: Dict[str, int] = {}  # run_id -> index in prepared_runs

        for idx, (passive_prep, active_prep, *_) in enumerate(prepared_runs):
            batch_runs.append((
                passive_prep.scenario_config,
                passive_prep.run_id,
                passive_prep.options,
            ))
            run_index_map[passive_prep.run_id] = idx * 2  # even indices are passive

            batch_runs.append((
                active_prep.scenario_config,
                active_prep.run_id,
                active_prep.options,
            ))
            run_index_map[active_prep.run_id] = idx * 2 + 1  # odd indices are active

        # Execute batch with progress callback
        completed = [0]

        def progress_callback(done: int, total: int):
            completed[0] = done
            elapsed = time.time() - self._start_time
            if done > 0:
                eta = elapsed / done * (total - done)
                print(f"\r  Progress: {done}/{total} runs ({done * 100 // total}%) - ETA: {self._format_time(eta)}    ", end="", flush=True)

        results = self.executor.execute_batch(
            [(config, run_id, opts) for config, run_id, opts, *_ in batch_runs],
            progress_callback=progress_callback,
        )
        print()  # newline after progress

        # Phase 3: Finalize runs and build results
        print("Finalizing results...", flush=True)

        for idx, (passive_prep, active_prep, kappa, concentration, mu, monotonicity, outside_mid_ratio, seed) in enumerate(prepared_runs):
            passive_result = results[idx * 2]
            active_result = results[idx * 2 + 1]

            # Get runners for finalization
            passive_runner = self._get_passive_runner(outside_mid_ratio)
            active_runner = self._get_active_runner(outside_mid_ratio)

            # Finalize runs
            passive_summary = passive_runner._finalize_run(passive_prep, passive_result)
            active_summary = active_runner._finalize_run(active_prep, active_result)

            # Extract dealer metrics
            dm = active_summary.dealer_metrics or {}

            result = BalancedComparisonResult(
                kappa=kappa,
                concentration=concentration,
                mu=mu,
                monotonicity=monotonicity,
                seed=seed,
                face_value=self.config.face_value,
                outside_mid_ratio=outside_mid_ratio,
                big_entity_share=self.config.big_entity_share,
                vbt_share_per_bucket=self.config.vbt_share_per_bucket,
                dealer_share_per_bucket=self.config.dealer_share_per_bucket,
                delta_passive=passive_summary.delta_total,
                phi_passive=passive_summary.phi_total,
                passive_run_id=passive_summary.run_id,
                passive_status="completed" if passive_summary.delta_total is not None else "failed",
                delta_active=active_summary.delta_total,
                phi_active=active_summary.phi_total,
                active_run_id=active_summary.run_id,
                active_status="completed" if active_summary.delta_total is not None else "failed",
                dealer_total_pnl=dm.get("dealer_total_pnl"),
                dealer_total_return=dm.get("dealer_total_return"),
                total_trades=dm.get("total_trades"),
                passive_modal_call_id=passive_summary.modal_call_id,
                active_modal_call_id=active_summary.modal_call_id,
            )

            self.comparison_results.append(result)
            key = self._make_key(kappa, concentration, mu, monotonicity, outside_mid_ratio)
            self._completed_keys.add(key)

            # Incremental CSV write
            self._write_comparison_csv()

        # Write final summary
        self._write_summary_json()

        total_time = time.time() - self._start_time
        print(f"\nSweep complete! {len(prepared_runs)} pairs in {self._format_time(total_time)}", flush=True)
        print(f"Results at: {self.aggregate_dir}", flush=True)

        return self.comparison_results

    def _run_all_sequential(self) -> List[BalancedComparisonResult]:
        """Execute all pairs sequentially (fallback for LocalExecutor)."""
        total_pairs = (
            len(self.config.kappas)
            * len(self.config.concentrations)
            * len(self.config.mus)
            * len(self.config.monotonicities)
            * len(self.config.outside_mid_ratios)
        )

        skipped = len(self._completed_keys)
        remaining = total_pairs - skipped

        logger.info(
            "Starting balanced comparison sweep: %d kappas × %d concentrations × %d mus × %d ρ = %d pairs",
            len(self.config.kappas),
            len(self.config.concentrations),
            len(self.config.mus),
            len(self.config.outside_mid_ratios),
            total_pairs,
        )

        if skipped > 0:
            print(f"Resuming: {skipped} pairs already completed, {remaining} remaining", flush=True)

        self._start_time = time.time()
        pair_idx = 0
        completed_this_run = 0

        for outside_mid_ratio in self.config.outside_mid_ratios:
            for kappa in self.config.kappas:
                for concentration in self.config.concentrations:
                    for mu in self.config.mus:
                        for monotonicity in self.config.monotonicities:
                            pair_idx += 1

                            # Check if already completed
                            key = self._make_key(kappa, concentration, mu, monotonicity, outside_mid_ratio)
                            if key in self._completed_keys:
                                continue

                            # Progress and ETA
                            if completed_this_run > 0:
                                elapsed = time.time() - self._start_time
                                avg_time = elapsed / completed_this_run
                                eta = avg_time * (remaining - completed_this_run)
                                progress_str = f"[{pair_idx}/{total_pairs}] ({completed_this_run}/{remaining} this run) ETA: {self._format_time(eta)}"
                            else:
                                progress_str = f"[{pair_idx}/{total_pairs}]"

                            print(
                                f"{progress_str} Running: κ={kappa}, c={concentration}, μ={mu}, ρ={outside_mid_ratio}",
                                flush=True,
                            )

                            result = self._run_pair(
                                kappa, concentration, mu, monotonicity, outside_mid_ratio
                            )
                            self.comparison_results.append(result)
                            self._completed_keys.add(key)
                            completed_this_run += 1

                            # Write incremental results
                            self._write_comparison_csv()

                            # Log completion with timing
                            elapsed = time.time() - self._start_time
                            if result.delta_passive is not None and result.delta_active is not None:
                                print(
                                    f"  Completed in {self._format_time(elapsed / completed_this_run)} avg | "
                                    f"δ_passive={result.delta_passive:.3f}, δ_active={result.delta_active:.3f}, "
                                    f"effect={result.trading_effect:.3f}",
                                    flush=True,
                                )
                            else:
                                print(
                                    f"  Completed in {self._format_time(elapsed / completed_this_run)} avg | "
                                    f"(one or both runs failed)",
                                    flush=True,
                                )

        # Write final summary
        self._write_summary_json()

        total_time = time.time() - self._start_time
        print(f"\nSweep complete! {completed_this_run} pairs in {self._format_time(total_time)}", flush=True)
        print(f"Results at: {self.aggregate_dir}", flush=True)

        logger.info("Balanced comparison sweep complete. Results at: %s", self.aggregate_dir)
        return self.comparison_results

    def _make_progress_callback(self, run_type: str) -> Callable[[int, int], None]:
        """Create a progress callback that prints day-by-day progress."""
        def callback(current_day: int, max_days: int) -> None:
            elapsed = time.time() - self._start_time
            print(f"    {run_type}: day {current_day}/{max_days} (elapsed: {self._format_time(elapsed)})", flush=True)
        return callback

    def _run_pair(
        self,
        kappa: Decimal,
        concentration: Decimal,
        mu: Decimal,
        monotonicity: Decimal,
        outside_mid_ratio: Decimal,
    ) -> BalancedComparisonResult:
        """Run one passive/active pair for given parameters."""
        passive_runner = self._get_passive_runner(outside_mid_ratio)
        active_runner = self._get_active_runner(outside_mid_ratio)

        # Use same seed for both runs
        seed = self._next_seed()

        # Run passive (no trading)
        logger.info("  Running passive (no trading)...")
        print("  Passive run:", flush=True)
        passive_result = passive_runner._execute_run(
            phase="balanced_passive",
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
            progress_callback=self._make_progress_callback("passive"),
        )

        # Run active (with trading)
        logger.info("  Running active (with trading)...")
        print("  Active run:", flush=True)
        active_result = active_runner._execute_run(
            phase="balanced_active",
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
            progress_callback=self._make_progress_callback("active"),
        )

        # Extract dealer metrics from active result
        dm = active_result.dealer_metrics or {}

        result = BalancedComparisonResult(
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
            face_value=self.config.face_value,
            outside_mid_ratio=outside_mid_ratio,
            big_entity_share=self.config.big_entity_share,  # DEPRECATED
            vbt_share_per_bucket=self.config.vbt_share_per_bucket,
            dealer_share_per_bucket=self.config.dealer_share_per_bucket,
            delta_passive=passive_result.delta_total,
            phi_passive=passive_result.phi_total,
            passive_run_id=passive_result.run_id,
            passive_status="completed" if passive_result.delta_total is not None else "failed",
            delta_active=active_result.delta_total,
            phi_active=active_result.phi_total,
            active_run_id=active_result.run_id,
            active_status="completed" if active_result.delta_total is not None else "failed",
            dealer_total_pnl=dm.get("dealer_total_pnl"),
            dealer_total_return=dm.get("dealer_total_return"),
            total_trades=dm.get("total_trades"),
            passive_modal_call_id=passive_result.modal_call_id,
            active_modal_call_id=active_result.modal_call_id,
        )

        # Log comparison
        if result.trading_effect is not None:
            logger.info(
                "  Comparison: δ_passive=%s, δ_active=%s, effect=%s (%.1f%%)",
                result.delta_passive,
                result.delta_active,
                result.trading_effect,
                float(result.trading_relief_ratio or 0) * 100,
            )
        else:
            logger.warning("  Comparison: One or both runs failed")

        return result

    def _write_comparison_csv(self) -> None:
        """Write comparison results to CSV."""
        with self.comparison_path.open("w", newline="") as fh:
            writer = csv.DictWriter(fh, fieldnames=self.COMPARISON_FIELDS)
            writer.writeheader()
            for result in self.comparison_results:
                row = {
                    "kappa": str(result.kappa),
                    "concentration": str(result.concentration),
                    "mu": str(result.mu),
                    "monotonicity": str(result.monotonicity),
                    "seed": str(result.seed),
                    "face_value": str(result.face_value),
                    "outside_mid_ratio": str(result.outside_mid_ratio),
                    "big_entity_share": str(result.big_entity_share),
                    "delta_passive": str(result.delta_passive) if result.delta_passive is not None else "",
                    "delta_active": str(result.delta_active) if result.delta_active is not None else "",
                    "trading_effect": str(result.trading_effect) if result.trading_effect is not None else "",
                    "trading_relief_ratio": str(result.trading_relief_ratio) if result.trading_relief_ratio is not None else "",
                    "phi_passive": str(result.phi_passive) if result.phi_passive is not None else "",
                    "phi_active": str(result.phi_active) if result.phi_active is not None else "",
                    "passive_run_id": result.passive_run_id,
                    "passive_status": result.passive_status,
                    "active_run_id": result.active_run_id,
                    "active_status": result.active_status,
                    "dealer_total_pnl": str(result.dealer_total_pnl) if result.dealer_total_pnl is not None else "",
                    "dealer_total_return": str(result.dealer_total_return) if result.dealer_total_return is not None else "",
                    "total_trades": str(result.total_trades) if result.total_trades is not None else "",
                }
                writer.writerow(row)

    def _write_summary_json(self) -> None:
        """Write summary statistics to JSON."""
        completed = [r for r in self.comparison_results if r.trading_effect is not None]

        if completed:
            delta_passives = [float(r.delta_passive) for r in completed if r.delta_passive is not None]
            delta_actives = [float(r.delta_active) for r in completed if r.delta_active is not None]
            trading_effects = [float(r.trading_effect) for r in completed if r.trading_effect is not None]
            relief_ratios = [float(r.trading_relief_ratio) for r in completed if r.trading_relief_ratio is not None]

            mean_delta_passive = sum(delta_passives) / len(delta_passives) if delta_passives else None
            mean_delta_active = sum(delta_actives) / len(delta_actives) if delta_actives else None
            mean_trading_effect = sum(trading_effects) / len(trading_effects) if trading_effects else None
            mean_relief_ratio = sum(relief_ratios) / len(relief_ratios) if relief_ratios else None

            improved = sum(1 for r in completed if r.trading_effect and r.trading_effect > 0)
            unchanged = sum(1 for r in completed if r.trading_effect == 0)
            worsened = sum(1 for r in completed if r.trading_effect and r.trading_effect < 0)
        else:
            mean_delta_passive = None
            mean_delta_active = None
            mean_trading_effect = None
            mean_relief_ratio = None
            improved = 0
            unchanged = 0
            worsened = 0

        summary = {
            "total_pairs": len(self.comparison_results),
            "completed_pairs": len(completed),
            "mean_delta_passive": mean_delta_passive,
            "mean_delta_active": mean_delta_active,
            "mean_trading_effect": mean_trading_effect,
            "mean_relief_ratio": mean_relief_ratio,
            "pairs_with_improvement": improved,
            "pairs_unchanged": unchanged,
            "pairs_worsened": worsened,
            "config": {
                "n_agents": self.config.n_agents,
                "maturity_days": self.config.maturity_days,
                "Q_total": str(self.config.Q_total),
                "base_seed": self.config.base_seed,
                "face_value": str(self.config.face_value),
                "big_entity_share": str(self.config.big_entity_share),  # DEPRECATED
                "vbt_share_per_bucket": str(self.config.vbt_share_per_bucket),
                "dealer_share_per_bucket": str(self.config.dealer_share_per_bucket),
                "rollover_enabled": self.config.rollover_enabled,
                "kappas": [str(k) for k in self.config.kappas],
                "concentrations": [str(c) for c in self.config.concentrations],
                "mus": [str(m) for m in self.config.mus],
                "outside_mid_ratios": [str(r) for r in self.config.outside_mid_ratios],
            },
        }

        with self.summary_path.open("w") as fh:
            json.dump(summary, fh, indent=2)


def run_balanced_comparison_sweep(
    out_dir: Path,
    *,
    n_agents: int = 100,
    maturity_days: int = 10,
    Q_total: Decimal = Decimal("10000"),
    kappas: Sequence[Decimal],
    concentrations: Sequence[Decimal],
    mus: Sequence[Decimal],
    monotonicities: Optional[Sequence[Decimal]] = None,
    face_value: Decimal = Decimal("20"),
    outside_mid_ratios: Sequence[Decimal],
    big_entity_share: Decimal = Decimal("0.25"),
    base_seed: int = 42,
    default_handling: str = "fail-fast",
    name_prefix: str = "Balanced Comparison",
) -> List[BalancedComparisonResult]:
    """
    Convenience function to run a balanced comparison sweep.

    Args:
        out_dir: Output directory for results
        n_agents: Number of agents in ring (default: 100)
        maturity_days: Maturity horizon (default: 10)
        Q_total: Total debt amount (default: 10000)
        kappas: List of kappa values to sweep
        concentrations: List of Dirichlet concentration values
        mus: List of mu (misalignment) values
        monotonicities: List of monotonicity values (default: [0])
        face_value: Face value S (default: 20)
        outside_mid_ratios: List of M/S ratios to sweep
        big_entity_share: Fraction of debt held by big entities (default: 0.25)
        base_seed: Base random seed
        default_handling: How to handle defaults
        name_prefix: Scenario name prefix

    Returns:
        List of BalancedComparisonResult objects
    """
    config = BalancedComparisonConfig(
        n_agents=n_agents,
        maturity_days=maturity_days,
        Q_total=Q_total,
        kappas=list(kappas),
        concentrations=list(concentrations),
        mus=list(mus),
        monotonicities=list(monotonicities or [Decimal("0")]),
        face_value=face_value,
        outside_mid_ratios=list(outside_mid_ratios),
        big_entity_share=big_entity_share,
        base_seed=base_seed,
        default_handling=default_handling,
        name_prefix=name_prefix,
    )

    runner = BalancedComparisonRunner(config, out_dir)
    return runner.run_all()


__all__ = [
    "BalancedComparisonResult",
    "BalancedComparisonConfig",
    "BalancedComparisonRunner",
    "run_balanced_comparison_sweep",
]

```

---

### 📄 src/bilancio/experiments/comparison.py

```python
"""Utilities for running dealer comparison experiments.

This module provides infrastructure for running paired control/treatment
experiments comparing Kalecki ring simulations with and without dealer-mediated
secondary markets.

The key output is the delta in defaults between conditions, measuring
the effect of the dealer on settlement rates.
"""

from __future__ import annotations

import csv
import json
import logging
from dataclasses import dataclass
from decimal import Decimal
from pathlib import Path
from typing import Any, Dict, List, Optional, Sequence, Tuple

from pydantic import BaseModel, Field

from bilancio.experiments.ring import RingSweepRunner, RingRunSummary, _decimal_list

logger = logging.getLogger(__name__)


@dataclass
class ComparisonResult:
    """Result of a single control/treatment comparison."""

    kappa: Decimal
    concentration: Decimal
    mu: Decimal
    monotonicity: Decimal
    seed: int

    # Control metrics (no dealer)
    delta_control: Optional[Decimal]
    phi_control: Optional[Decimal]
    control_run_id: str
    control_status: str

    # Treatment metrics (with dealer)
    delta_treatment: Optional[Decimal]
    phi_treatment: Optional[Decimal]
    treatment_run_id: str
    treatment_status: str

    # Dealer metrics (Section 8 of functional dealer specification)
    # From treatment run only (dealer_metrics dictionary)
    dealer_total_pnl: Optional[float] = None
    dealer_total_return: Optional[float] = None
    dealer_profitable: Optional[bool] = None
    spread_income_total: Optional[float] = None
    mean_trader_return: Optional[float] = None
    fraction_profitable_traders: Optional[float] = None
    liquidity_driven_sales: Optional[int] = None
    rescue_events: Optional[int] = None
    total_trades: Optional[int] = None
    unsafe_buy_count: Optional[int] = None
    fraction_unsafe_buys: Optional[float] = None

    # Plan 020 metrics: debt-to-money ratio and mid prices
    initial_total_debt: Optional[float] = None
    initial_total_money: Optional[float] = None
    debt_to_money_ratio: Optional[float] = None
    dealer_mid_final: Optional[Dict[str, float]] = None
    vbt_mid_final: Optional[Dict[str, float]] = None
    dealer_premium_final_pct: Optional[Dict[str, float]] = None
    vbt_premium_final_pct: Optional[Dict[str, float]] = None

    @property
    def delta_reduction(self) -> Optional[Decimal]:
        """Absolute reduction in default rate."""
        if self.delta_control is None or self.delta_treatment is None:
            return None
        return self.delta_control - self.delta_treatment

    @property
    def relief_ratio(self) -> Optional[Decimal]:
        """Percentage reduction in defaults (0 if no baseline defaults)."""
        if self.delta_control is None or self.delta_treatment is None:
            return None
        if self.delta_control == 0:
            return Decimal("0")  # No defaults to reduce
        return self.delta_reduction / self.delta_control


class ComparisonSweepConfig(BaseModel):
    """Configuration for dealer comparison experiments."""

    # Ring parameters
    n_agents: int = Field(default=100, description="Number of agents in ring")
    maturity_days: int = Field(default=10, description="Maturity horizon in days")
    max_simulation_days: int = Field(default=15, description="Max days to run simulation")
    Q_total: Decimal = Field(default=Decimal("10000"), description="Total debt amount")
    liquidity_mode: str = Field(default="uniform", description="Liquidity allocation mode")
    liquidity_agent: Optional[str] = Field(default=None, description="Target agent for single_at mode")
    base_seed: int = Field(default=42, description="Base random seed")
    name_prefix: str = Field(default="Dealer Comparison", description="Scenario name prefix")
    default_handling: str = Field(default="fail-fast", description="Default handling mode")

    # Grid parameters
    kappas: List[Decimal] = Field(default_factory=lambda: [Decimal("0.25"), Decimal("0.5"), Decimal("1"), Decimal("2"), Decimal("4")])
    concentrations: List[Decimal] = Field(default_factory=lambda: [Decimal("0.2"), Decimal("0.5"), Decimal("1"), Decimal("2"), Decimal("5")])
    mus: List[Decimal] = Field(default_factory=lambda: [Decimal("0"), Decimal("0.25"), Decimal("0.5"), Decimal("0.75"), Decimal("1")])
    monotonicities: List[Decimal] = Field(default_factory=lambda: [Decimal("0")])

    # Dealer configuration for treatment runs
    # Per specification: Dealer and VBT bring NEW outside money (not taken from traders)
    # Traders keep 100% of their receivables. Dealer/VBT start empty and buy from traders.
    dealer_ticket_size: Decimal = Field(default=Decimal("1"), description="Ticket size for dealer")
    dealer_share: Decimal = Field(default=Decimal("0.25"), description="Dealer capital as fraction of system cash (NEW outside money)")
    vbt_share: Decimal = Field(default=Decimal("0.50"), description="VBT capital as fraction of system cash (NEW outside money)")


class ComparisonSweepRunner:
    """
    Runs paired control/treatment experiments for dealer comparison.

    For each parameter combination (κ, c, μ):
    1. Run WITHOUT dealer -> control metrics
    2. Run WITH dealer -> treatment metrics
    3. Compute and log comparison metrics

    Outputs:
    - control/registry/experiments.csv: All control runs
    - treatment/registry/experiments.csv: All treatment runs
    - aggregate/comparison.csv: Paired comparison metrics
    - aggregate/summary.json: Aggregate statistics
    """

    COMPARISON_FIELDS = [
        "kappa",
        "concentration",
        "mu",
        "monotonicity",
        "seed",
        "delta_control",
        "delta_treatment",
        "delta_reduction",
        "relief_ratio",
        "phi_control",
        "phi_treatment",
        "control_run_id",
        "control_status",
        "treatment_run_id",
        "treatment_status",
        # Dealer metrics (Section 8)
        "dealer_total_pnl",
        "dealer_total_return",
        "dealer_profitable",
        "spread_income_total",
        "mean_trader_return",
        "fraction_profitable_traders",
        "liquidity_driven_sales",
        "rescue_events",
        "total_trades",
        "unsafe_buy_count",
        "fraction_unsafe_buys",
        # Plan 020 metrics
        "initial_total_debt",
        "initial_total_money",
        "debt_to_money_ratio",
        "dealer_mid_final",
        "vbt_mid_final",
        "dealer_premium_final_pct",
        "vbt_premium_final_pct",
    ]

    def __init__(self, config: ComparisonSweepConfig, out_dir: Path) -> None:
        self.config = config
        self.base_dir = out_dir
        self.control_dir = self.base_dir / "control"
        self.treatment_dir = self.base_dir / "treatment"
        self.aggregate_dir = self.base_dir / "aggregate"

        self.control_dir.mkdir(parents=True, exist_ok=True)
        self.treatment_dir.mkdir(parents=True, exist_ok=True)
        self.aggregate_dir.mkdir(parents=True, exist_ok=True)

        self.comparison_results: List[ComparisonResult] = []
        self.comparison_path = self.aggregate_dir / "comparison.csv"
        self.summary_path = self.aggregate_dir / "summary.json"

        # Build dealer config dict for treatment runs
        self.dealer_config = {
            "ticket_size": int(config.dealer_ticket_size),
            "dealer_share": str(config.dealer_share),
            "vbt_share": str(config.vbt_share),
        }

        # Initialize runners
        self._control_runner: Optional[RingSweepRunner] = None
        self._treatment_runner: Optional[RingSweepRunner] = None

    def _get_control_runner(self) -> RingSweepRunner:
        """Get or create control runner (no dealer)."""
        if self._control_runner is None:
            self._control_runner = RingSweepRunner(
                out_dir=self.control_dir,
                name_prefix=f"{self.config.name_prefix} (Control)",
                n_agents=self.config.n_agents,
                maturity_days=self.config.maturity_days,
                Q_total=self.config.Q_total,
                liquidity_mode=self.config.liquidity_mode,
                liquidity_agent=self.config.liquidity_agent,
                base_seed=self.config.base_seed,
                default_handling=self.config.default_handling,
                dealer_enabled=False,
                dealer_config=None,
            )
        return self._control_runner

    def _get_treatment_runner(self) -> RingSweepRunner:
        """Get or create treatment runner (with dealer)."""
        if self._treatment_runner is None:
            self._treatment_runner = RingSweepRunner(
                out_dir=self.treatment_dir,
                name_prefix=f"{self.config.name_prefix} (Treatment)",
                n_agents=self.config.n_agents,
                maturity_days=self.config.maturity_days,
                Q_total=self.config.Q_total,
                liquidity_mode=self.config.liquidity_mode,
                liquidity_agent=self.config.liquidity_agent,
                base_seed=self.config.base_seed,
                default_handling=self.config.default_handling,
                dealer_enabled=True,
                dealer_config=self.dealer_config,
            )
        return self._treatment_runner

    def run_all(self) -> List[ComparisonResult]:
        """Execute all control/treatment pairs and return comparison results."""
        logger.info(
            "Starting comparison sweep: %d kappas × %d concentrations × %d mus = %d pairs",
            len(self.config.kappas),
            len(self.config.concentrations),
            len(self.config.mus),
            len(self.config.kappas) * len(self.config.concentrations) * len(self.config.mus),
        )

        total_pairs = (
            len(self.config.kappas)
            * len(self.config.concentrations)
            * len(self.config.mus)
            * len(self.config.monotonicities)
        )
        pair_idx = 0

        for kappa in self.config.kappas:
            for concentration in self.config.concentrations:
                for mu in self.config.mus:
                    for monotonicity in self.config.monotonicities:
                        pair_idx += 1
                        logger.info(
                            "[%d/%d] Running pair: κ=%s, c=%s, μ=%s",
                            pair_idx,
                            total_pairs,
                            kappa,
                            concentration,
                            mu,
                        )
                        result = self._run_pair(kappa, concentration, mu, monotonicity)
                        self.comparison_results.append(result)

                        # Write incremental results
                        self._write_comparison_csv()

        # Write final summary
        self._write_summary_json()

        logger.info("Comparison sweep complete. Results at: %s", self.aggregate_dir)
        return self.comparison_results

    def _run_pair(
        self,
        kappa: Decimal,
        concentration: Decimal,
        mu: Decimal,
        monotonicity: Decimal,
    ) -> ComparisonResult:
        """Run one control/treatment pair for given parameters."""
        control_runner = self._get_control_runner()
        treatment_runner = self._get_treatment_runner()

        # Use same seed for both runs to ensure identical initial conditions
        seed = control_runner._next_seed()
        # Sync treatment runner seed
        treatment_runner.seed_counter = seed + 1

        # Run control (no dealer)
        logger.info("  Running control (no dealer)...")
        control_result = control_runner._execute_run(
            phase="comparison_control",
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
        )

        # Run treatment (with dealer) - use same seed
        logger.info("  Running treatment (with dealer)...")
        treatment_result = treatment_runner._execute_run(
            phase="comparison_treatment",
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
        )

        # Extract dealer metrics from treatment result
        dm = treatment_result.dealer_metrics or {}

        # Build comparison result
        result = ComparisonResult(
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
            delta_control=control_result.delta_total,
            phi_control=control_result.phi_total,
            control_run_id=control_result.run_id,
            control_status="completed" if control_result.delta_total is not None else "failed",
            delta_treatment=treatment_result.delta_total,
            phi_treatment=treatment_result.phi_total,
            treatment_run_id=treatment_result.run_id,
            treatment_status="completed" if treatment_result.delta_total is not None else "failed",
            # Dealer metrics from treatment run
            dealer_total_pnl=dm.get("dealer_total_pnl"),
            dealer_total_return=dm.get("dealer_total_return"),
            dealer_profitable=dm.get("dealer_profitable"),
            spread_income_total=dm.get("spread_income_total"),
            mean_trader_return=dm.get("mean_trader_return"),
            fraction_profitable_traders=dm.get("fraction_profitable_traders"),
            liquidity_driven_sales=dm.get("liquidity_driven_sales"),
            rescue_events=dm.get("rescue_events"),
            total_trades=dm.get("total_trades"),
            unsafe_buy_count=dm.get("unsafe_buy_count"),
            fraction_unsafe_buys=dm.get("fraction_unsafe_buys"),
            # Plan 020 metrics
            initial_total_debt=dm.get("initial_total_debt"),
            initial_total_money=dm.get("initial_total_money"),
            debt_to_money_ratio=dm.get("debt_to_money_ratio"),
            dealer_mid_final=dm.get("dealer_mid_final"),
            vbt_mid_final=dm.get("vbt_mid_final"),
            dealer_premium_final_pct=dm.get("dealer_premium_final_pct"),
            vbt_premium_final_pct=dm.get("vbt_premium_final_pct"),
        )

        # Log comparison
        if result.delta_reduction is not None:
            logger.info(
                "  Comparison: δ_control=%s, δ_treatment=%s, reduction=%s (%.1f%%)",
                result.delta_control,
                result.delta_treatment,
                result.delta_reduction,
                float(result.relief_ratio or 0) * 100,
            )
        else:
            logger.warning("  Comparison: One or both runs failed, cannot compute reduction")

        return result

    def _write_comparison_csv(self) -> None:
        """Write comparison results to CSV."""
        with self.comparison_path.open("w", newline="") as fh:
            writer = csv.DictWriter(fh, fieldnames=self.COMPARISON_FIELDS)
            writer.writeheader()
            for result in self.comparison_results:
                row = {
                    "kappa": str(result.kappa),
                    "concentration": str(result.concentration),
                    "mu": str(result.mu),
                    "monotonicity": str(result.monotonicity),
                    "seed": str(result.seed),
                    "delta_control": str(result.delta_control) if result.delta_control is not None else "",
                    "delta_treatment": str(result.delta_treatment) if result.delta_treatment is not None else "",
                    "delta_reduction": str(result.delta_reduction) if result.delta_reduction is not None else "",
                    "relief_ratio": str(result.relief_ratio) if result.relief_ratio is not None else "",
                    "phi_control": str(result.phi_control) if result.phi_control is not None else "",
                    "phi_treatment": str(result.phi_treatment) if result.phi_treatment is not None else "",
                    "control_run_id": result.control_run_id,
                    "control_status": result.control_status,
                    "treatment_run_id": result.treatment_run_id,
                    "treatment_status": result.treatment_status,
                    # Dealer metrics (Section 8)
                    "dealer_total_pnl": str(result.dealer_total_pnl) if result.dealer_total_pnl is not None else "",
                    "dealer_total_return": str(result.dealer_total_return) if result.dealer_total_return is not None else "",
                    "dealer_profitable": str(result.dealer_profitable) if result.dealer_profitable is not None else "",
                    "spread_income_total": str(result.spread_income_total) if result.spread_income_total is not None else "",
                    "mean_trader_return": str(result.mean_trader_return) if result.mean_trader_return is not None else "",
                    "fraction_profitable_traders": str(result.fraction_profitable_traders) if result.fraction_profitable_traders is not None else "",
                    "liquidity_driven_sales": str(result.liquidity_driven_sales) if result.liquidity_driven_sales is not None else "",
                    "rescue_events": str(result.rescue_events) if result.rescue_events is not None else "",
                    "total_trades": str(result.total_trades) if result.total_trades is not None else "",
                    "unsafe_buy_count": str(result.unsafe_buy_count) if result.unsafe_buy_count is not None else "",
                    "fraction_unsafe_buys": str(result.fraction_unsafe_buys) if result.fraction_unsafe_buys is not None else "",
                    # Plan 020 metrics
                    "initial_total_debt": str(result.initial_total_debt) if result.initial_total_debt is not None else "",
                    "initial_total_money": str(result.initial_total_money) if result.initial_total_money is not None else "",
                    "debt_to_money_ratio": str(result.debt_to_money_ratio) if result.debt_to_money_ratio is not None else "",
                    "dealer_mid_final": json.dumps(result.dealer_mid_final) if result.dealer_mid_final is not None else "",
                    "vbt_mid_final": json.dumps(result.vbt_mid_final) if result.vbt_mid_final is not None else "",
                    "dealer_premium_final_pct": json.dumps(result.dealer_premium_final_pct) if result.dealer_premium_final_pct is not None else "",
                    "vbt_premium_final_pct": json.dumps(result.vbt_premium_final_pct) if result.vbt_premium_final_pct is not None else "",
                }
                writer.writerow(row)

    def _write_summary_json(self) -> None:
        """Write summary statistics to JSON."""
        completed = [r for r in self.comparison_results if r.delta_reduction is not None]
        failed_control = [r for r in self.comparison_results if r.control_status == "failed"]
        failed_treatment = [r for r in self.comparison_results if r.treatment_status == "failed"]

        # Compute statistics
        if completed:
            delta_controls = [float(r.delta_control) for r in completed if r.delta_control is not None]
            delta_treatments = [float(r.delta_treatment) for r in completed if r.delta_treatment is not None]
            relief_ratios = [float(r.relief_ratio) for r in completed if r.relief_ratio is not None]

            mean_delta_control = sum(delta_controls) / len(delta_controls) if delta_controls else None
            mean_delta_treatment = sum(delta_treatments) / len(delta_treatments) if delta_treatments else None
            mean_relief_ratio = sum(relief_ratios) / len(relief_ratios) if relief_ratios else None

            improved = sum(1 for r in completed if r.delta_reduction and r.delta_reduction > 0)
            unchanged = sum(1 for r in completed if r.delta_reduction == 0)
            worsened = sum(1 for r in completed if r.delta_reduction and r.delta_reduction < 0)
        else:
            mean_delta_control = None
            mean_delta_treatment = None
            mean_relief_ratio = None
            improved = 0
            unchanged = 0
            worsened = 0

        summary = {
            "total_pairs": len(self.comparison_results),
            "completed_pairs": len(completed),
            "failed_control_runs": len(failed_control),
            "failed_treatment_runs": len(failed_treatment),
            "mean_delta_control": mean_delta_control,
            "mean_delta_treatment": mean_delta_treatment,
            "mean_relief_ratio": mean_relief_ratio,
            "pairs_with_improvement": improved,
            "pairs_unchanged": unchanged,
            "pairs_worsened": worsened,
            "config": {
                "n_agents": self.config.n_agents,
                "maturity_days": self.config.maturity_days,
                "Q_total": str(self.config.Q_total),
                "base_seed": self.config.base_seed,
                "kappas": [str(k) for k in self.config.kappas],
                "concentrations": [str(c) for c in self.config.concentrations],
                "mus": [str(m) for m in self.config.mus],
            },
        }

        with self.summary_path.open("w") as fh:
            json.dump(summary, fh, indent=2)


def run_comparison_sweep(
    out_dir: Path,
    *,
    n_agents: int = 100,
    maturity_days: int = 10,
    Q_total: Decimal = Decimal("10000"),
    kappas: Sequence[Decimal],
    concentrations: Sequence[Decimal],
    mus: Sequence[Decimal],
    monotonicities: Optional[Sequence[Decimal]] = None,
    base_seed: int = 42,
    default_handling: str = "fail-fast",
    dealer_ticket_size: Decimal = Decimal("1"),
    dealer_share: Decimal = Decimal("0.25"),
    vbt_share: Decimal = Decimal("0.50"),
    liquidity_mode: str = "uniform",
    liquidity_agent: Optional[str] = None,
    name_prefix: str = "Dealer Comparison",
) -> List[ComparisonResult]:
    """
    Convenience function to run a comparison sweep.

    Args:
        out_dir: Output directory for results
        n_agents: Number of agents in ring (default: 100)
        maturity_days: Maturity horizon (default: 10)
        Q_total: Total debt amount (default: 10000)
        kappas: List of kappa values to sweep
        concentrations: List of Dirichlet concentration values
        mus: List of mu (misalignment) values
        monotonicities: List of monotonicity values (default: [0])
        base_seed: Base random seed
        default_handling: How to handle defaults
        dealer_ticket_size: Ticket size for dealer
        dealer_share: Dealer capital as fraction of system cash (NEW outside money)
        vbt_share: VBT capital as fraction of system cash (NEW outside money)
        liquidity_mode: Liquidity allocation mode
        liquidity_agent: Target agent for single_at mode
        name_prefix: Scenario name prefix

    Returns:
        List of ComparisonResult objects
    """
    config = ComparisonSweepConfig(
        n_agents=n_agents,
        maturity_days=maturity_days,
        Q_total=Q_total,
        kappas=list(kappas),
        concentrations=list(concentrations),
        mus=list(mus),
        monotonicities=list(monotonicities or [Decimal("0")]),
        base_seed=base_seed,
        default_handling=default_handling,
        dealer_ticket_size=dealer_ticket_size,
        dealer_share=dealer_share,
        vbt_share=vbt_share,
        liquidity_mode=liquidity_mode,
        liquidity_agent=liquidity_agent,
        name_prefix=name_prefix,
    )

    runner = ComparisonSweepRunner(config, out_dir)
    return runner.run_all()


__all__ = [
    "ComparisonResult",
    "ComparisonSweepConfig",
    "ComparisonSweepRunner",
    "run_comparison_sweep",
]

```

---

### 📄 src/bilancio/experiments/ring.py

```python
"""Utilities for running Kalecki ring experiment sweeps."""

from __future__ import annotations

import uuid
from dataclasses import dataclass
from decimal import Decimal
from pathlib import Path
from typing import Any, Callable, Dict, List, Optional, Sequence, Tuple

import yaml
from pydantic import BaseModel, Field, ValidationError, model_validator

from bilancio.analysis.metrics_computer import MetricsComputer
from bilancio.config.models import RingExplorerGeneratorConfig
from bilancio.runners import LocalExecutor, RunOptions, ExecutionResult
from bilancio.runners.protocols import SimulationExecutor
from bilancio.experiments.sampling import (
    generate_frontier_params,
    generate_grid_params,
    generate_lhs_params,
)
from bilancio.scenarios import compile_ring_explorer
from bilancio.storage import (
    FileRegistryStore,
    LocalArtifactLoader,
    ModalVolumeArtifactLoader,
    RegistryEntry,
)
from bilancio.storage.models import RunStatus
from bilancio.storage.protocols import RegistryStore


@dataclass
class RingRunSummary:
    run_id: str
    phase: str
    kappa: Decimal
    concentration: Decimal
    mu: Decimal
    monotonicity: Decimal
    delta_total: Optional[Decimal]
    phi_total: Optional[Decimal]
    time_to_stability: int
    # Dealer metrics (only populated for treatment runs with dealer enabled)
    dealer_metrics: Optional[Dict[str, Any]] = None
    # Modal call ID for cloud execution debugging
    modal_call_id: Optional[str] = None


@dataclass
class PreparedRun:
    """Data needed to execute and finalize a prepared run.

    Created by RingSweepRunner._prepare_run(), consumed by _finalize_run().
    """
    run_id: str
    phase: str
    kappa: Decimal
    concentration: Decimal
    mu: Decimal
    monotonicity: Decimal
    seed: int
    scenario_config: Dict[str, Any]
    options: RunOptions
    run_dir: Path
    out_dir: Path
    scenario_path: Path
    base_params: Dict[str, Any]
    S1: Decimal
    L0: Decimal


def _decimal_list(spec: str) -> List[Decimal]:
    out: List[Decimal] = []
    for part in spec.split(','):
        part = part.strip()
        if not part:
            continue
        out.append(Decimal(part))
    return out


def _to_yaml_ready(obj: Any) -> Any:
    from decimal import Decimal as _D

    if isinstance(obj, dict):
        return {k: _to_yaml_ready(v) for k, v in obj.items() if v is not None}
    if isinstance(obj, list):
        return [_to_yaml_ready(v) for v in obj]
    if isinstance(obj, _D):
        norm = obj.normalize()
        if norm == norm.to_integral_value():
            return int(norm)
        return float(norm)
    return obj


class _RingSweepGridConfig(BaseModel):
    enabled: bool = True
    kappas: List[Decimal] = Field(default_factory=list)
    concentrations: List[Decimal] = Field(default_factory=list)
    mus: List[Decimal] = Field(default_factory=list)
    monotonicities: List[Decimal] = Field(default_factory=list)

    @model_validator(mode="after")
    def validate_lists(self) -> "_RingSweepGridConfig":
        if self.enabled:
            if not self.kappas:
                raise ValueError("grid.kappas must be provided when grid.enabled is true")
            if not self.concentrations:
                raise ValueError("grid.concentrations must be provided when grid.enabled is true")
            if not self.mus:
                raise ValueError("grid.mus must be provided when grid.enabled is true")
            if not self.monotonicities:
                self.monotonicities = [Decimal("0")]
        return self


class _RingSweepLHSConfig(BaseModel):
    count: int = 0
    kappa_range: Optional[Tuple[Decimal, Decimal]] = None
    concentration_range: Optional[Tuple[Decimal, Decimal]] = None
    mu_range: Optional[Tuple[Decimal, Decimal]] = None
    monotonicity_range: Optional[Tuple[Decimal, Decimal]] = None

    @model_validator(mode="after")
    def validate_ranges(self) -> "_RingSweepLHSConfig":
        if self.count <= 0:
            return self
        if self.monotonicity_range is None:
            self.monotonicity_range = (Decimal("0"), Decimal("0"))
        for name, rng in (
            ("kappa_range", self.kappa_range),
            ("concentration_range", self.concentration_range),
            ("mu_range", self.mu_range),
            ("monotonicity_range", self.monotonicity_range),
        ):
            if rng is None or len(rng) != 2:
                raise ValueError(f"lhs.{name} must contain exactly two values when lhs.count > 0")
        return self


class _RingSweepFrontierConfig(BaseModel):
    enabled: bool = False
    kappa_low: Optional[Decimal] = None
    kappa_high: Optional[Decimal] = None
    tolerance: Optional[Decimal] = None
    max_iterations: Optional[int] = None

    @model_validator(mode="after")
    def validate_frontier(self) -> "_RingSweepFrontierConfig":
        if not self.enabled:
            return self
        missing = [
            name
            for name in ("kappa_low", "kappa_high", "tolerance", "max_iterations")
            if getattr(self, name) is None
        ]
        if missing:
            missing_list = ", ".join(missing)
            raise ValueError(f"frontier fields missing when frontier.enabled is true: {missing_list}")
        return self


class _RingSweepRunnerConfig(BaseModel):
    n_agents: Optional[int] = None
    maturity_days: Optional[int] = None
    q_total: Optional[Decimal] = None
    liquidity_mode: Optional[str] = None
    liquidity_agent: Optional[str] = None
    base_seed: Optional[int] = None
    name_prefix: Optional[str] = None
    default_handling: Optional[str] = None
    dealer_enabled: bool = False
    dealer_config: Optional[Dict[str, Any]] = None


class RingSweepConfig(BaseModel):
    version: int = Field(1, description="Configuration version")
    out_dir: Optional[str] = None
    grid: Optional[_RingSweepGridConfig] = None
    lhs: Optional[_RingSweepLHSConfig] = None
    frontier: Optional[_RingSweepFrontierConfig] = None
    runner: Optional[_RingSweepRunnerConfig] = None

    @model_validator(mode="after")
    def ensure_version(self) -> "RingSweepConfig":
        if self.version != 1:
            raise ValueError(f"Unsupported sweep config version: {self.version}")
        return self


def load_ring_sweep_config(path: Path | str) -> RingSweepConfig:
    """Load and validate a ring sweep configuration from YAML."""
    config_path = Path(path)
    if not config_path.exists():
        raise FileNotFoundError(f"Sweep configuration not found: {config_path}")

    try:
        with config_path.open("r", encoding="utf-8") as fh:
            raw = yaml.safe_load(fh)
    except yaml.YAMLError as exc:
        raise yaml.YAMLError(f"Failed to parse YAML from {config_path}: {exc}")

    if not isinstance(raw, dict):
        raise ValueError("Sweep configuration must be a YAML mapping")

    try:
        return RingSweepConfig.model_validate(raw)
    except ValidationError as exc:
        messages = []
        for error in exc.errors():
            loc = " -> ".join(str(part) for part in error.get("loc", ()))
            messages.append(f"  - {loc}: {error.get('msg')}")
        details = "\n".join(messages)
        raise ValueError(f"Invalid sweep configuration:\n{details}") from exc


class RingSweepRunner:
    """Coordinator for running Kalecki ring experiments."""

    def __init__(
        self,
        out_dir: Path,
        *,
        name_prefix: str,
        n_agents: int,
        maturity_days: int,
        Q_total: Decimal,
        liquidity_mode: str,
        liquidity_agent: Optional[str],
        base_seed: int,
        default_handling: str = "fail-fast",
        dealer_enabled: bool = False,
        dealer_config: Optional[Dict[str, Any]] = None,
        balanced_mode: bool = False,
        face_value: Optional[Decimal] = None,
        outside_mid_ratio: Optional[Decimal] = None,
        big_entity_share: Optional[Decimal] = None,  # DEPRECATED
        vbt_share_per_bucket: Optional[Decimal] = None,
        dealer_share_per_bucket: Optional[Decimal] = None,
        rollover_enabled: bool = True,
        detailed_dealer_logging: bool = False,  # Plan 022
        registry_store: Optional[RegistryStore] = None,  # Plan 026
        executor: Optional[SimulationExecutor] = None,  # Plan 027
        quiet: bool = True,  # Plan 030: suppress verbose output for sweeps
    ) -> None:
        self.base_dir = out_dir
        self.registry_dir = self.base_dir / "registry"
        self.runs_dir = self.base_dir / "runs"
        self.aggregate_dir = self.base_dir / "aggregate"
        self.name_prefix = name_prefix
        self.n_agents = n_agents
        self.maturity_days = maturity_days
        self.Q_total = Q_total
        self.liquidity_mode = liquidity_mode
        self.liquidity_agent = liquidity_agent
        self.seed_counter = base_seed
        self.default_handling = default_handling
        self.dealer_enabled = dealer_enabled
        self.dealer_config = dealer_config
        self.balanced_mode = balanced_mode
        self.face_value = face_value or Decimal("20")
        self.outside_mid_ratio = outside_mid_ratio or Decimal("0.75")
        self.big_entity_share = big_entity_share or Decimal("0.25")  # DEPRECATED
        self.vbt_share_per_bucket = vbt_share_per_bucket or Decimal("0.25")
        self.dealer_share_per_bucket = dealer_share_per_bucket or Decimal("0.125")
        self.rollover_enabled = rollover_enabled
        self.detailed_dealer_logging = detailed_dealer_logging  # Plan 022
        self.quiet = quiet  # Plan 030: suppress verbose output

        # Use provided registry store or create default file-based store
        self.registry_store: RegistryStore = registry_store or FileRegistryStore(self.base_dir)
        # Use provided executor or create default local executor (Plan 027)
        self.executor: SimulationExecutor = executor or LocalExecutor()
        self.experiment_id = ""  # Empty = use base_dir directly

        self.registry_dir.mkdir(parents=True, exist_ok=True)
        self.runs_dir.mkdir(parents=True, exist_ok=True)
        self.aggregate_dir.mkdir(parents=True, exist_ok=True)

        # Initialize empty registry file if it doesn't exist (backward compatible)
        registry_path = self.registry_dir / "experiments.csv"
        if not registry_path.exists():
            self._init_empty_registry(registry_path)

    def _init_empty_registry(self, registry_path: Path) -> None:
        """Create an empty registry file with headers."""
        import csv
        default_fields = [
            "run_id", "experiment_id", "phase", "status", "error",
            "seed", "n_agents", "kappa", "concentration", "mu", "monotonicity",
            "maturity_days", "Q_total", "S1", "L0", "default_handling", "dealer_enabled",
            "phi_total", "delta_total", "time_to_stability",
            "scenario_yaml", "events_jsonl", "balances_csv", "metrics_csv",
            "metrics_html", "run_html",
        ]
        with registry_path.open("w", newline="") as fh:
            writer = csv.DictWriter(fh, fieldnames=default_fields)
            writer.writeheader()

    def _next_seed(self) -> int:
        value = self.seed_counter
        self.seed_counter += 1
        return value

    def _upsert_registry(
        self,
        run_id: str,
        phase: str,
        status: RunStatus,
        parameters: Dict[str, Any],
        metrics: Optional[Dict[str, Any]] = None,
        artifact_paths: Optional[Dict[str, str]] = None,
        error: Optional[str] = None,
    ) -> None:
        """Upsert a registry entry using the configured store."""
        entry = RegistryEntry(
            run_id=run_id,
            experiment_id=self.experiment_id,
            status=status,
            parameters=parameters,
            metrics=metrics or {},
            artifact_paths=artifact_paths or {},
            error=error,
        )
        self.registry_store.upsert(entry)

    def run_grid(
        self,
        kappas: Sequence[Decimal],
        concentrations: Sequence[Decimal],
        mus: Sequence[Decimal],
        monotonicities: Sequence[Decimal],
    ) -> List[RingRunSummary]:
        summaries: List[RingRunSummary] = []
        for kappa, concentration, mu, monotonicity in generate_grid_params(
            kappas, concentrations, mus, monotonicities
        ):
            seed = self._next_seed()
            summaries.append(
                self._execute_run(
                    "grid",
                    kappa,
                    concentration,
                    mu,
                    monotonicity,
                    seed,
                )
            )
        return summaries

    def run_lhs(
        self,
        count: int,
        *,
        kappa_range: Tuple[Decimal, Decimal],
        concentration_range: Tuple[Decimal, Decimal],
        mu_range: Tuple[Decimal, Decimal],
        monotonicity_range: Tuple[Decimal, Decimal],
    ) -> List[RingRunSummary]:
        if count <= 0:
            return []
        summaries: List[RingRunSummary] = []
        for kappa, concentration, mu, monotonicity in generate_lhs_params(
            count,
            kappa_range=kappa_range,
            concentration_range=concentration_range,
            mu_range=mu_range,
            monotonicity_range=monotonicity_range,
            seed=self.seed_counter,
        ):
            seed = self._next_seed()
            summaries.append(
                self._execute_run(
                    "lhs",
                    kappa,
                    concentration,
                    mu,
                    monotonicity,
                    seed,
                )
            )
        return summaries

    def run_frontier(
        self,
        concentrations: Sequence[Decimal],
        mus: Sequence[Decimal],
        monotonicities: Sequence[Decimal],
        *,
        kappa_low: Decimal,
        kappa_high: Decimal,
        tolerance: Decimal,
        max_iterations: int,
    ) -> List[RingRunSummary]:
        summaries: List[RingRunSummary] = []

        # Create execution function that captures self and returns delta_total
        def execute_fn(
            label: str,
            kappa: Decimal,
            concentration: Decimal,
            mu: Decimal,
            monotonicity: Decimal,
        ) -> Optional[Decimal]:
            # Execute run with label
            summary = self._execute_run(
                "frontier",
                kappa,
                concentration,
                mu,
                monotonicity,
                self._next_seed(),
                label=label,
            )
            summaries.append(summary)
            return summary.delta_total

        # Use frontier sampling to execute runs with binary search
        # Unlike grid/LHS, frontier calls execute_fn directly for immediate feedback
        generate_frontier_params(
            concentrations,
            mus,
            monotonicities,
            kappa_low=kappa_low,
            kappa_high=kappa_high,
            tolerance=tolerance,
            max_iterations=max_iterations,
            execute_fn=execute_fn,
        )

        return summaries

    def _execute_run(
        self,
        phase: str,
        kappa: Decimal,
        concentration: Decimal,
        mu: Decimal,
        monotonicity: Decimal,
        seed: int,
        *,
        label: Optional[str] = None,
        progress_callback: Optional[Callable[[int, int], None]] = None,
    ) -> RingRunSummary:
        run_uuid = uuid.uuid4().hex[:12]
        run_id = f"{phase}_{label}_{run_uuid}" if label else f"{phase}_{run_uuid}"
        run_dir = self.runs_dir / run_id
        run_dir.mkdir(parents=True, exist_ok=True)
        out_dir = run_dir / "out"
        out_dir.mkdir(parents=True, exist_ok=True)

        scenario_path = run_dir / "scenario.yaml"
        run_html_path = run_dir / "run.html"
        balances_path = out_dir / "balances.csv"
        events_path = out_dir / "events.jsonl"

        # Common parameters for all registry updates
        base_params = {
            "phase": phase,
            "seed": seed,
            "n_agents": self.n_agents,
            "kappa": str(kappa),
            "concentration": str(concentration),
            "mu": str(mu),
            "monotonicity": str(monotonicity),
            "maturity_days": self.maturity_days,
            "Q_total": str(self.Q_total),
            "default_handling": self.default_handling,
            "dealer_enabled": self.dealer_enabled,
        }

        # Initial "running" status
        self._upsert_registry(
            run_id=run_id,
            phase=phase,
            status=RunStatus.RUNNING,
            parameters=base_params,
        )

        generator_data = {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": self.name_prefix,
            "params": {
                "n_agents": self.n_agents,
                "seed": seed,
                "kappa": str(kappa),
                "Q_total": str(self.Q_total),
                "inequality": {
                    "scheme": "dirichlet",
                    "concentration": str(concentration),
                    "monotonicity": str(monotonicity),
                },
                "maturity": {
                    "days": self.maturity_days,
                    "mode": "lead_lag",
                    "mu": str(mu),
                },
                "liquidity": {
                    "allocation": self._liquidity_allocation_dict(),
                },
            },
            "compile": {"emit_yaml": False},
        }

        generator_config = RingExplorerGeneratorConfig.model_validate(generator_data)

        if self.balanced_mode:
            # Use balanced generator for C vs D comparison scenarios (Plan 024)
            from bilancio.scenarios import compile_ring_explorer_balanced
            scenario = compile_ring_explorer_balanced(
                generator_config,
                face_value=self.face_value,
                outside_mid_ratio=self.outside_mid_ratio,
                big_entity_share=self.big_entity_share,  # DEPRECATED
                vbt_share_per_bucket=self.vbt_share_per_bucket,
                dealer_share_per_bucket=self.dealer_share_per_bucket,
                mode="active" if self.dealer_enabled else "passive",
                rollover_enabled=self.rollover_enabled,
                source_path=None,
            )
        else:
            scenario = compile_ring_explorer(generator_config, source_path=None)

        if self.dealer_enabled:
            dealer_section: Dict[str, Any] = {"enabled": True}
            if self.dealer_config:
                dealer_section.update(self.dealer_config)
            else:
                dealer_section.update({
                    "ticket_size": 1,
                    "dealer_share": Decimal("0.25"),
                    "vbt_share": Decimal("0.50"),
                })
            scenario["dealer"] = dealer_section

        if self.default_handling:
            scenario_run = scenario.setdefault("run", {})
            scenario_run["default_handling"] = self.default_handling

        # RingSweepRunner writes scenario.yaml itself for control
        with scenario_path.open("w", encoding="utf-8") as fh:
            yaml.safe_dump(_to_yaml_ready(scenario), fh, sort_keys=False, allow_unicode=False)

        S1 = Decimal("0")
        L0 = Decimal("0")
        for action in scenario.get("initial_actions", []):
            if "create_payable" in action:
                S1 += action["create_payable"]["amount"]
            if "mint_cash" in action:
                L0 += action["mint_cash"]["amount"]

        # Determine regime for logging (Plan 022)
        regime = "active" if self.dealer_enabled else "passive"

        # Build RunOptions from scenario configuration (Plan 027)
        options = RunOptions(
            mode="until_stable",
            max_days=scenario.get("run", {}).get("max_days", 90),
            quiet_days=scenario.get("run", {}).get("quiet_days", 2),
            check_invariants="daily",
            default_handling=self.default_handling,
            # Plan 030: Use "none" for quiet mode to suppress verbose console output
            show_events="none" if self.quiet else scenario.get("run", {}).get("show", {}).get("events", "detailed"),
            show_balances=scenario.get("run", {}).get("show", {}).get("balances"),
            t_account=False,
            detailed_dealer_logging=self.detailed_dealer_logging,
            run_id=run_id,
            regime=regime,
        )

        # Delegate simulation to executor (Plan 027)
        result = self.executor.execute(
            scenario_config=_to_yaml_ready(scenario),
            run_id=run_id,
            output_dir=run_dir,
            options=options,
        )

        # Handle failure case
        if result.status == RunStatus.FAILED:
            fail_params = {**base_params, "S1": str(S1), "L0": str(L0)}
            self._upsert_registry(
                run_id=run_id,
                phase=phase,
                status=RunStatus.FAILED,
                parameters=fail_params,
                artifact_paths={
                    "scenario_yaml": self._rel_path(scenario_path),
                    "run_html": self._rel_path(run_html_path),
                },
                error=result.error,
            )
            return RingRunSummary(
                run_id, phase, kappa, concentration, mu, monotonicity, None, None, 0,
                modal_call_id=result.modal_call_id
            )

        # Use MetricsComputer for analytics (Plan 027)
        # result.artifacts contains relative paths (e.g., "out/events.jsonl")
        artifacts: Dict[str, str] = {}
        if "events_jsonl" in result.artifacts:
            artifacts["events_jsonl"] = result.artifacts["events_jsonl"]
        if "balances_csv" in result.artifacts:
            artifacts["balances_csv"] = result.artifacts["balances_csv"]

        loader = self._artifact_loader_for_result(result)
        computer = MetricsComputer(loader)
        bundle = computer.compute(artifacts)

        # Write metrics outputs
        output_paths = computer.write_outputs(bundle, out_dir)

        # Extract summary metrics
        delta_total = bundle.summary.get("delta_total")
        phi_total = bundle.summary.get("phi_total")
        time_to_stability = int(bundle.summary.get("max_day") or 0)

        # Read dealer metrics if available (treatment runs with dealer enabled)
        dealer_metrics: Optional[Dict[str, Any]] = None
        dealer_metrics_path = out_dir / "dealer_metrics.json"
        if dealer_metrics_path.exists():
            import json
            with dealer_metrics_path.open() as f:
                dealer_metrics = json.load(f)

        # Update registry with completed status
        success_params = {**base_params, "S1": str(S1), "L0": str(L0)}
        success_metrics = {
            "time_to_stability": time_to_stability,
            "phi_total": str(phi_total) if phi_total is not None else "",
            "delta_total": str(delta_total) if delta_total is not None else "",
        }
        self._upsert_registry(
            run_id=run_id,
            phase=phase,
            status=RunStatus.COMPLETED,
            parameters=success_params,
            metrics=success_metrics,
            artifact_paths={
                "scenario_yaml": self._rel_path(scenario_path),
                "events_jsonl": self._rel_path(events_path),
                "balances_csv": self._rel_path(balances_path),
                "metrics_csv": self._rel_path(output_paths["metrics_csv"]),
                "metrics_html": self._rel_path(output_paths["metrics_html"]),
                "run_html": self._rel_path(run_html_path),
            },
        )

        return RingRunSummary(
            run_id, phase, kappa, concentration, mu, monotonicity,
            delta_total, phi_total, time_to_stability, dealer_metrics,
            modal_call_id=result.modal_call_id
        )

    def _prepare_run(
        self,
        phase: str,
        kappa: Decimal,
        concentration: Decimal,
        mu: Decimal,
        monotonicity: Decimal,
        seed: int,
        label: str = "",
    ) -> PreparedRun:
        """Prepare a run without executing it.

        Creates directories, builds scenario config, writes scenario.yaml.
        Returns PreparedRun that can be passed to execute_batch and then _finalize_run.
        """
        run_uuid = uuid.uuid4().hex[:12]
        run_id = f"{phase}_{label}_{run_uuid}" if label else f"{phase}_{run_uuid}"
        run_dir = self.runs_dir / run_id
        run_dir.mkdir(parents=True, exist_ok=True)
        out_dir = run_dir / "out"
        out_dir.mkdir(parents=True, exist_ok=True)

        scenario_path = run_dir / "scenario.yaml"

        base_params = {
            "phase": phase,
            "seed": seed,
            "n_agents": self.n_agents,
            "kappa": str(kappa),
            "concentration": str(concentration),
            "mu": str(mu),
            "monotonicity": str(monotonicity),
            "maturity_days": self.maturity_days,
            "Q_total": str(self.Q_total),
            "default_handling": self.default_handling,
            "dealer_enabled": self.dealer_enabled,
        }

        # Initial "running" status
        self._upsert_registry(
            run_id=run_id,
            phase=phase,
            status=RunStatus.RUNNING,
            parameters=base_params,
        )

        generator_data = {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": self.name_prefix,
            "params": {
                "n_agents": self.n_agents,
                "seed": seed,
                "kappa": str(kappa),
                "Q_total": str(self.Q_total),
                "inequality": {
                    "scheme": "dirichlet",
                    "concentration": str(concentration),
                    "monotonicity": str(monotonicity),
                },
                "maturity": {
                    "days": self.maturity_days,
                    "mode": "lead_lag",
                    "mu": str(mu),
                },
                "liquidity": {
                    "allocation": self._liquidity_allocation_dict(),
                },
            },
            "compile": {"emit_yaml": False},
        }

        generator_config = RingExplorerGeneratorConfig.model_validate(generator_data)

        if self.balanced_mode:
            from bilancio.scenarios import compile_ring_explorer_balanced
            scenario = compile_ring_explorer_balanced(
                generator_config,
                face_value=self.face_value,
                outside_mid_ratio=self.outside_mid_ratio,
                big_entity_share=self.big_entity_share,
                vbt_share_per_bucket=self.vbt_share_per_bucket,
                dealer_share_per_bucket=self.dealer_share_per_bucket,
                mode="active" if self.dealer_enabled else "passive",
                rollover_enabled=self.rollover_enabled,
                source_path=None,
            )
        else:
            scenario = compile_ring_explorer(generator_config, source_path=None)

        if self.dealer_enabled:
            dealer_section: Dict[str, Any] = {"enabled": True}
            if self.dealer_config:
                dealer_section.update(self.dealer_config)
            else:
                dealer_section.update({
                    "ticket_size": 1,
                    "dealer_share": Decimal("0.25"),
                    "vbt_share": Decimal("0.50"),
                })
            scenario["dealer"] = dealer_section

        if self.default_handling:
            scenario_run = scenario.setdefault("run", {})
            scenario_run["default_handling"] = self.default_handling

        # Write scenario.yaml
        with scenario_path.open("w", encoding="utf-8") as fh:
            yaml.safe_dump(_to_yaml_ready(scenario), fh, sort_keys=False, allow_unicode=False)

        S1 = Decimal("0")
        L0 = Decimal("0")
        for action in scenario.get("initial_actions", []):
            if "create_payable" in action:
                S1 += action["create_payable"]["amount"]
            if "mint_cash" in action:
                L0 += action["mint_cash"]["amount"]

        regime = "active" if self.dealer_enabled else "passive"

        options = RunOptions(
            mode="until_stable",
            max_days=scenario.get("run", {}).get("max_days", 90),
            quiet_days=scenario.get("run", {}).get("quiet_days", 2),
            check_invariants="daily",
            default_handling=self.default_handling,
            show_events="none" if self.quiet else scenario.get("run", {}).get("show", {}).get("events", "detailed"),
            show_balances=scenario.get("run", {}).get("show", {}).get("balances"),
            t_account=False,
            detailed_dealer_logging=self.detailed_dealer_logging,
            run_id=run_id,
            regime=regime,
        )

        return PreparedRun(
            run_id=run_id,
            phase=phase,
            kappa=kappa,
            concentration=concentration,
            mu=mu,
            monotonicity=monotonicity,
            seed=seed,
            scenario_config=_to_yaml_ready(scenario),
            options=options,
            run_dir=run_dir,
            out_dir=out_dir,
            scenario_path=scenario_path,
            base_params=base_params,
            S1=S1,
            L0=L0,
        )

    def _finalize_run(
        self,
        prepared: PreparedRun,
        result: ExecutionResult,
    ) -> RingRunSummary:
        """Finalize a run after execution completes.

        Computes metrics, updates registry, returns summary.
        """
        run_html_path = prepared.run_dir / "run.html"
        balances_path = prepared.out_dir / "balances.csv"
        events_path = prepared.out_dir / "events.jsonl"

        # Handle failure case
        if result.status == RunStatus.FAILED:
            fail_params = {**prepared.base_params, "S1": str(prepared.S1), "L0": str(prepared.L0)}
            self._upsert_registry(
                run_id=prepared.run_id,
                phase=prepared.phase,
                status=RunStatus.FAILED,
                parameters=fail_params,
                artifact_paths={
                    "scenario_yaml": self._rel_path(prepared.scenario_path),
                    "run_html": self._rel_path(run_html_path),
                },
                error=result.error,
            )
            return RingRunSummary(
                prepared.run_id, prepared.phase, prepared.kappa, prepared.concentration,
                prepared.mu, prepared.monotonicity, None, None, 0,
                modal_call_id=result.modal_call_id
            )

        # Compute metrics
        artifacts: Dict[str, str] = {}
        if "events_jsonl" in result.artifacts:
            artifacts["events_jsonl"] = result.artifacts["events_jsonl"]
        if "balances_csv" in result.artifacts:
            artifacts["balances_csv"] = result.artifacts["balances_csv"]

        loader = self._artifact_loader_for_result(result)
        computer = MetricsComputer(loader)
        bundle = computer.compute(artifacts)

        output_paths = computer.write_outputs(bundle, prepared.out_dir)

        delta_total = bundle.summary.get("delta_total")
        phi_total = bundle.summary.get("phi_total")
        time_to_stability = int(bundle.summary.get("max_day") or 0)

        dealer_metrics: Optional[Dict[str, Any]] = None
        dealer_metrics_path = prepared.out_dir / "dealer_metrics.json"
        if dealer_metrics_path.exists():
            import json
            with dealer_metrics_path.open() as f:
                dealer_metrics = json.load(f)

        success_params = {**prepared.base_params, "S1": str(prepared.S1), "L0": str(prepared.L0)}
        success_metrics = {
            "time_to_stability": time_to_stability,
            "phi_total": str(phi_total) if phi_total is not None else "",
            "delta_total": str(delta_total) if delta_total is not None else "",
        }
        self._upsert_registry(
            run_id=prepared.run_id,
            phase=prepared.phase,
            status=RunStatus.COMPLETED,
            parameters=success_params,
            metrics=success_metrics,
            artifact_paths={
                "scenario_yaml": self._rel_path(prepared.scenario_path),
                "events_jsonl": self._rel_path(events_path),
                "balances_csv": self._rel_path(balances_path),
                "metrics_csv": self._rel_path(output_paths["metrics_csv"]),
                "metrics_html": self._rel_path(output_paths["metrics_html"]),
                "run_html": self._rel_path(run_html_path),
            },
        )

        return RingRunSummary(
            prepared.run_id, prepared.phase, prepared.kappa, prepared.concentration,
            prepared.mu, prepared.monotonicity,
            delta_total, phi_total, time_to_stability, dealer_metrics,
            modal_call_id=result.modal_call_id
        )

    def _rel_path(self, absolute: Path) -> str:
        try:
            return str(Path("..").joinpath(absolute.relative_to(self.base_dir)))
        except ValueError:
            return str(absolute)

    def _artifact_loader_for_result(self, result: ExecutionResult):
        if result.storage_type == "modal_volume":
            return ModalVolumeArtifactLoader(base_path=result.storage_base)
        return LocalArtifactLoader(base_path=Path(result.storage_base))

    def _liquidity_allocation_dict(self) -> Dict[str, Any]:
        allocation: Dict[str, Any] = {"mode": self.liquidity_mode}
        if self.liquidity_mode == "single_at" and self.liquidity_agent:
            allocation["agent"] = self.liquidity_agent
        return allocation


__all__ = [
    "RingSweepRunner",
    "RingRunSummary",
    "PreparedRun",
    "RingSweepConfig",
    "load_ring_sweep_config",
    "_decimal_list",
]

```

---

### 📄 src/bilancio/experiments/sampling/__init__.py

```python
"""Parameter sampling strategies for experiment sweeps."""

from __future__ import annotations

from .frontier import generate_frontier_params
from .grid import generate_grid_params
from .lhs import generate_lhs_params

__all__ = [
    "generate_grid_params",
    "generate_lhs_params",
    "generate_frontier_params",
]

```

---

### 📄 src/bilancio/experiments/sampling/frontier.py

```python
"""Frontier/binary search parameter sampling strategy."""

from __future__ import annotations

from decimal import Decimal
from typing import Callable, List, Optional, Sequence, Tuple


def generate_frontier_params(
    concentrations: Sequence[Decimal],
    mus: Sequence[Decimal],
    monotonicities: Sequence[Decimal],
    *,
    kappa_low: Decimal,
    kappa_high: Decimal,
    tolerance: Decimal,
    max_iterations: int,
    execute_fn: Callable[[str, Decimal, Decimal, Decimal, Decimal], Optional[Decimal]],
) -> None:
    """
    Execute frontier/binary search parameter combinations.

    For each combination of (concentration, mu, monotonicity), performs binary
    search over kappa to find the frontier where delta_total <= tolerance.

    This is an adaptive sampling strategy that uses feedback from simulations
    to efficiently locate the boundary between stable and unstable regions.

    Unlike grid and LHS sampling, frontier sampling executes runs directly via
    execute_fn because it needs immediate feedback to decide what to test next.

    Args:
        concentrations: Sequence of concentration values
        mus: Sequence of mu values
        monotonicities: Sequence of monotonicity values
        kappa_low: Initial lower bound for kappa
        kappa_high: Initial upper bound for kappa
        tolerance: Target tolerance for delta_total
        max_iterations: Maximum binary search iterations per cell
        execute_fn: Function that executes a run and returns delta_total.
                   Signature: (label, kappa, concentration, mu, monotonicity) -> Optional[Decimal]
                   Returns None if run failed to stabilize.

    Returns:
        None (calls execute_fn directly for side effects)
    """
    for concentration in concentrations:
        for mu in mus:
            for monotonicity in monotonicities:
                _run_frontier_cell(
                    concentration,
                    mu,
                    monotonicity,
                    kappa_low,
                    kappa_high,
                    tolerance,
                    max_iterations,
                    execute_fn,
                )


def _run_frontier_cell(
    concentration: Decimal,
    mu: Decimal,
    monotonicity: Decimal,
    kappa_low: Decimal,
    kappa_high: Decimal,
    tolerance: Decimal,
    max_iterations: int,
    execute_fn: Callable[[str, Decimal, Decimal, Decimal, Decimal], Optional[Decimal]],
) -> None:
    """
    Binary search for frontier kappa for a single parameter cell.

    Strategy:
    1. Test kappa_low - if already stable, return
    2. Test and expand kappa_high until stable or max reached
    3. Binary search between low and high to find tightest stable kappa

    Args:
        concentration: Concentration parameter
        mu: Mu parameter
        monotonicity: Monotonicity parameter
        kappa_low: Lower bound for kappa
        kappa_high: Initial upper bound for kappa
        tolerance: Target tolerance for delta_total
        max_iterations: Maximum binary search iterations
        execute_fn: Function to execute run and get delta_total

    Returns:
        None (calls execute_fn directly for side effects)
    """
    # Test lower bound
    low_delta = execute_fn("low", kappa_low, concentration, mu, monotonicity)

    # If lower bound is already stable, we're done
    if low_delta is not None and low_delta <= tolerance:
        return

    # Find upper bound that is stable
    hi_kappa = kappa_high
    hi_delta = execute_fn("high", hi_kappa, concentration, mu, monotonicity)

    # Expand upper bound if needed (up to 4x original or kappa=128)
    while (hi_delta is None or hi_delta > tolerance) and hi_kappa < kappa_high * 4:
        hi_kappa = hi_kappa * Decimal("1.5")
        hi_delta = execute_fn("high", hi_kappa, concentration, mu, monotonicity)
        if hi_kappa > Decimal("128"):
            break

    # If upper bound is still unstable, give up
    if hi_delta is None or hi_delta > tolerance:
        return

    # Binary search between stable bounds
    low = kappa_low
    high = hi_kappa

    for _ in range(max_iterations):
        if high - low <= tolerance:
            break

        mid = (low + high) / 2
        mid_delta = execute_fn("mid", mid, concentration, mu, monotonicity)

        if mid_delta is None:
            # Unstable, search higher
            low = mid
        elif mid_delta <= tolerance:
            # Stable, search lower
            high = mid
        else:
            # Unstable, search higher
            low = mid

```

---

### 📄 src/bilancio/experiments/sampling/grid.py

```python
"""Grid/Cartesian product parameter sampling strategy."""

from __future__ import annotations

from decimal import Decimal
from typing import Iterator, Sequence, Tuple


def generate_grid_params(
    kappas: Sequence[Decimal],
    concentrations: Sequence[Decimal],
    mus: Sequence[Decimal],
    monotonicities: Sequence[Decimal],
) -> Iterator[Tuple[Decimal, Decimal, Decimal, Decimal]]:
    """
    Generate parameter combinations using Cartesian product (grid sampling).

    Args:
        kappas: Sequence of kappa values
        concentrations: Sequence of concentration values
        mus: Sequence of mu values
        monotonicities: Sequence of monotonicity values

    Yields:
        Tuples of (kappa, concentration, mu, monotonicity)
    """
    for kappa in kappas:
        for concentration in concentrations:
            for mu in mus:
                for monotonicity in monotonicities:
                    yield (kappa, concentration, mu, monotonicity)

```

---

### 📄 src/bilancio/experiments/sampling/lhs.py

```python
"""Latin Hypercube Sampling (LHS) parameter generation strategy."""

from __future__ import annotations

import random
from decimal import Decimal
from typing import Iterator, List, Tuple


def generate_lhs_params(
    count: int,
    *,
    kappa_range: Tuple[Decimal, Decimal],
    concentration_range: Tuple[Decimal, Decimal],
    mu_range: Tuple[Decimal, Decimal],
    monotonicity_range: Tuple[Decimal, Decimal],
    seed: int,
) -> Iterator[Tuple[Decimal, Decimal, Decimal, Decimal]]:
    """
    Generate parameter combinations using Latin Hypercube Sampling.

    LHS divides each parameter range into equal-probability strata and samples
    one value from each stratum, then shuffles the samples to decorrelate them.
    This ensures good coverage of the parameter space with fewer samples than
    grid sampling.

    Args:
        count: Number of parameter combinations to generate
        kappa_range: (low, high) bounds for kappa
        concentration_range: (low, high) bounds for concentration
        mu_range: (low, high) bounds for mu
        monotonicity_range: (low, high) bounds for monotonicity
        seed: Random seed for reproducibility

    Yields:
        Tuples of (kappa, concentration, mu, monotonicity)
    """
    if count <= 0:
        return

    rng = random.Random(seed + 7919)  # Add offset for variety

    # Sample each dimension using LHS
    kappas = _lhs_axis(count, kappa_range, rng)
    concentrations = _lhs_axis(count, concentration_range, rng)
    mus = _lhs_axis(count, mu_range, rng)
    monotonicities = _lhs_axis(count, monotonicity_range, rng)

    # Shuffle to decorrelate dimensions
    rng.shuffle(concentrations)
    rng.shuffle(mus)
    rng.shuffle(monotonicities)

    # Yield parameter combinations
    for idx in range(count):
        yield (kappas[idx], concentrations[idx], mus[idx], monotonicities[idx])


def _lhs_axis(count: int, bounds: Tuple[Decimal, Decimal], rng: random.Random) -> List[Decimal]:
    """
    Sample a single parameter dimension using Latin Hypercube Sampling.

    Divides the range into 'count' equal strata and samples one value uniformly
    from each stratum.

    Args:
        count: Number of strata/samples
        bounds: (low, high) bounds for the parameter
        rng: Random number generator

    Returns:
        List of sampled values (shuffled)
    """
    low, high = bounds
    samples: List[Decimal] = []

    for stratum in range(count):
        # Define stratum boundaries as fractions [0,1]
        a = Decimal(stratum) / Decimal(count)
        b = Decimal(stratum + 1) / Decimal(count)

        # Sample uniformly within stratum
        u = Decimal(str(rng.random()))
        frac = a + (b - a) * u

        # Map to parameter range
        samples.append(low + (high - low) * frac)

    # Shuffle to decorrelate from stratum order
    rng.shuffle(samples)
    return samples

```

---

### 📄 src/bilancio/export/__init__.py

```python
"""Export utilities for Bilancio simulation results."""

from .writers import write_balances_csv, write_events_jsonl

__all__ = ["write_balances_csv", "write_events_jsonl"]
```

---

### 📄 src/bilancio/export/writers.py

```python
"""Writers for exporting Bilancio simulation data."""

import json
import csv
from pathlib import Path
from typing import Any, Dict, List
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.analysis.balances import as_rows, system_trial_balance


def decimal_default(obj):
    """JSON encoder for Decimal types.
    
    Preserves precision by converting to string for exact representation.
    Most JSON parsers can handle numeric strings correctly.
    """
    if isinstance(obj, Decimal):
        # Convert to string to preserve exact precision
        # Use normalize() to remove trailing zeros
        normalized = obj.normalize()
        # Check if it's an integer value
        if normalized == normalized.to_integral_value():
            return int(normalized)
        else:
            # Return as string to preserve exact decimal precision
            return str(normalized)
    raise TypeError(f"Object of type {type(obj)} is not JSON serializable")


def write_balances_csv(system: System, path: Path) -> None:
    """Export system balances to CSV format.
    
    Creates a CSV file with balance sheet data for all agents
    and the system as a whole.
    
    Args:
        system: System instance with simulation results
        path: Path where to write the CSV file
    """
    # Get balance rows
    rows = as_rows(system)
    
    # Add system trial balance
    trial_bal = system_trial_balance(system)
    rows.append({
        "agent_id": "SYSTEM",
        "agent_name": "System Total",
        "agent_kind": "system",
        "item_type": "summary",
        "item_name": "Total Assets",
        "amount": trial_bal.total_financial_assets
    })
    rows.append({
        "agent_id": "SYSTEM",
        "agent_name": "System Total",
        "agent_kind": "system",
        "item_type": "summary",
        "item_name": "Total Liabilities",
        "amount": trial_bal.total_financial_liabilities
    })
    rows.append({
        "agent_id": "SYSTEM",
        "agent_name": "System Total",
        "agent_kind": "system",
        "item_type": "summary",
        "item_name": "Total Equity",
        "amount": trial_bal.total_financial_assets - trial_bal.total_financial_liabilities
    })
    
    # Write to CSV
    if rows:
        # Collect all unique fieldnames from all rows
        fieldnames_set = set()
        for row in rows:
            fieldnames_set.update(row.keys())
        fieldnames = sorted(list(fieldnames_set))
        
        with open(path, 'w', newline='') as csvfile:
            writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
            writer.writeheader()
            
            for row in rows:
                # Convert Decimal to float for CSV
                row_copy = row.copy()
                for key, value in row_copy.items():
                    if isinstance(value, Decimal):
                        row_copy[key] = float(value)
                writer.writerow(row_copy)


def write_events_jsonl(system: System, path: Path) -> None:
    """Export system events to JSONL format.
    
    Creates a JSONL file (one JSON object per line) with all
    simulation events for detailed analysis.
    
    Args:
        system: System instance with simulation results
        path: Path where to write the JSONL file
    """
    with open(path, 'w') as f:
        for event in system.state.events:
            # Write each event as a separate JSON line
            json.dump(event, f, default=decimal_default)
            f.write('\n')


def write_balances_snapshot(
    system: System,
    path: Path,
    day: int,
    agent_ids: List[str] = None
) -> None:
    """Export a snapshot of balances for specific agents on a specific day.
    
    Args:
        system: System instance
        path: Path where to write the snapshot
        day: Day number for the snapshot
        agent_ids: List of agent IDs to include (None for all)
    """
    snapshot = {
        "day": day,
        "agents": {}
    }
    
    # Determine which agents to include
    if agent_ids is None:
        agent_ids = list(system.state.agents.keys())
    
    # Collect balance data for each agent
    for agent_id in agent_ids:
        if agent_id not in system.state.agents:
            continue
            
        agent = system.state.agents[agent_id]
        
        # Get balance sheet items
        assets = []
        for asset_id in agent.asset_ids:
            if asset_id in system.state.contracts:
                contract = system.state.contracts[asset_id]
                assets.append({
                    "id": asset_id,
                    "type": type(contract).__name__,
                    "amount": getattr(contract, "amount", None)
                })
        
        liabilities = []
        for liability_id in agent.liability_ids:
            if liability_id in system.state.contracts:
                contract = system.state.contracts[liability_id]
                liabilities.append({
                    "id": liability_id,
                    "type": type(contract).__name__,
                    "amount": getattr(contract, "amount", None)
                })
        
        stocks = []
        for stock_id in agent.stock_ids:
            if stock_id in system.state.stocks:
                stock = system.state.stocks[stock_id]
                stocks.append({
                    "id": stock_id,
                    "sku": stock.sku,
                    "quantity": stock.quantity,
                    "unit_price": stock.unit_price,
                    "total_value": stock.quantity * stock.unit_price
                })
        
        snapshot["agents"][agent_id] = {
            "name": agent.name,
            "kind": agent.kind,
            "assets": assets,
            "liabilities": liabilities,
            "stocks": stocks
        }
    
    # Write snapshot to file
    with open(path, 'w') as f:
        json.dump(snapshot, f, indent=2, default=decimal_default)
```

---

### 📄 src/bilancio/jobs/__init__.py

```python
"""Job management for simulation runs."""

from .job_id import generate_job_id, validate_job_id
from .manager import JobManager, create_job_manager
from .models import Job, JobConfig, JobEvent, JobStatus

__all__ = [
    "create_job_manager",
    "generate_job_id",
    "validate_job_id",
    "Job",
    "JobConfig",
    "JobEvent",
    "JobManager",
    "JobStatus",
]

```

---

### 📄 src/bilancio/jobs/job_id.py

```python
"""Job ID generation for memorable simulation job identifiers."""

from xkcdpass import xkcd_password as xp

# Use the EFF large wordlist (7776 words, designed for memorability)
_wordlist = xp.generate_wordlist(wordfile=xp.locate_wordfile())


def generate_job_id(num_words: int = 4) -> str:
    """Generate a memorable job ID as a hyphen-separated passphrase.

    Uses the EFF wordlist via xkcdpass for high-quality memorable words.

    Args:
        num_words: Number of words in the passphrase (default 4)

    Returns:
        A job ID like "castle-river-mountain-forest"

    Example:
        >>> job_id = generate_job_id()
        >>> print(job_id)  # "correct-horse-battery-staple"
    """
    return xp.generate_xkcdpassword(_wordlist, numwords=num_words, delimiter="-")


def validate_job_id(job_id: str) -> bool:
    """Validate that a job ID has the correct format.

    Args:
        job_id: The job ID to validate

    Returns:
        True if valid format (hyphen-separated words), False otherwise
    """
    if not job_id:
        return False
    parts = job_id.split("-")
    if len(parts) < 2:  # At least 2 words
        return False
    return all(part.isalpha() and part.islower() for part in parts)

```

---

### 📄 src/bilancio/jobs/manager.py

```python
"""Job lifecycle management."""

import json
import logging
from datetime import datetime
from pathlib import Path
from typing import Optional, TYPE_CHECKING

from .job_id import generate_job_id
from .models import Job, JobConfig, JobEvent, JobStatus

if TYPE_CHECKING:
    from .supabase_store import SupabaseJobStore

logger = logging.getLogger(__name__)


def create_job_manager(
    jobs_dir: Optional[Path] = None,
    cloud: bool = False,
    local: bool = True,
) -> "JobManager":
    """Factory function to create a JobManager with optional cloud storage.

    Args:
        jobs_dir: Directory to store job manifests. If None and local=True,
                  jobs are only in-memory.
        cloud: If True, enable Supabase cloud storage (requires BILANCIO_SUPABASE_*
               environment variables to be set).
        local: If False, skip local file storage (useful for memory-constrained VMs).
               When cloud=True and local=False, jobs are only stored in Supabase.

    Returns:
        Configured JobManager instance.

    Example:
        >>> # Cloud-only (no local files)
        >>> manager = create_job_manager(cloud=True, local=False)
        >>> job = manager.create_job("Test job", config)
        >>>
        >>> # Both local and cloud
        >>> manager = create_job_manager(Path("./jobs"), cloud=True, local=True)
    """
    cloud_store = None
    if cloud:
        try:
            from bilancio.storage.supabase_client import is_supabase_configured

            if is_supabase_configured():
                from .supabase_store import SupabaseJobStore

                cloud_store = SupabaseJobStore()
                logger.info("Supabase cloud storage enabled for jobs")
            else:
                logger.warning(
                    "Cloud storage requested but Supabase not configured. "
                    "Set BILANCIO_SUPABASE_URL and BILANCIO_SUPABASE_ANON_KEY."
                )
        except ImportError as e:
            logger.warning(f"Failed to import Supabase: {e}")

    # If local=False, don't pass jobs_dir to avoid creating local files
    effective_jobs_dir = jobs_dir if local else None

    return JobManager(jobs_dir=effective_jobs_dir, cloud_store=cloud_store)


class JobManager:
    """Manages job lifecycle and persistence.

    Supports both local file storage and optional cloud storage via Supabase.
    When cloud_store is provided, jobs are persisted to both local and cloud.
    """

    def __init__(
        self,
        jobs_dir: Optional[Path] = None,
        cloud_store: Optional["SupabaseJobStore"] = None,
    ):
        """Initialize the job manager.

        Args:
            jobs_dir: Directory to store job manifests. If None, jobs are only in-memory.
            cloud_store: Optional Supabase store for cloud persistence. Jobs will be
                        saved to both local and cloud when provided.
        """
        self.jobs_dir = jobs_dir
        self.cloud_store = cloud_store
        self._jobs: dict[str, Job] = {}

        if jobs_dir:
            jobs_dir.mkdir(parents=True, exist_ok=True)

    def create_job(
        self,
        description: str,
        config: JobConfig,
        job_id: Optional[str] = None,
        notes: Optional[str] = None,
    ) -> Job:
        """Create a new job.

        Args:
            description: User's description of the simulation request
            config: Job configuration
            job_id: Optional custom job ID (auto-generated if not provided)
            notes: Optional additional notes

        Returns:
            The created Job instance
        """
        if job_id is None:
            job_id = generate_job_id()

        now = datetime.utcnow()
        job = Job(
            job_id=job_id,
            created_at=now,
            status=JobStatus.PENDING,
            description=description,
            config=config,
            notes=notes,
        )

        # Record creation event
        event = JobEvent(
            job_id=job_id,
            event_type="created",
            timestamp=now,
            details={"config": config.to_dict()},
        )
        job.events.append(event)

        self._jobs[job_id] = job
        self._save_job(job)
        self._save_event(event)

        return job

    def start_job(self, job_id: str) -> None:
        """Mark a job as started.

        Args:
            job_id: The job ID to start

        Raises:
            KeyError: If job not found
        """
        job = self.get_job(job_id)
        if job is None:
            raise KeyError(f"Job not found: {job_id}")

        job.status = JobStatus.RUNNING
        event = JobEvent(
            job_id=job_id,
            event_type="started",
            timestamp=datetime.utcnow(),
        )
        job.events.append(event)
        self._save_job(job)
        self._save_event(event)

    def record_progress(
        self,
        job_id: str,
        run_id: str,
        metrics: Optional[dict] = None,
        modal_call_id: Optional[str] = None,
    ) -> None:
        """Record progress on a job (a run completed).

        Args:
            job_id: The job ID
            run_id: The completed run ID
            metrics: Optional metrics from the run
            modal_call_id: Optional Modal function call ID for debugging

        Raises:
            KeyError: If job not found
        """
        job = self.get_job(job_id)
        if job is None:
            raise KeyError(f"Job not found: {job_id}")

        job.run_ids.append(run_id)
        if modal_call_id:
            job.modal_call_ids[run_id] = modal_call_id
        event = JobEvent(
            job_id=job_id,
            event_type="progress",
            timestamp=datetime.utcnow(),
            details={"run_id": run_id, "metrics": metrics or {}, "modal_call_id": modal_call_id},
        )
        job.events.append(event)
        self._save_job(job)
        self._save_event(event)

    def complete_job(self, job_id: str, summary: Optional[dict] = None) -> None:
        """Mark a job as completed.

        Args:
            job_id: The job ID
            summary: Optional summary statistics

        Raises:
            KeyError: If job not found
        """
        job = self.get_job(job_id)
        if job is None:
            raise KeyError(f"Job not found: {job_id}")

        now = datetime.utcnow()
        job.status = JobStatus.COMPLETED
        job.completed_at = now

        event = JobEvent(
            job_id=job_id,
            event_type="completed",
            timestamp=now,
            details={"summary": summary or {}},
        )
        job.events.append(event)
        self._save_job(job)
        self._save_event(event)

    def fail_job(self, job_id: str, error: str) -> None:
        """Mark a job as failed.

        Args:
            job_id: The job ID
            error: Error message

        Raises:
            KeyError: If job not found
        """
        job = self.get_job(job_id)
        if job is None:
            raise KeyError(f"Job not found: {job_id}")

        now = datetime.utcnow()
        job.status = JobStatus.FAILED
        job.completed_at = now
        job.error = error

        event = JobEvent(
            job_id=job_id,
            event_type="failed",
            timestamp=now,
            details={"error": error},
        )
        job.events.append(event)
        self._save_job(job)
        self._save_event(event)

    def get_job(self, job_id: str) -> Optional[Job]:
        """Get a job by ID.

        Args:
            job_id: The job ID

        Returns:
            The Job instance or None if not found
        """
        # Check in-memory cache first
        if job_id in self._jobs:
            return self._jobs[job_id]

        # Try to load from disk
        if self.jobs_dir:
            manifest_path = self.jobs_dir / job_id / "job_manifest.json"
            if manifest_path.exists():
                job = self._load_job(manifest_path)
                self._jobs[job_id] = job
                return job

        return None

    def list_jobs(self) -> list[Job]:
        """List all known jobs.

        Returns:
            List of Job instances
        """
        # Load any jobs from disk that aren't in memory
        if self.jobs_dir and self.jobs_dir.exists():
            for job_dir in self.jobs_dir.iterdir():
                if job_dir.is_dir():
                    job_id = job_dir.name
                    if job_id not in self._jobs:
                        manifest_path = job_dir / "job_manifest.json"
                        if manifest_path.exists():
                            job = self._load_job(manifest_path)
                            self._jobs[job_id] = job

        return list(self._jobs.values())

    def _save_job(self, job: Job) -> None:
        """Save job manifest to disk and optionally to cloud.

        Args:
            job: The job to save
        """
        # Save to local filesystem
        if self.jobs_dir is not None:
            job_dir = self.jobs_dir / job.job_id
            job_dir.mkdir(parents=True, exist_ok=True)

            manifest_path = job_dir / "job_manifest.json"
            with open(manifest_path, "w") as f:
                json.dump(job.to_dict(), f, indent=2)

        # Save to cloud store if configured
        if self.cloud_store is not None:
            try:
                self.cloud_store.save_job(job)
            except Exception as e:
                logger.warning(f"Failed to save job to cloud: {e}")

    def _save_event(self, event: JobEvent) -> None:
        """Save a job event to cloud storage.

        Events are saved to Supabase for queryable history.
        Local events are stored in the job manifest itself.

        Args:
            event: The event to save
        """
        if self.cloud_store is not None:
            try:
                self.cloud_store.save_event(event)
            except Exception as e:
                logger.warning(f"Failed to save event to cloud: {e}")

    def _load_job(self, manifest_path: Path) -> Job:
        """Load a job from a manifest file.

        Args:
            manifest_path: Path to job_manifest.json

        Returns:
            The loaded Job instance
        """
        with open(manifest_path) as f:
            data = json.load(f)
        return Job.from_dict(data)

```

---

### 📄 src/bilancio/jobs/models.py

```python
"""Job system data models."""

from dataclasses import dataclass, field
from datetime import datetime
from decimal import Decimal
from enum import Enum
from typing import Optional


class JobStatus(Enum):
    """Status of a simulation job."""

    PENDING = "pending"
    RUNNING = "running"
    COMPLETED = "completed"
    FAILED = "failed"


@dataclass
class JobConfig:
    """Configuration for a simulation job."""

    sweep_type: str  # "ring", "balanced", "single"
    n_agents: int
    kappas: list[Decimal]
    concentrations: list[Decimal]
    mus: list[Decimal]
    cloud: bool = False
    outside_mid_ratios: list[Decimal] = field(default_factory=lambda: [Decimal("1")])
    maturity_days: int = 5
    seeds: list[int] = field(default_factory=lambda: [42])

    def to_dict(self) -> dict:
        """Convert to dictionary for serialization."""
        return {
            "sweep_type": self.sweep_type,
            "n_agents": self.n_agents,
            "kappas": [str(k) for k in self.kappas],
            "concentrations": [str(c) for c in self.concentrations],
            "mus": [str(m) for m in self.mus],
            "cloud": self.cloud,
            "outside_mid_ratios": [str(r) for r in self.outside_mid_ratios],
            "maturity_days": self.maturity_days,
            "seeds": self.seeds,
        }

    @classmethod
    def from_dict(cls, data: dict) -> "JobConfig":
        """Create from dictionary."""
        return cls(
            sweep_type=data["sweep_type"],
            n_agents=data["n_agents"],
            kappas=[Decimal(k) for k in data["kappas"]],
            concentrations=[Decimal(c) for c in data["concentrations"]],
            mus=[Decimal(m) for m in data["mus"]],
            cloud=data.get("cloud", False),
            outside_mid_ratios=[
                Decimal(r) for r in data.get("outside_mid_ratios", ["1"])
            ],
            maturity_days=data.get("maturity_days", 5),
            seeds=data.get("seeds", [42]),
        )


@dataclass
class JobEvent:
    """An event in the job lifecycle."""

    job_id: str
    event_type: str  # "created", "started", "progress", "completed", "failed"
    timestamp: datetime
    details: dict = field(default_factory=dict)

    def to_dict(self) -> dict:
        """Convert to dictionary for serialization."""
        return {
            "job_id": self.job_id,
            "event_type": self.event_type,
            "timestamp": self.timestamp.isoformat(),
            "details": self.details,
        }

    @classmethod
    def from_dict(cls, data: dict) -> "JobEvent":
        """Create from dictionary."""
        return cls(
            job_id=data["job_id"],
            event_type=data["event_type"],
            timestamp=datetime.fromisoformat(data["timestamp"]),
            details=data.get("details", {}),
        )


@dataclass
class Job:
    """A simulation job with lifecycle tracking."""

    job_id: str
    created_at: datetime
    status: JobStatus
    description: str
    config: JobConfig
    run_ids: list[str] = field(default_factory=list)
    modal_call_ids: dict[str, str] = field(default_factory=dict)  # run_id -> modal_call_id
    completed_at: Optional[datetime] = None
    error: Optional[str] = None
    notes: Optional[str] = None
    events: list[JobEvent] = field(default_factory=list)

    def to_dict(self) -> dict:
        """Convert to dictionary for serialization."""
        return {
            "job_id": self.job_id,
            "created_at": self.created_at.isoformat(),
            "status": self.status.value,
            "description": self.description,
            "config": self.config.to_dict(),
            "run_ids": self.run_ids,
            "modal_call_ids": self.modal_call_ids,
            "completed_at": self.completed_at.isoformat() if self.completed_at else None,
            "error": self.error,
            "notes": self.notes,
            "events": [e.to_dict() for e in self.events],
        }

    @classmethod
    def from_dict(cls, data: dict) -> "Job":
        """Create from dictionary."""
        return cls(
            job_id=data["job_id"],
            created_at=datetime.fromisoformat(data["created_at"]),
            status=JobStatus(data["status"]),
            description=data["description"],
            config=JobConfig.from_dict(data["config"]),
            run_ids=data.get("run_ids", []),
            modal_call_ids=data.get("modal_call_ids", {}),
            completed_at=(
                datetime.fromisoformat(data["completed_at"])
                if data.get("completed_at")
                else None
            ),
            error=data.get("error"),
            notes=data.get("notes"),
            events=[JobEvent.from_dict(e) for e in data.get("events", [])],
        )

```

---

### 📄 src/bilancio/jobs/supabase_store.py

```python
"""Supabase storage backend for job persistence.

This module provides a SupabaseJobStore class that persists jobs and events
to a Supabase PostgreSQL database for durable, queryable storage.
"""

import logging
from datetime import datetime
from decimal import Decimal
from typing import Any, Optional

from .models import Job, JobConfig, JobEvent, JobStatus

logger = logging.getLogger(__name__)


class SupabaseJobStore:
    """Persists jobs and events to Supabase.

    This store provides durable storage for job metadata, allowing jobs to be
    queried across sessions and from different environments (local, Modal, etc).

    If Supabase is unavailable, operations fail gracefully with warnings rather
    than raising exceptions, allowing the application to continue with local
    storage fallback.
    """

    def __init__(self, client: Optional[Any] = None) -> None:
        """Initialize the Supabase job store.

        Args:
            client: Optional Supabase client instance. If not provided,
                   attempts to get one from the supabase_client module.
        """
        self._client = client
        self._initialized = False

    @property
    def client(self) -> Optional[Any]:
        """Lazily initialize and return the Supabase client."""
        if self._client is not None:
            return self._client

        if self._initialized:
            return None

        self._initialized = True

        try:
            from bilancio.storage.supabase_client import (
                get_supabase_client,
                is_supabase_configured,
            )

            if not is_supabase_configured():
                logger.debug("Supabase is not configured")
                return None

            self._client = get_supabase_client()
            return self._client
        except ImportError:
            logger.warning("supabase_client module not found")
            return None
        except Exception as e:
            logger.warning(f"Failed to initialize Supabase client: {e}")
            return None

    def save_job(self, job: Job) -> None:
        """Save or update a job to Supabase.

        Maps the Job dataclass to the database schema, handling type conversions
        for arrays, decimals, and timestamps.

        Args:
            job: The Job instance to save.
        """
        if self.client is None:
            logger.debug("Supabase unavailable, skipping job save")
            return

        try:
            # Map Job fields to database columns
            data = {
                "job_id": job.job_id,
                "created_at": job.created_at.isoformat(),
                "status": job.status.value,
                "description": job.description,
                # Config fields (flattened into job table)
                "sweep_type": job.config.sweep_type,
                "n_agents": job.config.n_agents,
                "maturity_days": job.config.maturity_days,
                "kappas": [str(k) for k in job.config.kappas],
                "concentrations": [str(c) for c in job.config.concentrations],
                "mus": [str(m) for m in job.config.mus],
                "outside_mid_ratios": [str(r) for r in job.config.outside_mid_ratios],
                "seeds": job.config.seeds,
                "cloud": job.config.cloud,
                # Optional fields
                "notes": job.notes,
                "error": job.error,
                "total_runs": len(job.run_ids) if job.run_ids else None,
                "completed_runs": len(job.run_ids) if job.status == JobStatus.COMPLETED else 0,
            }

            # Add completed_at if present
            if job.completed_at:
                data["completed_at"] = job.completed_at.isoformat()

            # Upsert the job (insert or update on conflict)
            self.client.table("jobs").upsert(data, on_conflict="job_id").execute()

            logger.debug(f"Saved job {job.job_id} to Supabase")

        except Exception as e:
            logger.warning(f"Failed to save job to Supabase: {e}")

    def save_event(self, event: JobEvent) -> None:
        """Save a job event to Supabase.

        Args:
            event: The JobEvent instance to save.
        """
        if self.client is None:
            logger.debug("Supabase unavailable, skipping event save")
            return

        try:
            data = {
                "job_id": event.job_id,
                "event_type": event.event_type,
                "timestamp": event.timestamp.isoformat(),
                "details": event.details,
            }

            self.client.table("job_events").insert(data).execute()

            logger.debug(f"Saved event {event.event_type} for job {event.job_id}")

        except Exception as e:
            logger.warning(f"Failed to save event to Supabase: {e}")

    def get_job(self, job_id: str) -> Optional[Job]:
        """Load a job from Supabase by ID.

        Args:
            job_id: The unique job identifier.

        Returns:
            The Job instance if found, None otherwise.
        """
        if self.client is None:
            logger.debug("Supabase unavailable, cannot get job")
            return None

        try:
            response = (
                self.client.table("jobs")
                .select("*")
                .eq("job_id", job_id)
                .single()
                .execute()
            )

            if not response.data:
                return None

            return self._row_to_job(response.data)

        except Exception as e:
            logger.warning(f"Failed to get job from Supabase: {e}")
            return None

    def list_jobs(
        self,
        status: Optional[str] = None,
        limit: int = 100,
    ) -> list[Job]:
        """List jobs from Supabase with optional filtering.

        Args:
            status: Optional status filter (e.g., "running", "completed").
            limit: Maximum number of jobs to return (default 100).

        Returns:
            List of Job instances matching the criteria.
        """
        if self.client is None:
            logger.debug("Supabase unavailable, returning empty list")
            return []

        try:
            query = (
                self.client.table("jobs")
                .select("*")
                .order("created_at", desc=True)
                .limit(limit)
            )

            if status:
                query = query.eq("status", status)

            response = query.execute()

            if not response.data:
                return []

            return [self._row_to_job(row) for row in response.data]

        except Exception as e:
            logger.warning(f"Failed to list jobs from Supabase: {e}")
            return []

    def update_status(
        self,
        job_id: str,
        status: JobStatus,
        completed_at: Optional[datetime] = None,
        error: Optional[str] = None,
    ) -> None:
        """Update the status of a job.

        This is a lightweight update method that only modifies status-related
        fields without requiring a full Job object.

        Args:
            job_id: The job ID to update.
            status: The new status.
            completed_at: Optional completion timestamp.
            error: Optional error message (for failed status).
        """
        if self.client is None:
            logger.debug("Supabase unavailable, skipping status update")
            return

        try:
            data: dict[str, Any] = {"status": status.value}

            if completed_at:
                data["completed_at"] = completed_at.isoformat()

            if error:
                data["error"] = error

            self.client.table("jobs").update(data).eq("job_id", job_id).execute()

            logger.debug(f"Updated job {job_id} status to {status.value}")

        except Exception as e:
            logger.warning(f"Failed to update job status in Supabase: {e}")

    def _row_to_job(self, row: dict[str, Any]) -> Job:
        """Convert a database row to a Job instance.

        Args:
            row: Dictionary containing database row data.

        Returns:
            A Job instance populated from the row data.
        """
        # Parse arrays - Supabase returns them as lists already
        kappas = [Decimal(str(k)) for k in (row.get("kappas") or [])]
        concentrations = [Decimal(str(c)) for c in (row.get("concentrations") or [])]
        mus = [Decimal(str(m)) for m in (row.get("mus") or [])]
        outside_mid_ratios = [
            Decimal(str(r)) for r in (row.get("outside_mid_ratios") or ["1"])
        ]
        seeds = row.get("seeds") or [42]

        # Build JobConfig
        config = JobConfig(
            sweep_type=row["sweep_type"],
            n_agents=row["n_agents"],
            kappas=kappas,
            concentrations=concentrations,
            mus=mus,
            cloud=row.get("cloud", False),
            outside_mid_ratios=outside_mid_ratios,
            maturity_days=row.get("maturity_days", 5),
            seeds=seeds,
        )

        # Parse timestamps
        created_at = datetime.fromisoformat(row["created_at"].replace("Z", "+00:00"))
        completed_at = None
        if row.get("completed_at"):
            completed_at = datetime.fromisoformat(
                row["completed_at"].replace("Z", "+00:00")
            )

        # Build Job (events are loaded separately if needed)
        return Job(
            job_id=row["job_id"],
            created_at=created_at,
            status=JobStatus(row["status"]),
            description=row.get("description") or "",
            config=config,
            run_ids=[],  # Run IDs would need separate query to runs table
            modal_call_ids={},  # Modal call IDs stored per-run, not in jobs table
            completed_at=completed_at,
            error=row.get("error"),
            notes=row.get("notes"),
            events=[],  # Events loaded separately if needed
        )

    def get_events(self, job_id: str) -> list[JobEvent]:
        """Load all events for a job from Supabase.

        Args:
            job_id: The job ID to get events for.

        Returns:
            List of JobEvent instances, ordered by timestamp.
        """
        if self.client is None:
            logger.debug("Supabase unavailable, returning empty events list")
            return []

        try:
            response = (
                self.client.table("job_events")
                .select("*")
                .eq("job_id", job_id)
                .order("timestamp", desc=False)
                .execute()
            )

            if not response.data:
                return []

            events = []
            for row in response.data:
                timestamp = datetime.fromisoformat(
                    row["timestamp"].replace("Z", "+00:00")
                )
                events.append(
                    JobEvent(
                        job_id=row["job_id"],
                        event_type=row["event_type"],
                        timestamp=timestamp,
                        details=row.get("details") or {},
                    )
                )

            return events

        except Exception as e:
            logger.warning(f"Failed to get events from Supabase: {e}")
            return []

```

---

### 📄 src/bilancio/ops/__init__.py

```python

```

---

### 📄 src/bilancio/ops/aliases.py

```python
from __future__ import annotations

from typing import Optional


def get_alias_for_id(system, contract_id: str) -> Optional[str]:
    """Return the alias for a given contract_id, if any."""
    for alias, cid in (system.state.aliases or {}).items():
        if cid == contract_id:
            return alias
    return None


def get_id_for_alias(system, alias: str) -> Optional[str]:
    """Return the contract id for a given alias, if any."""
    return (system.state.aliases or {}).get(alias)


```

---

### 📄 src/bilancio/ops/banking.py

```python
from bilancio.core.atomic_tx import atomic
from bilancio.core.errors import ValidationError
from bilancio.ops.primitives import coalesce_deposits, split


def deposit_cash(system, customer_id: str, bank_id: str, amount: int) -> str:
    if amount <= 0:
        raise ValidationError("amount must be positive")
    # collect payer cash, splitting as needed
    with atomic(system):
        remaining = amount
        cash_ids = [cid for cid in list(system.state.agents[customer_id].asset_ids)
                    if system.state.contracts[cid].kind == "cash"]
        moved_piece_ids = []
        for cid in cash_ids:
            instr = system.state.contracts[cid]
            if instr.amount > remaining:
                cid = split(system, cid, remaining)
                instr = system.state.contracts[cid]
            # move holder to bank (issuer CB unchanged)
            system.state.agents[customer_id].asset_ids.remove(cid)
            system.state.agents[bank_id].asset_ids.append(cid)
            instr.asset_holder_id = bank_id
            moved_piece_ids.append(cid)
            remaining -= instr.amount
            if remaining == 0:
                break
        if remaining != 0:
            raise ValidationError("insufficient cash for deposit")

        # credit/ensure deposit
        dep_id = coalesce_deposits(system, customer_id, bank_id)
        system.state.contracts[dep_id].amount += amount
        system.log("CashDeposited", customer=customer_id, bank=bank_id, amount=amount,
                   cash_piece_ids=moved_piece_ids, deposit_id=dep_id)
        return dep_id

def withdraw_cash(system, customer_id: str, bank_id: str, amount: int) -> str:
    if amount <= 0:
        raise ValidationError("amount must be positive")
    with atomic(system):
        # 1) debit deposit
        dep_ids = system.deposit_ids(customer_id, bank_id)
        if not dep_ids:
            raise ValidationError("no deposit at this bank")
        remaining = amount
        for dep_id in dep_ids:
            dep = system.state.contracts[dep_id]
            take = min(dep.amount, remaining)
            dep.amount -= take
            remaining -= take
            if dep.amount == 0 and take > 0:
                # remove empty instrument
                holder = system.state.agents[customer_id]
                issuer = system.state.agents[bank_id]
                holder.asset_ids.remove(dep_id)
                issuer.liability_ids.remove(dep_id)
                del system.state.contracts[dep_id]
            if remaining == 0:
                break
        if remaining != 0:
            raise ValidationError("insufficient deposit balance")

        # 2) move cash from bank vault → customer (require sufficient cash on hand)
        bank_cash_ids = [cid for cid in list(system.state.agents[bank_id].asset_ids)
                         if system.state.contracts[cid].kind == "cash"]
        remaining = amount
        moved_piece_ids = []
        for cid in bank_cash_ids:
            instr = system.state.contracts[cid]
            if instr.amount > remaining:
                cid = split(system, cid, remaining)
                instr = system.state.contracts[cid]
            system.state.agents[bank_id].asset_ids.remove(cid)
            system.state.agents[customer_id].asset_ids.append(cid)
            instr.asset_holder_id = customer_id
            moved_piece_ids.append(cid)
            remaining -= instr.amount
            if remaining == 0:
                break
        if remaining != 0:
            raise ValidationError("bank has insufficient cash on hand (MVP: no auto conversion from reserves)")

        system.log("CashWithdrawn", customer=customer_id, bank=bank_id, amount=amount, cash_piece_ids=moved_piece_ids)
        # 3) coalesce customer cash if you want tidy balances (optional)
        return "ok"

def client_payment(system, payer_id: str, payer_bank: str, payee_id: str, payee_bank: str,
                   amount: int, allow_cash_fallback: bool=False) -> str:
    if amount <= 0:
        raise ValidationError("amount must be positive")
    with atomic(system):
        # 1) debit payer's deposit at payer_bank
        dep_ids = system.deposit_ids(payer_id, payer_bank)
        remaining = amount
        deposit_paid = 0
        for dep_id in dep_ids:
            dep = system.state.contracts[dep_id]
            take = min(dep.amount, remaining)
            dep.amount -= take
            remaining -= take
            deposit_paid += take
            if dep.amount == 0 and take > 0:
                holder = system.state.agents[payer_id]
                issuer = system.state.agents[payer_bank]
                holder.asset_ids.remove(dep_id)
                issuer.liability_ids.remove(dep_id)
                del system.state.contracts[dep_id]
            if remaining == 0:
                break

        # Optional fallback: use payer's cash for the remainder (real-world "pay cash")
        cash_paid = 0
        if remaining and allow_cash_fallback:
            cash_ids = [cid for cid in list(system.state.agents[payer_id].asset_ids)
                        if system.state.contracts[cid].kind == "cash"]
            for cid in cash_ids:
                instr = system.state.contracts[cid]
                if instr.amount > remaining:
                    cid = split(system, cid, remaining)
                    instr = system.state.contracts[cid]
                # move payer cash → payee (physical cash handover)
                system.state.agents[payer_id].asset_ids.remove(cid)
                system.state.agents[payee_id].asset_ids.append(cid)
                instr.asset_holder_id = payee_id
                cash_paid += instr.amount
                remaining -= instr.amount
                if remaining == 0:
                    break

        if remaining != 0:
            raise ValidationError("insufficient funds for payment")

        # 2) credit payee's deposit at payee_bank (only the deposit portion, not cash)
        dep_rx = coalesce_deposits(system, payee_id, payee_bank)
        system.state.contracts[dep_rx].amount += deposit_paid

        # 3) Log payment events with proper classification
        if deposit_paid > 0:
            if payer_bank == payee_bank:
                # Intra-bank payment (same bank)
                system.log("IntraBankPayment", 
                          payer=payer_id, 
                          payee=payee_id, 
                          bank=payer_bank, 
                          amount=deposit_paid)
            else:
                # Inter-bank payment (cross-bank, will need clearing)
                system.log("ClientPayment", 
                          payer=payer_id, 
                          payer_bank=payer_bank,
                          payee=payee_id, 
                          payee_bank=payee_bank, 
                          amount=deposit_paid)
        
        if cash_paid > 0:
            # Cash payment was used as fallback
            system.log("CashPayment",
                      payer=payer_id,
                      payee=payee_id,
                      amount=cash_paid)

        return dep_rx

```

---

### 📄 src/bilancio/ops/cashflows.py

```python
"""Cash flow operations and data structures."""

from dataclasses import dataclass
from datetime import datetime
from decimal import Decimal

# Placeholder types - these should be replaced with actual implementations from the domain layer
Money = Decimal  # Placeholder for Money type
TimeCoordinate = datetime  # Placeholder for TimeCoordinate type
Agent = str  # Placeholder for Agent type


@dataclass
class CashFlow:
    """Represents a single cash flow between two agents."""

    amount: Money
    time: TimeCoordinate
    payer: Agent
    payee: Agent


class CashFlowStream:
    """Manages a collection of cash flows with basic operations."""

    def __init__(self, flows: list[CashFlow] = None):
        """Initialize with an optional list of cash flows."""
        self.flows = flows or []

    def add_flow(self, flow: CashFlow) -> None:
        """Add a cash flow to the stream."""
        self.flows.append(flow)

    def get_flows_at_time(self, time: TimeCoordinate) -> list[CashFlow]:
        """Get all cash flows occurring at a specific time."""
        return [flow for flow in self.flows if flow.time == time]

    def get_all_flows(self) -> list[CashFlow]:
        """Get all cash flows in the stream."""
        return self.flows.copy()

    def __len__(self) -> int:
        """Return the number of flows in the stream."""
        return len(self.flows)

```

---

### 📄 src/bilancio/ops/primitives.py

```python

from bilancio.core.errors import ValidationError
from bilancio.core.ids import new_id
from bilancio.domain.instruments.base import Instrument


def fungible_key(instr: Instrument) -> tuple:
    # Same type, denomination, issuer, holder → can merge
    return (instr.kind, instr.denom, instr.liability_issuer_id, instr.asset_holder_id)

def is_divisible(instr: Instrument) -> bool:
    # Cash and bank deposits are divisible
    if instr.kind in ("cash", "bank_deposit", "reserve_deposit"):
        return True
    return False

def split(system, instr_id: str, amount: int) -> str:
    instr = system.state.contracts[instr_id]
    if amount <= 0 or amount > instr.amount:
        raise ValidationError("invalid split amount")
    if not is_divisible(instr):
        raise ValidationError("instrument is not divisible")
    # reduce original
    instr.amount -= amount
    # create twin
    twin_id = new_id("C")
    twin = type(instr)(
        id=twin_id,
        kind=instr.kind,
        amount=amount,
        denom=instr.denom,
        asset_holder_id=instr.asset_holder_id,
        liability_issuer_id=instr.liability_issuer_id,
        **{k: getattr(instr, k) for k in ("due_day",) if hasattr(instr, k)}
    )
    system.add_contract(twin)  # attaches to holder/issuer lists too
    return twin_id

def merge(system, a_id: str, b_id: str) -> str:
    if a_id == b_id:
        return a_id
    a = system.state.contracts[a_id]
    b = system.state.contracts[b_id]
    if fungible_key(a) != fungible_key(b):
        raise ValidationError("instruments are not fungible-compatible")
    a.amount += b.amount
    # detach b from registries
    holder = system.state.agents[b.asset_holder_id]
    issuer = system.state.agents[b.liability_issuer_id]
    holder.asset_ids.remove(b_id)
    issuer.liability_ids.remove(b_id)
    del system.state.contracts[b_id]
    system.log("InstrumentMerged", keep=a_id, removed=b_id)
    return a_id

def consume(system, instr_id: str, amount: int) -> None:
    instr = system.state.contracts[instr_id]
    if amount <= 0 or amount > instr.amount:
        raise ValidationError("invalid consume amount")
    instr.amount -= amount
    if instr.amount == 0:
        holder = system.state.agents[instr.asset_holder_id]
        issuer = system.state.agents[instr.liability_issuer_id]
        holder.asset_ids.remove(instr_id)
        issuer.liability_ids.remove(instr_id)
        del system.state.contracts[instr_id]

def coalesce_deposits(system, customer_id: str, bank_id: str) -> str:
    """Coalesce all deposits for a customer at a bank into a single instrument"""
    ids = system.deposit_ids(customer_id, bank_id)
    if not ids:
        # create a zero-balance deposit instrument
        from bilancio.domain.instruments.means_of_payment import BankDeposit
        dep_id = system.new_contract_id("D")
        dep = BankDeposit(
            id=dep_id, kind="bank_deposit", amount=0, denom="X",
            asset_holder_id=customer_id, liability_issuer_id=bank_id
        )
        system.add_contract(dep)
        return dep_id
    # merge all into the first
    keep = ids[0]
    for other in ids[1:]:
        merge(system, keep, other)
    return keep

```

---

### 📄 src/bilancio/ops/primitives_stock.py

```python
"""Stock operations primitives - separate from financial instrument operations."""

from decimal import Decimal
from typing import TYPE_CHECKING

from bilancio.core.errors import ValidationError
from bilancio.core.ids import InstrId, new_id
from bilancio.domain.goods import StockLot

if TYPE_CHECKING:
    from bilancio.engines.system import System


def stock_fungible_key(lot: StockLot) -> tuple:
    """Return fungible key for stock lots. Include price so lots with different valuation don't merge."""
    return (lot.kind, lot.sku, lot.owner_id, lot.unit_price)


def split_stock(system: 'System', stock_id: InstrId, quantity: int) -> InstrId:
    """Split a stock lot into two pieces. Returns ID of the new split piece."""
    stock = system.state.stocks[stock_id]
    
    if not stock.divisible:
        raise ValidationError("Stock lot is not divisible")
    if quantity <= 0 or quantity >= stock.quantity:
        raise ValidationError("Invalid split quantity")
    
    # Create new stock lot with split quantity
    new_id_val = new_id("S")
    new_stock = StockLot(
        id=new_id_val,
        kind="stock_lot",
        sku=stock.sku,
        quantity=quantity,
        unit_price=stock.unit_price,
        owner_id=stock.owner_id,
        divisible=stock.divisible
    )
    
    # Update original stock quantity
    stock.quantity -= quantity
    
    # Register new stock
    system.state.stocks[new_id_val] = new_stock
    system.state.agents[stock.owner_id].stock_ids.append(new_id_val)
    
    system.log("StockSplit", 
              original_id=stock_id, 
              new_id=new_id_val, 
              sku=stock.sku,
              original_qty=stock.quantity + quantity,
              split_qty=quantity,
              remaining_qty=stock.quantity)
    
    return new_id_val


def merge_stock(system: 'System', keep_id: InstrId, remove_id: InstrId) -> InstrId:
    """Merge two stock lots. Returns the ID of the kept lot."""
    keep_stock = system.state.stocks[keep_id]
    remove_stock = system.state.stocks[remove_id]
    
    # Check if stocks are fungible
    if stock_fungible_key(keep_stock) != stock_fungible_key(remove_stock):
        raise ValidationError("Stock lots are not fungible - cannot merge")
    
    # Merge quantities
    original_qty = keep_stock.quantity
    keep_stock.quantity += remove_stock.quantity
    
    # Remove the merged stock
    del system.state.stocks[remove_id]
    system.state.agents[remove_stock.owner_id].stock_ids.remove(remove_id)
    
    system.log("StockMerged",
              keep_id=keep_id,
              remove_id=remove_id,
              sku=keep_stock.sku,
              final_qty=keep_stock.quantity,
              keep_qty=original_qty,
              merged_qty=remove_stock.quantity)
    
    return keep_id


def consume_stock(system: 'System', stock_id: InstrId, quantity: int) -> None:
    """Consume (destroy) a portion of stock. For future use if needed."""
    stock = system.state.stocks[stock_id]
    
    if quantity <= 0 or quantity > stock.quantity:
        raise ValidationError("Invalid consumption quantity")
    
    if quantity == stock.quantity:
        # Complete consumption - remove the stock
        del system.state.stocks[stock_id]
        system.state.agents[stock.owner_id].stock_ids.remove(stock_id)
        system.log("StockConsumed", stock_id=stock_id, sku=stock.sku, qty=quantity, complete=True)
    else:
        # Partial consumption
        stock.quantity -= quantity
        system.log("StockConsumed", stock_id=stock_id, sku=stock.sku, qty=quantity, remaining=stock.quantity, complete=False)
```

---

### 📄 src/bilancio/runners/__init__.py

```python
"""Runner abstractions for simulation execution."""

from .protocols import SimulationExecutor, JobExecutor
from .local_executor import LocalExecutor
from .cloud_executor import CloudExecutor
from .models import RunOptions, ExecutionResult

__all__ = [
    "SimulationExecutor",
    "JobExecutor",
    "LocalExecutor",
    "CloudExecutor",
    "RunOptions",
    "ExecutionResult",
]

```

---

### 📄 src/bilancio/runners/cloud_executor.py

```python
"""Cloud executor using Modal for remote simulation execution."""

from __future__ import annotations

import itertools
import subprocess
from pathlib import Path
from typing import Any, Callable, Dict, List, Optional, Tuple

from bilancio.runners.models import ExecutionResult, RunOptions
from bilancio.storage.models import RunStatus


class CloudExecutor:
    """Execute simulations on Modal cloud infrastructure.

    Results are stored on a Modal Volume and optionally downloaded to local disk
    after execution completes.

    This executor implements the SimulationExecutor protocol from
    bilancio.runners.protocols.

    Example:
        executor = CloudExecutor(experiment_id="my_sweep", job_id="castle-river-forest-mountain")
        result = executor.execute(
            scenario_config=scenario,
            run_id="run_001",
            output_dir=Path("./output"),
            options=RunOptions(max_days=30),
        )
    """

    def __init__(
        self,
        experiment_id: str,
        download_artifacts: bool = True,
        local_output_dir: Optional[Path] = None,
        volume_name: str = "bilancio-results",
        job_id: str = "",
    ):
        """Initialize cloud executor.

        Args:
            experiment_id: Identifier for this experiment (groups runs together).
            download_artifacts: Whether to download results to local disk after execution.
            local_output_dir: Where to download artifacts. Defaults to
                out/experiments/{experiment_id}.
            volume_name: Name of the Modal Volume for result storage. Note: This must
                match the volume name hardcoded in modal_app.py ("bilancio-results").
            job_id: Bilancio job ID for tracking (displayed in Modal logs).
        """
        self.experiment_id = experiment_id
        self.download_artifacts = download_artifacts
        self.local_output_dir = local_output_dir or Path(
            f"out/experiments/{experiment_id}"
        )
        self.volume_name = volume_name
        self.app_name = "bilancio-simulations"
        self.job_id = job_id

        # Lazy reference to deployed function
        self._run_simulation = None

    def _get_run_simulation(self):
        """Get reference to the deployed Modal function.

        Uses Function.from_name() to reference the deployed function,
        which allows calling it from outside the Modal app context.
        """
        if self._run_simulation is None:
            import modal

            self._run_simulation = modal.Function.from_name(
                self.app_name, "run_simulation"
            )
        return self._run_simulation

    def execute(
        self,
        scenario_config: Dict[str, Any],
        run_id: str,
        output_dir: Path,
        options: RunOptions,
    ) -> ExecutionResult:
        """Execute simulation on Modal cloud.

        Args:
            scenario_config: Full scenario configuration dict.
            run_id: Unique run identifier.
            output_dir: Local directory for results (used if download_artifacts=True).
            options: Simulation run options.

        Returns:
            ExecutionResult with status and artifact references.
        """
        run_simulation = self._get_run_simulation()

        # Convert options to dict for serialization
        options_dict = self._options_to_dict(options)

        # Execute remotely (blocks until complete)
        result = run_simulation.remote(
            scenario_config=scenario_config,
            run_id=run_id,
            experiment_id=self.experiment_id,
            options=options_dict,
            job_id=self.job_id,
        )

        # Download artifacts if requested and determine storage location
        if self.download_artifacts and result["status"] == "completed":
            self._download_run_artifacts(run_id, output_dir, result["artifacts"])
            # When downloading, the storage_base should be the local path
            storage_type = "local"
            storage_base = str(output_dir.resolve())
        else:
            # When not downloading, keep the modal_volume reference
            storage_type = result["storage_type"]
            storage_base = result["storage_base"]

        return ExecutionResult(
            run_id=result["run_id"],
            status=(
                RunStatus.COMPLETED
                if result["status"] == "completed"
                else RunStatus.FAILED
            ),
            storage_type=storage_type,
            storage_base=storage_base,
            artifacts=result["artifacts"],
            error=result.get("error"),
            execution_time_ms=result.get("execution_time_ms"),
            modal_call_id=result.get("modal_call_id"),
        )

    def execute_batch(
        self,
        runs: List[Tuple[Dict[str, Any], str, RunOptions]],
        max_parallel: int = 50,
        progress_callback: Optional[Callable[[int, int], None]] = None,
    ) -> List[ExecutionResult]:
        """Execute multiple simulations in parallel on Modal.

        Modal handles parallelization automatically. This method provides
        a convenient interface for batch execution.

        Args:
            runs: List of (scenario_config, run_id, options) tuples.
            max_parallel: Maximum concurrent Modal function calls (unused,
                Modal handles this internally).
            progress_callback: Called with (completed, total) after each completion.

        Returns:
            List of ExecutionResult in same order as input.
        """
        run_simulation = self._get_run_simulation()

        total = len(runs)
        results: List[Optional[ExecutionResult]] = [None] * total

        run_id_to_index = {run_id: idx for idx, (_, run_id, _) in enumerate(runs)}
        configs = [config for config, _, _ in runs]
        run_ids = [run_id for _, run_id, _ in runs]
        options_dicts = [self._options_to_dict(options) for _, _, options in runs]

        # Collect results as they complete (unordered) so progress doesn't stall
        completed = 0
        for result in run_simulation.map(
            configs,
            run_ids,
            itertools.repeat(self.experiment_id),
            options_dicts,
            itertools.repeat(self.job_id),
            order_outputs=False,
        ):
            run_id = result["run_id"]
            idx = run_id_to_index[run_id]

            # Download artifacts if requested and determine storage location
            if self.download_artifacts and result["status"] == "completed":
                output_dir = self.local_output_dir / "runs" / run_id
                self._download_run_artifacts(run_id, output_dir, result["artifacts"])
                # When downloading, the storage_base should be the local path
                storage_type = "local"
                storage_base = str(output_dir.resolve())
            else:
                # When not downloading, keep the modal_volume reference
                storage_type = result["storage_type"]
                storage_base = result["storage_base"]

            results[idx] = ExecutionResult(
                run_id=result["run_id"],
                status=(
                    RunStatus.COMPLETED
                    if result["status"] == "completed"
                    else RunStatus.FAILED
                ),
                storage_type=storage_type,
                storage_base=storage_base,
                artifacts=result["artifacts"],
                error=result.get("error"),
                execution_time_ms=result.get("execution_time_ms"),
                modal_call_id=result.get("modal_call_id"),
            )

            completed += 1
            if progress_callback:
                progress_callback(completed, total)

        return results  # type: ignore

    def _options_to_dict(self, options: RunOptions) -> Dict[str, Any]:
        """Convert RunOptions to serializable dict."""
        return {
            "mode": options.mode,
            "max_days": options.max_days,
            "quiet_days": options.quiet_days,
            "check_invariants": options.check_invariants,
            "default_handling": options.default_handling,
            "show_events": options.show_events,
            "t_account": options.t_account,
            "detailed_dealer_logging": options.detailed_dealer_logging,
            "regime": options.regime or "",
        }

    def _download_run_artifacts(
        self,
        run_id: str,
        output_dir: Path,
        artifacts: Dict[str, str],
    ) -> None:
        """Download artifacts from Modal Volume to local disk.

        Args:
            run_id: The run identifier.
            output_dir: Local directory to download to.
            artifacts: Dict mapping artifact names to relative paths.
        """
        output_dir.mkdir(parents=True, exist_ok=True)
        out_subdir = output_dir / "out"
        out_subdir.mkdir(exist_ok=True)

        remote_base = f"{self.experiment_id}/runs/{run_id}"

        for artifact_name, artifact_path in artifacts.items():
            remote_path = f"{remote_base}/{artifact_path}"
            local_path = output_dir / artifact_path

            # Ensure parent directory exists
            local_path.parent.mkdir(parents=True, exist_ok=True)

            # Use Modal CLI to download
            try:
                subprocess.run(
                    [
                        "modal",
                        "volume",
                        "get",
                        self.volume_name,
                        remote_path,
                        str(local_path),
                        "--force",  # Overwrite existing files
                    ],
                    check=True,
                    capture_output=True,
                )
            except subprocess.CalledProcessError as e:
                # Log but don't fail - artifact might be optional
                print(
                    f"Warning: Failed to download {artifact_name}: {e.stderr.decode()}"
                )

```

---

### 📄 src/bilancio/runners/local_executor.py

```python
"""Local synchronous simulation executor."""

from __future__ import annotations

import time
from pathlib import Path
from typing import Dict, Any

import yaml

from bilancio.runners.models import RunOptions, ExecutionResult
from bilancio.storage.models import RunStatus


class LocalExecutor:
    """Execute simulations locally and synchronously.

    This executor only runs the simulation and returns artifact locations.
    It does NOT compute metrics - that's MetricsComputer's job.

    The executor:
    1. Writes the scenario YAML to the run directory
    2. Calls run_scenario() with appropriate parameters
    3. Returns an ExecutionResult with artifact paths (relative to storage_base)
    """

    def execute(
        self,
        scenario_config: Dict[str, Any],
        run_id: str,
        output_dir: Path,
        options: RunOptions,
    ) -> ExecutionResult:
        """Execute simulation, return result with artifact paths.

        Args:
            scenario_config: Complete scenario configuration dict
            run_id: Unique identifier for this run
            output_dir: Directory for output files (must be provided)
            options: RunOptions with simulation parameters

        Returns:
            ExecutionResult with storage location and relative artifact paths
        """
        # Import here to avoid circular imports at module load time
        from bilancio.ui.run import run_scenario

        start_time = time.time()

        # Ensure output directory exists
        output_dir.mkdir(parents=True, exist_ok=True)

        # Write scenario YAML
        scenario_path = output_dir / "scenario.yaml"
        scenario_path.write_text(yaml.dump(scenario_config, default_flow_style=False))

        # Set up export paths
        exports_dir = output_dir / "out"
        exports_dir.mkdir(exist_ok=True)

        balances_path = exports_dir / "balances.csv"
        events_path = exports_dir / "events.jsonl"
        run_html_path = output_dir / "run.html"

        try:
            # Run simulation
            run_scenario(
                path=scenario_path,
                mode=options.mode,
                max_days=options.max_days,
                quiet_days=options.quiet_days,
                show=options.show_events,
                agent_ids=options.show_balances,
                check_invariants=options.check_invariants,
                export={
                    "balances_csv": str(balances_path),
                    "events_jsonl": str(events_path),
                },
                html_output=run_html_path,
                t_account=options.t_account,
                default_handling=options.default_handling,
                detailed_dealer_logging=options.detailed_dealer_logging,
                run_id=options.run_id or run_id,
                regime=options.regime or "",
            )

            execution_time_ms = int((time.time() - start_time) * 1000)

            # Build artifact paths (relative to output_dir)
            artifacts: Dict[str, str] = {
                "scenario_yaml": "scenario.yaml",
            }
            if events_path.exists():
                artifacts["events_jsonl"] = "out/events.jsonl"
            if balances_path.exists():
                artifacts["balances_csv"] = "out/balances.csv"
            if run_html_path.exists():
                artifacts["run_html"] = "run.html"

            return ExecutionResult(
                run_id=run_id,
                status=RunStatus.COMPLETED,
                storage_type="local",
                storage_base=str(output_dir.resolve()),
                artifacts=artifacts,
                execution_time_ms=execution_time_ms,
            )

        except Exception as e:
            execution_time_ms = int((time.time() - start_time) * 1000)

            # Still record what artifacts exist
            artifacts: Dict[str, str] = {}
            if scenario_path.exists():
                artifacts["scenario_yaml"] = "scenario.yaml"

            return ExecutionResult(
                run_id=run_id,
                status=RunStatus.FAILED,
                storage_type="local",
                storage_base=str(output_dir.resolve()),
                artifacts=artifacts,
                error=str(e),
                execution_time_ms=execution_time_ms,
            )

```

---

### 📄 src/bilancio/runners/models.py

```python
"""Data models for the runner abstraction layer."""

from __future__ import annotations

from dataclasses import dataclass, field
from typing import Dict, List, Optional

from bilancio.storage.models import RunStatus


@dataclass
class RunOptions:
    """Options passed to run_scenario().

    These options configure how the simulation is executed and what
    outputs are generated. The executor passes these through to the
    underlying simulation engine.

    Attributes:
        mode: Execution mode - "until_stable", "fixed_days", or "continuous".
        max_days: Maximum number of simulation days to run.
        quiet_days: Number of consecutive quiet days before stopping
            (for "until_stable" mode).
        check_invariants: When to check balance sheet invariants -
            "daily", "end", or "never".
        default_handling: How to handle defaults - "fail-fast" or "continue".
        show_events: Event display level for HTML report -
            "detailed", "summary", or "none".
        show_balances: List of agent names to show balances for in HTML report.
            If None, shows all agents.
        t_account: Whether to use T-account format in balance display.
        detailed_dealer_logging: Enable detailed logging for dealer simulations.
        run_id: Optional run identifier. If not provided, one will be generated.
        regime: Optional regime identifier for parameter sweeps.
    """

    mode: str = "until_stable"
    max_days: int = 90
    quiet_days: int = 2
    check_invariants: str = "daily"
    default_handling: str = "fail-fast"

    # Display options (for HTML report)
    show_events: str = "detailed"
    show_balances: Optional[List[str]] = None
    t_account: bool = False

    # Dealer options
    detailed_dealer_logging: bool = False
    run_id: Optional[str] = None
    regime: Optional[str] = None


@dataclass
class ExecutionResult:
    """Result of simulation execution.

    Returned by the executor after a simulation run completes (or fails).
    Contains references to where artifacts are stored rather than the
    artifacts themselves.

    Attributes:
        run_id: Unique identifier for this run.
        status: Final status of the run (COMPLETED, FAILED, etc.).
        storage_type: Type of storage backend - "local", "s3", "gcs".
        storage_base: Base path/URI for artifacts - e.g., "/path/to/run"
            or "s3://bucket/prefix".
        artifacts: Mapping of artifact type to relative path within storage_base.
            Keys are artifact names like "events_jsonl", "balances_csv", etc.
        error: Error message if the run failed.
        execution_time_ms: Execution time in milliseconds.
        modal_call_id: Modal function call ID (for cloud execution debugging).
    """

    run_id: str
    status: RunStatus

    # Storage location
    storage_type: str  # "local", "s3", "gcs"
    storage_base: str  # "/path/to/run" or "s3://bucket/prefix"

    # Artifact references (relative to storage_base)
    artifacts: Dict[str, str] = field(default_factory=dict)

    # Error info if failed
    error: Optional[str] = None
    execution_time_ms: Optional[int] = None

    # Cloud execution info
    modal_call_id: Optional[str] = None

```

---

### 📄 src/bilancio/runners/protocols.py

```python
"""Protocol definitions for simulation executors."""

from __future__ import annotations

from pathlib import Path
from typing import Protocol, Optional, Dict, Any, runtime_checkable

from bilancio.runners.models import RunOptions, ExecutionResult
from bilancio.storage.models import RunStatus, RunResult


@runtime_checkable
class SimulationExecutor(Protocol):
    """Protocol for synchronous simulation execution.

    The executor only runs the simulation and returns where artifacts
    are stored. It does NOT compute metrics - that's MetricsComputer's job.
    """

    def execute(
        self,
        scenario_config: Dict[str, Any],
        run_id: str,
        output_dir: Path,
        options: RunOptions,
    ) -> ExecutionResult:
        """Execute a simulation, return result with artifact paths.

        Args:
            scenario_config: Complete scenario configuration dict
            run_id: Unique identifier for this run
            output_dir: Directory for output files
            options: RunOptions with simulation parameters

        Returns:
            ExecutionResult with storage location and relative artifact paths
        """
        ...


@runtime_checkable
class JobExecutor(Protocol):
    """Protocol for async/distributed job execution (future use)."""

    def submit(self, scenario_config: Dict[str, Any], run_id: str) -> str:
        """Submit job, return job_id."""
        ...

    def status(self, job_id: str) -> RunStatus:
        """Check job status."""
        ...

    def result(self, job_id: str) -> Optional[RunResult]:
        """Get result if completed."""
        ...

    def cancel(self, job_id: str) -> bool:
        """Cancel a pending/running job."""
        ...

```

---

### 📄 src/bilancio/scenarios/__init__.py

```python
"""Scenario generation utilities."""

from __future__ import annotations

from pathlib import Path
from typing import Any, Dict, Optional

from bilancio.config.models import (
    GeneratorConfig,
    RingExplorerGeneratorConfig,
)

from .ring_explorer import (
    compile_ring_explorer,
    compile_ring_explorer_balanced,
)


def compile_generator(
    config: GeneratorConfig,
    *,
    source_path: Optional[Path] = None,
) -> Dict[str, Any]:
    """Compile a generator specification into a scenario dictionary."""
    if isinstance(config, RingExplorerGeneratorConfig):
        return compile_ring_explorer(config, source_path=source_path)
    raise ValueError(f"Unsupported generator '{getattr(config, 'generator', 'unknown')}'")


__all__ = [
    "compile_generator",
    "compile_ring_explorer",
    "compile_ring_explorer_balanced",
]

```

---

### 📄 src/bilancio/scenarios/ring_explorer.py

```python
"""Ring explorer scenario generator."""

from __future__ import annotations

import random
import re
from dataclasses import dataclass
from decimal import Decimal, getcontext
from pathlib import Path
from typing import Any, Dict, List, Optional

import yaml

from bilancio.config.models import (
    RingExplorerGeneratorConfig,
    RingExplorerParamsModel,
)

# Ensure ample precision for Decimal arithmetic when scaling Dirichlet weights
getcontext().prec = 28


@dataclass
class LiquiditySpec:
    total: Decimal
    mode: str
    agent: Optional[str]
    vector: Optional[List[Decimal]]


@dataclass
class InequalitySpec:
    concentration: Decimal
    monotonicity: Decimal


@dataclass
class MaturitySpec:
    days: int
    mode: str
    mu: Decimal


@dataclass
class RingExplorerParams:
    n_agents: int
    seed: int
    kappa: Decimal
    Q_total: Decimal
    liquidity: LiquiditySpec
    inequality: InequalitySpec
    maturity: MaturitySpec
    currency: str
    policy_overrides: Optional[Dict[str, Any]]

    @classmethod
    def from_model(cls, model: RingExplorerParamsModel) -> "RingExplorerParams":
        Q_total = model.Q_total
        liquidity_total = model.liquidity.total

        if Q_total is None and liquidity_total is None:
            raise ValueError("Either params.Q_total or params.liquidity.total must be provided")

        if liquidity_total is None and Q_total is not None:
            liquidity_total = (Q_total / model.kappa)
        elif Q_total is None and liquidity_total is not None:
            Q_total = (model.kappa * liquidity_total)

        if Q_total is None or liquidity_total is None:
            raise ValueError("Failed to resolve Q_total and liquidity total from parameters")

        if liquidity_total <= 0 or Q_total <= 0:
            raise ValueError("Derived Q_total and liquidity must be positive")

        liquidity_spec = LiquiditySpec(
            total=liquidity_total,
            mode=model.liquidity.allocation.mode,
            agent=model.liquidity.allocation.agent,
            vector=[Decimal(str(v)) for v in (model.liquidity.allocation.vector or [])] or None,
        )
        inequality_spec = InequalitySpec(
            concentration=model.inequality.concentration,
            monotonicity=model.inequality.monotonicity,
        )
        maturity_spec = MaturitySpec(
            days=model.maturity.days,
            mode=model.maturity.mode,
            mu=model.maturity.mu,
        )

        policy_overrides = None
        if model.policy_overrides is not None:
            policy_overrides = model.policy_overrides.model_dump(exclude_none=True)

        return cls(
            n_agents=model.n_agents,
            seed=model.seed,
            kappa=model.kappa,
            Q_total=Q_total,
            liquidity=liquidity_spec,
            inequality=inequality_spec,
            maturity=maturity_spec,
            currency=model.currency,
            policy_overrides=policy_overrides,
        )


def compile_ring_explorer(
    config: RingExplorerGeneratorConfig,
    *,
    source_path: Optional[Path] = None,
) -> Dict[str, Any]:
    params = RingExplorerParams.from_model(config.params)

    payable_amounts = _draw_payables(
        params.n_agents,
        params.inequality.concentration,
        params.inequality.monotonicity,
        params.Q_total,
        params.seed,
    )
    liquidity_amounts = _allocate_liquidity(params)
    due_days = _build_due_days(params.n_agents, params.maturity.days, params.maturity.mu)

    agents = _build_agents(params.n_agents)
    initial_actions = []

    # Seed cash liquidity per allocation plan
    for idx, amount in enumerate(liquidity_amounts):
        if amount <= 0:
            continue
        agent_id = f"H{idx + 1}"
        initial_actions.append({
            "mint_cash": {
                "to": agent_id,
                "amount": amount,
                "alias": f"LIQ_{agent_id}",
            }
        })

    # Create ring payables
    for idx, amount in enumerate(payable_amounts):
        from_agent = f"H{idx + 1}"
        to_agent = f"H{(idx + 1) % params.n_agents + 1}"
        due_day = due_days[idx]
        initial_actions.append({
            "create_payable": {
                "from": from_agent,
                "to": to_agent,
                "amount": amount,
                "due_day": due_day,
                "alias": f"P_{from_agent}_{to_agent}",
            }
        })

    scenario_name = _render_scenario_name(config.name_prefix, params)
    description = _render_description(params)

    scenario: Dict[str, Any] = {
        "version": 1,
        "name": scenario_name,
        "description": description,
        "policy_overrides": params.policy_overrides,
        "agents": agents,
        "initial_actions": initial_actions,
        "scheduled_actions": [],
        "run": {
            "mode": "until_stable",
            "max_days": max(30, params.maturity.days + 5),
            "quiet_days": 2,
            "show": {
                "balances": [agent["id"] for agent in agents if agent["id"].startswith("H")],
                "events": "detailed",
            },
            "export": {
                "balances_csv": "out/balances.csv",
                "events_jsonl": "out/events.jsonl",
            },
        },
    }

    if config.compile.emit_yaml:
        _emit_yaml(
            scenario,
            config,
            source_path=source_path,
        )

    return scenario


def compile_ring_explorer_balanced(
    config: RingExplorerGeneratorConfig,
    face_value: Decimal = Decimal("20"),
    outside_mid_ratio: Decimal = Decimal("0.75"),
    big_entity_share: Decimal = Decimal("0.25"),  # DEPRECATED
    vbt_share_per_bucket: Decimal = Decimal("0.25"),
    dealer_share_per_bucket: Decimal = Decimal("0.125"),
    mode: str = "active",
    rollover_enabled: bool = True,
    *,
    source_path: Optional[Path] = None,
) -> Dict[str, Any]:
    """
    Generate a ring scenario with balanced VBT and Dealer entities per maturity bucket.

    Per PDF specification (Plan 024):
    - VBT-like passive holder: 25% of total claims per maturity bucket + equal cash
    - Dealer-like passive holder: 12.5% of total claims per maturity bucket + equal cash
    - Traders keep remaining 62.5% of claims

    The scenario creates:
    1. N traders in a ring structure with payables
    2. For each maturity bucket (short/mid/long):
       - VBT agent with vbt_share_per_bucket (25%) of that bucket's claims + matching cash
       - Dealer agent with dealer_share_per_bucket (12.5%) of that bucket's claims + matching cash
    3. Traders receive additional cash to fund their obligations to VBT/Dealer

    Args:
        config: Base ring explorer configuration
        face_value: Face value S (cashflow at maturity), default 20
        outside_mid_ratio: M/S ratio (0.5 to 1.0), default 0.75
        big_entity_share: DEPRECATED - use vbt_share_per_bucket and dealer_share_per_bucket
        vbt_share_per_bucket: VBT holds 25% of claims per maturity bucket
        dealer_share_per_bucket: Dealer holds 12.5% of claims per maturity bucket
        mode: "passive" (mimics) or "active" (dealers)
        rollover_enabled: Whether to enable continuous rollover of matured claims
        source_path: Optional path for YAML output

    Returns:
        Complete scenario dictionary with balanced VBT/Dealer per bucket
    """
    params = RingExplorerParams.from_model(config.params)

    # Define maturity buckets (matching dealer module defaults)
    BUCKET_BOUNDS = {
        "short": (1, 3),    # days 1-3
        "mid": (4, 8),      # days 4-8
        "long": (9, 999),   # days 9+
    }
    BUCKETS = ["short", "mid", "long"]

    # Total share going to big entities per bucket
    big_share = vbt_share_per_bucket + dealer_share_per_bucket  # 0.375 total

    # Get base payable amounts
    base_payable_amounts = _draw_payables(
        params.n_agents,
        params.inequality.concentration,
        params.inequality.monotonicity,
        params.Q_total,
        params.seed,
    )

    # Get due days for the ring
    due_days = _build_due_days(params.n_agents, params.maturity.days, params.maturity.mu)

    # Assign each payable to a maturity bucket
    def _get_bucket(due_day: int) -> str:
        for bucket, (lo, hi) in BUCKET_BOUNDS.items():
            if lo <= due_day <= hi:
                return bucket
        return "long"  # Default to long for very long maturities

    payable_buckets = [_get_bucket(d) for d in due_days]

    # Calculate total face value per bucket (from trader-to-trader ring)
    bucket_totals = {b: Decimal("0") for b in BUCKETS}
    for idx, amount in enumerate(base_payable_amounts):
        bucket = payable_buckets[idx]
        bucket_totals[bucket] += amount

    # Calculate big entity holdings per bucket
    # VBT gets vbt_share_per_bucket of each bucket, Dealer gets dealer_share_per_bucket
    vbt_holdings = {b: bucket_totals[b] * vbt_share_per_bucket for b in BUCKETS}
    dealer_holdings = {b: bucket_totals[b] * dealer_share_per_bucket for b in BUCKETS}

    # Calculate additional debt per trader to VBT/Dealer
    # Each trader contributes proportionally to their original debt
    trader_to_vbt = []
    trader_to_dealer = []
    for idx, amount in enumerate(base_payable_amounts):
        bucket = payable_buckets[idx]
        bucket_total = bucket_totals[bucket]
        if bucket_total > 0:
            # This trader's share of the bucket
            share = amount / bucket_total
            # Their contribution to VBT/Dealer for this bucket
            trader_to_vbt.append((vbt_holdings[bucket] * share, bucket, due_days[idx]))
            trader_to_dealer.append((dealer_holdings[bucket] * share, bucket, due_days[idx]))
        else:
            trader_to_vbt.append((Decimal("0"), bucket, due_days[idx]))
            trader_to_dealer.append((Decimal("0"), bucket, due_days[idx]))

    # Total additional cash needed by traders to pay VBT/Dealer
    total_additional_debt = sum(vbt_holdings.values()) + sum(dealer_holdings.values())

    # Allocate base liquidity
    base_liquidity = params.liquidity.total
    base_liquidity_amounts = _allocate_liquidity(params)

    # Scale up liquidity to fund additional obligations
    # Traders need cash to pay their obligations to VBT/Dealer
    additional_cash_per_trader = total_additional_debt / Decimal(params.n_agents)

    # Build agents
    agents = _build_agents(params.n_agents)

    # Add VBT and Dealer agents per bucket
    for bucket in BUCKETS:
        agents.append({
            "id": f"vbt_{bucket}",
            "kind": "household",
            "name": f"VBT ({bucket})",
        })
        agents.append({
            "id": f"dealer_{bucket}",
            "kind": "household",
            "name": f"Dealer ({bucket})",
        })

    initial_actions = []

    # Seed cash liquidity to traders (base + additional for VBT/Dealer obligations)
    for idx, base_amount in enumerate(base_liquidity_amounts):
        agent_id = f"H{idx + 1}"
        total_amount = base_amount + additional_cash_per_trader
        if total_amount > 0:
            initial_actions.append({
                "mint_cash": {
                    "to": agent_id,
                    "amount": total_amount,
                    "alias": f"LIQ_{agent_id}",
                }
            })

    # Create ring payables (trader-to-trader, original structure)
    for idx, amount in enumerate(base_payable_amounts):
        from_agent = f"H{idx + 1}"
        to_agent = f"H{(idx + 1) % params.n_agents + 1}"
        due_day = due_days[idx]
        initial_actions.append({
            "create_payable": {
                "from": from_agent,
                "to": to_agent,
                "amount": amount,
                "due_day": due_day,
                "alias": f"P_{from_agent}_{to_agent}",
                "maturity_distance": due_day,  # Plan 024: for rollover
            }
        })

    # Create payables from traders to VBT (per bucket)
    for idx in range(params.n_agents):
        vbt_amount, bucket, due_day = trader_to_vbt[idx]
        if vbt_amount > Decimal("0.01"):  # Skip tiny amounts
            from_agent = f"H{idx + 1}"
            to_agent = f"vbt_{bucket}"
            initial_actions.append({
                "create_payable": {
                    "from": from_agent,
                    "to": to_agent,
                    "amount": vbt_amount,
                    "due_day": due_day,
                    "alias": f"P_{from_agent}_{to_agent}",
                    "maturity_distance": due_day,  # Plan 024: for rollover
                }
            })

    # Create payables from traders to Dealer (per bucket)
    for idx in range(params.n_agents):
        dealer_amount, bucket, due_day = trader_to_dealer[idx]
        if dealer_amount > Decimal("0.01"):  # Skip tiny amounts
            from_agent = f"H{idx + 1}"
            to_agent = f"dealer_{bucket}"
            initial_actions.append({
                "create_payable": {
                    "from": from_agent,
                    "to": to_agent,
                    "amount": dealer_amount,
                    "due_day": due_day,
                    "alias": f"P_{from_agent}_{to_agent}",
                    "maturity_distance": due_day,  # Plan 024: for rollover
                }
            })

    # Mint cash to VBT and Dealer (market value of their holdings = balanced position)
    # Market value = face_value_held × outside_mid_ratio
    for bucket in BUCKETS:
        # VBT cash
        vbt_cash = vbt_holdings[bucket] * outside_mid_ratio
        if vbt_cash > 0:
            initial_actions.append({
                "mint_cash": {
                    "to": f"vbt_{bucket}",
                    "amount": vbt_cash,
                    "alias": f"LIQ_vbt_{bucket}",
                }
            })

        # Dealer cash
        dealer_cash = dealer_holdings[bucket] * outside_mid_ratio
        if dealer_cash > 0:
            initial_actions.append({
                "mint_cash": {
                    "to": f"dealer_{bucket}",
                    "amount": dealer_cash,
                    "alias": f"LIQ_dealer_{bucket}",
                }
            })

    scenario_name = _render_scenario_name(config.name_prefix, params)
    scenario_name = f"{scenario_name} [Balanced {mode}]"
    description = _render_description(params)
    description = (
        f"{description}; balanced mode={mode}, "
        f"VBT={_fmt_decimal(vbt_share_per_bucket)}, "
        f"Dealer={_fmt_decimal(dealer_share_per_bucket)}, "
        f"ρ={_fmt_decimal(outside_mid_ratio)}"
    )

    scenario: Dict[str, Any] = {
        "version": 1,
        "name": scenario_name,
        "description": description,
        "policy_overrides": params.policy_overrides,
        "agents": agents,
        "initial_actions": initial_actions,
        "scheduled_actions": [],
        "run": {
            "mode": "until_stable",
            "max_days": max(30, params.maturity.days + 5),
            "quiet_days": 2,
            "rollover_enabled": rollover_enabled,  # Plan 024: continuous rollover
            "show": {
                "balances": [agent["id"] for agent in agents],
                "events": "detailed",
            },
            "export": {
                "balances_csv": "out/balances.csv",
                "events_jsonl": "out/events.jsonl",
            },
        },
        # Store balanced config for later use
        "_balanced_config": {
            "face_value": float(face_value),
            "outside_mid_ratio": float(outside_mid_ratio),
            "vbt_share_per_bucket": float(vbt_share_per_bucket),
            "dealer_share_per_bucket": float(dealer_share_per_bucket),
            "mode": mode,
            "rollover_enabled": rollover_enabled,
        },
    }

    if config.compile.emit_yaml:
        _emit_yaml(
            scenario,
            config,
            source_path=source_path,
        )

    return scenario


def _draw_payables(
    n: int,
    concentration: Decimal,
    monotonicity: Decimal,
    total: Decimal,
    seed: int,
) -> List[Decimal]:
    rng = random.Random(seed)
    alpha = float(concentration)
    if alpha <= 0:
        raise ValueError("Dirichlet concentration must be positive")

    weights = [rng.gammavariate(alpha, 1.0) for _ in range(n)]
    weight_sum = sum(weights)
    if weight_sum <= 0:
        raise ValueError("Failed to draw positive Dirichlet weights")

    decimals = [Decimal(str(w)) for w in weights]
    weight_total = sum(decimals)

    amounts: List[Decimal] = []
    running = Decimal("0")
    for idx, weight in enumerate(decimals):
        if idx == n - 1:
            amount = total - running
        else:
            amount = (total * weight) / weight_total
            running += amount
        amounts.append(amount)
    amounts = _ensure_positive_amounts(amounts, total)
    return _apply_monotonicity(amounts, monotonicity, rng)


def _apply_monotonicity(
    amounts: List[Decimal],
    monotonicity: Decimal,
    rng: random.Random,
) -> List[Decimal]:
    if len(amounts) <= 1:
        return list(amounts)

    try:
        m = float(monotonicity)
    except (ValueError, TypeError):
        m = 0.0

    if abs(m) < 1e-9:
        return list(amounts)

    strength = max(0.0, min(abs(m), 1.0))
    direction_desc = m >= 0

    ordered = sorted(amounts, reverse=direction_desc)
    if strength >= 1.0 - 1e-9:
        return ordered

    swap_factor = 1.0 - strength
    if swap_factor <= 1e-9:
        return ordered

    n = len(ordered)
    swap_count = int(round(swap_factor * n * max(1, n - 1)))
    if swap_count <= 0:
        return ordered

    max_swaps = n * (n - 1)
    for _ in range(min(swap_count, max_swaps)):
        idx = rng.randrange(n - 1)
        ordered[idx], ordered[idx + 1] = ordered[idx + 1], ordered[idx]

    return ordered


def _ensure_positive_amounts(amounts: List[Decimal], total: Decimal) -> List[Decimal]:
    """Clamp payable amounts to be strictly positive while preserving the total."""
    min_amount = Decimal("0.01")
    adjusted = list(amounts)
    deficit = Decimal("0")

    for idx, amt in enumerate(adjusted):
        if amt <= 0:
            need = min_amount - amt
            deficit += need
            adjusted[idx] = min_amount

    if deficit > 0:
        # Redistribute the deficit across larger payables.
        order = sorted(range(len(adjusted)), key=lambda i: adjusted[i], reverse=True)
        for idx in order:
            if deficit <= 0:
                break
            available = adjusted[idx] - min_amount
            if available <= 0:
                continue
            take = min(available, deficit)
            adjusted[idx] -= take
            deficit -= take

    current_total = sum(adjusted)
    diff = current_total - total
    if diff > 0:
        order = sorted(range(len(adjusted)), key=lambda i: adjusted[i], reverse=True)
        for idx in order:
            if diff <= 0:
                break
            available = adjusted[idx] - min_amount
            if available <= 0:
                continue
            take = min(available, diff)
            adjusted[idx] -= take
            diff -= take
    elif diff < 0:
        adjusted[-1] += (-diff)

    # Final guard to ensure all entries stay above the minimum after adjustments
    for idx, amt in enumerate(adjusted):
        if amt < min_amount:
            adjusted[idx] = min_amount
    final_total = sum(adjusted)
    if final_total != total:
        adjusted[-1] += (total - final_total)
        if adjusted[-1] < min_amount:
            adjusted[-1] = min_amount

    return adjusted


def _allocate_liquidity(params: RingExplorerParams) -> List[Decimal]:
    total = params.liquidity.total
    n = params.n_agents
    mode = params.liquidity.mode

    if mode == "uniform":
        share = total / Decimal(n)
        return [share] * n
    if mode == "single_at":
        target = params.liquidity.agent or "H1"
        values = []
        for idx in range(n):
            agent_id = f"H{idx + 1}"
            values.append(total if agent_id == target else Decimal("0"))
        if all(v == 0 for v in values):
            raise ValueError(f"liquidity allocation agent '{target}' not in ring")
        return values
    if mode == "vector":
        vector = params.liquidity.vector
        if not vector or len(vector) != n:
            raise ValueError("liquidity.vector must have length equal to n_agents")
        weight_total = sum(vector)
        if weight_total <= 0:
            raise ValueError("liquidity.vector must sum to a positive value")
        scaled: List[Decimal] = []
        running = Decimal("0")
        for idx, weight in enumerate(vector):
            if idx == n - 1:
                amount = total - running
            else:
                amount = (total * weight) / weight_total
                running += amount
            scaled.append(amount)
        return scaled

    raise ValueError(f"Unsupported liquidity allocation mode '{mode}'")


def _build_due_days(n: int, days: int, mu: Decimal) -> List[int]:
    if days <= 1:
        return [1] * n
    max_shift = days - 1
    lead_steps = int(round(float(mu) * max_shift))
    lead_steps = max(0, min(max_shift, lead_steps))
    if lead_steps == 0:
        return [1] * n
    cycle = max_shift + 1
    step = max(lead_steps, 1)
    due_days: List[int] = []
    for idx in range(n):
        phase = (idx * step) % cycle
        offset = (cycle + phase - lead_steps) % cycle
        due_days.append(int(offset + 1))
    return due_days


def _build_agents(n: int) -> List[Dict[str, Any]]:
    agents: List[Dict[str, Any]] = [
        {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
    ]
    agents.extend({
        "id": f"H{idx}",
        "kind": "household",
        "name": f"Agent {idx}",
    } for idx in range(1, n + 1))
    return agents


def _render_scenario_name(prefix: str, params: RingExplorerParams) -> str:
    kappa_str = _fmt_decimal(params.kappa)
    conc_str = _fmt_decimal(params.inequality.concentration)
    mu_str = _fmt_decimal(params.maturity.mu)
    return f"{prefix} (n={params.n_agents}, kappa={kappa_str}, c={conc_str}, mu={mu_str})"


def _render_description(params: RingExplorerParams) -> str:
    parts = [
        f"Ring of {params.n_agents} agents with total dues S1={_fmt_decimal(params.Q_total)}",
        f"initial liquidity L0={_fmt_decimal(params.liquidity.total)} (kappa={_fmt_decimal(params.kappa)})",
        f"Dirichlet concentration c={_fmt_decimal(params.inequality.concentration)}",
        f"maturity mu={_fmt_decimal(params.maturity.mu)} over {params.maturity.days} day horizon",
    ]
    return "; ".join(parts)


def _fmt_decimal(value: Decimal) -> str:
    normalized = value.normalize()
    if normalized == normalized.to_integral_value():
        return str(int(normalized))
    return format(normalized, "f").rstrip("0").rstrip(".")


def _emit_yaml(scenario: Dict[str, Any], config: RingExplorerGeneratorConfig, source_path: Optional[Path]) -> None:
    base_dir = None
    if config.compile.out_dir:
        out_dir = Path(config.compile.out_dir)
        if not out_dir.is_absolute() and source_path is not None:
            base_dir = source_path.parent / out_dir
        else:
            base_dir = out_dir
    elif source_path is not None:
        base_dir = source_path.parent
    else:
        return

    base_dir.mkdir(parents=True, exist_ok=True)

    slug = _slugify(scenario.get("name", "scenario"))
    target = base_dir / f"{slug}.yaml"

    dumpable = _to_yaml_ready(scenario)
    with target.open("w", encoding="utf-8") as fh:
        yaml.safe_dump(dumpable, fh, sort_keys=False, allow_unicode=False)


def _slugify(name: str) -> str:
    slug = re.sub(r"[^A-Za-z0-9]+", "_", name)
    slug = slug.strip("_")
    return slug.lower() or "scenario"


def _to_yaml_ready(obj: Any) -> Any:
    if isinstance(obj, dict):
        return {k: _to_yaml_ready(v) for k, v in obj.items() if v is not None}
    if isinstance(obj, list):
        return [_to_yaml_ready(v) for v in obj]
    if isinstance(obj, Decimal):
        normalized = obj.normalize()
        if normalized == normalized.to_integral_value():
            return int(normalized)
        return float(normalized)
    return obj


__all__ = ["compile_ring_explorer", "compile_ring_explorer_balanced"]

```

---

### 📄 src/bilancio/storage/__init__.py

```python
"""Storage abstractions for experiment results."""

from .models import (
    RunStatus,
    RunArtifacts,
    RunResult,
    RegistryEntry,
)
from .protocols import ResultStore, RegistryStore
from .file_store import FileResultStore, FileRegistryStore
from .artifact_loaders import ArtifactLoader, LocalArtifactLoader
from .modal_artifact_loader import ModalVolumeArtifactLoader
from .supabase_client import (
    get_supabase_client,
    is_supabase_configured,
    SupabaseConfigError,
)
from .supabase_registry import SupabaseRegistryStore

__all__ = [
    "RunStatus",
    "RunArtifacts",
    "RunResult",
    "RegistryEntry",
    "ResultStore",
    "RegistryStore",
    "FileResultStore",
    "FileRegistryStore",
    "ArtifactLoader",
    "LocalArtifactLoader",
    "ModalVolumeArtifactLoader",
    # Supabase
    "get_supabase_client",
    "is_supabase_configured",
    "SupabaseConfigError",
    "SupabaseRegistryStore",
]

```

---

### 📄 src/bilancio/storage/artifact_loaders.py

```python
"""Artifact loaders for fetching artifacts from various storage backends."""

from pathlib import Path
from typing import Protocol, runtime_checkable


@runtime_checkable
class ArtifactLoader(Protocol):
    """Protocol for loading artifacts from any storage backend.

    This protocol defines the interface for artifact loading, allowing
    different implementations for local filesystem, cloud storage, etc.
    """

    def load_bytes(self, reference: str) -> bytes:
        """Load artifact as bytes.

        Args:
            reference: The artifact reference (e.g., relative path or URI).

        Returns:
            The artifact contents as bytes.

        Raises:
            FileNotFoundError: If the artifact does not exist.
        """
        ...

    def load_text(self, reference: str) -> str:
        """Load artifact as text.

        Args:
            reference: The artifact reference (e.g., relative path or URI).

        Returns:
            The artifact contents as a string.

        Raises:
            FileNotFoundError: If the artifact does not exist.
        """
        ...

    def exists(self, reference: str) -> bool:
        """Check if artifact exists.

        Args:
            reference: The artifact reference (e.g., relative path or URI).

        Returns:
            True if the artifact exists, False otherwise.
        """
        ...


class LocalArtifactLoader:
    """Load artifacts from local filesystem.

    This implementation resolves artifact references as paths relative
    to a base directory.
    """

    def __init__(self, base_path: Path) -> None:
        """Initialize with base path for relative references.

        Args:
            base_path: The base directory for resolving relative paths.
        """
        self.base_path = Path(base_path)

    def load_bytes(self, reference: str) -> bytes:
        """Load artifact as bytes from filesystem.

        Args:
            reference: Relative path to the artifact from base_path.

        Returns:
            The artifact contents as bytes.

        Raises:
            FileNotFoundError: If the artifact does not exist.
        """
        path = self.base_path / reference
        return path.read_bytes()

    def load_text(self, reference: str) -> str:
        """Load artifact as text from filesystem.

        Args:
            reference: Relative path to the artifact from base_path.

        Returns:
            The artifact contents as a string.

        Raises:
            FileNotFoundError: If the artifact does not exist.
        """
        path = self.base_path / reference
        return path.read_text()

    def exists(self, reference: str) -> bool:
        """Check if artifact exists on filesystem.

        Args:
            reference: Relative path to the artifact from base_path.

        Returns:
            True if the artifact exists, False otherwise.
        """
        path = self.base_path / reference
        return path.exists()

```

---

### 📄 src/bilancio/storage/file_store.py

```python
"""File-based result storage implementation."""

from __future__ import annotations

import csv
import json
import re
from pathlib import Path
from typing import Optional, List, Dict, Any

from .models import RunResult, RegistryEntry, RunArtifacts, RunStatus


# Pattern for valid IDs (alphanumeric, dash, underscore, dot)
_VALID_ID_PATTERN = re.compile(r'^[a-zA-Z0-9_\-\.]+$')


def _validate_id(value: str, field_name: str) -> None:
    """Validate an ID to prevent path traversal attacks.

    Args:
        value: The ID value to validate.
        field_name: Name of the field for error messages.

    Raises:
        ValueError: If the ID contains invalid characters.
    """
    if not value:
        return  # Empty is allowed for some cases (e.g., empty experiment_id)
    if not _VALID_ID_PATTERN.match(value):
        raise ValueError(
            f"Invalid {field_name}: '{value}'. "
            f"Must contain only alphanumeric characters, dashes, underscores, and dots."
        )


class FileResultStore:
    """Store results as files on local filesystem."""

    def __init__(self, base_dir: Path | str):
        self.base_dir = Path(base_dir)
        self.base_dir.mkdir(parents=True, exist_ok=True)

    def _run_dir(self, experiment_id: str, run_id: str) -> Path:
        _validate_id(experiment_id, "experiment_id")
        _validate_id(run_id, "run_id")
        return self.base_dir / experiment_id / "runs" / run_id

    def save_artifact(
        self,
        experiment_id: str,
        run_id: str,
        name: str,
        content: bytes,
        content_type: str = "application/octet-stream"
    ) -> str:
        """Save artifact to file, return relative path."""
        run_dir = self._run_dir(experiment_id, run_id)
        run_dir.mkdir(parents=True, exist_ok=True)

        # Determine subdirectory based on artifact type
        if name in ("scenario.yaml",):
            path = run_dir / name
        else:
            out_dir = run_dir / "out"
            out_dir.mkdir(exist_ok=True)
            path = out_dir / name

        path.write_bytes(content)
        return str(path.relative_to(self.base_dir))

    def save_run(self, experiment_id: str, result: RunResult) -> None:
        """Save run result metadata as JSON."""
        run_dir = self._run_dir(experiment_id, result.run_id)
        run_dir.mkdir(parents=True, exist_ok=True)

        meta_path = run_dir / "result.json"
        meta = {
            "run_id": result.run_id,
            "status": result.status.value,
            "parameters": result.parameters,
            "metrics": result.metrics,
            "artifacts": {
                k: v for k, v in vars(result.artifacts).items() if v is not None
            },
            "error": result.error,
            "execution_time_ms": result.execution_time_ms,
        }
        meta_path.write_text(json.dumps(meta, indent=2))

    def load_run(self, experiment_id: str, run_id: str) -> Optional[RunResult]:
        """Load run result from file."""
        meta_path = self._run_dir(experiment_id, run_id) / "result.json"
        if not meta_path.exists():
            return None

        meta = json.loads(meta_path.read_text())
        return RunResult(
            run_id=meta["run_id"],
            status=RunStatus(meta["status"]),
            parameters=meta.get("parameters", {}),
            metrics=meta.get("metrics", {}),
            artifacts=RunArtifacts(**meta.get("artifacts", {})),
            error=meta.get("error"),
            execution_time_ms=meta.get("execution_time_ms"),
        )

    def load_artifact(self, reference: str) -> bytes:
        """Load artifact content by path.

        Raises:
            ValueError: If reference attempts path traversal outside base_dir.
        """
        path = self.base_dir / reference
        # Validate path doesn't escape base_dir (security: prevent path traversal)
        try:
            path.resolve().relative_to(self.base_dir.resolve())
        except ValueError:
            raise ValueError(f"Invalid artifact reference: path traversal detected in '{reference}'")
        return path.read_bytes()


class FileRegistryStore:
    """Store registry as CSV file."""

    # Default fields - will be extended dynamically
    DEFAULT_FIELDS = [
        "run_id", "experiment_id", "phase", "status", "error",
        # Common parameters
        "seed", "n_agents", "kappa", "concentration", "mu", "monotonicity",
        "maturity_days", "Q_total", "S1", "L0", "default_handling", "dealer_enabled",
        # Common metrics
        "phi_total", "delta_total", "time_to_stability",
        # Common artifact paths
        "scenario_yaml", "events_jsonl", "balances_csv", "metrics_csv",
        "metrics_html", "run_html",
    ]

    def __init__(self, base_dir: Path | str):
        self.base_dir = Path(base_dir)

    def _registry_path(self, experiment_id: str) -> Path:
        _validate_id(experiment_id, "experiment_id")
        if experiment_id:
            return self.base_dir / experiment_id / "registry" / "experiments.csv"
        # Empty experiment_id means use base_dir directly
        return self.base_dir / "registry" / "experiments.csv"

    def upsert(self, entry: RegistryEntry) -> None:
        """Insert or update registry entry."""
        registry_path = self._registry_path(entry.experiment_id)
        registry_path.parent.mkdir(parents=True, exist_ok=True)

        # Load existing entries
        entries: Dict[str, Dict[str, str]] = {}
        fieldnames = list(self.DEFAULT_FIELDS)

        if registry_path.exists():
            with open(registry_path, "r", newline="") as f:
                reader = csv.DictReader(f)
                if reader.fieldnames:
                    fieldnames = list(reader.fieldnames)
                for row in reader:
                    entries[row["run_id"]] = dict(row)

        # Build row from entry
        row: Dict[str, str] = {
            "run_id": entry.run_id,
            "experiment_id": entry.experiment_id,
            "status": entry.status.value,
            "error": entry.error or "",
        }

        # Add parameters, metrics, artifact paths
        for k, v in entry.parameters.items():
            row[k] = str(v) if v is not None else ""
            if k not in fieldnames:
                fieldnames.append(k)

        for k, v in entry.metrics.items():
            row[k] = str(v) if v is not None else ""
            if k not in fieldnames:
                fieldnames.append(k)

        for k, v in entry.artifact_paths.items():
            row[k] = str(v) if v is not None else ""
            if k not in fieldnames:
                fieldnames.append(k)

        entries[entry.run_id] = row

        # Write back
        with open(registry_path, "w", newline="") as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames, extrasaction="ignore")
            writer.writeheader()
            for r in entries.values():
                writer.writerow(r)

    def get(self, experiment_id: str, run_id: str) -> Optional[RegistryEntry]:
        """Get registry entry by ID."""
        registry_path = self._registry_path(experiment_id)
        if not registry_path.exists():
            return None

        with open(registry_path, "r", newline="") as f:
            reader = csv.DictReader(f)
            for row in reader:
                if row["run_id"] == run_id:
                    return self._row_to_entry(row)
        return None

    def list_runs(self, experiment_id: str) -> List[str]:
        """List all run IDs."""
        registry_path = self._registry_path(experiment_id)
        if not registry_path.exists():
            return []

        with open(registry_path, "r", newline="") as f:
            reader = csv.DictReader(f)
            return [row["run_id"] for row in reader]

    def get_completed_keys(
        self,
        experiment_id: str,
        key_fields: Optional[List[str]] = None
    ) -> set:
        """Get completed parameter keys for resumption."""
        if key_fields is None:
            key_fields = ["seed", "kappa", "concentration"]

        registry_path = self._registry_path(experiment_id)
        if not registry_path.exists():
            return set()

        completed = set()
        with open(registry_path, "r", newline="") as f:
            reader = csv.DictReader(f)
            for row in reader:
                if row.get("status") == "completed":
                    key_values = []
                    for field in key_fields:
                        val = row.get(field, "")
                        # Try to parse as number for consistent hashing
                        try:
                            if "." in val:
                                key_values.append(float(val))
                            else:
                                key_values.append(int(val))
                        except (ValueError, TypeError):
                            key_values.append(val)
                    completed.add(tuple(key_values))
        return completed

    def query(
        self,
        experiment_id: str,
        filters: Optional[Dict[str, Any]] = None
    ) -> List[RegistryEntry]:
        """Query registry with filters."""
        registry_path = self._registry_path(experiment_id)
        if not registry_path.exists():
            return []

        results = []
        with open(registry_path, "r", newline="") as f:
            reader = csv.DictReader(f)
            for row in reader:
                if filters:
                    match = all(
                        str(row.get(k, "")) == str(v)
                        for k, v in filters.items()
                    )
                    if not match:
                        continue
                results.append(self._row_to_entry(row))
        return results

    def _row_to_entry(self, row: Dict[str, str]) -> RegistryEntry:
        """Convert CSV row to RegistryEntry."""
        # Known parameter, metric, and artifact keys
        param_keys = {"phase", "seed", "n_agents", "kappa", "concentration", "mu",
                      "monotonicity", "maturity_days", "Q_total", "S1", "L0",
                      "default_handling", "dealer_enabled"}
        metric_keys = {"phi_total", "delta_total", "time_to_stability"}
        artifact_keys = {"scenario_yaml", "events_jsonl", "balances_csv",
                        "metrics_csv", "metrics_json", "metrics_html", "run_html",
                        "dealer_metrics_json", "trades_csv", "repayment_events_csv"}
        meta_keys = {"run_id", "experiment_id", "status", "error"}

        parameters: Dict[str, Any] = {}
        metrics: Dict[str, Any] = {}
        artifact_paths: Dict[str, str] = {}

        for k, v in row.items():
            if not v or k in meta_keys:
                continue
            if k in param_keys:
                # Try to parse as number
                try:
                    if "." in v:
                        parameters[k] = float(v)
                    else:
                        parameters[k] = int(v)
                except ValueError:
                    parameters[k] = v
            elif k in metric_keys:
                try:
                    metrics[k] = float(v)
                except ValueError:
                    metrics[k] = v
            elif k in artifact_keys:
                artifact_paths[k] = v
            else:
                # Unknown field - add to parameters
                parameters[k] = v

        return RegistryEntry(
            run_id=row["run_id"],
            experiment_id=row.get("experiment_id", ""),
            status=RunStatus(row.get("status", "completed")),
            parameters=parameters,
            metrics=metrics,
            artifact_paths=artifact_paths,
            error=row.get("error") or None,
        )

```

---

### 📄 src/bilancio/storage/modal_artifact_loader.py

```python
"""Artifact loader for Modal Volume storage."""

from __future__ import annotations

import subprocess
import tempfile
from pathlib import Path
from typing import Optional


class ModalVolumeArtifactLoader:
    """Load artifacts from a Modal Volume.

    Uses the Modal CLI to download files on demand.
    Implements caching to avoid repeated downloads.

    Example:
        loader = ModalVolumeArtifactLoader(
            volume_name="bilancio-results",
            base_path="my_experiment/runs/run_001",
        )
        events_text = loader.load_text("out/events.jsonl")
        html_bytes = loader.load_bytes("run.html")
    """

    def __init__(
        self,
        volume_name: str = "bilancio-results",
        base_path: str = "",
        cache_dir: Optional[Path] = None,
    ):
        """Initialize loader.

        Args:
            volume_name: Name of the Modal Volume.
            base_path: Base path within the volume (e.g., "experiment_001/runs/run_001").
            cache_dir: Local directory for caching downloads. If None, uses a
                temporary directory.
        """
        self.volume_name = volume_name
        self.base_path = base_path
        self._cache_dir = cache_dir
        self._temp_dir: Optional[tempfile.TemporaryDirectory] = None

    @property
    def cache_dir(self) -> Path:
        """Get the cache directory, creating it if necessary."""
        if self._cache_dir is not None:
            self._cache_dir.mkdir(parents=True, exist_ok=True)
            return self._cache_dir

        if self._temp_dir is None:
            self._temp_dir = tempfile.TemporaryDirectory(prefix="modal_cache_")
        return Path(self._temp_dir.name)

    def load_bytes(self, reference: str) -> bytes:
        """Load artifact as bytes.

        Args:
            reference: Relative path to artifact within base_path.

        Returns:
            File contents as bytes.

        Raises:
            FileNotFoundError: If the artifact doesn't exist.
            subprocess.CalledProcessError: If download fails.
        """
        local_path = self._ensure_downloaded(reference)
        return local_path.read_bytes()

    def load_text(self, reference: str, encoding: str = "utf-8") -> str:
        """Load artifact as text.

        Args:
            reference: Relative path to artifact within base_path.
            encoding: Text encoding (default: utf-8).

        Returns:
            File contents as string.

        Raises:
            FileNotFoundError: If the artifact doesn't exist.
            subprocess.CalledProcessError: If download fails.
        """
        local_path = self._ensure_downloaded(reference)
        return local_path.read_text(encoding=encoding)

    def exists(self, reference: str) -> bool:
        """Check if artifact exists on volume.

        Args:
            reference: Relative path to artifact within base_path.

        Returns:
            True if the file exists, False otherwise.
        """
        remote_path = f"{self.base_path}/{reference}" if self.base_path else reference

        result = subprocess.run(
            ["modal", "volume", "ls", self.volume_name, remote_path],
            capture_output=True,
            text=True,
        )
        return result.returncode == 0

    def get_local_path(self, reference: str) -> Path:
        """Get local path to cached artifact, downloading if necessary.

        Args:
            reference: Relative path to artifact within base_path.

        Returns:
            Path to the locally cached file.
        """
        return self._ensure_downloaded(reference)

    def _ensure_downloaded(self, reference: str) -> Path:
        """Download artifact if not already cached.

        Args:
            reference: Relative path to artifact within base_path.

        Returns:
            Path to the locally cached file.

        Raises:
            subprocess.CalledProcessError: If download fails.
        """
        # Create cache path maintaining directory structure
        cache_path = self.cache_dir / reference

        if cache_path.exists():
            return cache_path

        # Ensure parent directory exists
        cache_path.parent.mkdir(parents=True, exist_ok=True)

        # Download from Modal Volume
        remote_path = f"{self.base_path}/{reference}" if self.base_path else reference

        subprocess.run(
            ["modal", "volume", "get", self.volume_name, remote_path, str(cache_path)],
            check=True,
            capture_output=True,
        )

        return cache_path

    def clear_cache(self) -> None:
        """Clear all cached files."""
        if self._temp_dir is not None:
            self._temp_dir.cleanup()
            self._temp_dir = None
        elif self._cache_dir is not None and self._cache_dir.exists():
            import shutil

            shutil.rmtree(self._cache_dir)
            self._cache_dir.mkdir(parents=True, exist_ok=True)

    def __del__(self):
        """Cleanup temporary directory on deletion."""
        if self._temp_dir is not None:
            self._temp_dir.cleanup()

```

---

### 📄 src/bilancio/storage/models.py

```python
"""Data models for storage abstractions."""

from __future__ import annotations

from dataclasses import dataclass, field
from typing import Dict, Any, Optional
from enum import Enum


class RunStatus(Enum):
    """Status of a simulation run."""
    PENDING = "pending"
    RUNNING = "running"
    COMPLETED = "completed"
    FAILED = "failed"


@dataclass
class RunArtifacts:
    """References to simulation output artifacts."""
    scenario_yaml: Optional[str] = None
    events_jsonl: Optional[str] = None
    balances_csv: Optional[str] = None
    metrics_csv: Optional[str] = None
    metrics_json: Optional[str] = None
    run_html: Optional[str] = None
    dealer_metrics_json: Optional[str] = None
    trades_csv: Optional[str] = None
    repayment_events_csv: Optional[str] = None


@dataclass
class RunResult:
    """Complete result of a single simulation run."""
    run_id: str
    status: RunStatus
    parameters: Dict[str, Any] = field(default_factory=dict)
    metrics: Dict[str, Any] = field(default_factory=dict)
    artifacts: RunArtifacts = field(default_factory=RunArtifacts)
    error: Optional[str] = None
    execution_time_ms: Optional[int] = None


@dataclass
class RegistryEntry:
    """Metadata for registry storage."""
    run_id: str
    experiment_id: str
    status: RunStatus
    parameters: Dict[str, Any] = field(default_factory=dict)
    metrics: Dict[str, Any] = field(default_factory=dict)
    artifact_paths: Dict[str, str] = field(default_factory=dict)
    error: Optional[str] = None

```

---

### 📄 src/bilancio/storage/protocols.py

```python
"""Protocol definitions for storage backends."""

from __future__ import annotations

from typing import Protocol, Optional, List, Dict, Any, runtime_checkable

from .models import RunResult, RegistryEntry


@runtime_checkable
class ResultStore(Protocol):
    """Protocol for storing simulation results."""

    def save_artifact(
        self,
        experiment_id: str,
        run_id: str,
        name: str,
        content: bytes,
        content_type: str = "application/octet-stream"
    ) -> str:
        """Save an artifact, return its reference (path or key)."""
        ...

    def save_run(self, experiment_id: str, result: RunResult) -> None:
        """Save a complete run result."""
        ...

    def load_run(self, experiment_id: str, run_id: str) -> Optional[RunResult]:
        """Load a run result by ID."""
        ...

    def load_artifact(self, reference: str) -> bytes:
        """Load artifact content by reference."""
        ...


@runtime_checkable
class RegistryStore(Protocol):
    """Protocol for experiment registry storage."""

    def upsert(self, entry: RegistryEntry) -> None:
        """Insert or update a registry entry."""
        ...

    def get(self, experiment_id: str, run_id: str) -> Optional[RegistryEntry]:
        """Get a specific registry entry."""
        ...

    def list_runs(self, experiment_id: str) -> List[str]:
        """List all run IDs for an experiment."""
        ...

    def get_completed_keys(
        self,
        experiment_id: str,
        key_fields: Optional[List[str]] = None
    ) -> set:
        """Get set of completed parameter keys for resumption."""
        ...

    def query(
        self,
        experiment_id: str,
        filters: Optional[Dict[str, Any]] = None
    ) -> List[RegistryEntry]:
        """Query registry entries with optional filters."""
        ...

```

---

### 📄 src/bilancio/storage/supabase_client.py

```python
"""Supabase client wrapper for bilancio storage.

This module provides a configured Supabase client for persisting simulation
results and job metadata to the Supabase database.

Environment variables required:
    BILANCIO_SUPABASE_URL: The Supabase project URL
    BILANCIO_SUPABASE_ANON_KEY: The Supabase anonymous/public key
"""

from __future__ import annotations

import os
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from supabase import Client

# Module-level singleton for client reuse
_supabase_client: Client | None = None


class SupabaseConfigError(Exception):
    """Raised when Supabase credentials are missing or invalid."""

    pass


def is_supabase_configured() -> bool:
    """Check if Supabase environment variables are set.

    Returns:
        True if both BILANCIO_SUPABASE_URL and BILANCIO_SUPABASE_ANON_KEY
        are set in the environment, False otherwise.
    """
    url = os.environ.get("BILANCIO_SUPABASE_URL")
    key = os.environ.get("BILANCIO_SUPABASE_ANON_KEY")
    return bool(url and key)


def get_supabase_client() -> Client:
    """Get a configured Supabase client instance.

    This function implements a singleton pattern - the client is created
    once and reused for subsequent calls. This is efficient for connection
    pooling and reduces overhead.

    Returns:
        A configured Supabase Client instance.

    Raises:
        SupabaseConfigError: If BILANCIO_SUPABASE_URL or
            BILANCIO_SUPABASE_ANON_KEY environment variables are not set.

    Example:
        >>> client = get_supabase_client()
        >>> response = client.table("jobs").select("*").execute()
    """
    global _supabase_client

    if _supabase_client is not None:
        return _supabase_client

    url = os.environ.get("BILANCIO_SUPABASE_URL")
    key = os.environ.get("BILANCIO_SUPABASE_ANON_KEY")

    if not url:
        raise SupabaseConfigError(
            "BILANCIO_SUPABASE_URL environment variable is not set. "
            "Please set it to your Supabase project URL "
            "(e.g., https://xxxxx.supabase.co)"
        )

    if not key:
        raise SupabaseConfigError(
            "BILANCIO_SUPABASE_ANON_KEY environment variable is not set. "
            "Please set it to your Supabase anonymous/public key."
        )

    from supabase import create_client

    _supabase_client = create_client(url, key)
    return _supabase_client


def reset_client() -> None:
    """Reset the singleton client instance.

    This is primarily useful for testing or when credentials change.
    The next call to get_supabase_client() will create a new client.
    """
    global _supabase_client
    _supabase_client = None

```

---

### 📄 src/bilancio/storage/supabase_registry.py

```python
"""Supabase-based registry store implementation."""

from __future__ import annotations

import logging
from datetime import datetime, timezone
from decimal import Decimal
from typing import Optional, List, Dict, Any, TYPE_CHECKING

from .models import RegistryEntry, RunStatus

if TYPE_CHECKING:
    from supabase import Client

logger = logging.getLogger(__name__)


class SupabaseRegistryStore:
    """Store registry entries in Supabase PostgreSQL database.

    This implementation stores run metadata in the `runs` table and
    associated metrics in the `metrics` table. It implements the
    RegistryStore protocol for compatibility with the storage abstraction.

    The schema expects:
    - runs: run_id, job_id, status, kappa, concentration, mu, seed, etc.
    - metrics: run_id, job_id, delta_total, phi_total, raw_metrics, etc.
    """

    # Parameter fields that map directly to runs table columns
    RUNS_PARAM_COLUMNS = {
        "kappa", "concentration", "mu", "outside_mid_ratio", "seed", "regime"
    }

    # Metric fields that map directly to metrics table columns
    METRICS_COLUMNS = {
        "delta_total", "phi_total", "n_defaults", "n_clears",
        "time_to_stability", "trading_effect", "total_trades", "total_trade_volume"
    }

    def __init__(self, client: Optional["Client"] = None):
        """Initialize Supabase registry store.

        Args:
            client: Optional Supabase client. If not provided, will be
                    created lazily using get_supabase_client().
        """
        self._client = client
        self._initialized = client is not None

    @property
    def client(self) -> "Client":
        """Get or create the Supabase client.

        Returns:
            Supabase client instance.

        Raises:
            RuntimeError: If Supabase is not configured.
        """
        if not self._initialized:
            from bilancio.storage.supabase_client import (
                get_supabase_client,
                is_supabase_configured,
            )

            if not is_supabase_configured():
                raise RuntimeError(
                    "Supabase is not configured. Set SUPABASE_URL and "
                    "SUPABASE_KEY environment variables."
                )
            self._client = get_supabase_client()
            self._initialized = True

        return self._client

    def upsert(self, entry: RegistryEntry) -> None:
        """Insert or update a registry entry.

        This method performs two operations:
        1. Upserts the run record in the `runs` table
        2. Upserts the metrics record in the `metrics` table

        Args:
            entry: The registry entry to upsert.
        """
        try:
            # Build runs table row
            runs_row = self._build_runs_row(entry)

            # Upsert into runs table
            self.client.table("runs").upsert(
                runs_row,
                on_conflict="run_id"
            ).execute()

            # Build and upsert metrics if we have any
            if entry.metrics:
                metrics_row = self._build_metrics_row(entry)

                # Check if metrics row already exists for this run
                existing = self.client.table("metrics").select("id").eq(
                    "run_id", entry.run_id
                ).execute()

                if existing.data:
                    # Update existing metrics row
                    self.client.table("metrics").update(metrics_row).eq(
                        "run_id", entry.run_id
                    ).execute()
                else:
                    # Insert new metrics row
                    self.client.table("metrics").insert(metrics_row).execute()

            logger.debug(f"Upserted registry entry for run {entry.run_id}")

        except Exception as e:
            logger.warning(f"Failed to upsert registry entry {entry.run_id}: {e}")

    def get(self, experiment_id: str, run_id: str) -> Optional[RegistryEntry]:
        """Get a specific registry entry.

        Args:
            experiment_id: The job/experiment ID.
            run_id: The run ID to retrieve.

        Returns:
            RegistryEntry if found, None otherwise.
        """
        try:
            # Query runs table with metrics join
            result = self.client.table("runs").select(
                "*, metrics(*)"
            ).eq("run_id", run_id).eq("job_id", experiment_id).execute()

            if not result.data:
                return None

            row = result.data[0]
            return self._row_to_entry(row)

        except Exception as e:
            logger.warning(f"Failed to get registry entry {run_id}: {e}")
            return None

    def list_runs(self, experiment_id: str) -> List[str]:
        """List all run IDs for an experiment.

        Args:
            experiment_id: The job/experiment ID.

        Returns:
            List of run IDs.
        """
        try:
            result = self.client.table("runs").select("run_id").eq(
                "job_id", experiment_id
            ).execute()

            return [row["run_id"] for row in result.data]

        except Exception as e:
            logger.warning(f"Failed to list runs for {experiment_id}: {e}")
            return []

    def get_completed_keys(
        self,
        experiment_id: str,
        key_fields: Optional[List[str]] = None
    ) -> set:
        """Get set of completed parameter combinations.

        Used for sweep resumption to identify which parameter combinations
        have already been completed.

        Args:
            experiment_id: The job/experiment ID.
            key_fields: List of parameter field names to use as keys.
                       Defaults to ["seed", "kappa", "concentration"].

        Returns:
            Set of tuples containing completed parameter combinations.
        """
        if key_fields is None:
            key_fields = ["seed", "kappa", "concentration"]

        try:
            # Build select clause for requested fields
            select_fields = ",".join(key_fields)

            result = self.client.table("runs").select(select_fields).eq(
                "job_id", experiment_id
            ).eq("status", "completed").execute()

            completed = set()
            for row in result.data:
                key_values = []
                for field in key_fields:
                    val = row.get(field)
                    if val is not None:
                        # Convert Decimal to float for consistent hashing
                        if isinstance(val, (Decimal, str)):
                            try:
                                val = float(val)
                            except (ValueError, TypeError):
                                pass
                        key_values.append(val)
                    else:
                        key_values.append(None)
                completed.add(tuple(key_values))

            return completed

        except Exception as e:
            logger.warning(
                f"Failed to get completed keys for {experiment_id}: {e}"
            )
            return set()

    def query(
        self,
        experiment_id: str,
        filters: Optional[Dict[str, Any]] = None
    ) -> List[RegistryEntry]:
        """Query registry entries with optional filters.

        Args:
            experiment_id: The job/experiment ID.
            filters: Optional dict of field=value filters to apply.

        Returns:
            List of matching RegistryEntry objects.
        """
        try:
            # Start with base query including metrics
            query = self.client.table("runs").select("*, metrics(*)").eq(
                "job_id", experiment_id
            )

            # Apply filters
            if filters:
                for field, value in filters.items():
                    query = query.eq(field, value)

            result = query.execute()

            return [self._row_to_entry(row) for row in result.data]

        except Exception as e:
            logger.warning(
                f"Failed to query registry for {experiment_id}: {e}"
            )
            return []

    def _build_runs_row(self, entry: RegistryEntry) -> Dict[str, Any]:
        """Build a row dict for the runs table.

        Args:
            entry: The registry entry to convert.

        Returns:
            Dict suitable for inserting into runs table.
        """
        row: Dict[str, Any] = {
            "run_id": entry.run_id,
            "job_id": entry.experiment_id,
            "status": entry.status.value,
        }

        # Add error if present
        if entry.error:
            row["error"] = entry.error

        # Add timestamps based on status
        now = datetime.now(timezone.utc).isoformat()
        if entry.status == RunStatus.COMPLETED:
            row["completed_at"] = now
        elif entry.status == RunStatus.FAILED:
            row["completed_at"] = now

        # Map parameters to runs table columns
        for param, value in entry.parameters.items():
            if param in self.RUNS_PARAM_COLUMNS:
                row[param] = self._convert_value(value)

        # Store Modal volume path if present in artifact_paths
        if entry.artifact_paths:
            # Derive volume path from any artifact path
            for artifact_path in entry.artifact_paths.values():
                if artifact_path:
                    # Extract base path (e.g., "experiment/runs/run_id")
                    parts = artifact_path.split("/")
                    if "runs" in parts:
                        idx = parts.index("runs")
                        if idx + 2 <= len(parts):
                            row["modal_volume_path"] = "/".join(parts[:idx + 2])
                            break

        return row

    def _build_metrics_row(self, entry: RegistryEntry) -> Dict[str, Any]:
        """Build a row dict for the metrics table.

        Args:
            entry: The registry entry to convert.

        Returns:
            Dict suitable for inserting into metrics table.
        """
        row: Dict[str, Any] = {
            "run_id": entry.run_id,
            "job_id": entry.experiment_id,
            "raw_metrics": entry.metrics,  # Store full metrics as JSONB
        }

        # Map known metrics to dedicated columns
        for metric, value in entry.metrics.items():
            if metric in self.METRICS_COLUMNS:
                row[metric] = self._convert_value(value)

        return row

    def _row_to_entry(self, row: Dict[str, Any]) -> RegistryEntry:
        """Convert a database row to RegistryEntry.

        Args:
            row: Dict from Supabase query result.

        Returns:
            RegistryEntry object.
        """
        # Extract parameters from runs table columns
        parameters: Dict[str, Any] = {}
        for param in self.RUNS_PARAM_COLUMNS:
            if param in row and row[param] is not None:
                parameters[param] = self._parse_value(row[param])

        # Extract metrics from nested metrics relation or raw_metrics
        metrics: Dict[str, Any] = {}
        metrics_data = row.get("metrics")

        if metrics_data:
            # metrics is a list from the join, take first item
            if isinstance(metrics_data, list) and metrics_data:
                metrics_row = metrics_data[0]
            else:
                metrics_row = metrics_data

            # Prefer raw_metrics if available (has all metrics)
            raw_metrics = metrics_row.get("raw_metrics")
            if raw_metrics and isinstance(raw_metrics, dict):
                metrics = raw_metrics
            else:
                # Fall back to individual columns
                for metric in self.METRICS_COLUMNS:
                    if metric in metrics_row and metrics_row[metric] is not None:
                        metrics[metric] = self._parse_value(metrics_row[metric])

        # Build artifact paths from modal_volume_path
        artifact_paths: Dict[str, str] = {}
        volume_path = row.get("modal_volume_path")
        if volume_path:
            # Reconstruct standard artifact paths
            artifact_paths["scenario_yaml"] = f"{volume_path}/scenario.yaml"
            artifact_paths["events_jsonl"] = f"{volume_path}/out/events.jsonl"
            artifact_paths["balances_csv"] = f"{volume_path}/out/balances.csv"
            artifact_paths["metrics_csv"] = f"{volume_path}/out/metrics.csv"
            artifact_paths["run_html"] = f"{volume_path}/run.html"

        return RegistryEntry(
            run_id=row["run_id"],
            experiment_id=row.get("job_id", ""),
            status=RunStatus(row.get("status", "completed")),
            parameters=parameters,
            metrics=metrics,
            artifact_paths=artifact_paths,
            error=row.get("error"),
        )

    @staticmethod
    def _convert_value(value: Any) -> Any:
        """Convert Python value for Supabase storage.

        Args:
            value: Value to convert.

        Returns:
            Converted value suitable for database storage.
        """
        if isinstance(value, Decimal):
            return float(value)
        if isinstance(value, bool):
            return value
        return value

    @staticmethod
    def _parse_value(value: Any) -> Any:
        """Parse database value to Python type.

        Args:
            value: Value from database.

        Returns:
            Parsed Python value.
        """
        if isinstance(value, str):
            # Try to parse as number
            try:
                if "." in value:
                    return float(value)
                return int(value)
            except ValueError:
                return value
        if isinstance(value, Decimal):
            return float(value)
        return value

```

---

### 📄 src/bilancio/ui/__init__.py

```python
"""User interface layer for Bilancio CLI."""

from .cli import main

__all__ = ["main"]
```

---

### 📄 src/bilancio/ui/cli/__init__.py

```python
"""Command-line interface for Bilancio."""

from __future__ import annotations

import click

from .run import run, validate, new, analyze
from .sweep import sweep
from .volume import volume
from .jobs import jobs


@click.group()
def cli():
    """Bilancio - Economic simulation framework."""
    pass


# Add all commands to the main CLI group
cli.add_command(run)
cli.add_command(validate)
cli.add_command(new)
cli.add_command(analyze)
cli.add_command(sweep)
cli.add_command(volume)
cli.add_command(jobs)


def main():
    """Main entry point for the CLI."""
    cli()


# Re-export for backwards compatibility
__all__ = ['cli', 'main']

```

---

### 📄 src/bilancio/ui/cli/jobs.py

```python
"""Job management CLI commands."""

from __future__ import annotations

from datetime import datetime
from pathlib import Path
from typing import Optional

import click


def format_datetime(dt: Optional[datetime]) -> str:
    """Format datetime for display."""
    if dt is None:
        return "-"
    return dt.strftime("%Y-%m-%d %H:%M")


def format_duration(start: datetime, end: Optional[datetime]) -> str:
    """Format duration between two datetimes."""
    if end is None:
        return "running"
    delta = end - start
    minutes = delta.total_seconds() / 60
    if minutes < 1:
        return f"{delta.total_seconds():.0f}s"
    if minutes < 60:
        return f"{minutes:.1f}m"
    return f"{minutes/60:.1f}h"


@click.group()
def jobs():
    """Query and manage simulation jobs."""
    pass


@jobs.command("ls")
@click.option(
    "--cloud", is_flag=True, help="Query from Supabase cloud storage"
)
@click.option(
    "--local",
    type=click.Path(exists=True, path_type=Path),
    help="Local directory containing job manifests",
)
@click.option(
    "--status",
    type=click.Choice(["pending", "running", "completed", "failed"]),
    help="Filter by job status",
)
@click.option("--limit", default=20, help="Maximum number of jobs to show")
def list_jobs(
    cloud: bool, local: Optional[Path], status: Optional[str], limit: int
):
    """List simulation jobs.

    By default, lists from Supabase if configured.

    Examples:
        bilancio jobs ls --cloud
        bilancio jobs ls --local out/experiments
        bilancio jobs ls --status completed --limit 10
    """
    jobs_list = []

    if cloud:
        # Query from Supabase
        try:
            from bilancio.jobs.supabase_store import SupabaseJobStore

            store = SupabaseJobStore()
            if store.client is None:
                raise click.ClickException(
                    "Supabase not configured. Set BILANCIO_SUPABASE_URL and "
                    "BILANCIO_SUPABASE_ANON_KEY environment variables."
                )
            jobs_list = store.list_jobs(status=status, limit=limit)
        except ImportError as e:
            raise click.ClickException(f"Failed to import Supabase: {e}")

    elif local:
        # Query from local filesystem
        from bilancio.jobs import JobManager

        manager = JobManager(jobs_dir=local)
        jobs_list = manager.list_jobs()

        # Apply filters
        if status:
            jobs_list = [j for j in jobs_list if j.status.value == status]

        # Sort by creation time (newest first) and limit
        jobs_list = sorted(jobs_list, key=lambda j: j.created_at, reverse=True)[
            :limit
        ]

    else:
        # Try Supabase first, fall back to error
        try:
            from bilancio.storage.supabase_client import is_supabase_configured

            if is_supabase_configured():
                from bilancio.jobs.supabase_store import SupabaseJobStore

                store = SupabaseJobStore()
                jobs_list = store.list_jobs(status=status, limit=limit)
            else:
                click.echo(
                    "No source specified. Use --cloud or --local <path>.\n"
                    "Tip: Set BILANCIO_SUPABASE_* env vars to use --cloud."
                )
                return
        except Exception as e:
            raise click.ClickException(f"Failed to query jobs: {e}")

    if not jobs_list:
        click.echo("No jobs found.")
        return

    # Display jobs
    click.echo(f"{'JOB ID':<36} {'STATUS':<10} {'CREATED':<16} {'DURATION':<10} {'RUNS':<6}")
    click.echo("-" * 80)

    for job in jobs_list:
        duration = format_duration(job.created_at, job.completed_at)
        runs = len(job.run_ids) if job.run_ids else 0
        click.echo(
            f"{job.job_id:<36} {job.status.value:<10} "
            f"{format_datetime(job.created_at):<16} {duration:<10} {runs:<6}"
        )

    click.echo("-" * 80)
    click.echo(f"Total: {len(jobs_list)} jobs")


@jobs.command("get")
@click.argument("job_id")
@click.option("--cloud", is_flag=True, help="Query from Supabase cloud storage")
@click.option(
    "--local",
    type=click.Path(exists=True, path_type=Path),
    help="Local directory containing job manifests",
)
def get_job(job_id: str, cloud: bool, local: Optional[Path]):
    """Get detailed information about a job.

    Examples:
        bilancio jobs get castle-river-mountain-forest
        bilancio jobs get castle-river-mountain-forest --cloud
    """
    job = None

    if cloud:
        try:
            from bilancio.jobs.supabase_store import SupabaseJobStore

            store = SupabaseJobStore()
            if store.client is None:
                raise click.ClickException("Supabase not configured.")
            job = store.get_job(job_id)
        except ImportError as e:
            raise click.ClickException(f"Failed to import Supabase: {e}")

    elif local:
        from bilancio.jobs import JobManager

        manager = JobManager(jobs_dir=local)
        job = manager.get_job(job_id)

    else:
        # Try Supabase first, then local
        try:
            from bilancio.storage.supabase_client import is_supabase_configured

            if is_supabase_configured():
                from bilancio.jobs.supabase_store import SupabaseJobStore

                store = SupabaseJobStore()
                job = store.get_job(job_id)
        except Exception:
            pass

        if job is None:
            # Try common local paths
            for path in [Path("out/experiments"), Path(".")]:
                if path.exists():
                    from bilancio.jobs import JobManager

                    manager = JobManager(jobs_dir=path)
                    job = manager.get_job(job_id)
                    if job:
                        break

    if job is None:
        raise click.ClickException(f"Job not found: {job_id}")

    # Display job details
    click.echo(f"Job ID:      {job.job_id}")
    click.echo(f"Status:      {job.status.value}")
    click.echo(f"Description: {job.description}")
    click.echo(f"Created:     {format_datetime(job.created_at)}")
    click.echo(f"Completed:   {format_datetime(job.completed_at)}")
    if job.error:
        click.echo(f"Error:       {job.error}")
    click.echo()

    # Configuration
    click.echo("Configuration:")
    config = job.config
    click.echo(f"  Sweep Type:    {config.sweep_type}")
    click.echo(f"  N Agents:      {config.n_agents}")
    click.echo(f"  Maturity Days: {config.maturity_days}")
    click.echo(f"  Kappas:        {', '.join(str(k) for k in config.kappas)}")
    click.echo(f"  Concentrations: {', '.join(str(c) for c in config.concentrations)}")
    click.echo(f"  Mus:           {', '.join(str(m) for m in config.mus)}")
    click.echo(f"  Cloud:         {config.cloud}")
    click.echo()

    # Runs
    if job.run_ids:
        click.echo(f"Runs ({len(job.run_ids)}):")
        for run_id in job.run_ids[:10]:  # Show first 10
            click.echo(f"  - {run_id}")
        if len(job.run_ids) > 10:
            click.echo(f"  ... and {len(job.run_ids) - 10} more")


@jobs.command("runs")
@click.argument("job_id")
@click.option("--cloud", is_flag=True, help="Query from Supabase cloud storage")
@click.option(
    "--status",
    type=click.Choice(["pending", "running", "completed", "failed"]),
    help="Filter by run status",
)
def list_runs(job_id: str, cloud: bool, status: Optional[str]):
    """List runs for a specific job.

    Examples:
        bilancio jobs runs castle-river-mountain-forest
        bilancio jobs runs castle-river-mountain-forest --cloud
    """
    if not cloud:
        click.echo("Note: Use --cloud to query runs from Supabase.")
        click.echo("Local run listing requires reading registry CSV files.")
        return

    try:
        from bilancio.storage.supabase_registry import SupabaseRegistryStore

        store = SupabaseRegistryStore()
        entries = store.query(job_id, {"status": status} if status else None)

        if not entries:
            click.echo(f"No runs found for job: {job_id}")
            return

        click.echo(f"{'RUN ID':<40} {'STATUS':<10} {'KAPPA':<8} {'CONC':<8} {'DELTA':<10}")
        click.echo("-" * 80)

        for entry in entries:
            kappa = entry.parameters.get("kappa", "-")
            conc = entry.parameters.get("concentration", "-")
            delta = entry.metrics.get("delta_total", "-")
            if isinstance(delta, float):
                delta = f"{delta:.4f}"
            click.echo(
                f"{entry.run_id:<40} {entry.status.value:<10} "
                f"{kappa:<8} {conc:<8} {delta:<10}"
            )

        click.echo("-" * 80)
        click.echo(f"Total: {len(entries)} runs")

    except Exception as e:
        raise click.ClickException(f"Failed to query runs: {e}")


@jobs.command("metrics")
@click.argument("job_id")
@click.option("--cloud", is_flag=True, help="Query from Supabase cloud storage")
def show_metrics(job_id: str, cloud: bool):
    """Show aggregate metrics for a job.

    Examples:
        bilancio jobs metrics castle-river-mountain-forest --cloud
    """
    if not cloud:
        click.echo("Use --cloud to query metrics from Supabase.")
        return

    try:
        from bilancio.storage.supabase_registry import SupabaseRegistryStore

        store = SupabaseRegistryStore()
        entries = store.query(job_id)

        if not entries:
            click.echo(f"No runs found for job: {job_id}")
            return

        # Calculate aggregate metrics
        completed = [e for e in entries if e.status.value == "completed"]

        if not completed:
            click.echo("No completed runs to show metrics for.")
            return

        # Collect delta values
        deltas = [
            e.metrics.get("delta_total", 0) for e in completed if "delta_total" in e.metrics
        ]
        phis = [
            e.metrics.get("phi_total", 0) for e in completed if "phi_total" in e.metrics
        ]

        click.echo(f"Job: {job_id}")
        click.echo(f"Completed runs: {len(completed)} / {len(entries)}")
        click.echo()

        if deltas:
            click.echo("Delta (default rate):")
            click.echo(f"  Mean:   {sum(deltas)/len(deltas):.4f}")
            click.echo(f"  Min:    {min(deltas):.4f}")
            click.echo(f"  Max:    {max(deltas):.4f}")

        if phis:
            click.echo("Phi (clearing rate):")
            click.echo(f"  Mean:   {sum(phis)/len(phis):.4f}")
            click.echo(f"  Min:    {min(phis):.4f}")
            click.echo(f"  Max:    {max(phis):.4f}")

    except Exception as e:
        raise click.ClickException(f"Failed to query metrics: {e}")

```

---

### 📄 src/bilancio/ui/cli/run.py

```python
"""CLI commands for running and analyzing scenarios."""

from __future__ import annotations

import sys
from pathlib import Path
from typing import Optional

import click
from rich.console import Console
from rich.panel import Panel

from bilancio.analysis.loaders import read_events_jsonl, read_balances_csv
from bilancio.analysis.report import (
    write_day_metrics_csv,
    write_day_metrics_json,
    write_debtor_shares_csv,
    write_intraday_csv,
    write_metrics_html,
    compute_day_metrics,
    parse_day_ranges,
)
from bilancio.ui.run import run_scenario
from bilancio.ui.wizard import create_scenario_wizard


console = Console()


@click.command()
@click.argument('scenario_file', type=click.Path(exists=True, path_type=Path))
@click.option('--mode', type=click.Choice(['step', 'until-stable']),
              default='until-stable', help='Simulation run mode')
@click.option('--max-days', type=int, default=90,
              help='Maximum days to simulate')
@click.option('--quiet-days', type=int, default=2,
              help='Required quiet days for stable state')
@click.option('--show', type=click.Choice(['summary', 'detailed', 'table']),
              default='detailed', help='Event display mode')
@click.option('--agents', type=str, default=None,
              help='Comma-separated list of agent IDs to show balances for')
@click.option('--check-invariants',
              type=click.Choice(['setup', 'daily', 'none']),
              default='setup',
              help='When to check system invariants')
@click.option('--export-balances', type=click.Path(path_type=Path),
              default=None, help='Path to export balances CSV')
@click.option('--export-events', type=click.Path(path_type=Path),
              default=None, help='Path to export events JSONL')
@click.option('--html', type=click.Path(path_type=Path),
              default=None, help='Path to export colored output as HTML')
@click.option('--t-account/--no-t-account', default=False, help='Use detailed T-account layout for balances')
@click.option('--default-handling', type=click.Choice(['fail-fast', 'expel-agent']),
              default=None, help='Default-handling mode (override scenario setting)')
def run(scenario_file: Path,
        mode: str,
        max_days: int,
        quiet_days: int,
        show: str,
        agents: Optional[str],
        check_invariants: str,
        export_balances: Optional[Path],
        export_events: Optional[Path],
        html: Optional[Path],
        t_account: bool,
        default_handling: Optional[str]):
    """Run a Bilancio simulation scenario.

    Load a scenario from a YAML file and run the simulation either
    step-by-step or until a stable state is reached.
    """
    try:
        # Parse agent list if provided
        agent_ids = None
        if agents:
            agent_ids = [a.strip() for a in agents.split(',')]

        # Override export paths if provided via CLI
        export = {
            'balances_csv': str(export_balances) if export_balances else None,
            'events_jsonl': str(export_events) if export_events else None
        }

        # Run the scenario
        run_scenario(
            path=scenario_file,
            mode=mode,
            max_days=max_days,
            quiet_days=quiet_days,
            show=show,
            agent_ids=agent_ids,
            check_invariants=check_invariants,
            export=export,
            html_output=html,
            t_account=t_account,
            default_handling=default_handling
        )

    except FileNotFoundError as e:
        console.print(Panel(
            f"[red]File not found:[/red] {e}",
            title="Error",
            border_style="red"
        ))
        sys.exit(1)

    except ValueError as e:
        console.print(Panel(
            f"[red]Configuration error:[/red]\n{e}",
            title="Error",
            border_style="red"
        ))
        sys.exit(1)

    except Exception as e:
        console.print(Panel(
            f"[red]Unexpected error:[/red]\n{e}",
            title="Error",
            border_style="red"
        ))
        if '--debug' in sys.argv:
            raise
        sys.exit(1)


@click.command()
@click.argument('scenario_file', type=click.Path(exists=True, path_type=Path))
def validate(scenario_file: Path):
    """Validate a Bilancio scenario configuration file.

    Check that a YAML configuration file is valid without running
    the simulation. Reports any errors in the configuration structure,
    agent definitions, or initial actions.
    """
    try:
        from bilancio.config import load_yaml
        from bilancio.engines.system import System
        from bilancio.config import apply_to_system

        # Load and parse the configuration
        console.print(f"[dim]Validating {scenario_file}...[/dim]")
        config = load_yaml(scenario_file)

        console.print(f"[green]✓[/green] Configuration syntax is valid")
        console.print(f"  Name: {config.name}")
        console.print(f"  Version: {config.version}")
        console.print(f"  Agents: {len(config.agents)}")
        console.print(f"  Initial actions: {len(config.initial_actions)}")

        # Try to apply to a test system to validate actions
        console.print("[dim]Checking if configuration can be applied...[/dim]")
        test_system = System()
        apply_to_system(config, test_system)

        console.print(f"[green]✓[/green] Configuration can be applied successfully")

        # Run invariant checks
        test_system.assert_invariants()
        console.print(f"[green]✓[/green] System invariants pass")

        # Summary
        console.print("\n[bold green]Configuration is valid![/bold green]")
        console.print(f"\nAgents defined:")
        for agent in config.agents:
            console.print(f"  • {agent.id} ({agent.kind}): {agent.name}")

        if config.run.export.balances_csv or config.run.export.events_jsonl:
            console.print(f"\nExports configured:")
            if config.run.export.balances_csv:
                console.print(f"  • Balances: {config.run.export.balances_csv}")
            if config.run.export.events_jsonl:
                console.print(f"  • Events: {config.run.export.events_jsonl}")

    except FileNotFoundError as e:
        console.print(Panel(
            f"[red]File not found:[/red] {e}",
            title="Error",
            border_style="red"
        ))
        sys.exit(1)

    except ValueError as e:
        console.print(Panel(
            f"[red]Configuration error:[/red]\n{e}",
            title="Validation Failed",
            border_style="red"
        ))
        sys.exit(1)

    except Exception as e:
        console.print(Panel(
            f"[red]Validation error:[/red]\n{e}",
            title="Validation Failed",
            border_style="red"
        ))
        if '--debug' in sys.argv:
            raise
        sys.exit(1)


@click.command()
@click.option('--from', 'from_template', type=str, default=None,
              help='Base template to use')
@click.option('-o', '--output', type=click.Path(path_type=Path),
              required=True, help='Output YAML file path')
def new(from_template: Optional[str], output: Path):
    """Create a new scenario configuration.

    Interactive wizard to create a new Bilancio scenario
    configuration file.
    """
    try:
        create_scenario_wizard(output, from_template)
        console.print(f"[green]✓[/green] Created scenario file: {output}")

    except Exception as e:
        console.print(Panel(
            f"[red]Failed to create scenario:[/red]\n{e}",
            title="Error",
            border_style="red"
        ))
        sys.exit(1)


@click.command()
@click.option('--events', 'events_path', type=click.Path(exists=True, path_type=Path), required=True,
              help='Path to events JSONL exported by a run')
@click.option('--balances', 'balances_path', type=click.Path(exists=False, path_type=Path), required=False,
              help='Path to balances CSV (optional, improves G_t/M_t)')
@click.option('--days', type=str, default=None,
              help='Days to analyze, e.g. "1,2-3". Default: infer from events')
@click.option('--out-csv', 'out_csv', type=click.Path(path_type=Path), default=None,
              help='Output CSV for day-level metrics')
@click.option('--out-json', 'out_json', type=click.Path(path_type=Path), default=None,
              help='Output JSON for day-level metrics')
@click.option('--intraday-csv', 'intraday_csv', type=click.Path(path_type=Path), default=None,
              help='Optional CSV for intraday P_prefix steps')
@click.option('--html', 'html_out', type=click.Path(path_type=Path), default=None,
              help='Optional HTML analytics report')
def analyze(
    events_path: Path,
    balances_path: Optional[Path],
    days: Optional[str],
    out_csv: Optional[Path],
    out_json: Optional[Path],
    intraday_csv: Optional[Path],
    html_out: Optional[Path],
):
    """Analyze a completed run and export Kalecki-style metrics.

    Produces a day-level metrics CSV/JSON, optional intraday CSV (diagnostic).
    """
    # Load inputs
    console.print(f"[dim]Reading events from {events_path}...[/dim]")
    events = list(read_events_jsonl(events_path))

    balances_rows = None
    if balances_path and balances_path.exists():
        console.print(f"[dim]Reading balances from {balances_path}...[/dim]")
        balances_rows = read_balances_csv(balances_path)

    day_list = parse_day_ranges(days) if days else None

    bundle = compute_day_metrics(events, balances_rows, day_list)

    if not bundle["day_metrics"]:
        console.print("[yellow]No days found to analyze.[/yellow]")
        return

    # Determine default output paths if not provided
    base = events_path.stem.replace("_events", "") or "metrics"
    out_dir = events_path.parent
    if not out_csv:
        out_csv = out_dir / f"{base}_metrics_day.csv"
    if not out_json:
        out_json = out_dir / f"{base}_metrics_day.json"
    if intraday_csv:
        intraday_csv.parent.mkdir(parents=True, exist_ok=True)

    # Write outputs
    metrics_rows = bundle["day_metrics"]
    ds_rows = bundle["debtor_shares"]
    intraday_rows = bundle["intraday"]

    write_day_metrics_csv(out_csv, metrics_rows)
    console.print(f"[green]✓[/green] Wrote day metrics CSV: {out_csv}")
    write_day_metrics_json(out_json, metrics_rows)
    console.print(f"[green]✓[/green] Wrote day metrics JSON: {out_json}")

    # Debtor shares and intraday are optional; only write if path provided
    base_name = out_csv.stem.replace("_metrics_day", "") if out_csv else "metrics"
    ds_path = out_csv.parent / f"{base_name}_ds.csv"
    write_debtor_shares_csv(ds_path, ds_rows)
    console.print(f"[green]✓[/green] Wrote debtor shares CSV: {ds_path}")

    if intraday_csv:
        write_intraday_csv(intraday_csv, intraday_rows)
        console.print(f"[green]✓[/green] Wrote intraday CSV: {intraday_csv}")

    if html_out:
        title = f"Bilancio Analytics — {events_path.stem.replace('_events','')}"
        subtitle = f"Events: {events_path.name}{' | Balances: ' + balances_path.name if balances_path else ''}"
        write_metrics_html(html_out, metrics_rows, ds_rows, intraday_rows, title=title, subtitle=subtitle)
        console.print(f"[green]✓[/green] Wrote HTML analytics: {html_out}")

```

---

### 📄 src/bilancio/ui/cli/sweep.py

```python
"""CLI commands for running experiment sweeps."""

from __future__ import annotations

from datetime import datetime
from decimal import Decimal
from pathlib import Path
from typing import Optional

import click
from click.core import ParameterSource

from bilancio.analysis.report import aggregate_runs, render_dashboard
from bilancio.experiments.ring import (
    RingSweepRunner,
    RingSweepConfig,
    load_ring_sweep_config,
    _decimal_list,
)
from bilancio.jobs import JobManager, JobConfig, generate_job_id

from .utils import console, _as_decimal_list


@click.group()
def sweep():
    """Experiment sweeps."""
    pass


@sweep.command("ring")
@click.option('--config', type=click.Path(path_type=Path), default=None, help='Path to sweep config YAML')
@click.option('--out-dir', type=click.Path(path_type=Path), default=None, help='Base output directory')
@click.option('--cloud', is_flag=True, help='Run simulations on Modal cloud')
@click.option('--grid/--no-grid', default=True, help='Run coarse grid sweep')
@click.option('--kappas', type=str, default="0.25,0.5,1,2,4", help='Comma list for grid kappa values')
@click.option('--concentrations', type=str, default="0.2,0.5,1,2,5", help='Comma list for grid Dirichlet concentrations')
@click.option('--mus', type=str, default="0,0.25,0.5,0.75,1", help='Comma list for grid mu values')
@click.option('--monotonicities', type=str, default="0", help='Comma list for grid monotonicity values')
@click.option('--lhs', 'lhs_count', type=int, default=0, help='Latin Hypercube samples to draw')
@click.option('--kappa-min', type=float, default=0.2, help='LHS min kappa')
@click.option('--kappa-max', type=float, default=5.0, help='LHS max kappa')
@click.option('--c-min', type=float, default=0.2, help='LHS min concentration')
@click.option('--c-max', type=float, default=5.0, help='LHS max concentration')
@click.option('--mu-min', type=float, default=0.0, help='LHS min mu')
@click.option('--mu-max', type=float, default=1.0, help='LHS max mu')
@click.option('--monotonicity-min', type=float, default=0.0, help='LHS min monotonicity')
@click.option('--monotonicity-max', type=float, default=0.0, help='LHS max monotonicity')
@click.option('--frontier/--no-frontier', default=False, help='Run frontier search')
@click.option('--frontier-low', type=float, default=0.1, help='Frontier lower bound for kappa')
@click.option('--frontier-high', type=float, default=4.0, help='Initial frontier upper bound for kappa')
@click.option('--frontier-tolerance', type=float, default=0.02, help='Frontier tolerance on delta_total')
@click.option('--frontier-iterations', type=int, default=6, help='Max bisection iterations per cell')
@click.option('--n-agents', type=int, default=5, help='Ring size')
@click.option('--maturity-days', type=int, default=3, help='Due day horizon for generator')
@click.option('--q-total', type=float, default=500.0, help='Total dues S1 for generation')
@click.option('--liquidity-mode', type=click.Choice(['single_at', 'uniform']), default='single_at', help='Liquidity allocation mode')
@click.option('--liquidity-agent', type=str, default='H1', help='Target for single_at liquidity allocation')
@click.option('--base-seed', type=int, default=42, help='Base PRNG seed')
@click.option('--name-prefix', type=str, default='Kalecki Ring Sweep', help='Scenario name prefix')
@click.option('--default-handling', type=click.Choice(['fail-fast', 'expel-agent']), default='fail-fast', help='Default handling mode for runs')
@click.option('--job-id', type=str, default=None, help='Job ID (auto-generated if not provided)')
@click.pass_context
def sweep_ring(
    ctx,
    config: Optional[Path],
    out_dir: Optional[Path],
    cloud: bool,
    grid: bool,
    kappas: str,
    concentrations: str,
    mus: str,
    monotonicities: str,
    lhs_count: int,
    kappa_min: float,
    kappa_max: float,
    c_min: float,
    c_max: float,
    mu_min: float,
    mu_max: float,
    monotonicity_min: float,
    monotonicity_max: float,
    frontier: bool,
    frontier_low: float,
    frontier_high: float,
    frontier_tolerance: float,
    frontier_iterations: int,
    n_agents: int,
    maturity_days: int,
    q_total: float,
    liquidity_mode: str,
    liquidity_agent: str,
    base_seed: int,
    name_prefix: str,
    default_handling: str,
    job_id: Optional[str],
):
    """Run the Kalecki ring experiment sweep."""
    sweep_config: Optional[RingSweepConfig] = None
    if config is not None:
        sweep_config = load_ring_sweep_config(config)

    def _using_default(param_name: str) -> bool:
        source = ctx.get_parameter_source(param_name)
        return source in (ParameterSource.DEFAULT, ParameterSource.DEFAULT_MAP)

    if sweep_config is not None and sweep_config.out_dir and _using_default("out_dir"):
        out_dir = Path(sweep_config.out_dir)

    dealer_enabled = False
    dealer_config = None
    if sweep_config is not None and sweep_config.runner is not None:
        runner_cfg = sweep_config.runner
        if runner_cfg.n_agents is not None and _using_default("n_agents"):
            n_agents = runner_cfg.n_agents
        if runner_cfg.maturity_days is not None and _using_default("maturity_days"):
            maturity_days = runner_cfg.maturity_days
        if runner_cfg.q_total is not None and _using_default("q_total"):
            q_total = float(runner_cfg.q_total)
        if runner_cfg.liquidity_mode is not None and _using_default("liquidity_mode"):
            liquidity_mode = runner_cfg.liquidity_mode
        if runner_cfg.liquidity_agent is not None and _using_default("liquidity_agent"):
            liquidity_agent = runner_cfg.liquidity_agent
        if runner_cfg.base_seed is not None and _using_default("base_seed"):
            base_seed = runner_cfg.base_seed
        if runner_cfg.name_prefix is not None and _using_default("name_prefix"):
            name_prefix = runner_cfg.name_prefix
        if runner_cfg.default_handling is not None and _using_default("default_handling"):
            default_handling = runner_cfg.default_handling
        dealer_enabled = runner_cfg.dealer_enabled
        dealer_config = runner_cfg.dealer_config

    if sweep_config is not None and sweep_config.grid is not None:
        grid_cfg = sweep_config.grid
        if _using_default("grid"):
            grid = grid_cfg.enabled
        if grid_cfg.kappas and _using_default("kappas"):
            kappas = grid_cfg.kappas
        if grid_cfg.concentrations and _using_default("concentrations"):
            concentrations = grid_cfg.concentrations
        if grid_cfg.mus and _using_default("mus"):
            mus = grid_cfg.mus
        if grid_cfg.monotonicities and _using_default("monotonicities"):
            monotonicities = grid_cfg.monotonicities

    if sweep_config is not None and sweep_config.lhs is not None:
        lhs_cfg = sweep_config.lhs
        if _using_default("lhs_count"):
            lhs_count = lhs_cfg.count
        if lhs_cfg.kappa_range is not None:
            if _using_default("kappa_min"):
                kappa_min = float(lhs_cfg.kappa_range[0])
            if _using_default("kappa_max"):
                kappa_max = float(lhs_cfg.kappa_range[1])
        if lhs_cfg.concentration_range is not None:
            if _using_default("c_min"):
                c_min = float(lhs_cfg.concentration_range[0])
            if _using_default("c_max"):
                c_max = float(lhs_cfg.concentration_range[1])
        if lhs_cfg.mu_range is not None:
            if _using_default("mu_min"):
                mu_min = float(lhs_cfg.mu_range[0])
            if _using_default("mu_max"):
                mu_max = float(lhs_cfg.mu_range[1])
        if lhs_cfg.monotonicity_range is not None:
            if _using_default("monotonicity_min"):
                monotonicity_min = float(lhs_cfg.monotonicity_range[0])
            if _using_default("monotonicity_max"):
                monotonicity_max = float(lhs_cfg.monotonicity_range[1])

    if sweep_config is not None and sweep_config.frontier is not None:
        frontier_cfg = sweep_config.frontier
        if _using_default("frontier"):
            frontier = frontier_cfg.enabled
        if frontier_cfg.enabled:
            if frontier_cfg.kappa_low is not None and _using_default("frontier_low"):
                frontier_low = float(frontier_cfg.kappa_low)
            if frontier_cfg.kappa_high is not None and _using_default("frontier_high"):
                frontier_high = float(frontier_cfg.kappa_high)
            if frontier_cfg.tolerance is not None and _using_default("frontier_tolerance"):
                frontier_tolerance = float(frontier_cfg.tolerance)
            if frontier_cfg.max_iterations is not None and _using_default("frontier_iterations"):
                frontier_iterations = frontier_cfg.max_iterations

    if out_dir is not None and not isinstance(out_dir, Path):
        out_dir = Path(out_dir)

    if out_dir is None:
        ts = datetime.now().strftime("%Y%m%d_%H%M%S")
        out_dir = Path("out") / "experiments" / f"{ts}_ring"

    out_dir.mkdir(parents=True, exist_ok=True)

    # Generate job ID if not provided
    if job_id is None:
        job_id = generate_job_id()

    # Create job manager and job config
    manager: Optional[JobManager] = None
    try:
        manager = JobManager(jobs_dir=out_dir)

        grid_kappas = _as_decimal_list(kappas)
        grid_concentrations = _as_decimal_list(concentrations)
        grid_mus = _as_decimal_list(mus)

        job_config = JobConfig(
            sweep_type="ring",
            n_agents=n_agents,
            kappas=grid_kappas,
            concentrations=grid_concentrations,
            mus=grid_mus,
            cloud=cloud,
            maturity_days=maturity_days,
            seeds=[base_seed],
        )

        job = manager.create_job(
            description=f"Ring sweep (n={n_agents}, cloud={cloud})",
            config=job_config,
            job_id=job_id,
        )

        console.print(f"[cyan]Job ID: {job.job_id}[/cyan]")
        manager.start_job(job.job_id)
    except Exception as e:
        console.print(f"[yellow]Warning: Job tracking initialization failed: {e}[/yellow]")
        manager = None

    # Create executor based on --cloud flag
    executor = None
    if cloud:
        from bilancio.runners import CloudExecutor

        executor = CloudExecutor(
            experiment_id=job_id,  # Use job_id as experiment_id for simplicity
            download_artifacts=False,
            local_output_dir=out_dir,
            job_id=job_id,
        )
        console.print(f"[cyan]Cloud execution enabled[/cyan]")

    q_total_dec = Decimal(str(q_total))
    runner = RingSweepRunner(
        out_dir,
        name_prefix=name_prefix,
        n_agents=n_agents,
        maturity_days=maturity_days,
        Q_total=q_total_dec,
        liquidity_mode=liquidity_mode,
        liquidity_agent=liquidity_agent,
        base_seed=base_seed,
        default_handling=default_handling,
        dealer_enabled=dealer_enabled,
        dealer_config=dealer_config,
        executor=executor,
    )

    console.print(f"[dim]Output directory: {out_dir}[/dim]")

    grid_kappas = _as_decimal_list(kappas)
    grid_concentrations = _as_decimal_list(concentrations)
    grid_mus = _as_decimal_list(mus)
    grid_monotonicities = _as_decimal_list(monotonicities)

    try:
        if grid:
            total_runs = len(grid_kappas) * len(grid_concentrations) * len(grid_mus) * len(grid_monotonicities)
            console.print(f"[dim]Running grid sweep: {total_runs} runs[/dim]")
            runner.run_grid(grid_kappas, grid_concentrations, grid_mus, grid_monotonicities)

        if lhs_count > 0:
            console.print(f"[dim]Running Latin Hypercube ({lhs_count})[/dim]")
            runner.run_lhs(
                lhs_count,
                kappa_range=(Decimal(str(kappa_min)), Decimal(str(kappa_max))),
                concentration_range=(Decimal(str(c_min)), Decimal(str(c_max))),
                mu_range=(Decimal(str(mu_min)), Decimal(str(mu_max))),
                monotonicity_range=(Decimal(str(monotonicity_min)), Decimal(str(monotonicity_max))),
            )

        if frontier:
            console.print(f"[dim]Running frontier search across {len(grid_concentrations) * len(grid_mus) * len(grid_monotonicities)} cells[/dim]")
            runner.run_frontier(
                grid_concentrations,
                grid_mus,
                grid_monotonicities,
                kappa_low=Decimal(str(frontier_low)),
                kappa_high=Decimal(str(frontier_high)),
                tolerance=Decimal(str(frontier_tolerance)),
                max_iterations=frontier_iterations,
            )

        registry_csv = runner.registry_dir / "experiments.csv"
        results_csv = runner.aggregate_dir / "results.csv"
        dashboard_html = runner.aggregate_dir / "dashboard.html"

        aggregate_runs(registry_csv, results_csv)
        render_dashboard(results_csv, dashboard_html)

        # Complete job
        if manager is not None:
            try:
                manager.complete_job(job_id, {
                    "grid_runs": total_runs if grid else 0,
                    "lhs_runs": lhs_count,
                    "frontier": frontier,
                })
            except Exception as e:
                console.print(f"[yellow]Warning: Failed to complete job tracking: {e}[/yellow]")

        console.print(f"[green]Sweep complete.[/green] Registry: {registry_csv}")
        console.print(f"[green]Aggregated results: {results_csv}")
        console.print(f"[green]Dashboard: {dashboard_html}")

    except Exception as e:
        # Fail job on error
        if manager is not None:
            try:
                manager.fail_job(job_id, str(e))
            except Exception:
                pass  # Don't let job tracking failure mask the original error
        raise


@sweep.command("comparison")
@click.option('--out-dir', type=click.Path(path_type=Path), required=True, help='Output directory for results')
@click.option('--n-agents', type=int, default=100, help='Ring size (default: 100)')
@click.option('--maturity-days', type=int, default=10, help='Maturity horizon in days (default: 10)')
@click.option('--q-total', type=float, default=10000.0, help='Total debt amount (default: 10000)')
@click.option('--kappas', type=str, default="0.25,0.5,1,2,4", help='Comma list for kappa values')
@click.option('--concentrations', type=str, default="0.2,0.5,1,2,5", help='Comma list for Dirichlet concentrations')
@click.option('--mus', type=str, default="0,0.25,0.5,0.75,1", help='Comma list for mu values')
@click.option('--monotonicities', type=str, default="0", help='Comma list for monotonicity values')
@click.option('--base-seed', type=int, default=42, help='Base PRNG seed')
@click.option('--default-handling', type=click.Choice(['fail-fast', 'expel-agent']), default='fail-fast', help='Default handling mode')
@click.option('--dealer-ticket-size', type=float, default=1.0, help='Ticket size for dealer')
@click.option('--dealer-share', type=float, default=0.25, help='Dealer capital as fraction of system cash (NEW outside money)')
@click.option('--vbt-share', type=float, default=0.50, help='VBT capital as fraction of system cash (NEW outside money)')
@click.option('--liquidity-mode', type=click.Choice(['single_at', 'uniform']), default='uniform', help='Liquidity allocation mode')
@click.option('--liquidity-agent', type=str, default=None, help='Target agent for single_at mode')
@click.option('--name-prefix', type=str, default='Dealer Comparison', help='Scenario name prefix')
def sweep_comparison(
    out_dir: Path,
    n_agents: int,
    maturity_days: int,
    q_total: float,
    kappas: str,
    concentrations: str,
    mus: str,
    monotonicities: str,
    base_seed: int,
    default_handling: str,
    dealer_ticket_size: float,
    dealer_share: float,
    vbt_share: float,
    liquidity_mode: str,
    liquidity_agent: Optional[str],
    name_prefix: str,
):
    """
    Run dealer comparison experiments.

    For each parameter combination (κ, c, μ), runs:
    1. Control: No dealer (baseline)
    2. Treatment: With dealer

    Outputs comparison metrics showing the delta in defaults between conditions.
    """
    import logging
    logging.basicConfig(level=logging.INFO, format='%(message)s')

    # Deferred import to avoid circular import
    from bilancio.experiments.comparison import ComparisonSweepRunner, ComparisonSweepConfig

    out_dir = Path(out_dir)
    out_dir.mkdir(parents=True, exist_ok=True)

    grid_kappas = _as_decimal_list(kappas)
    grid_concentrations = _as_decimal_list(concentrations)
    grid_mus = _as_decimal_list(mus)
    grid_monotonicities = _as_decimal_list(monotonicities)

    total_pairs = len(grid_kappas) * len(grid_concentrations) * len(grid_mus) * len(grid_monotonicities)
    console.print(f"[dim]Output directory: {out_dir}[/dim]")
    console.print(f"[dim]Running comparison sweep: {total_pairs} parameter combinations × 2 conditions = {total_pairs * 2} runs[/dim]")

    config = ComparisonSweepConfig(
        n_agents=n_agents,
        maturity_days=maturity_days,
        Q_total=Decimal(str(q_total)),
        kappas=grid_kappas,
        concentrations=grid_concentrations,
        mus=grid_mus,
        monotonicities=grid_monotonicities,
        base_seed=base_seed,
        default_handling=default_handling,
        dealer_ticket_size=Decimal(str(dealer_ticket_size)),
        dealer_share=Decimal(str(dealer_share)),
        vbt_share=Decimal(str(vbt_share)),
        liquidity_mode=liquidity_mode,
        liquidity_agent=liquidity_agent,
        name_prefix=name_prefix,
    )

    runner = ComparisonSweepRunner(config, out_dir)
    results = runner.run_all()

    # Summary
    completed = [r for r in results if r.delta_reduction is not None]
    if completed:
        mean_relief = sum(float(r.relief_ratio or 0) for r in completed) / len(completed)
        improved = sum(1 for r in completed if r.delta_reduction and r.delta_reduction > 0)
        console.print(f"\n[green]Comparison sweep complete.[/green]")
        console.print(f"  Pairs completed: {len(completed)}/{len(results)}")
        console.print(f"  Mean relief ratio: {mean_relief:.1%}")
        console.print(f"  Pairs with improvement: {improved}")
    else:
        console.print(f"\n[yellow]Comparison sweep complete but no pairs completed successfully.[/yellow]")

    console.print(f"\n[green]Results:[/green]")
    console.print(f"  Comparison CSV: {runner.comparison_path}")
    console.print(f"  Summary JSON: {runner.summary_path}")
    console.print(f"  Control registry: {runner.control_dir / 'registry' / 'experiments.csv'}")
    console.print(f"  Treatment registry: {runner.treatment_dir / 'registry' / 'experiments.csv'}")


@sweep.command("balanced")
@click.option(
    "--out-dir",
    type=click.Path(path_type=Path),
    required=True,
    help="Output directory for results",
)
@click.option("--n-agents", type=int, default=100, help="Number of agents in ring")
@click.option("--maturity-days", type=int, default=10, help="Maturity horizon")
@click.option("--q-total", type=Decimal, default=Decimal("10000"), help="Total debt")
@click.option("--base-seed", type=int, default=42, help="Base random seed")
@click.option(
    "--kappas",
    type=str,
    default="0.25,0.5,1,2,4",
    help="Comma-separated kappa values",
)
@click.option(
    "--concentrations",
    type=str,
    default="0.2,0.5,1,2,5",
    help="Comma-separated concentration values",
)
@click.option(
    "--mus",
    type=str,
    default="0,0.25,0.5,0.75,1",
    help="Comma-separated mu values",
)
@click.option(
    "--face-value",
    type=Decimal,
    default=Decimal("20"),
    help="Face value S (cashflow at maturity)",
)
@click.option(
    "--outside-mid-ratios",
    type=str,
    default="1.0,0.9,0.8,0.75,0.5",
    help="Comma-separated M/S ratios to sweep",
)
@click.option(
    "--big-entity-share",
    type=Decimal,
    default=Decimal("0.25"),
    help="Fraction of debt held by big entities (β)",
)
@click.option(
    "--default-handling",
    type=click.Choice(["fail-fast", "expel-agent"]),
    default="fail-fast",
    help="Default handling mode",
)
@click.option(
    "--detailed-logging/--no-detailed-logging",
    default=True,
    help="Enable detailed CSV logging (trades.csv, repayment_events.csv, etc.)",
)
@click.option('--cloud', is_flag=True, help='Run simulations on Modal cloud')
@click.option('--job-id', type=str, default=None, help='Job ID (auto-generated if not provided)')
@click.option(
    '--quiet/--verbose',
    default=True,
    help='Suppress verbose console output during sweeps (default: quiet)',
)
def sweep_balanced(
    out_dir: Path,
    n_agents: int,
    maturity_days: int,
    q_total: Decimal,
    base_seed: int,
    kappas: str,
    concentrations: str,
    mus: str,
    face_value: Decimal,
    outside_mid_ratios: str,
    big_entity_share: Decimal,
    default_handling: str,
    detailed_logging: bool,
    cloud: bool,
    job_id: Optional[str],
    quiet: bool,
) -> None:
    """
    Run balanced C vs D comparison experiments.

    Compares passive holders (C) against active dealers (D) with
    identical starting balance sheets. Each pair runs the same scenario
    twice: once with trading disabled (passive) and once with trading
    enabled (active).

    Output:
      - passive/: All passive holder runs
      - active/: All active dealer runs
      - aggregate/comparison.csv: C vs D metrics
      - aggregate/summary.json: Aggregate statistics
    """
    from bilancio.experiments.ring import _decimal_list
    from bilancio.experiments.balanced_comparison import (
        BalancedComparisonConfig,
        BalancedComparisonRunner,
    )

    out_dir = Path(out_dir)

    # Generate job ID if not provided
    if job_id is None:
        job_id = generate_job_id()

    # Create job manager
    manager: Optional[JobManager] = None
    try:
        manager = JobManager(jobs_dir=out_dir)

        # Create job config
        job_config = JobConfig(
            sweep_type="balanced",
            n_agents=n_agents,
            kappas=_decimal_list(kappas),
            concentrations=_decimal_list(concentrations),
            mus=_decimal_list(mus),
            cloud=cloud,
            outside_mid_ratios=_decimal_list(outside_mid_ratios),
            maturity_days=maturity_days,
            seeds=[base_seed],
        )

        # Create and start job
        job = manager.create_job(
            description=f"Balanced comparison sweep (n={n_agents}, cloud={cloud})",
            config=job_config,
            job_id=job_id,
        )

        click.echo(f"Job ID: {job.job_id}")
        manager.start_job(job.job_id)
    except Exception as e:
        click.echo(f"Warning: Job tracking initialization failed: {e}")
        manager = None

    # Create executor (Plan 028)
    executor = None
    if cloud:
        from bilancio.runners import CloudExecutor
        executor = CloudExecutor(
            experiment_id=job_id,  # Use job_id as experiment_id for simplicity
            download_artifacts=False,
            local_output_dir=out_dir,
            job_id=job_id,
        )
        click.echo(f"Cloud execution enabled")

    config = BalancedComparisonConfig(
        n_agents=n_agents,
        maturity_days=maturity_days,
        Q_total=q_total,
        base_seed=base_seed,
        kappas=_decimal_list(kappas),
        concentrations=_decimal_list(concentrations),
        mus=_decimal_list(mus),
        face_value=face_value,
        outside_mid_ratios=_decimal_list(outside_mid_ratios),
        big_entity_share=big_entity_share,
        default_handling=default_handling,
        detailed_logging=detailed_logging,
        quiet=quiet,  # Plan 030
    )

    runner = BalancedComparisonRunner(config, out_dir, executor=executor)

    try:
        results = runner.run_all()

        # Record run IDs from results
        if manager is not None:
            try:
                for r in results:
                    if r.passive_run_id:
                        manager.record_progress(
                            job_id, r.passive_run_id,
                            modal_call_id=r.passive_modal_call_id
                        )
                    if r.active_run_id:
                        manager.record_progress(
                            job_id, r.active_run_id,
                            modal_call_id=r.active_modal_call_id
                        )
            except Exception as e:
                click.echo(f"Warning: Failed to record run progress: {e}")

        # Print summary
        completed = sum(1 for r in results if r.trading_effect is not None)
        improved = sum(1 for r in results if r.trading_effect and r.trading_effect > 0)

        # Complete job with summary
        if manager is not None:
            try:
                manager.complete_job(job_id, {
                    "total_pairs": len(results),
                    "completed": completed,
                    "improved_with_trading": improved,
                })
            except Exception as e:
                click.echo(f"Warning: Failed to complete job tracking: {e}")

        click.echo(f"\nBalanced comparison complete!")
        click.echo(f"  Total pairs: {len(results)}")
        click.echo(f"  Completed: {completed}")
        click.echo(f"  Improved with trading: {improved}")
        click.echo(f"\nResults at: {out_dir / 'aggregate' / 'comparison.csv'}")

    except Exception as e:
        # Fail job on error
        if manager is not None:
            try:
                manager.fail_job(job_id, str(e))
            except Exception:
                pass  # Don't let job tracking failure mask the original error
        raise


@sweep.command("strategy-outcomes")
@click.option('--experiment', type=click.Path(exists=True, path_type=Path), required=True,
              help='Path to experiment directory (containing aggregate/comparison.csv)')
@click.option('-v', '--verbose', is_flag=True, help='Enable verbose logging')
def sweep_strategy_outcomes(experiment: Path, verbose: bool):
    """Analyze trading strategy outcomes across experiment runs.

    Reads repayment_events.csv files and computes per-strategy metrics:
    - Count and face value per strategy
    - Default count and face value per strategy
    - Default rate per strategy

    Outputs:
    - aggregate/strategy_outcomes_by_run.csv
    - aggregate/strategy_outcomes_overall.csv
    """
    import logging
    from bilancio.analysis.strategy_outcomes import run_strategy_analysis

    logging.basicConfig(
        level=logging.DEBUG if verbose else logging.INFO,
        format="%(levelname)s: %(message)s",
    )

    by_run_path, overall_path = run_strategy_analysis(experiment)

    if by_run_path and by_run_path.exists():
        console.print(f"[green]✓[/green] Strategy outcomes by run: {by_run_path}")
        console.print(f"[green]✓[/green] Strategy outcomes overall: {overall_path}")
    else:
        console.print("[yellow]No output generated - check that repayment_events.csv files exist[/yellow]")


@sweep.command("dealer-usage")
@click.option('--experiment', type=click.Path(exists=True, path_type=Path), required=True,
              help='Path to experiment directory (containing aggregate/comparison.csv)')
@click.option('-v', '--verbose', is_flag=True, help='Enable verbose logging')
def sweep_dealer_usage(experiment: Path, verbose: bool):
    """Analyze dealer usage patterns across experiment runs.

    Reads trades.csv, inventory_timeseries.csv, system_state_timeseries.csv,
    and repayment_events.csv to explain why dealers have or don't have an effect.

    Outputs:
    - aggregate/dealer_usage_by_run.csv
    """
    import logging
    from bilancio.analysis.dealer_usage_summary import run_dealer_usage_analysis

    logging.basicConfig(
        level=logging.DEBUG if verbose else logging.INFO,
        format="%(levelname)s: %(message)s",
    )

    output_path = run_dealer_usage_analysis(experiment)

    if output_path and output_path.exists():
        console.print(f"[green]✓[/green] Dealer usage summary: {output_path}")
    else:
        console.print("[yellow]No output generated - check that required CSV files exist[/yellow]")

```

---

### 📄 src/bilancio/ui/cli/utils.py

```python
"""Shared utilities for CLI commands."""

from __future__ import annotations

from decimal import Decimal

from rich.console import Console

from bilancio.experiments.ring import _decimal_list


console = Console()


def _as_decimal_list(value):
    """Convert value to list of Decimals.

    Handles both list/tuple input and comma-separated string input.
    """
    if isinstance(value, (list, tuple)):
        return [Decimal(str(item)) for item in value]
    return _decimal_list(value)

```

---

### 📄 src/bilancio/ui/cli/volume.py

```python
"""Modal Volume management commands."""

from __future__ import annotations

import subprocess
import json
from datetime import datetime, timedelta
from typing import Optional

import click


def get_volume_contents(volume_name: str = "bilancio-results") -> list[dict]:
    """Get contents of Modal Volume as list of dicts."""
    result = subprocess.run(
        ["uv", "run", "modal", "volume", "ls", volume_name, "--json"],
        capture_output=True,
        text=True,
    )
    if result.returncode != 0:
        raise click.ClickException(f"Failed to list volume: {result.stderr}")
    return json.loads(result.stdout)


def delete_volume_path(volume_name: str, path: str) -> bool:
    """Delete a path from Modal Volume."""
    result = subprocess.run(
        ["uv", "run", "modal", "volume", "rm", volume_name, path, "-r"],
        capture_output=True,
        text=True,
    )
    return result.returncode == 0


def parse_modal_date(date_str: str) -> datetime:
    """Parse Modal's date format (e.g., '2026-01-12 16:20 CET')."""
    # Remove timezone abbreviation and parse
    parts = date_str.rsplit(" ", 1)
    date_part = parts[0]
    try:
        return datetime.strptime(date_part, "%Y-%m-%d %H:%M")
    except ValueError:
        # Fallback: return now if parsing fails
        return datetime.now()


@click.group()
def volume():
    """Manage Modal Volume storage."""
    pass


@volume.command("ls")
@click.option("--volume", "volume_name", default="bilancio-results", help="Volume name")
def list_volume(volume_name: str):
    """List experiments in Modal Volume."""
    try:
        contents = get_volume_contents(volume_name)
    except Exception as e:
        raise click.ClickException(str(e))

    if not contents:
        click.echo("Volume is empty.")
        return

    click.echo(f"Experiments in {volume_name}:")
    click.echo("-" * 60)

    for item in contents:
        name = item.get("Filename", "unknown")
        modified = item.get("Created/Modified", "unknown")
        item_type = item.get("Type", "unknown")
        if item_type == "dir":
            click.echo(f"  {name:<40} {modified}")

    click.echo("-" * 60)
    click.echo(f"Total: {len([i for i in contents if i.get('Type') == 'dir'])} experiments")


@volume.command("cleanup")
@click.option("--volume", "volume_name", default="bilancio-results", help="Volume name")
@click.option(
    "--older-than",
    type=int,
    default=None,
    help="Delete experiments older than N days",
)
@click.option(
    "--pattern",
    type=str,
    default=None,
    help="Delete experiments matching pattern (e.g., 'test_*')",
)
@click.option("--dry-run", is_flag=True, help="Show what would be deleted without deleting")
@click.option("--yes", "-y", is_flag=True, help="Skip confirmation prompt")
def cleanup(
    volume_name: str,
    older_than: Optional[int],
    pattern: Optional[str],
    dry_run: bool,
    yes: bool,
):
    """Clean up old experiments from Modal Volume.

    Examples:
        bilancio volume cleanup --older-than 30
        bilancio volume cleanup --pattern "test_*" --dry-run
        bilancio volume cleanup --older-than 7 --yes
    """
    try:
        contents = get_volume_contents(volume_name)
    except Exception as e:
        raise click.ClickException(str(e))

    # Filter directories only
    experiments = [i for i in contents if i.get("Type") == "dir"]

    if not experiments:
        click.echo("No experiments found in volume.")
        return

    # Apply filters
    to_delete = []
    now = datetime.now()

    for exp in experiments:
        name = exp.get("Filename", "")
        modified_str = exp.get("Created/Modified", "")
        modified = parse_modal_date(modified_str)

        should_delete = False

        # Age filter
        if older_than is not None:
            age_days = (now - modified).days
            if age_days >= older_than:
                should_delete = True

        # Pattern filter
        if pattern is not None:
            import fnmatch

            if fnmatch.fnmatch(name, pattern):
                should_delete = True

        # If no filters specified, don't delete anything
        if older_than is None and pattern is None:
            click.echo("Error: Specify --older-than or --pattern to select experiments to delete.")
            click.echo("Use 'bilancio volume ls' to see all experiments.")
            return

        if should_delete:
            to_delete.append(exp)

    if not to_delete:
        click.echo("No experiments match the criteria.")
        return

    # Show what will be deleted
    click.echo(f"{'[DRY RUN] ' if dry_run else ''}Experiments to delete:")
    click.echo("-" * 60)
    for exp in to_delete:
        name = exp.get("Filename", "")
        modified = exp.get("Created/Modified", "")
        click.echo(f"  {name:<40} {modified}")
    click.echo("-" * 60)
    click.echo(f"Total: {len(to_delete)} experiments")

    if dry_run:
        click.echo("\n[DRY RUN] No changes made.")
        return

    # Confirm
    if not yes:
        if not click.confirm(f"\nDelete {len(to_delete)} experiments?"):
            click.echo("Aborted.")
            return

    # Delete
    deleted = 0
    failed = 0
    for exp in to_delete:
        name = exp.get("Filename", "")
        click.echo(f"Deleting {name}...", nl=False)
        if delete_volume_path(volume_name, name):
            click.echo(" OK")
            deleted += 1
        else:
            click.echo(" FAILED")
            failed += 1

    click.echo(f"\nDeleted: {deleted}, Failed: {failed}")


@volume.command("rm")
@click.argument("experiment_id")
@click.option("--volume", "volume_name", default="bilancio-results", help="Volume name")
@click.option("--yes", "-y", is_flag=True, help="Skip confirmation prompt")
def remove(experiment_id: str, volume_name: str, yes: bool):
    """Remove a specific experiment from Modal Volume.

    Example:
        bilancio volume rm castle-river-mountain-forest
    """
    if not yes:
        if not click.confirm(f"Delete experiment '{experiment_id}'?"):
            click.echo("Aborted.")
            return

    click.echo(f"Deleting {experiment_id}...", nl=False)
    if delete_volume_path(volume_name, experiment_id):
        click.echo(" OK")
    else:
        click.echo(" FAILED")
        raise click.ClickException("Failed to delete experiment")

```

---

### 📄 src/bilancio/ui/display.py

```python
"""Display utilities for Bilancio CLI."""

from typing import Optional, List, Dict, Any, Union
from rich.console import Console, RenderableType
from rich.panel import Panel
from rich.table import Table
from rich.text import Text

from bilancio.engines.system import System
from bilancio.analysis.visualization import (
    display_agent_balance_table,
    display_multiple_agent_balances,
    display_events,
    display_events_for_day,
    display_agent_balance_table_renderable,
    display_multiple_agent_balances_renderable,
    display_events_renderable,
    display_events_for_day_renderable,
    display_events_table_renderable,
    display_agent_t_account_renderable,
    display_events_tables_by_phase_renderables
)
from bilancio.analysis.balances import system_trial_balance
from bilancio.core.errors import DefaultError, ValidationError


console = Console()


def show_scenario_header_renderable(name: str, description: Optional[str] = None, agents: Optional[Any] = None) -> List[RenderableType]:
    """Return renderables for scenario header including agent list.
    
    Args:
        name: Scenario name
        description: Optional scenario description
        agents: Optional list or dict of agent configs to display
        
    Returns:
        List of renderables
    """
    renderables = []
    
    # Add scenario header panel
    header = Text(name, style="bold cyan")
    if description:
        header.append(f"\n{description}", style="dim")
    
    renderables.append(Panel(
        header,
        title="Bilancio Scenario",
        border_style="cyan"
    ))
    
    # Add agent list if provided
    if agents:
        from rich.table import Table
        
        agent_table = Table(title="Agents", box=None, show_header=False, padding=(0, 2))
        agent_table.add_column("ID", style="bold yellow")
        agent_table.add_column("Name", style="white")
        agent_table.add_column("Type", style="cyan")
        
        # Handle both list and dict formats
        if isinstance(agents, list):
            # agents is a list of AgentSpec objects
            for agent_config in agents:
                agent_id = agent_config.id if hasattr(agent_config, 'id') else str(agent_config.get('id', 'unknown'))
                agent_type = agent_config.kind if hasattr(agent_config, 'kind') else str(agent_config.get('kind', 'unknown'))
                agent_name = agent_config.name if hasattr(agent_config, 'name') else str(agent_config.get('name', agent_id))
                agent_table.add_row(agent_id, agent_name, f"({agent_type})")
        elif isinstance(agents, dict):
            # agents is a dictionary
            for agent_id, agent_config in agents.items():
                agent_type = agent_config.kind if hasattr(agent_config, 'kind') else str(agent_config.get('kind', 'unknown'))
                agent_name = agent_config.name if hasattr(agent_config, 'name') else str(agent_config.get('name', agent_id))
                agent_table.add_row(agent_id, agent_name, f"({agent_type})")
        
        renderables.append(Text())  # Empty line
        renderables.append(agent_table)
    
    return renderables


def show_scenario_header(name: str, description: Optional[str] = None, agents: Optional[Dict[str, Any]] = None) -> None:
    """Display scenario header.
    
    Args:
        name: Scenario name
        description: Optional scenario description
        agents: Optional dict of agent configs to display
    """
    renderables = show_scenario_header_renderable(name, description, agents)
    for renderable in renderables:
        console.print(renderable)


def show_day_summary_renderable(
    system: System,
    agent_ids: Optional[List[str]] = None,
    event_mode: str = "detailed",
    day: Optional[int] = None,
    t_account: bool = False
) -> List[RenderableType]:
    """Return renderables for a simulation day summary.

    Args:
        system: System instance
        agent_ids: Agent IDs to show balances for
        event_mode: "summary", "detailed", "table", or "none"
        day: Day number to display events for (None for all)

    Returns:
        List of renderables (empty list if event_mode="none")
    """
    # Plan 030: "none" mode suppresses all output for sweep performance
    if event_mode == "none":
        return []

    renderables = []

    # Show events
    if day is not None:
        # Show events for specific day
        events_for_day = [e for e in system.state.events if e.get("day") == day]
        if events_for_day:
            renderables.append(Text("\nEvents:", style="bold"))
            if event_mode == "table":
                # Show 3 separate tables by phase (A/B/C)
                phase_tables = display_events_tables_by_phase_renderables(events_for_day, day=day)
                renderables.extend(phase_tables)
            elif event_mode == "detailed":
                event_renderables = display_events_renderable(events_for_day, format="detailed")
                renderables.extend(event_renderables)
            else:
                # Summary mode - just count by type
                event_counts = {}
                for event in events_for_day:
                    event_type = event.get("kind", "Unknown")
                    event_counts[event_type] = event_counts.get(event_type, 0) + 1
                for event_type, count in sorted(event_counts.items()):
                    renderables.append(Text(f"  • {event_type}: {count}"))
    else:
        # Show all recent events (initial view, typically setup/day 0)
        if system.state.events:
            renderables.append(Text("\nEvents:", style="bold"))
            if event_mode == "table":
                # Use phase-separated tables even in the initial no-day view.
                # If these are setup events, this will render a single "Setup" table.
                # Otherwise, it renders Phase B/C tables for the current day.
                # Determine a representative day to label (default to 0 if any setup events exist).
                rep_day = 0 if any(e.get("phase") == "setup" for e in system.state.events) else system.state.day
                phase_tables = display_events_tables_by_phase_renderables(system.state.events, day=rep_day)
                renderables.extend(phase_tables)
            elif event_mode == "detailed":
                event_renderables = display_events_renderable(system.state.events, format="detailed")
                renderables.extend(event_renderables)
            else:
                # Summary mode
                event_counts = {}
                for event in system.state.events:
                    event_type = event.get("kind", "Unknown")
                    event_counts[event_type] = event_counts.get(event_type, 0) + 1
                for event_type, count in sorted(event_counts.items()):
                    renderables.append(Text(f"  • {event_type}: {count}"))
    
    # Show balances
    if agent_ids is not None:
        if len(agent_ids) == 0:
            renderables.append(Text("\nBalances:", style="bold"))
            renderables.append(Text("  • No active agents to display", style="dim"))
        elif len(agent_ids) == 1:
            renderables.append(Text("\nBalances:", style="bold"))
            # Single agent - show detailed balance
            if t_account:
                balance_renderable = display_agent_t_account_renderable(system, agent_ids[0])
            else:
                balance_renderable = display_agent_balance_table_renderable(system, agent_ids[0], format="rich")
            renderables.append(balance_renderable)
        else:
            renderables.append(Text("\nBalances:", style="bold"))
            # Multiple agents
            if t_account:
                # Render one T-account per agent, stacked for readability
                for aid in agent_ids:
                    renderables.append(display_agent_t_account_renderable(system, aid))
                    renderables.append(Text(""))  # spacing
            else:
                # Show compact legacy tables side by side
                balance_renderable = display_multiple_agent_balances_renderable(system, agent_ids, format="rich")
                renderables.append(balance_renderable)
    else:
        # Show system trial balance
        renderables.append(Text("\nSystem Trial Balance:", style="bold"))
        trial_bal = system_trial_balance(system)
        
        table = Table(show_header=True, header_style="bold")
        table.add_column("Metric")
        table.add_column("Value", justify="right")
        
        total_assets = trial_bal.total_financial_assets
        total_liabilities = trial_bal.total_financial_liabilities
        
        table.add_row("Total Assets", f"{total_assets:,.2f}")
        table.add_row("Total Liabilities", f"{total_liabilities:,.2f}")
        table.add_row("Total Equity", f"{total_assets - total_liabilities:,.2f}")
        
        # Check if balanced
        diff = abs(total_assets - total_liabilities)
        if diff < 0.01:
            table.add_row("Status", "[green]✓ Balanced[/green]")
        else:
            table.add_row("Status", f"[red]✗ Imbalanced ({diff:,.2f})[/red]")
        
        renderables.append(table)
    
    return renderables


def show_day_summary(
    system: System,
    agent_ids: Optional[List[str]] = None,
    event_mode: str = "detailed",
    day: Optional[int] = None,
    t_account: bool = False
) -> None:
    """Display summary for a simulation day.
    
    Args:
        system: System instance
        agent_ids: Agent IDs to show balances for
        event_mode: "summary" or "detailed"
        day: Day number to display events for (None for all)
    """
    renderables = show_day_summary_renderable(system, agent_ids, event_mode, day, t_account)
    for renderable in renderables:
        console.print(renderable)


def show_simulation_summary_renderable(system: System) -> Panel:
    """Return a renderable for final simulation summary.
    
    Args:
        system: System instance
        
    Returns:
        Panel renderable
    """
    return Panel(
        f"[bold]Final State[/bold]\n"
        f"Day: {system.state.day}\n"
        f"Total Events: {len(system.state.events)}\n"
        f"Active Agents: {len(system.state.agents)}\n"
        f"Active Contracts: {len(system.state.contracts)}\n"
        f"Stock Lots: {len(system.state.stocks)}",
        title="Summary",
        border_style="green"
    )


def show_simulation_summary(system: System) -> None:
    """Display final simulation summary.
    
    Args:
        system: System instance
    """
    console.print(show_simulation_summary_renderable(system))


def show_error_panel(
    error: Exception,
    phase: str,
    context: Optional[Dict[str, Any]] = None
) -> None:
    """Display error in a formatted panel.
    
    Args:
        error: Exception that occurred
        phase: Phase where error occurred (setup, day_N, simulation)
        context: Additional context information
    """
    error_type = type(error).__name__
    error_msg = str(error)
    
    # Build error content
    content = Text()
    content.append(f"Type: {error_type}\n", style="red bold")
    content.append(f"Message: {error_msg}\n", style="red")
    
    if context:
        content.append("\nContext:\n", style="yellow")
        for key, value in context.items():
            content.append(f"  • {key}: {value}\n", style="dim")
    
    # Add helpful hints based on error type
    if isinstance(error, DefaultError):
        content.append("\n💡 ", style="yellow")
        content.append("This usually means a debtor lacks sufficient funds or assets to settle an obligation.\n", style="dim")
        content.append("Check the agent's balance sheet and available means of payment.", style="dim")
        
    elif isinstance(error, ValidationError):
        content.append("\n💡 ", style="yellow")
        content.append("This indicates a system invariant violation.\n", style="dim")
        content.append("Common causes: duplicate IDs, negative balances, or mismatched references.", style="dim")
    
    # Display the panel
    console.print(Panel(
        content,
        title=f"Error in {phase}",
        border_style="red",
        expand=False
    ))
    
    # Log the error as an event
    if context and "scenario" in context:
        console.print(f"[dim]Error logged to simulation events[/dim]")

```

---

### 📄 src/bilancio/ui/html_export.py

```python
"""Semantic HTML export for Bilancio runs (readable, non-monospace).

Generates a light-themed, spreadsheet-style HTML report inspired by temp/demo_correct.html,
without changing simulation logic.
"""

from __future__ import annotations

from pathlib import Path
from typing import Any, Dict, List, Optional
import math
from decimal import Decimal
import html as _html

from bilancio.engines.system import System
from bilancio.analysis.visualization import build_t_account_rows
from bilancio.analysis.balances import AgentBalance


def _load_css() -> str:
    """Load export CSS from assets with a safe inline fallback.

    Keeps styling out of Python while remaining robust if the file is missing.
    """
    asset_path = Path(__file__).with_name("assets").joinpath("export.css")
    try:
        return asset_path.read_text(encoding="utf-8")
    except Exception:
        # Minimal fallback to keep the page readable if asset is missing.
        return "body{font-family:system-ui,Arial,sans-serif;padding:16px;background:#f5f5f5;color:#333}table{border-collapse:collapse;width:100%}th,td{border:1px solid #e5e7eb;padding:6px}tbody tr:nth-child(even){background:#fafafa}h1,h2,h3{margin:.5rem 0}"


def _html_escape(value: Any) -> str:
    """Escape text for safe HTML display, including quotes.

    Uses stdlib html.escape and additionally escapes single quotes.
    """
    if value is None:
        return ""
    text = str(value)
    # html.escape handles & < > and ", then we also escape single quotes
    return _html.escape(text, quote=True).replace("'", "&#x27;")


def _safe_int_conversion(value: Any) -> Optional[int]:
    """Safely convert value to int.

    - Accepts int, float, Decimal, and stringified digits
    - Returns None for None
    - Raises ValueError for invalid values
    """
    if value is None:
        return None
    # Fast path for ints
    if isinstance(value, int):
        return value
    # Floats/Decimals lose precision but we accept truncation for display
    if isinstance(value, (float, Decimal)):
        # Guard against NaN/Inf
        if isinstance(value, float) and (math.isnan(value) or math.isinf(value)):
            raise ValueError("Invalid numeric value: NaN/Inf")
        return int(value)
    # Strings: allow simple digit strings and formatted numbers with commas
    if isinstance(value, str):
        s = value.strip().replace(",", "")
        if s == "":
            return None
        try:
            return int(s)
        except Exception as e:
            raise ValueError(f"Invalid numeric value: {value}") from e
    # Objects with __int__
    if hasattr(value, "__int__"):
        try:
            return int(value)  # type: ignore[arg-type]
        except Exception as e:
            raise ValueError(f"Invalid numeric value: {value}") from e
    raise ValueError(f"Cannot convert {type(value)} to int")


def _format_amount(v: Any) -> str:
    if v in (None, "—", "-"):
        return "—"
    try:
        iv = _safe_int_conversion(v)
        if iv is None:
            return "—"
        return f"{iv:,}"
    except ValueError:
        # As a last resort, try float -> int formatting without erroring
        try:
            return f"{int(float(v)):,}"
        except Exception:
            return _html_escape(v)


def _render_t_account_from_rows(title: str, assets_rows: List[dict], liabs_rows: List[dict]) -> str:
    def tr(row: Optional[dict]) -> str:
        if not row:
            return "<tr><td class=\"empty\" colspan=\"6\">—</td></tr>"
        qty = row.get('quantity')
        val = row.get('value_minor')
        cpty = row.get('counterparty_name') or "—"
        mat = row.get('maturity') or "—"
        id_or_alias = row.get('id_or_alias') or "—"
        # Robust numeric formatting with safe conversion
        try:
            qiv = _safe_int_conversion(qty)
        except ValueError:
            qiv = None
        try:
            viv = _safe_int_conversion(val)
        except ValueError:
            viv = None
        qty_s = "—" if qiv in (None, "") else f"{qiv:,}"
        val_s = "—" if viv in (None, "") else f"{viv:,}"
        return (
            f"<tr>"
            f"<td class=\"name\">{_html_escape(row.get('name',''))}</td>"
            f"<td class=\"id\">{_html_escape(id_or_alias)}</td>"
            f"<td class=\"qty\">{qty_s}</td>"
            f"<td class=\"val\">{val_s}</td>"
            f"<td class=\"cpty\">{_html_escape(cpty)}</td>"
            f"<td class=\"mat\">{_html_escape(mat)}</td>"
            f"</tr>"
        )

    assets_html = "".join(tr(r) for r in assets_rows) or tr(None)
    liabs_html = "".join(tr(r) for r in liabs_rows) or tr(None)

    return f"""
<section class="t-account">
  <h3>{_html_escape(title)}</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets</h4>
      <table class="side">
        <thead><tr><th>Name</th><th>ID/Alias</th><th>Qty</th><th>Value</th><th>Counterparty</th><th>Maturity</th></tr></thead>
        <tbody>{assets_html}</tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities</h4>
      <table class="side">
        <thead><tr><th>Name</th><th>ID/Alias</th><th>Qty</th><th>Value</th><th>Counterparty</th><th>Maturity</th></tr></thead>
        <tbody>{liabs_html}</tbody>
      </table>
    </div>
  </div>
</section>
"""


def _render_t_account(system: System, agent_id: str) -> str:
    acct = build_t_account_rows(system, agent_id)
    agent = system.state.agents[agent_id]
    title = f"{agent.name or agent_id} [{agent_id}] ({agent.kind})"
    # Convert to dict rows for the row renderer
    def to_row(r):
        return {
            'name': getattr(r, 'name', ''),
            'quantity': getattr(r, 'quantity', None),
            'value_minor': getattr(r, 'value_minor', None),
            'counterparty_name': getattr(r, 'counterparty_name', None),
            'maturity': getattr(r, 'maturity', None),
            'id_or_alias': getattr(r, 'id_or_alias', None),
        }
    assets_rows = [to_row(r) for r in acct.assets]
    liabs_rows = [to_row(r) for r in acct.liabilities]
    return _render_t_account_from_rows(title, assets_rows, liabs_rows)


def _build_rows_from_balance(balance: AgentBalance) -> (List[dict], List[dict]):
    assets: List[dict] = []
    liabs: List[dict] = []

    # Inventory (stocks owned)
    for sku, data in balance.inventory_by_sku.items():
        qty = data.get('quantity', 0)
        val = data.get('value', 0)
        try:
            val_i = _safe_int_conversion(val)
        except ValueError:
            val_i = None
        try:
            qty_i = _safe_int_conversion(qty)
        except ValueError:
            qty_i = None
        if qty_i and qty_i > 0:
            assets.append({'name': str(sku), 'quantity': qty_i, 'value_minor': val_i, 'counterparty_name': '—', 'maturity': '—'})

    # Non-financial assets receivable
    for sku, data in balance.nonfinancial_assets_by_kind.items():
        qty = data.get('quantity', 0)
        val = data.get('value', 0)
        try:
            val_i = _safe_int_conversion(val)
        except ValueError:
            val_i = None
        try:
            qty_i = _safe_int_conversion(qty)
        except ValueError:
            qty_i = None
        if qty_i and qty_i > 0:
            assets.append({'name': f"{sku} receivable", 'quantity': qty_i, 'value_minor': val_i, 'counterparty_name': '—', 'maturity': '—'})

    # Financial assets by kind (skip non-financial kinds)
    for kind, amount in balance.assets_by_kind.items():
        if kind == 'delivery_obligation':
            continue
        try:
            amount_i = _safe_int_conversion(amount)
        except ValueError:
            amount_i = None
        if amount_i and amount_i > 0:
            assets.append({'name': kind, 'quantity': None, 'value_minor': amount_i, 'counterparty_name': '—', 'maturity': 'on-demand' if kind in ('cash','bank_deposit','reserve_deposit') else '—'})

    # Non-financial liabilities
    for sku, data in balance.nonfinancial_liabilities_by_kind.items():
        qty = data.get('quantity', 0)
        val = data.get('value', 0)
        try:
            val_i = _safe_int_conversion(val)
        except ValueError:
            val_i = None
        try:
            qty_i = _safe_int_conversion(qty)
        except ValueError:
            qty_i = None
        if qty_i and qty_i > 0:
            liabs.append({'name': f"{sku} obligation", 'quantity': qty_i, 'value_minor': val_i, 'counterparty_name': '—', 'maturity': '—'})

    # Financial liabilities
    for kind, amount in balance.liabilities_by_kind.items():
        if kind == 'delivery_obligation':
            continue
        try:
            amount_i = _safe_int_conversion(amount)
        except ValueError:
            amount_i = None
        if amount_i and amount_i > 0:
            liabs.append({'name': kind, 'quantity': None, 'value_minor': amount_i, 'counterparty_name': '—', 'maturity': 'on-demand' if kind in ('cash','bank_deposit','reserve_deposit') else '—'})

    # Ordering similar to render layer
    def asset_key(row):
        name = row['name']
        # inventory rows have quantity and cpty/maturity '—'
        if row['quantity'] is not None and row.get('counterparty_name') == '—':
            return (0, name)
        if name.endswith('receivable'):
            return (1, name)
        order = {'cash':0,'bank_deposit':1,'reserve_deposit':2,'payable':3}
        return (2, order.get(name, 99), name)

    def liab_key(row):
        name = row['name']
        if name.endswith('obligation'):
            return (0, name)
        order = {'payable':0,'bank_deposit':1,'reserve_deposit':2,'cash':3}
        return (1, order.get(name, 99), name)

    assets.sort(key=asset_key)
    liabs.sort(key=liab_key)
    return assets, liabs


def _map_event_fields(e: Dict[str, Any]) -> Dict[str, str]:
    kind = str(e.get("kind", ""))
    if kind in ("CashDeposited", "CashWithdrawn"):
        frm = e.get("customer") if kind == "CashDeposited" else e.get("bank")
        to = e.get("bank") if kind == "CashDeposited" else e.get("customer")
    elif kind in ("ClientPayment", "IntraBankPayment", "CashPayment"):
        frm = e.get("payer"); to = e.get("payee")
    elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
        frm = e.get("debtor_bank"); to = e.get("creditor_bank")
    elif kind == "StockCreated":
        frm = e.get("owner"); to = None
    elif kind == "dealer_trade":
        # Dealer trade: trader sells/buys ticket through dealer
        frm = e.get("trader")
        to = "VBT" if e.get("is_passthrough") else "Dealer"
    elif kind == "ClaimTransferredDealer":
        frm = e.get("from_holder")
        to = e.get("to_holder")
    else:
        frm = e.get("frm") or e.get("from") or e.get("debtor") or e.get("payer") or e.get("agent")
        to  = e.get("to") or e.get("creditor") or e.get("payee")
    # Identifier column prefers alias, then contract/instrument IDs
    id_or_alias = (
        e.get("alias")
        or e.get("contract_id")
        or e.get("payable_id")
        or e.get("obligation_id")
        or e.get("pid")
        or e.get("id")
        or e.get("instr_id")
        or e.get("stock_id")
        or e.get("ticket_id")  # For dealer_trade events
        or "—"
    )
    # SKU/Instr column should show SKU (for stock/delivery events) when available
    # Otherwise leave blank/dash
    sku = e.get("sku") or "—"
    qty = e.get("qty") or e.get("quantity") or "—"
    # Amount: use 'price' for dealer_trade, 'face' for showing original face value
    amt = e.get("amount") or e.get("price") or "—"
    notes = ""
    if kind == "ClientPayment":
        notes = f"{e.get('payer_bank','?')} → {e.get('payee_bank','?')}"
    elif kind in ("InterbankCleared", "InterbankOvernightCreated"):
        notes = f"{e.get('debtor_bank','?')} → {e.get('creditor_bank','?')}"
        if 'due_day' in e:
            notes += f"; due {e.get('due_day')}"
    elif kind == "AgentDefaulted":
        shortfall = e.get('shortfall')
        trigger = e.get('trigger_contract')
        bits = []
        if shortfall is not None:
            bits.append(f"shortfall {shortfall}")
        if trigger:
            bits.append(f"trigger {trigger}")
        notes = ", ".join(bits) if bits else "default"
    elif kind == "dealer_trade":
        side = e.get("side", "?")
        unit_price = e.get("unit_price")
        bucket = e.get("bucket", "?")
        passthrough = "passthrough" if e.get("is_passthrough") else "interior"
        if unit_price is not None:
            notes = f"{side} @ {unit_price:.2f} ({bucket}, {passthrough})"
        else:
            notes = f"{side} ({bucket}, {passthrough})"
    elif kind == "ClaimTransferredDealer":
        due_day = e.get("due_day")
        notes = f"due day {due_day}" if due_day is not None else ""
    return {
        "kind": kind,
        "from": _html_escape(frm or "—"),
        "to": _html_escape(to or "—"),
        "id_or_alias": _html_escape(id_or_alias),
        "sku": _html_escape(sku),
        "qty": _html_escape(qty),
        "amount": _format_amount(amt),
        "notes": _html_escape(notes),
    }


def _render_events_table(title: str, events: List[Dict[str, Any]]) -> str:
    # Exclude marker rows
    events = [e for e in events if e.get("kind") not in ("PhaseA","PhaseB","PhaseC","SubphaseB1","SubphaseB2","SubphaseB_Dealer")]
    rows_html = []
    for e in events:
        m = _map_event_fields(e)
        rows_html.append(
            f"<tr>"
            f"<td class=\"event-kind\">{m['kind']}</td>"
            f"<td class=\"event-id\">{m['id_or_alias']}</td>"
            f"<td>{m['from']}</td><td>{m['to']}</td>"
            f"<td>{m['sku']}</td><td class=\"qty\">{m['qty']}</td>"
            f"<td class=\"amount\">{m['amount']}</td><td class=\"notes\">{m['notes']}</td>"
            f"</tr>"
        )
    if not rows_html:
        rows_html.append("<tr><td colspan=\"7\" class=\"notes\">No events</td></tr>")
    return f"""
<section class="events-table">
  <h4>{_html_escape(title)}</h4>
  <table>
    <thead>
      <tr><th>Kind</th><th>ID/Alias</th><th>From</th><th>To</th><th>SKU/Instr</th><th>Qty</th><th>Amount</th><th>Notes</th></tr>
    </thead>
    <tbody>
      {''.join(rows_html)}
    </tbody>
  </table>
</section>
"""


def _split_by_phases(day_events: List[Dict[str, Any]]) -> Dict[str, List[Dict[str, Any]]]:
    buckets = {"A": [], "B": [], "C": []}
    current = "A"
    for e in day_events:
        k = e.get("kind")
        if k == "PhaseA":
            current = "A"; continue
        if k == "PhaseB":
            current = "B"; continue
        if k == "PhaseC":
            current = "C"; continue
        buckets[current].append(e)
    return buckets

def _split_phase_b_into_subphases(events_b: List[Dict[str, Any]]) -> tuple:
    """Split Phase B events into B1 (scheduled), B_Dealer, and B2 (settlements) using subphase markers.

    Returns:
        Tuple of (b1_events, b_dealer_events, b2_events)
        Excludes Subphase markers from returned lists.
    """
    b1: List[Dict[str, Any]] = []
    b_dealer: List[Dict[str, Any]] = []
    b2: List[Dict[str, Any]] = []
    # 0=B1, 1=Dealer, 2=B2
    current_phase = 0
    for e in events_b:
        k = e.get("kind")
        if k == "SubphaseB1":
            current_phase = 0
            continue
        if k == "SubphaseB_Dealer":
            current_phase = 1
            continue
        if k == "SubphaseB2":
            current_phase = 2
            continue
        if current_phase == 0:
            b1.append(e)
        elif current_phase == 1:
            b_dealer.append(e)
        else:
            b2.append(e)
    return b1, b_dealer, b2


def export_pretty_html(
    system: System,
    out_path: Path,
    scenario_name: str,
    description: Optional[str],
    agent_ids: Optional[List[str]],
    initial_balances: Optional[Dict[str, Any]],
    days_data: List[Dict[str, Any]],
    *,
    max_days: Optional[int] = None,
    quiet_days: Optional[int] = None,
    initial_rows: Optional[Dict[str, Dict[str, List[dict]]]] = None,
) -> None:
    out_path.parent.mkdir(parents=True, exist_ok=True)

    # Meta
    final_day = system.state.day
    total_events = len(system.state.events)
    active_agents = len(system.state.agents)
    active_contracts = len(system.state.contracts)

    # Determine convergence robustly: check tail quiet days and open obligations
    def _has_open_obligations() -> bool:
        try:
            return any(c.kind in ("payable", "delivery_obligation") for c in system.state.contracts.values())
        except Exception:
            return False
    has_open = _has_open_obligations()
    tail_quiet_ok = False
    end_day = None
    if days_data:
        end_day = days_data[-1].get('day')
        if quiet_days is not None and len(days_data) >= quiet_days:
            tail = [d.get('quiet') for d in days_data[-quiet_days:]]
            tail_quiet_ok = all(bool(x) for x in tail)

    html_parts: List[str] = []
    html_parts.append("<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\">")
    html_parts.append("<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">")
    html_parts.append(f"<title>Bilancio Simulation - { _html_escape(scenario_name) }</title>")
    html_parts.append(f"<style>{_load_css()}</style></head><body>")
    html_parts.append("<div class=\"container\">")
    html_parts.append("<header>")
    html_parts.append("<h1>Bilancio Simulation</h1>")
    html_parts.append(f"<h2>{_html_escape(scenario_name)}</h2>")
    if description:
        html_parts.append(f"<p class=\"description\">{_html_escape(description)}</p>")
    # Status line (converged or not)
    converged = (tail_quiet_ok and not has_open)
    status_text = "Converged" if converged else "Stopped without convergence"
    if converged and end_day is not None:
        status_text = f"Converged on day {end_day}"
    elif (not converged) and max_days is not None:
        status_text = f"Stopped without convergence (max_days = {max_days})"
    html_parts.append(
        f"<div class=\"meta\"><span>Final Day: {final_day}</span>"
        f"<span>Total Events: {total_events}</span>"
        f"<span>Active Agents: {active_agents}</span>"
        f"<span>Active Contracts: {active_contracts}</span>"
        f"<span>Status: {status_text}</span></div>"
    )
    html_parts.append("</header><main>")

    # Agents table
    html_parts.append("<section class=\"agents\"><h2>Agents</h2>")
    html_parts.append("<section class=\"events-table\"><table><thead><tr><th>ID</th><th>Name</th><th>Type</th></tr></thead><tbody>")
    for aid, agent in system.state.agents.items():
        name = _html_escape(agent.name or aid)
        kind = _html_escape(agent.kind)
        html_parts.append(f"<tr><td>{_html_escape(aid)}</td><td>{name}</td><td>{kind}</td></tr>")
    html_parts.append("</tbody></table></section></section>")

    # Day 0 (Setup)
    html_parts.append("<section class=\"day-section\"><h2 class=\"day-header\">📅 Day 0 (Setup)</h2>")
    setup_events = [e for e in system.state.events if e.get("phase") == "setup"]
    html_parts.append("<div class=\"events-section\"><h3>Setup Events</h3>")
    html_parts.append(_render_events_table("Setup", setup_events))
    html_parts.append("</div>")
    if agent_ids and initial_balances:
        html_parts.append("<div class=\"balances-section\"><h3>Balances</h3>")
        for aid in agent_ids:
            # Prefer captured initial_rows for detailed counterparties
            if initial_rows and aid in initial_rows:
                ag = system.state.agents[aid]
                title = f"{ag.name or aid} [{aid}] ({ag.kind})"
                rows = initial_rows[aid]
                html_parts.append(_render_t_account_from_rows(title, rows.get('assets', []), rows.get('liabs', [])))
            else:
                bal = initial_balances.get(aid)
                if isinstance(bal, AgentBalance):
                    assets_rows, liabs_rows = _build_rows_from_balance(bal)
                    ag = system.state.agents[aid]
                    title = f"{ag.name or aid} [{aid}] ({ag.kind})"
                    html_parts.append(_render_t_account_from_rows(title, assets_rows, liabs_rows))
                else:
                    html_parts.append(_render_t_account(system, aid))
        html_parts.append("</div>")
    html_parts.append("</section>")

    # Subsequent days from days_data (already chronological)
    for d in days_data:
        day_num = d.get('day')
        html_parts.append(f"<section class=\"day-section\"><h2 class=\"day-header\">📅 Day {day_num}</h2>")
        ev = d.get('events', [])
        buckets = _split_by_phases(ev)
        html_parts.append("<div class=\"events-section\">")
        b1, b_dealer, b2 = _split_phase_b_into_subphases(buckets.get("B", []))
        html_parts.append(_render_events_table("Phase B1 — Scheduled Actions", b1))
        if b_dealer:
            html_parts.append(_render_events_table("Phase B — Dealer Trading", b_dealer))
        html_parts.append(_render_events_table("Phase B2 — Settlement", b2))
        html_parts.append(_render_events_table("Phase C — Clearing", buckets.get("C", [])))
        html_parts.append("</div>")
        if agent_ids:
            ids_for_day = d.get('agent_ids')
            if ids_for_day is None:
                ids_for_day = agent_ids
            ids_for_day = [aid for aid in ids_for_day if aid in system.state.agents]
            if ids_for_day:
                html_parts.append("<div class=\"balances-section\"><h3>Balances</h3>")
                day_balances = d.get('balances') or {}
                day_rows = d.get('rows') or {}
                for aid in ids_for_day:
                    # Prefer captured rows with counterparties for this day
                    if aid in day_rows:
                        rows = day_rows[aid]
                        ag = system.state.agents[aid]
                        title = f"{ag.name or aid} [{aid}] ({ag.kind})"
                        html_parts.append(_render_t_account_from_rows(title, rows.get('assets', []), rows.get('liabs', [])))
                    else:
                        bal = day_balances.get(aid)
                        if isinstance(bal, AgentBalance):
                            assets_rows, liabs_rows = _build_rows_from_balance(bal)
                            ag = system.state.agents[aid]
                            title = f"{ag.name or aid} [{aid}] ({ag.kind})"
                            html_parts.append(_render_t_account_from_rows(title, assets_rows, liabs_rows))
                        else:
                            html_parts.append(_render_t_account(system, aid))
                html_parts.append("</div>")
        html_parts.append("</section>")

    # Conclusion section with termination reason
    html_parts.append("<section class=\"events-table\">")
    html_parts.append("<h3>Simulation End</h3>")
    if converged and end_day is not None:
        qtxt = f" after {quiet_days} quiet days" if quiet_days is not None else ""
        html_parts.append(
            f"<p>The system converged on day <strong>{end_day}</strong>{qtxt}: no impactful events and no open obligations.</p>"
        )
    else:
        mtxt = f" (max_days = {max_days})" if max_days is not None else ""
        html_parts.append(
            f"<p>Stopped without convergence{mtxt}. Consider increasing max days or reviewing outstanding obligations.</p>"
        )
    html_parts.append("</section>")

    html_parts.append("</main><footer>Generated by Bilancio</footer></div></body></html>")

    out_path.write_text("".join(html_parts), encoding="utf-8")

```

---

### 📄 src/bilancio/ui/render/__init__.py

```python
"""Rendering utilities for Bilancio UI components."""

from .models import AgentBalanceView, DayEventsView, DaySummaryView
from .formatters import EventFormatterRegistry
from .rich_builders import (
    build_agent_balance_table,
    build_multiple_agent_balances, 
    build_events_panel,
    build_day_summary
)

__all__ = [
    "AgentBalanceView",
    "DayEventsView", 
    "DaySummaryView",
    "EventFormatterRegistry",
    "build_agent_balance_table",
    "build_multiple_agent_balances",
    "build_events_panel", 
    "build_day_summary"
]
```

---

### 📄 src/bilancio/ui/render/formatters.py

```python
"""Event formatters for bilancio - Improved version with no redundancy."""

from typing import Dict, Any, Tuple, List


class EventFormatterRegistry:
    """Registry for event formatters."""
    
    def __init__(self):
        self._formatters = {}
    
    def register(self, event_kind: str):
        """Decorator to register a formatter for an event kind."""
        def decorator(func):
            self._formatters[event_kind] = func
            return func
        return decorator
    
    def format(self, event: Dict[str, Any]) -> Tuple[str, List[str], str]:
        """Format an event using the registered formatter."""
        kind = event.get("kind", "Unknown")
        formatter = self._formatters.get(kind)
        
        if formatter:
            return formatter(event)
        else:
            # Generic fallback for unknown events
            return self._format_generic(event)
    
    def _format_generic(self, event: Dict[str, Any]) -> Tuple[str, List[str], str]:
        """Generic formatter for unknown event kinds."""
        kind = event.get("kind", "Unknown")
        
        # Build a generic representation
        title = f"{kind} Event"
        lines = []
        
        # Add key fields, skipping meta fields
        skip_fields = {"kind", "day", "phase", "type"}
        for key, value in event.items():
            if key not in skip_fields:
                lines.append(f"{key}: {value}")
        
        return title, lines[:3], "❓"  # Limit to 3 lines


# Create global registry instance
registry = EventFormatterRegistry()


# Register specific formatters for common event kinds
@registry.register("CashTransferred")
def format_cash_transferred(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format cash transfer events."""
    amount = event.get("amount", 0)
    frm = event.get("frm", "Unknown")
    to = event.get("to", "Unknown")
    
    title = f"💰 Cash Transfer: ${amount:,}"
    lines = [f"{frm} → {to}"]
    
    return title, lines, "💰"


@registry.register("ReservesTransferred")
def format_reserves_transferred(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format reserves transfer events."""
    amount = event.get("amount", 0)
    frm = event.get("frm", "Unknown")
    to = event.get("to", "Unknown")
    
    title = f"🏦 Reserves Transfer: ${amount:,}"
    lines = [f"{frm} → {to}"]
    
    return title, lines, "🏦"


@registry.register("StockTransferred")
def format_stock_transferred(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format stock transfer events."""
    sku = event.get("sku", "Unknown")
    quantity = event.get("qty", event.get("quantity", 0))
    frm = event.get("frm", "Unknown") 
    to = event.get("to", "Unknown")
    unit_price = event.get("unit_price", None)
    
    title = f"📦 Stock Transfer: {quantity} {sku}"
    lines = [f"{frm} → {to}"]
    if unit_price:
        lines.append(f"@ ${unit_price:,}/unit")
    
    return title, lines, "📦"


@registry.register("DeliveryObligationCreated")
def format_delivery_obligation_created(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format delivery obligation creation events."""
    sku = event.get("sku", "Unknown")
    quantity = event.get("quantity", event.get("qty", 0))
    frm = event.get("frm", "Unknown")
    to = event.get("to", "Unknown")
    due_day = event.get("due_day", None)
    
    title = f"📋 Delivery Obligation: {quantity} {sku}"
    lines = [f"{frm} → {to}"]
    if due_day:
        lines.append(f"Due: Day {due_day}")
    
    return title, lines, "📋"


@registry.register("DeliveryObligationSettled")
def format_delivery_obligation_settled(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format delivery obligation settlement events."""
    sku = event.get("sku", "Unknown")
    quantity = event.get("quantity", event.get("qty", 0))
    debtor = event.get("debtor", "Unknown")
    creditor = event.get("creditor", "Unknown")
    
    title = f"✅ Delivery Settled: {quantity} {sku}"
    lines = [f"{debtor} → {creditor}"]
    
    return title, lines, "✅"


@registry.register("PayableCreated")
def format_payable_created(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format payable creation events."""
    amount = event.get("amount", 0)
    debtor = event.get("debtor", event.get("frm", "Unknown"))
    creditor = event.get("creditor", event.get("to", "Unknown"))
    due_day = event.get("due_day", None)
    
    title = f"💸 Payable Created: ${amount:,}"
    lines = [f"{debtor} owes {creditor}"]
    if due_day is not None:
        lines.append(f"Due: Day {due_day}")
    
    return title, lines, "💸"


@registry.register("PayableSettled")
def format_payable_settled(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format payable settlement events."""
    amount = event.get("amount", 0)
    debtor = event.get("debtor", "Unknown")
    creditor = event.get("creditor", "Unknown")
    
    title = f"💰 Payable Settled: ${amount:,}"
    lines = [f"{debtor} → {creditor}"]
    
    return title, lines, "💰"


@registry.register("CashDeposited")
def format_cash_deposited(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format cash deposit events."""
    customer = event.get("customer", "Unknown")
    bank = event.get("bank", "Unknown")
    amount = event.get("amount", 0)
    
    title = f"🏧 Cash Deposit: ${amount:,}"
    lines = [f"{customer} → {bank}"]
    
    return title, lines, "🏧"


@registry.register("CashWithdrawn")
def format_cash_withdrawn(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format cash withdrawal events."""
    customer = event.get("customer", "Unknown")
    bank = event.get("bank", "Unknown") 
    amount = event.get("amount", 0)
    
    title = f"💸 Cash Withdrawal: ${amount:,}"
    lines = [f"{customer} ← {bank}"]
    
    return title, lines, "💸"


@registry.register("ClientPayment")
def format_client_payment(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format inter-bank client payment events."""
    payer = event.get("payer", "Unknown")
    payee = event.get("payee", "Unknown")
    amount = event.get("amount", 0)
    payer_bank = event.get("payer_bank", "Unknown")
    payee_bank = event.get("payee_bank", "Unknown")
    
    title = f"💳 Inter-Bank Payment: ${amount:,}"
    lines = [
        f"{payer} → {payee}",
        f"via {payer_bank} → {payee_bank}"
    ]
    
    return title, lines, "💳"


@registry.register("IntraBankPayment")
def format_intra_bank_payment(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format intra-bank payment events."""
    payer = event.get("payer", "Unknown")
    payee = event.get("payee", "Unknown")
    amount = event.get("amount", 0)
    bank = event.get("bank", "Unknown")
    
    title = f"🏦 Intra-Bank Payment: ${amount:,}"
    lines = [
        f"{payer} → {payee}",
        f"at {bank}"
    ]
    
    return title, lines, "🏦"


@registry.register("CashPayment")
def format_cash_payment(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format cash payment events."""
    payer = event.get("payer", "Unknown")
    payee = event.get("payee", "Unknown")
    amount = event.get("amount", 0)
    
    title = f"💵 Cash Payment: ${amount:,}"
    lines = [f"{payer} → {payee}"]
    
    return title, lines, "💵"


@registry.register("InstrumentMerged")
def format_instrument_merged(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format instrument merge events (cash consolidation)."""
    keep = event.get("keep", "Unknown")
    removed = event.get("removed", "Unknown")
    
    # Extract short IDs for readability
    keep_short = keep.split('_')[-1][:8] if keep != "Unknown" else keep
    removed_short = removed.split('_')[-1][:8] if removed != "Unknown" else removed
    
    title = f"🔀 Cash Consolidation"
    lines = [
        f"Merged: {removed_short} → {keep_short}",
        f"(Reduces fragmentation)"
    ]
    
    return title, lines, "🔀"


@registry.register("InterbankCleared")
def format_interbank_cleared(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format interbank clearing events."""
    debtor_bank = event.get("debtor_bank", "Unknown")
    creditor_bank = event.get("creditor_bank", "Unknown")
    amount = event.get("amount", 0)
    
    title = f"🔄 Interbank Clearing: ${amount:,}"
    lines = [f"{debtor_bank} → {creditor_bank}"]
    
    return title, lines, "🔄"


@registry.register("CashMinted")
def format_cash_minted(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format cash minting events."""
    to = event.get("to", "Unknown")
    amount = event.get("amount", 0)
    
    title = f"🖨️ Cash Minted: ${amount:,}"
    lines = [f"To: {to}"]
    
    return title, lines, "🖨️"


@registry.register("ReservesMinted")
def format_reserves_minted(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format reserves minting events."""
    to = event.get("to", "Unknown")
    amount = event.get("amount", 0)
    
    title = f"🏛️ Reserves Minted: ${amount:,}"
    lines = [f"Bank: {to}"]
    
    return title, lines, "🏛️"


@registry.register("StockSplit")
def format_stock_split(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format stock split events."""
    sku = event.get("sku", "Unknown")
    original_qty = event.get("original_qty", 0)
    split_qty = event.get("split_qty", 0)
    remaining_qty = event.get("remaining_qty", 0)
    
    title = f"✂️ Stock Split: {split_qty} {sku}"
    lines = [
        f"From lot of {original_qty} → {remaining_qty} remain",
        f"(Preparing transfer)"
    ]
    
    return title, lines, "✂️"


@registry.register("DeliveryObligationCancelled")
def format_delivery_cancelled(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format delivery obligation cancellation."""
    obligation_id = event.get("obligation_id", "Unknown")
    debtor = event.get("debtor", "Unknown")
    
    # Short ID for readability
    short_id = obligation_id.split('_')[-1][:8] if obligation_id != "Unknown" else obligation_id
    
    title = f"✓ Obligation Cleared"
    lines = [
        f"By: {debtor}",
        f"ID: ...{short_id}"
    ]
    
    return title, lines, "✓"


@registry.register("StockCreated")
def format_stock_created(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format stock creation events."""
    owner = event.get("owner", "Unknown")
    sku = event.get("sku", "Unknown")
    qty = event.get("qty", event.get("quantity", 0))
    unit_price = event.get("unit_price", None)
    
    title = f"📋 Stock Created: {qty} {sku}"
    lines = [f"Owner: {owner}"]
    if unit_price:
        if isinstance(qty, (int, float)) and isinstance(unit_price, (int, float)):
            total_value = qty * unit_price
            lines.append(f"Value: ${unit_price:,}/unit (${total_value:,} total)")
        else:
            lines.append(f"Value: ${unit_price}/unit")
    
    return title, lines, "📋"


# Phase markers
@registry.register("PhaseA")
def format_phase_a(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format phase A markers."""
    day = event.get("day", "?")
    return f"⏰ Day {day} begins", ["Morning activities"], "⏰"


@registry.register("PhaseB")
def format_phase_b(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format phase B markers."""
    return "🌅 Business hours", ["Main economic activity"], "🌅"


@registry.register("PhaseC")
def format_phase_c(event: Dict[str, Any]) -> Tuple[str, List[str], str]:
    """Format phase C markers."""
    return "🌙 End of day", ["Settlements and clearing"], "🌙"
```

---

### 📄 src/bilancio/ui/render/models.py

```python
"""View model classes for Bilancio UI rendering."""

from __future__ import annotations

from dataclasses import dataclass
from decimal import Decimal
from typing import Dict, List, Any


@dataclass
class BalanceItemView:
    """View model for a single balance sheet item."""
    category: str  # e.g., "Assets", "Liabilities"
    instrument: str  # e.g., "Cash", "Reserves", "Stock"
    amount: int | Decimal  # Quantity or monetary amount
    value: int | Decimal  # Monetary value


@dataclass
class AgentBalanceView:
    """View model for agent balance information."""
    agent_id: str
    agent_name: str
    agent_kind: str
    items: List[BalanceItemView]


@dataclass
class EventView:
    """View model for a single event."""
    kind: str
    title: str
    lines: List[str]
    icon: str
    raw_event: Dict[str, Any]  # Original event data for reference


@dataclass
class DayEventsView:
    """View model for events in a simulation day."""
    day: int
    phases: Dict[str, List[EventView]]  # phase -> list of events


@dataclass
class DaySummaryView:
    """View model for a complete day summary."""
    day: int
    events_view: DayEventsView
    agent_balances: List[AgentBalanceView]
```

---

### 📄 src/bilancio/ui/render/rich_builders.py

```python
"""Rich renderable builder functions for Bilancio UI components."""

from __future__ import annotations

from typing import List, Dict, Any, Union

try:
    from rich.table import Table
    from rich.columns import Columns
    from rich.panel import Panel
    from rich.text import Text
    from rich.tree import Tree
    from rich import box
    from rich.console import RenderableType
    RICH_AVAILABLE = True
except ImportError:
    RICH_AVAILABLE = False
    # Fallback types for type hints
    Table = Any
    Columns = Any
    Panel = Any
    RenderableType = Any

from .models import AgentBalanceView, DayEventsView, DaySummaryView, BalanceItemView, EventView
from .formatters import registry as event_formatter_registry


def _format_currency(amount: Union[int, float], show_sign: bool = False) -> str:
    """Format an amount as currency."""
    formatted = f"{amount:,}"
    if show_sign and amount > 0:
        formatted = f"+{formatted}"
    return formatted


def build_agent_balance_table(balance_view: AgentBalanceView) -> Table:
    """Build a Rich Table for a single agent's balance sheet.
    
    Args:
        balance_view: Agent balance view model
        
    Returns:
        Rich Table renderable
    """
    if not RICH_AVAILABLE:
        raise RuntimeError("Rich library not available")
    
    # Create title with agent info
    if balance_view.agent_name and balance_view.agent_name != balance_view.agent_id:
        title = f"{balance_view.agent_name} [{balance_view.agent_id}] ({balance_view.agent_kind})"
    else:
        title = f"{balance_view.agent_id} ({balance_view.agent_kind})"
    
    # Create the main table
    table = Table(title=title, box=box.ROUNDED, title_style="bold cyan")
    table.add_column("ASSETS", style="green", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="green", width=15, no_wrap=True)
    table.add_column("LIABILITIES", style="red", width=35, no_wrap=False)
    table.add_column("Amount", justify="right", style="red", width=15, no_wrap=True)
    
    # Separate assets and liabilities
    assets = [item for item in balance_view.items if item.category == "Assets"]
    liabilities = [item for item in balance_view.items if item.category == "Liabilities"]
    
    # Determine the maximum number of rows needed
    max_rows = max(len(assets), len(liabilities), 1)
    
    for i in range(max_rows):
        asset_name = assets[i].instrument if i < len(assets) else ""
        asset_amount = _format_currency(assets[i].value) if i < len(assets) else ""
        liability_name = liabilities[i].instrument if i < len(liabilities) else ""
        liability_amount = _format_currency(liabilities[i].value) if i < len(liabilities) else ""
        
        table.add_row(asset_name, asset_amount, liability_name, liability_amount)
    
    # Calculate totals
    total_assets = sum(item.value for item in assets)
    total_liabilities = sum(item.value for item in liabilities)
    net_worth = total_assets - total_liabilities
    
    # Add separator and totals
    table.add_row("", "", "", "", end_section=True)
    table.add_row(
        Text("TOTAL ASSETS", style="bold green"),
        Text(_format_currency(total_assets), style="bold green"),
        Text("TOTAL LIABILITIES", style="bold red"),
        Text(_format_currency(total_liabilities), style="bold red")
    )
    
    # Add net worth
    table.add_row("", "", "", "", end_section=True)
    net_worth_style = "bold green" if net_worth >= 0 else "bold red"
    table.add_row(
        "",
        "",
        Text("NET WORTH", style="bold blue"),
        Text(_format_currency(net_worth, show_sign=True), style=net_worth_style)
    )
    
    return table


def build_multiple_agent_balances(balances: List[AgentBalanceView]) -> Columns:
    """Build a Rich Columns layout for multiple agent balance sheets.
    
    Args:
        balances: List of agent balance view models
        
    Returns:
        Rich Columns renderable
    """
    if not RICH_AVAILABLE:
        raise RuntimeError("Rich library not available")
    
    tables = [build_agent_balance_table(balance) for balance in balances]
    return Columns(tables, equal=True, expand=True)


def build_events_panel(day_events_view: DayEventsView) -> Panel:
    """Build a Rich Panel for day events organized by phase.
    
    Args:
        day_events_view: Day events view model
        
    Returns:
        Rich Panel renderable
    """
    if not RICH_AVAILABLE:
        raise RuntimeError("Rich library not available")
    
    if not day_events_view.phases:
        return Panel(
            Text("No events occurred on this day.", style="dim"),
            title=f"Day {day_events_view.day} Events",
            border_style="blue"
        )
    
    # Create a tree structure for phases and events
    tree = Tree(f"📅 Day {day_events_view.day}")
    
    for phase, events in day_events_view.phases.items():
        if not events:
            continue
            
        # Add phase node
        phase_node = tree.add(f"📍 {phase}")
        
        # Add events under the phase
        for event in events:
            event_text = Text()
            event_text.append(f"{event.icon} ", style="")
            event_text.append(event.title, style="bold")
            
            event_node = phase_node.add(event_text)
            
            # Add event details as sub-items
            for line in event.lines:
                event_node.add(Text(line, style="dim"))
    
    return Panel(
        tree,
        title=f"Day {day_events_view.day} Events",
        border_style="blue"
    )


def build_events_list(day_events_view: DayEventsView) -> List[RenderableType]:
    """Build a list of Rich renderables for day events.
    
    Args:
        day_events_view: Day events view model
        
    Returns:
        List of Rich renderables
    """
    if not RICH_AVAILABLE:
        raise RuntimeError("Rich library not available")
    
    renderables = []
    
    if not day_events_view.phases:
        renderables.append(Text("No events occurred on this day.", style="dim"))
        return renderables
    
    for phase, events in day_events_view.phases.items():
        if not events:
            continue
            
        # Phase header
        renderables.append(Text(f"📍 {phase}", style="bold blue"))
        
        # Events in this phase
        for event in events:
            event_text = Text()
            event_text.append(f"  {event.icon} ", style="")
            event_text.append(event.title, style="bold")
            renderables.append(event_text)
            
            # Event details
            for line in event.lines:
                renderables.append(Text(f"    {line}", style="dim"))
        
        # Add spacing between phases
        renderables.append(Text(""))
    
    return renderables


def build_day_summary(view: DaySummaryView) -> List[RenderableType]:
    """Build a list of Rich renderables for a complete day summary.
    
    Args:
        view: Day summary view model
        
    Returns:
        List of Rich renderables
    """
    if not RICH_AVAILABLE:
        raise RuntimeError("Rich library not available")
    
    renderables = []
    
    # Day header
    renderables.append(Panel(
        Text(f"Day {view.day} Summary", style="bold cyan"),
        border_style="cyan"
    ))
    
    # Events section
    if view.events_view.phases:
        renderables.append(build_events_panel(view.events_view))
    else:
        renderables.append(Text("No events occurred on this day.", style="dim"))
    
    # Agent balances section
    if view.agent_balances:
        renderables.append(Text("\n💰 Agent Balances", style="bold yellow"))
        renderables.append(build_multiple_agent_balances(view.agent_balances))
    
    return renderables


def convert_raw_event_to_view(raw_event: Dict[str, Any]) -> EventView:
    """Convert a raw event dictionary to an EventView model.
    
    Args:
        raw_event: Raw event dictionary from system.state.events
        
    Returns:
        EventView model
    """
    title, lines, icon = event_formatter_registry.format(raw_event)
    
    return EventView(
        kind=raw_event.get("kind", "Unknown"),
        title=title,
        lines=lines,
        icon=icon,
        raw_event=raw_event
    )


def convert_raw_events_to_day_view(raw_events: List[Dict[str, Any]], day: int) -> DayEventsView:
    """Convert raw events for a day into a DayEventsView model.
    
    Args:
        raw_events: List of raw event dictionaries for the day
        day: Day number
        
    Returns:
        DayEventsView model
    """
    phases: Dict[str, List[EventView]] = {}
    
    for raw_event in raw_events:
        phase = raw_event.get("phase", "unknown")
        event_view = convert_raw_event_to_view(raw_event)
        
        if phase not in phases:
            phases[phase] = []
        phases[phase].append(event_view)
    
    return DayEventsView(day=day, phases=phases)
```

---

### 📄 src/bilancio/ui/run.py

```python
"""Orchestration logic for running Bilancio simulations."""

from pathlib import Path
from typing import Optional, List, Dict, Any, Callable
import sys

from rich.console import Console
from rich.panel import Panel
from rich.prompt import Confirm
from rich.table import Table

from bilancio.engines.system import System
from bilancio.engines.simulation import run_day, run_until_stable
from bilancio.core.errors import ValidationError, DefaultError
from bilancio.config import load_yaml, apply_to_system
from bilancio.export.writers import write_balances_csv, write_events_jsonl

from .display import (
    show_scenario_header,
    show_scenario_header_renderable,
    show_day_summary,
    show_day_summary_renderable,
    show_simulation_summary,
    show_simulation_summary_renderable,
    show_error_panel
)


console = Console(record=True, width=120)


def _filter_active_agent_ids(system: System, agent_ids: Optional[List[str]]) -> Optional[List[str]]:
    """Return only agent IDs that remain active (not defaulted)."""
    if agent_ids is None:
        return None
    active_ids: List[str] = []
    for aid in agent_ids:
        agent = system.state.agents.get(aid)
        if not agent:
            continue
        if getattr(agent, "defaulted", False):
            continue
        active_ids.append(aid)
    return active_ids


def run_scenario(
    path: Path,
    mode: str = "until_stable",
    max_days: int = 90,
    quiet_days: int = 2,
    show: str = "detailed",
    agent_ids: Optional[List[str]] = None,
    check_invariants: str = "setup",
    export: Optional[Dict[str, str]] = None,
    html_output: Optional[Path] = None,
    t_account: bool = False,
    default_handling: Optional[str] = None,
    detailed_dealer_logging: bool = False,
    run_id: str = "",
    regime: str = "",
    progress_callback: Optional[Callable[[int, int], None]] = None,
) -> None:
    """Run a Bilancio simulation scenario.

    Args:
        path: Path to scenario YAML file
        mode: "step" or "until_stable"
        max_days: Maximum days to simulate
        quiet_days: Required quiet days for stable state
        show: "summary", "detailed" or "table" for event display
        agent_ids: List of agent IDs to show balances for
        check_invariants: "setup", "daily", or "none"
        export: Dictionary with export paths (balances_csv, events_jsonl)
        html_output: Optional path to export HTML with colored output
        progress_callback: Optional callback(current_day, max_days) for progress tracking
    """
    # Load configuration
    console.print("[dim]Loading scenario...[/dim]")
    config = load_yaml(path)

    # Determine effective default-handling strategy (CLI override wins)
    effective_default_handling = default_handling or config.run.default_handling
    if default_handling and config.run.default_handling != default_handling:
        config = config.model_copy(update={
            "run": config.run.model_copy(update={"default_handling": effective_default_handling})
        })

    # Create and configure system with selected default-handling mode
    system = System(default_mode=effective_default_handling)
    # Preflight schedule validation (aliases available when referenced)
    try:
        from bilancio.config.apply import validate_scheduled_aliases
        validate_scheduled_aliases(config)
    except ValueError as e:
        show_error_panel(
            error=e,
            phase="setup",
            context={"scenario": config.name}
        )
        sys.exit(1)

    # Apply configuration
    try:
        apply_to_system(config, system)
        
        if check_invariants in ("setup", "daily"):
            system.assert_invariants()
            
    except (ValidationError, ValueError) as e:
        show_error_panel(
            error=e,
            phase="setup",
            context={"scenario": config.name}
        )
        sys.exit(1)
    
    # Plan 024: Enable rollover if configured
    system.state.rollover_enabled = config.run.rollover_enabled

    # Stage scheduled actions into system state (Phase B1 execution by day)
    try:
        if getattr(config, 'scheduled_actions', None):
            for sa in config.scheduled_actions:
                day = sa.day
                system.state.scheduled_actions_by_day.setdefault(day, []).append(sa.action)
    except Exception:
        # Keep robust even if config lacks scheduled actions
        pass
    
    # Use config settings unless overridden by CLI
    if agent_ids is None and config.run.show.balances:
        agent_ids = config.run.show.balances
    
    if export is None:
        export = {}
    
    # Use config export settings if not overridden
    if not export.get('balances_csv') and config.run.export.balances_csv:
        export['balances_csv'] = config.run.export.balances_csv
    if not export.get('events_jsonl') and config.run.export.events_jsonl:
        export['events_jsonl'] = config.run.export.events_jsonl
    
    # Plan 030: Check for quiet mode (show="none") to suppress verbose output
    quiet_mode = show == "none"

    # Show scenario header with agent list (skip in quiet mode)
    if not quiet_mode:
        header_renderables = show_scenario_header_renderable(config.name, config.description, config.agents)
        for renderable in header_renderables:
            console.print(renderable)
        console.print(f"[dim]Default handling mode: {effective_default_handling}[/dim]")

        # Show initial state
        console.print("\n[bold cyan]📅 Day 0 (After Setup)[/bold cyan]")
        renderables = show_day_summary_renderable(system, agent_ids, show, t_account=t_account)
        for renderable in renderables:
            console.print(renderable)
    
    # Capture initial balance state for HTML export
    initial_balances: Dict[str, Any] = {}
    initial_rows: Dict[str, Dict[str, list]] = {}
    from bilancio.analysis.balances import agent_balance
    from bilancio.analysis.visualization import build_t_account_rows
    # Capture balances for all agents that we might display
    capture_ids = agent_ids if agent_ids else [a.id for a in system.state.agents.values()]
    for agent_id in capture_ids:
        initial_balances[agent_id] = agent_balance(system, agent_id)
        # also capture detailed rows with counterparties at setup
        acct = build_t_account_rows(system, agent_id)
        def _row_dict(r):
            return {
                'name': getattr(r, 'name', ''),
                'quantity': getattr(r, 'quantity', None),
                'value_minor': getattr(r, 'value_minor', None),
                'counterparty_name': getattr(r, 'counterparty_name', None),
                'maturity': getattr(r, 'maturity', None),
                'id_or_alias': getattr(r, 'id_or_alias', None),
            }
        initial_rows[agent_id] = {
            'assets': [_row_dict(r) for r in acct.assets],
            'liabs': [_row_dict(r) for r in acct.liabilities],
        }
    
    # Track day data for PDF export
    days_data = []

    # Check if dealer subsystem is enabled
    enable_dealer = hasattr(system.state, 'dealer_subsystem') and system.state.dealer_subsystem is not None

    if mode == "step":
        days_data = run_step_mode(
            system=system,
            max_days=max_days,
            show=show,
            agent_ids=agent_ids,
            check_invariants=check_invariants,
            scenario_name=config.name,
            t_account=t_account,
            enable_dealer=enable_dealer
        )
    else:
        days_data = run_until_stable_mode(
            system=system,
            max_days=max_days,
            quiet_days=quiet_days,
            show=show,
            agent_ids=agent_ids,
            check_invariants=check_invariants,
            scenario_name=config.name,
            t_account=t_account,
            enable_dealer=enable_dealer,
            progress_callback=progress_callback,
        )
    
    # Export results if requested
    if export.get('balances_csv'):
        export_path = Path(export['balances_csv'])
        export_path.parent.mkdir(parents=True, exist_ok=True)
        write_balances_csv(system, export_path)
        console.print(f"[green]✓[/green] Exported balances to {export_path}")
    
    if export.get('events_jsonl'):
        export_path = Path(export['events_jsonl'])
        export_path.parent.mkdir(parents=True, exist_ok=True)
        write_events_jsonl(system, export_path)
        console.print(f"[green]✓[/green] Exported events to {export_path}")

    # Export dealer metrics if dealer subsystem is enabled
    if enable_dealer and hasattr(system.state, 'dealer_subsystem') and system.state.dealer_subsystem is not None:
        dealer_metrics_path = None
        if export.get('events_jsonl'):
            dealer_metrics_path = Path(export['events_jsonl']).parent / "dealer_metrics.json"
        elif export.get('balances_csv'):
            dealer_metrics_path = Path(export['balances_csv']).parent / "dealer_metrics.json"

        if dealer_metrics_path:
            import json
            dealer_summary = system.state.dealer_subsystem.metrics.summary()
            with dealer_metrics_path.open('w') as f:
                json.dump(dealer_summary, f, indent=2)
            console.print(f"[green]✓[/green] Exported dealer metrics to {dealer_metrics_path}")

            # Plan 022: Export detailed dealer CSV logs if enabled
            if detailed_dealer_logging:
                metrics = system.state.dealer_subsystem.metrics
                # Set run context on metrics and propagate to all records
                metrics.run_id = run_id
                metrics.regime = regime

                # Propagate run_id/regime to all trade records
                for trade in metrics.trades:
                    trade.run_id = run_id
                    trade.regime = regime

                # Propagate to dealer snapshots
                for snap in metrics.dealer_snapshots:
                    snap.run_id = run_id
                    snap.regime = regime

                # Propagate to system state snapshots
                for snap in metrics.system_state_snapshots:
                    snap.run_id = run_id
                    snap.regime = regime

                out_dir = dealer_metrics_path.parent

                # trades.csv
                trades_path = out_dir / "trades.csv"
                metrics.to_trade_log_csv(str(trades_path))
                console.print(f"[green]✓[/green] Exported trades to {trades_path}")

                # inventory_timeseries.csv (uses dealer_snapshots with new fields)
                inventory_path = out_dir / "inventory_timeseries.csv"
                metrics.to_inventory_timeseries_csv(str(inventory_path))
                console.print(f"[green]✓[/green] Exported inventory timeseries to {inventory_path}")

                # system_state_timeseries.csv
                system_state_path = out_dir / "system_state_timeseries.csv"
                metrics.to_system_state_csv(str(system_state_path))
                console.print(f"[green]✓[/green] Exported system state timeseries to {system_state_path}")

                # repayment_events.csv (Plan 022 - Phase 2)
                # Build repayment events from the event log and trades
                from bilancio.dealer.metrics import build_repayment_events
                repayment_events = build_repayment_events(
                    event_log=system.state.events,
                    trades=metrics.trades,
                    run_id=run_id,
                    regime=regime,
                )
                metrics.repayment_events = repayment_events
                repayment_events_path = out_dir / "repayment_events.csv"
                metrics.to_repayment_events_csv(str(repayment_events_path))
                console.print(f"[green]✓[/green] Exported repayment events to {repayment_events_path}")

    # Export to HTML if requested (semantic HTML for readability)
    if html_output:
        from .html_export import export_pretty_html
        export_pretty_html(
            system=system,
            out_path=html_output,
            scenario_name=config.name,
            description=config.description,
            agent_ids=agent_ids,
            initial_balances=initial_balances,
            days_data=days_data,
            initial_rows=initial_rows,
            max_days=max_days,
            quiet_days=quiet_days,
        )
        console.print(f"[green]✓[/green] Exported HTML report: {html_output}")


def run_step_mode(
    system: System,
    max_days: int,
    show: str,
    agent_ids: Optional[List[str]],
    check_invariants: str,
    scenario_name: str,
    t_account: bool = False,
    enable_dealer: bool = False
) -> List[Dict[str, Any]]:
    """Run simulation in step-by-step mode.

    Args:
        system: Configured system
        max_days: Maximum days to simulate
        show: Event display mode
        agent_ids: Agent IDs to show balances for
        check_invariants: Invariant checking mode
        scenario_name: Name of the scenario for error context
        enable_dealer: If True, run dealer trading phase each day

    Returns:
        List of day data dictionaries
    """
    days_data = []

    for _ in range(max_days):
        # Get the current day before running
        day_before = system.state.day

        # Prompt to continue (ask about the next day which is day_before + 1)
        console.print()
        if not Confirm.ask(f"[cyan]Run day {day_before + 1}?[/cyan]", default=True):
            console.print("[yellow]Simulation stopped by user[/yellow]")
            break

        try:
            # Run the next day
            day_report = run_day(system, enable_dealer=enable_dealer)
            
            # Check invariants if requested
            if check_invariants == "daily":
                system.assert_invariants()
            
            # Skip day 0 display - it's already shown as "Day 0 (After Setup)"
            # But still capture Day 0 simulation events for HTML export
            if day_before == 0:
                # Only capture Day 0 simulation events for HTML
                day0_events = [e for e in system.state.events
                              if e.get("day") == 0 and e.get("phase") == "simulation"]
                if day0_events:
                    days_data.append({
                        'day': 0,
                        'events': day0_events,
                        'quiet': False,
                        'stable': False,
                        'balances': {},
                        'rows': {},
                        'agent_ids': [],
                    })
            if day_before >= 1:
                # Show day summary
                console.print(f"\n[bold cyan]📅 Day {day_before}[/bold cyan]")
                display_agent_ids = _filter_active_agent_ids(system, agent_ids) if agent_ids is not None else None
                renderables = show_day_summary_renderable(system, display_agent_ids, show, day=day_before, t_account=t_account)
                for renderable in renderables:
                    console.print(renderable)
                
                # Collect day data for HTML export  
                # Use the actual event day
                day_events = [e for e in system.state.events 
                             if e.get("day") == day_before and e.get("phase") == "simulation"]
                
                # Capture current balance state for this day
                day_balances: Dict[str, Any] = {}
                day_rows: Dict[str, Dict[str, list]] = {}
                active_agents_for_day: Optional[List[str]] = None
                if agent_ids is not None:
                    active_agents_for_day = display_agent_ids or []
                if active_agents_for_day:
                    from bilancio.analysis.balances import agent_balance
                    from bilancio.analysis.visualization import build_t_account_rows

                    def _row_dict(r):
                        return {
                            'name': getattr(r, 'name', ''),
                            'quantity': getattr(r, 'quantity', None),
                            'value_minor': getattr(r, 'value_minor', None),
                            'counterparty_name': getattr(r, 'counterparty_name', None),
                            'maturity': getattr(r, 'maturity', None),
                            'id_or_alias': getattr(r, 'id_or_alias', None),
                        }

                    for agent_id in active_agents_for_day:
                        day_balances[agent_id] = agent_balance(system, agent_id)
                        acct = build_t_account_rows(system, agent_id)
                        day_rows[agent_id] = {
                            'assets': [_row_dict(r) for r in acct.assets],
                            'liabs': [_row_dict(r) for r in acct.liabilities],
                        }
                
                days_data.append({
                    'day': day_before,  # Use actual event day, not 1-based counter
                    'events': day_events,
                    'quiet': day_report.quiet,
                    'stable': day_report.quiet and not day_report.has_open_obligations,
                    'balances': day_balances,
                    'rows': day_rows,
                    'agent_ids': active_agents_for_day if active_agents_for_day is not None else [],
                })
            
            # Check if we've reached a stable state
            if day_report.quiet and not day_report.has_open_obligations:
                console.print("[green]✓[/green] System reached stable state")
                break
                
        except DefaultError as e:
            show_error_panel(
                error=e,
                phase=f"day_{system.state.day}",
                context={
                    "scenario": scenario_name,
                    "day": system.state.day,
                    "phase": system.state.phase
                }
            )
            break
            
        except ValidationError as e:
            show_error_panel(
                error=e,
                phase=f"day_{system.state.day}",
                context={
                    "scenario": scenario_name,
                    "day": system.state.day,
                    "phase": system.state.phase
                }
            )
            break
            
        except Exception as e:
            show_error_panel(
                error=e,
                phase=f"day_{system.state.day}",
                context={
                    "scenario": scenario_name,
                    "day": system.state.day
                }
            )
            break
    
    # Show final summary
    console.print("\n[bold]Simulation Complete[/bold]")
    console.print(show_simulation_summary_renderable(system))
    
    return days_data


def run_until_stable_mode(
    system: System,
    max_days: int,
    quiet_days: int,
    show: str,
    agent_ids: Optional[List[str]],
    check_invariants: str,
    scenario_name: str,
    t_account: bool = False,
    enable_dealer: bool = False,
    progress_callback: Optional[Callable[[int, int], None]] = None,
) -> List[Dict[str, Any]]:
    """Run simulation until stable state is reached.

    Args:
        system: Configured system
        max_days: Maximum days to simulate
        quiet_days: Required quiet days for stable state
        show: Event display mode
        agent_ids: Agent IDs to show balances for
        check_invariants: Invariant checking mode
        scenario_name: Name of the scenario for error context
        enable_dealer: If True, run dealer trading phase each day
        progress_callback: Optional callback(current_day, max_days) for progress tracking

    Returns:
        List of day data dictionaries
    """
    # Plan 030: Skip verbose output in quiet mode (show="none")
    quiet_mode = show == "none"
    if not quiet_mode:
        console.print(f"\n[dim]Running simulation until stable (max {max_days} days)...[/dim]\n")

    try:
        # Run simulation day by day to capture correct balance snapshots
        from bilancio.engines.simulation import run_day, _impacted_today, _has_open_obligations
        from bilancio.analysis.balances import agent_balance

        reports = []
        consecutive_quiet = 0
        days_data = []

        for _ in range(max_days):
            # Run the next day
            day_before = system.state.day
            run_day(system, enable_dealer=enable_dealer)
            impacted = _impacted_today(system, day_before)

            # Call progress callback if provided
            if progress_callback:
                progress_callback(day_before + 1, max_days)
            
            # Create report
            from bilancio.engines.simulation import DayReport
            report = DayReport(day=day_before, impacted=impacted)
            reports.append(report)
            
            # Skip day 0 display - it's already shown as "Day 0 (After Setup)"
            # But still capture Day 0 simulation events for HTML export
            if day_before == 0:
                # Only capture Day 0 simulation events for HTML
                day0_events = [e for e in system.state.events
                              if e.get("day") == 0 and e.get("phase") == "simulation"]
                if day0_events:
                    days_data.append({
                        'day': 0,
                        'events': day0_events,
                        'quiet': False,
                        'stable': False,
                        'balances': {},
                        'rows': {},
                        'agent_ids': [],
                    })
            if day_before >= 1:
                # Display this day's results immediately (with correct balance state)
                # Plan 030: Skip day headers in quiet mode
                if not quiet_mode:
                    console.print(f"[bold cyan]📅 Day {day_before}[/bold cyan]")

                # Check invariants if requested
                if check_invariants == "daily":
                    try:
                        system.assert_invariants()
                    except Exception as e:
                        if not quiet_mode:
                            console.print(f"[yellow]⚠ Invariant check failed: {e}[/yellow]")

                # Show events and balances for this specific day
                # Note: events are stored with 0-based day numbers
                # Plan 030: show_day_summary_renderable returns [] for show="none"
                # Always compute display_agent_ids (needed for HTML export even in quiet mode)
                display_agent_ids = _filter_active_agent_ids(system, agent_ids) if agent_ids is not None else None
                if not quiet_mode:
                    renderables = show_day_summary_renderable(system, display_agent_ids, show, day=day_before, t_account=t_account)
                    for renderable in renderables:
                        console.print(renderable)
                
                # Collect day data for HTML export
                # We want simulation events from the day that was just displayed
                # show_day_summary was called with day=day_before
                day_events = [e for e in system.state.events
                             if e.get("day") == day_before and e.get("phase") == "simulation"]
                # Plan 024: stability check accounts for rollover mode
                is_stable = consecutive_quiet >= quiet_days
                if not system.state.rollover_enabled:
                    is_stable = is_stable and not _has_open_obligations(system)
                
                # Capture current balance state for this day
                day_balances: Dict[str, Any] = {}
                day_rows: Dict[str, Dict[str, list]] = {}
                active_agents_for_day: Optional[List[str]] = None
                if agent_ids is not None:
                    active_agents_for_day = display_agent_ids or []
                if active_agents_for_day:
                    from bilancio.analysis.visualization import build_t_account_rows
                    for agent_id in active_agents_for_day:
                        day_balances[agent_id] = agent_balance(system, agent_id)
                        acct = build_t_account_rows(system, agent_id)
                        def to_row(r):
                            return {
                                'name': getattr(r, 'name', ''),
                                'quantity': getattr(r, 'quantity', None),
                                'value_minor': getattr(r, 'value_minor', None),
                                'counterparty_name': getattr(r, 'counterparty_name', None),
                                'maturity': getattr(r, 'maturity', None),
                                'id_or_alias': getattr(r, 'id_or_alias', None),
                            }
                        day_rows[agent_id] = {
                            'assets': [to_row(r) for r in acct.assets],
                            'liabs': [to_row(r) for r in acct.liabilities],
                        }
                
                days_data.append({
                    'day': day_before,  # Use actual event day, not 1-based counter
                    'events': day_events,
                    'quiet': report.impacted == 0,
                    'stable': is_stable,
                    'balances': day_balances,
                    'rows': day_rows,
                    'agent_ids': active_agents_for_day if active_agents_for_day is not None else [],
                })
                
                # Show activity summary (Plan 030: skip in quiet mode)
                if not quiet_mode:
                    if report.impacted > 0:
                        console.print(f"[dim]Activity: {report.impacted} impactful events[/dim]")
                    else:
                        console.print("[dim]→ Quiet day (no activity)[/dim]")

                    if report.notes:
                        console.print(f"[dim]Note: {report.notes}[/dim]")

                    console.print()
            
            # Check for stable state
            if impacted == 0:
                consecutive_quiet += 1
            else:
                consecutive_quiet = 0

            # Plan 024: With rollover, we can never have "no open obligations"
            # because debt continuously rolls over. Check stability based on quiet days only.
            stability_condition = consecutive_quiet >= quiet_days
            if not system.state.rollover_enabled:
                stability_condition = stability_condition and not _has_open_obligations(system)

            if stability_condition:
                console.print("[green]✓[/green] System reached stable state")
                break
        
        # If we didn't break early, check if we hit max days
        else:
            console.print("[yellow]⚠[/yellow] Maximum days reached without stable state")
        
    except DefaultError as e:
        show_error_panel(
            error=e,
            phase="simulation",
            context={
                "scenario": scenario_name,
                "day": system.state.day,
                "phase": system.state.phase
            }
        )
        
    except ValidationError as e:
        show_error_panel(
            error=e,
            phase="simulation",
            context={
                "scenario": scenario_name,
                "day": system.state.day,
                "phase": system.state.phase
            }
        )
        
    except Exception as e:
        show_error_panel(
            error=e,
            phase="simulation",
            context={
                "scenario": scenario_name,
                "day": system.state.day
            }
        )
    
    # Show final summary
    console.print("\n[bold]Simulation Complete[/bold]")
    console.print(show_simulation_summary_renderable(system))
    
    return days_data

```

---

### 📄 src/bilancio/ui/settings.py

```python
"""UI settings and configuration for bilancio display."""

from dataclasses import dataclass


@dataclass(frozen=True)
class Settings:
    """Central configuration for UI display settings."""
    
    # Console settings
    console_width: int = 100        # Width used by Console(width=...) universally
    
    # Currency and display
    currency_denom: str = "X"       # Default denomination symbol
    currency_precision: int = 2     # Decimal places for currency values
    
    # HTML export settings
    html_inline_styles: bool = True # Whether to inline CSS styles in HTML export
    
    # Table display settings
    balance_table_width: int = 80   # Width for balance sheet tables
    event_panel_width: int = 90     # Width for event panels
    
    # Formatting thresholds
    zero_threshold: float = 0.01    # Values below this are considered zero
    
    # Event display settings
    max_event_lines: int = 10       # Maximum lines per event in display
    show_event_icons: bool = True   # Whether to show emoji icons for events
    
    # Phase colors (for Rich console)
    phase_colors: dict = None
    
    def __post_init__(self):
        """Initialize mutable defaults."""
        if self.phase_colors is None:
            # Use object.__setattr__ to set value on frozen dataclass
            object.__setattr__(self, 'phase_colors', {
                'A': 'cyan',
                'B': 'yellow', 
                'C': 'green'
            })


# Global default settings instance
DEFAULT_SETTINGS = Settings()
```

---

### 📄 src/bilancio/ui/wizard.py

```python
"""Interactive wizard for creating Bilancio scenarios."""

import yaml
from pathlib import Path
from typing import Optional
from rich.console import Console
from rich.prompt import Prompt, IntPrompt, Confirm

console = Console()


def create_scenario_wizard(output_path: Path, template: Optional[str] = None) -> None:
    """Interactive wizard to create a scenario configuration.
    
    Args:
        output_path: Path where to save the configuration
        template: Optional template name to use (simple, standard, complex, or path to YAML)
    """
    console.print("[bold cyan]Bilancio Scenario Creator[/bold cyan]\n")
    
    # If template is provided, use it to determine complexity
    if template:
        # Check if template is a file path
        template_path = Path(template)
        if template_path.exists() and template_path.suffix in ['.yaml', '.yml']:
            # Load existing YAML as template
            console.print(f"[dim]Using template from: {template}[/dim]")
            with open(template_path, 'r') as f:
                config = yaml.safe_load(f)
            
            # Allow user to modify the loaded template
            name = Prompt.ask("Scenario name", default=config.get("name", "My Scenario"))
            description = Prompt.ask("Description (optional)", 
                                    default=config.get("description", ""))
            
            # Update the config with new name and description
            config["name"] = name
            config["description"] = description or None
            
            # Save and exit early
            output_path.parent.mkdir(parents=True, exist_ok=True)
            with open(output_path, 'w') as f:
                yaml.dump(config, f, default_flow_style=False, sort_keys=False)
            
            console.print(f"\n[green]✓[/green] Scenario configuration saved to: {output_path}")
            console.print(f"\nRun your scenario with: [cyan]bilancio run {output_path}[/cyan]")
            return
        
        # Otherwise, treat template as complexity level
        elif template in ["simple", "standard", "complex"]:
            complexity = template
            console.print(f"[dim]Using {complexity} template[/dim]")
        else:
            console.print(f"[yellow]Warning: Unknown template '{template}', using interactive mode[/yellow]")
            complexity = Prompt.ask(
                "Complexity",
                choices=["simple", "standard", "complex"],
                default="simple"
            )
    else:
        # No template provided, ask for complexity
        complexity = Prompt.ask(
            "Complexity",
            choices=["simple", "standard", "complex"],
            default="simple"
        )
    
    # Get basic information (with fallback for non-interactive mode)
    try:
        name = Prompt.ask("Scenario name", default="My Scenario")
        description = Prompt.ask("Description (optional)", default="")
    except (EOFError, KeyboardInterrupt):
        # Non-interactive mode or user cancelled - use defaults
        name = "My Scenario"
        description = ""
    
    config = {
        "version": 1,
        "name": name,
        "description": description or None,
        "agents": [],
        "initial_actions": [],
        "run": {
            "mode": "until_stable",
            "max_days": 90,
            "quiet_days": 2,
            "show": {
                "events": "detailed"
            }
        }
    }
    
    if complexity == "simple":
        # Simple: 1 central bank, 1 bank, 2 households
        config["agents"] = [
            {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
            {"id": "B1", "kind": "bank", "name": "First Bank"},
            {"id": "H1", "kind": "household", "name": "Household 1"},
            {"id": "H2", "kind": "household", "name": "Household 2"}
        ]
        
        config["initial_actions"] = [
            {"mint_reserves": {"to": "B1", "amount": 10000}},
            {"mint_cash": {"to": "H1", "amount": 1000}},
            {"mint_cash": {"to": "H2", "amount": 1000}},
            {"deposit_cash": {"customer": "H1", "bank": "B1", "amount": 800}}
        ]
        
        config["run"]["show"]["balances"] = ["B1", "H1", "H2"]
        
    elif complexity == "standard":
        # Standard: Add a firm and some delivery obligations
        config["agents"] = [
            {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
            {"id": "B1", "kind": "bank", "name": "First Bank"},
            {"id": "B2", "kind": "bank", "name": "Second Bank"},
            {"id": "H1", "kind": "household", "name": "Household 1"},
            {"id": "H2", "kind": "household", "name": "Household 2"},
            {"id": "F1", "kind": "firm", "name": "ABC Corp"}
        ]
        
        config["initial_actions"] = [
            {"mint_reserves": {"to": "B1", "amount": 10000}},
            {"mint_reserves": {"to": "B2", "amount": 10000}},
            {"mint_cash": {"to": "H1", "amount": 2000}},
            {"mint_cash": {"to": "H2", "amount": 1500}},
            {"deposit_cash": {"customer": "H1", "bank": "B1", "amount": 1500}},
            {"deposit_cash": {"customer": "H2", "bank": "B2", "amount": 1000}},
            {"create_stock": {"owner": "F1", "sku": "WIDGET", "quantity": 100, "unit_price": "50"}},
            {"create_delivery_obligation": {
                "from": "F1", "to": "H1", 
                "sku": "WIDGET", "quantity": 5, 
                "unit_price": "50", "due_day": 2
            }}
        ]
        
        config["run"]["show"]["balances"] = ["B1", "B2", "H1", "H2", "F1"]
        
    else:  # complex
        console.print("[yellow]Complex scenarios should be hand-crafted.[/yellow]")
        console.print("Creating a template with all available features...")
        
        # Complex: Full example with all features
        config["policy_overrides"] = {
            "mop_rank": {
                "household": ["bank_deposit", "cash"],
                "bank": ["reserve_deposit"]
            }
        }
        
        config["agents"] = [
            {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
            {"id": "T1", "kind": "treasury", "name": "Treasury"},
            {"id": "B1", "kind": "bank", "name": "Commercial Bank 1"},
            {"id": "B2", "kind": "bank", "name": "Commercial Bank 2"},
            {"id": "H1", "kind": "household", "name": "Smith Family"},
            {"id": "H2", "kind": "household", "name": "Jones Family"},
            {"id": "F1", "kind": "firm", "name": "Manufacturing Inc"},
            {"id": "F2", "kind": "firm", "name": "Retail Corp"}
        ]
        
        config["initial_actions"] = [
            # Initial reserves
            {"mint_reserves": {"to": "B1", "amount": 50000}},
            {"mint_reserves": {"to": "B2", "amount": 50000}},
            
            # Initial cash
            {"mint_cash": {"to": "H1", "amount": 5000}},
            {"mint_cash": {"to": "H2", "amount": 3000}},
            {"mint_cash": {"to": "F1", "amount": 10000}},
            {"mint_cash": {"to": "F2", "amount": 8000}},
            
            # Bank deposits
            {"deposit_cash": {"customer": "H1", "bank": "B1", "amount": 4000}},
            {"deposit_cash": {"customer": "H2", "bank": "B2", "amount": 2500}},
            {"deposit_cash": {"customer": "F1", "bank": "B1", "amount": 8000}},
            {"deposit_cash": {"customer": "F2", "bank": "B2", "amount": 6000}},
            
            # Create inventory
            {"create_stock": {"owner": "F1", "sku": "MACHINE", "quantity": 10, "unit_price": "1000"}},
            {"create_stock": {"owner": "F2", "sku": "GOODS", "quantity": 100, "unit_price": "50"}},
            
            # Create obligations
            {"create_delivery_obligation": {
                "from": "F1", "to": "F2",
                "sku": "MACHINE", "quantity": 2,
                "unit_price": "1000", "due_day": 3
            }},
            {"create_payable": {
                "from": "H1", "to": "F2",
                "amount": 500, "due_day": 1
            }}
        ]
        
        config["run"]["show"]["balances"] = ["CB", "B1", "B2", "H1", "H2", "F1", "F2"]
        config["run"]["export"] = {
            "balances_csv": "out/balances.csv",
            "events_jsonl": "out/events.jsonl"
        }
    
    # Save the configuration
    output_path.parent.mkdir(parents=True, exist_ok=True)
    with open(output_path, 'w') as f:
        yaml.dump(config, f, default_flow_style=False, sort_keys=False)
    
    console.print(f"\n[green]✓[/green] Scenario configuration saved to: {output_path}")
    console.print(f"\nRun your scenario with: [cyan]bilancio run {output_path}[/cyan]")
```

---

## Tests

Below are all the test files:

### 🧪 tests/analysis/__init__.py

```python
"""Analysis module tests."""
```

---

### 🧪 tests/analysis/test_balances.py

```python
"""Comprehensive tests for the balance analytics module."""
from decimal import Decimal

import pytest

from bilancio.engines.system import System
from bilancio.domain.agents import CentralBank, Bank, Household
from bilancio.ops.banking import deposit_cash
from bilancio.analysis.balances import agent_balance, system_trial_balance


class TestBalanceAnalytics:
    """Test comprehensive balance analytics scenarios."""

    def test_agent_balance_simple_deposit(self):
        """Test agent balance with a simple cash deposit scenario.
        
        Creates System with CentralBank, Bank, and Household.
        Mints cash to household, then deposits at bank.
        Verifies household has deposit asset, no liabilities.
        Verifies bank has deposit liability and cash asset.
        Verifies trial balance totals match.
        """
        # Create system and agents
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        bank = Bank(id="BK01", name="Test Bank", kind="bank")  
        household = Household(id="HH01", name="Test Household", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(bank)
        system.add_agent(household)
        
        # Mint cash to household
        cash_amount = 1000
        system.mint_cash("HH01", cash_amount)
        
        # Deposit cash at bank
        deposit_amount = 600
        deposit_id = deposit_cash(system, "HH01", "BK01", deposit_amount)
        
        # Verify household balance
        hh_balance = agent_balance(system, "HH01")
        assert hh_balance.agent_id == "HH01"
        assert hh_balance.total_financial_assets == deposit_amount + (cash_amount - deposit_amount)
        assert hh_balance.total_financial_liabilities == 0
        assert hh_balance.net_financial == cash_amount  # Still has same total wealth
        assert hh_balance.assets_by_kind.get("bank_deposit", 0) == deposit_amount
        assert hh_balance.assets_by_kind.get("cash", 0) == cash_amount - deposit_amount
        assert hh_balance.liabilities_by_kind == {}
        
        # Verify bank balance
        bank_balance = agent_balance(system, "BK01")
        assert bank_balance.agent_id == "BK01"
        assert bank_balance.total_financial_assets == deposit_amount  # Cash from household
        assert bank_balance.total_financial_liabilities == deposit_amount  # Deposit liability
        assert bank_balance.net_financial == 0  # Bank's net position is zero
        assert bank_balance.assets_by_kind.get("cash", 0) == deposit_amount
        assert bank_balance.liabilities_by_kind.get("bank_deposit", 0) == deposit_amount
        
        # Verify trial balance
        trial = system_trial_balance(system)
        assert trial.total_financial_assets == trial.total_financial_liabilities
        expected_total = cash_amount + deposit_amount  # Cash + deposit instruments
        assert trial.total_financial_assets == expected_total
        assert trial.assets_by_kind.get("cash", 0) == cash_amount
        assert trial.assets_by_kind.get("bank_deposit", 0) == deposit_amount
        assert trial.liabilities_by_kind.get("cash", 0) == cash_amount
        assert trial.liabilities_by_kind.get("bank_deposit", 0) == deposit_amount
        
        # Ensure all invariants pass
        system.assert_invariants()

    def test_trial_balance_reserves_counters_match(self):
        """Test trial balance with reserves.
        
        Creates System with CentralBank and two Banks.
        Mints reserves to both banks.
        Verifies trial balance shows correct reserve amounts.
        Verifies assets equal liabilities system-wide.
        """
        # Create system and agents
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        bank1 = Bank(id="BK01", name="Bank One", kind="bank")
        bank2 = Bank(id="BK02", name="Bank Two", kind="bank")
        
        system.bootstrap_cb(cb)
        system.add_agent(bank1)
        system.add_agent(bank2)
        
        # Mint reserves to both banks
        reserves1_amount = 5000
        reserves2_amount = 3000
        system.mint_reserves("BK01", reserves1_amount)
        system.mint_reserves("BK02", reserves2_amount)
        
        # Verify individual bank balances
        bank1_balance = agent_balance(system, "BK01")
        assert bank1_balance.total_financial_assets == reserves1_amount
        assert bank1_balance.total_financial_liabilities == 0
        assert bank1_balance.net_financial == reserves1_amount
        assert bank1_balance.assets_by_kind.get("reserve_deposit", 0) == reserves1_amount
        assert bank1_balance.liabilities_by_kind == {}
        
        bank2_balance = agent_balance(system, "BK02")
        assert bank2_balance.total_financial_assets == reserves2_amount
        assert bank2_balance.total_financial_liabilities == 0
        assert bank2_balance.net_financial == reserves2_amount
        assert bank2_balance.assets_by_kind.get("reserve_deposit", 0) == reserves2_amount
        assert bank2_balance.liabilities_by_kind == {}
        
        # Verify central bank balance
        cb_balance = agent_balance(system, "CB01")
        assert cb_balance.total_financial_assets == 0
        assert cb_balance.total_financial_liabilities == reserves1_amount + reserves2_amount
        assert cb_balance.net_financial == -(reserves1_amount + reserves2_amount)
        assert cb_balance.assets_by_kind == {}
        assert cb_balance.liabilities_by_kind.get("reserve_deposit", 0) == reserves1_amount + reserves2_amount
        
        # Verify trial balance
        trial = system_trial_balance(system)
        total_reserves = reserves1_amount + reserves2_amount
        assert trial.total_financial_assets == trial.total_financial_liabilities == total_reserves
        assert trial.assets_by_kind.get("reserve_deposit", 0) == total_reserves
        assert trial.liabilities_by_kind.get("reserve_deposit", 0) == total_reserves
        
        # Verify system tracking counters match
        assert system.state.cb_reserves_outstanding == total_reserves
        
        # Ensure all invariants pass
        system.assert_invariants()

    def test_duplicate_ref_invariant(self):
        """Test the duplicate reference invariant.
        
        Creates System with agents.
        Mints cash.
        Manually duplicates a reference to trigger the invariant.
        Verifies the invariant catches the duplicate.
        """
        # Create system and agents
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        household = Household(id="HH01", name="Test Household", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(household)
        
        # Mint cash
        cash_id = system.mint_cash("HH01", 1000)
        
        # System should be valid at this point
        system.assert_invariants()
        
        # Now manually introduce a duplicate reference to test invariant
        # This simulates a bug where the same contract ID appears twice in asset_ids
        household.asset_ids.append(cash_id)  # Add duplicate
        
        # The invariant should catch this duplicate
        with pytest.raises(AssertionError, match="duplicate asset ref"):
            system.assert_invariants()
        
        # Remove the duplicate to restore system integrity
        household.asset_ids.remove(cash_id)
        
        # System should be valid again
        system.assert_invariants()
        
        # Test duplicate liability reference as well
        cb.liability_ids.append(cash_id)  # Add duplicate liability ref
        
        with pytest.raises(AssertionError, match="duplicate liability ref"):
            system.assert_invariants()

    def test_comprehensive_multi_agent_scenario(self):
        """Test a complex scenario with multiple agents and instrument types."""
        # Create system with multiple agents
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        bank1 = Bank(id="BK01", name="Bank One", kind="bank")
        bank2 = Bank(id="BK02", name="Bank Two", kind="bank")
        hh1 = Household(id="HH01", name="Household One", kind="household")
        hh2 = Household(id="HH02", name="Household Two", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(bank1)
        system.add_agent(bank2)
        system.add_agent(hh1)
        system.add_agent(hh2)
        
        # Complex operations
        # 1. Mint reserves to banks
        system.mint_reserves("BK01", 10000)
        system.mint_reserves("BK02", 8000)
        
        # 2. Mint cash to households
        system.mint_cash("HH01", 2000)
        system.mint_cash("HH02", 1500)
        
        # 3. Make deposits
        deposit_cash(system, "HH01", "BK01", 1200)
        deposit_cash(system, "HH02", "BK02", 800)
        
        # 4. Create some non-financial instruments
        # Create stock for HH01
        system.create_stock("HH01", "INVENTORY", 50, Decimal("0"))
        # Create delivery obligation from HH01 to HH02
        system.create_delivery_obligation("HH01", "HH02", "WIDGETS", 25, Decimal("0"), due_day=1)
        
        # Verify system-wide balance
        trial = system_trial_balance(system)
        
        # Calculate expected totals
        total_reserves = 18000  # 10000 + 8000
        total_cash = 3500     # 2000 + 1500 original cash
        total_deposits = 2000  # 1200 + 800
        total_delivery_obligations = 25
        
        expected_financial_total = total_reserves + total_cash + total_deposits
        
        assert trial.total_financial_assets == trial.total_financial_liabilities == expected_financial_total
        assert trial.assets_by_kind.get("reserve_deposit", 0) == total_reserves
        assert trial.assets_by_kind.get("cash", 0) == total_cash
        assert trial.assets_by_kind.get("bank_deposit", 0) == total_deposits
        assert trial.assets_by_kind.get("delivery_obligation", 0) == total_delivery_obligations
        
        # Verify individual balances make sense
        hh1_balance = agent_balance(system, "HH01")
        # HH01 should have: remaining cash + deposit + delivery obligation liability
        expected_hh1_cash = 2000 - 1200  # 800
        assert hh1_balance.assets_by_kind.get("cash", 0) == expected_hh1_cash
        assert hh1_balance.assets_by_kind.get("bank_deposit", 0) == 1200
        assert hh1_balance.liabilities_by_kind.get("delivery_obligation", 0) == 25
        
        # Bank1 should have: reserves + cash from deposit, deposit liability
        bank1_balance = agent_balance(system, "BK01")
        assert bank1_balance.assets_by_kind.get("reserve_deposit", 0) == 10000
        assert bank1_balance.assets_by_kind.get("cash", 0) == 1200  # From HH01 deposit
        assert bank1_balance.liabilities_by_kind.get("bank_deposit", 0) == 1200
        
        # Ensure all invariants pass
        system.assert_invariants()
```

---

### 🧪 tests/analysis/test_metrics_computer.py

```python
"""Tests for MetricsComputer."""

import json
import pytest
from pathlib import Path
from typing import Dict, Any, List

from bilancio.storage.artifact_loaders import LocalArtifactLoader
from bilancio.analysis.metrics_computer import MetricsComputer, MetricsBundle


# Sample events in JSONL format for testing
SAMPLE_EVENTS_JSONL = """{"type": "setup", "event": "mint_reserves", "day": 0, "amount": 10000, "to": "Bank1"}
{"type": "setup", "event": "create_payable", "day": 0, "from": "Firm1", "to": "Firm2", "amount": 500, "due_day": 1}
{"type": "phase", "day": 1, "phase": "B"}
{"type": "settlement", "day": 1, "from": "Firm1", "to": "Firm2", "amount": 500, "event": "settled"}
{"type": "phase", "day": 1, "phase": "C"}
{"type": "end_day", "day": 1}
{"type": "phase", "day": 2, "phase": "B"}
{"type": "phase", "day": 2, "phase": "C"}
{"type": "end_day", "day": 2}
"""

# Sample balances CSV content
SAMPLE_BALANCES_CSV = """day,agent,account,balance
0,Bank1,reserves,10000
0,Firm1,deposits,2000
0,Firm2,deposits,1000
1,Bank1,reserves,10000
1,Firm1,deposits,1500
1,Firm2,deposits,1500
"""


@pytest.fixture
def sample_events_file(tmp_path: Path) -> Path:
    """Create a sample events.jsonl file."""
    events_file = tmp_path / "events.jsonl"
    events_file.write_text(SAMPLE_EVENTS_JSONL)
    return events_file


@pytest.fixture
def sample_balances_file(tmp_path: Path) -> Path:
    """Create a sample balances.csv file."""
    balances_file = tmp_path / "balances.csv"
    balances_file.write_text(SAMPLE_BALANCES_CSV)
    return balances_file


@pytest.fixture
def loader(tmp_path: Path) -> LocalArtifactLoader:
    """Create a LocalArtifactLoader for temp directory."""
    return LocalArtifactLoader(tmp_path)


@pytest.fixture
def computer(loader: LocalArtifactLoader) -> MetricsComputer:
    """Create a MetricsComputer instance."""
    return MetricsComputer(loader)


class TestMetricsComputerCompute:
    """Tests for MetricsComputer.compute()."""

    def test_compute_with_events_only(
        self, computer: MetricsComputer, sample_events_file: Path
    ):
        """compute() works with only events_jsonl artifact."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        assert isinstance(bundle, MetricsBundle)
        assert isinstance(bundle.day_metrics, list)
        assert isinstance(bundle.debtor_shares, list)
        assert isinstance(bundle.intraday, list)
        assert isinstance(bundle.summary, dict)

    def test_compute_with_events_and_balances(
        self,
        computer: MetricsComputer,
        sample_events_file: Path,
        sample_balances_file: Path,
    ):
        """compute() works with both events_jsonl and balances_csv."""
        artifacts = {
            "events_jsonl": "events.jsonl",
            "balances_csv": "balances.csv",
        }
        bundle = computer.compute(artifacts)

        assert isinstance(bundle, MetricsBundle)
        # With balances, M_t and G_t should potentially be computed
        assert bundle.day_metrics is not None

    def test_compute_raises_keyerror_when_events_missing(
        self, computer: MetricsComputer
    ):
        """compute() raises KeyError when events_jsonl is missing."""
        artifacts: Dict[str, str] = {}

        with pytest.raises(KeyError) as exc_info:
            computer.compute(artifacts)

        assert "events_jsonl" in str(exc_info.value)

    def test_compute_raises_keyerror_when_events_none(
        self, computer: MetricsComputer
    ):
        """compute() raises KeyError when events_jsonl is None."""
        artifacts = {"events_jsonl": None}

        with pytest.raises(KeyError):
            computer.compute(artifacts)

    def test_compute_raises_filenotfound_for_missing_events_file(
        self, computer: MetricsComputer, tmp_path: Path
    ):
        """compute() raises FileNotFoundError when events file doesn't exist."""
        artifacts = {"events_jsonl": "nonexistent.jsonl"}

        with pytest.raises(FileNotFoundError):
            computer.compute(artifacts)

    def test_compute_with_day_list(
        self, computer: MetricsComputer, sample_events_file: Path
    ):
        """compute() accepts optional day_list parameter."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts, day_list=[1])

        assert isinstance(bundle, MetricsBundle)

    def test_compute_ignores_missing_balances_file(
        self, computer: MetricsComputer, sample_events_file: Path
    ):
        """compute() ignores balances_csv if file doesn't exist."""
        artifacts = {
            "events_jsonl": "events.jsonl",
            "balances_csv": "nonexistent_balances.csv",
        }

        # Should not raise, just skip balances
        bundle = computer.compute(artifacts)
        assert isinstance(bundle, MetricsBundle)

    def test_compute_returns_metrics_bundle(
        self, computer: MetricsComputer, sample_events_file: Path
    ):
        """compute() returns a MetricsBundle instance."""
        artifacts = {"events_jsonl": "events.jsonl"}
        result = computer.compute(artifacts)

        assert isinstance(result, MetricsBundle)


class TestMetricsComputerWriteOutputs:
    """Tests for MetricsComputer.write_outputs()."""

    def test_write_outputs_creates_metrics_csv(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates metrics.csv file."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        assert "metrics_csv" in paths
        assert paths["metrics_csv"].exists()
        assert paths["metrics_csv"].name == "metrics.csv"

    def test_write_outputs_creates_metrics_json(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates metrics.json file."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        assert "metrics_json" in paths
        assert paths["metrics_json"].exists()
        assert paths["metrics_json"].name == "metrics.json"

    def test_write_outputs_creates_debtor_shares_csv(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates debtor_shares.csv file."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        assert "debtor_shares_csv" in paths
        assert paths["debtor_shares_csv"].exists()
        assert paths["debtor_shares_csv"].name == "debtor_shares.csv"

    def test_write_outputs_creates_intraday_csv(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates intraday.csv file."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        assert "intraday_csv" in paths
        assert paths["intraday_csv"].exists()
        assert paths["intraday_csv"].name == "intraday.csv"

    def test_write_outputs_creates_metrics_html(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates metrics.html file."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        assert "metrics_html" in paths
        assert paths["metrics_html"].exists()
        assert paths["metrics_html"].name == "metrics.html"

    def test_write_outputs_creates_all_expected_files(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates all 5 expected output files."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(bundle, output_dir)

        expected_files = {
            "metrics_csv",
            "metrics_json",
            "debtor_shares_csv",
            "intraday_csv",
            "metrics_html",
        }
        assert set(paths.keys()) == expected_files

    def test_write_outputs_creates_output_directory(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() creates output directory if it doesn't exist."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "nested" / "output"
        assert not output_dir.exists()

        computer.write_outputs(bundle, output_dir)

        assert output_dir.exists()

    def test_write_outputs_accepts_title_and_subtitle(
        self, computer: MetricsComputer, sample_events_file: Path, tmp_path: Path
    ):
        """write_outputs() accepts optional title and subtitle."""
        artifacts = {"events_jsonl": "events.jsonl"}
        bundle = computer.compute(artifacts)

        output_dir = tmp_path / "output"
        paths = computer.write_outputs(
            bundle, output_dir, title="Test Report", subtitle="Test Subtitle"
        )

        # Just verify it doesn't raise and creates the files
        assert paths["metrics_html"].exists()


class TestMetricsBundle:
    """Tests for MetricsBundle dataclass."""

    def test_metrics_bundle_has_day_metrics_attribute(self):
        """MetricsBundle has day_metrics attribute."""
        bundle = MetricsBundle(
            day_metrics=[],
            debtor_shares=[],
            intraday=[],
            summary={},
        )
        assert hasattr(bundle, "day_metrics")

    def test_metrics_bundle_has_debtor_shares_attribute(self):
        """MetricsBundle has debtor_shares attribute."""
        bundle = MetricsBundle(
            day_metrics=[],
            debtor_shares=[],
            intraday=[],
            summary={},
        )
        assert hasattr(bundle, "debtor_shares")

    def test_metrics_bundle_has_intraday_attribute(self):
        """MetricsBundle has intraday attribute."""
        bundle = MetricsBundle(
            day_metrics=[],
            debtor_shares=[],
            intraday=[],
            summary={},
        )
        assert hasattr(bundle, "intraday")

    def test_metrics_bundle_has_summary_attribute(self):
        """MetricsBundle has summary attribute."""
        bundle = MetricsBundle(
            day_metrics=[],
            debtor_shares=[],
            intraday=[],
            summary={},
        )
        assert hasattr(bundle, "summary")

    def test_metrics_bundle_stores_values(self):
        """MetricsBundle stores provided values correctly."""
        day_metrics = [{"day": 1, "S_t": 100}]
        debtor_shares = [{"day": 1, "agent": "A", "DS_t": 0.5}]
        intraday = [{"day": 1, "step": 0, "P_prefix": 50}]
        summary = {"phi_total": 100.0, "delta_total": 50.0}

        bundle = MetricsBundle(
            day_metrics=day_metrics,
            debtor_shares=debtor_shares,
            intraday=intraday,
            summary=summary,
        )

        assert bundle.day_metrics == day_metrics
        assert bundle.debtor_shares == debtor_shares
        assert bundle.intraday == intraday
        assert bundle.summary == summary


class TestMetricsComputerInit:
    """Tests for MetricsComputer initialization."""

    def test_init_stores_loader(self, loader: LocalArtifactLoader):
        """__init__ stores the loader."""
        computer = MetricsComputer(loader)
        assert computer.loader is loader

    def test_accepts_artifact_loader_protocol(self, tmp_path: Path):
        """__init__ accepts any ArtifactLoader implementation."""
        loader = LocalArtifactLoader(tmp_path)
        computer = MetricsComputer(loader)
        assert computer.loader is not None

```

---

### 🧪 tests/analysis/test_report_aggregate.py

```python
from decimal import Decimal
from pathlib import Path

from bilancio.analysis.report import aggregate_runs, render_dashboard


def test_aggregate_runs_and_dashboard(tmp_path):
    base = tmp_path
    registry_dir = base / "registry"
    runs_dir = base / "runs"
    aggregate_dir = base / "aggregate"
    registry_dir.mkdir()
    run_dir = runs_dir / "grid_abcd"
    out_dir = run_dir / "out"
    out_dir.mkdir(parents=True)
    aggregate_dir.mkdir()

    metrics_csv = out_dir / "metrics.csv"
    metrics_csv.write_text(
        "day,S_t,phi_t,delta_t,G_t,alpha_t,Mpeak_t,v_t,HHIplus_t\n"
        "1,100,1,0,0,0.4,50,2,0.5\n"
        "2,50,0.5,0.5,10,0.2,40,1.5,0.3\n"
    )

    registry_csv = registry_dir / "experiments.csv"
    registry_csv.write_text(
        "run_id,phase,seed,n_agents,kappa,concentration,mu,monotonicity,Q_total,S1,L0,scenario_yaml,events_jsonl,balances_csv,metrics_csv,metrics_html,run_html,status,time_to_stability,phi_total,delta_total,error\n"
        "grid_abcd,grid,42,5,1,0.5,0.25,0,150,150,120,../runs/grid_abcd/scenario.yaml,../runs/grid_abcd/out/events.jsonl,../runs/grid_abcd/out/balances.csv,../runs/grid_abcd/out/metrics.csv,../runs/grid_abcd/out/metrics.html,../runs/grid_abcd/run.html,completed,2,,,\n"
    )

    results_csv = aggregate_dir / "results.csv"
    rows = aggregate_runs(registry_csv, results_csv)

    assert rows
    row = rows[0]
    assert row["phi_total"] == Decimal("0.8333333333333333333333333333")
    assert row["delta_total"] == Decimal("0.1666666666666666666666666667")
    assert row["monotonicity"] == "0"
    assert results_csv.exists()

    dashboard_html = aggregate_dir / "dashboard.html"
    render_dashboard(results_csv, dashboard_html)
    assert dashboard_html.exists()
    html_content = dashboard_html.read_text()
    assert "grid_abcd" in html_content

```

---

### 🧪 tests/analysis/test_t_account_builder.py

```python
"""Tests for T-account row builder and maturity parsing."""

from decimal import Decimal
from bilancio.engines.system import System
from bilancio.config.apply import create_agent
from bilancio.analysis.visualization import build_t_account_rows, parse_day_from_maturity


def test_parse_day_from_maturity_helper():
    assert parse_day_from_maturity("Day 10") == 10
    # Unknown or malformed sorts to end (inf)
    assert parse_day_from_maturity("Soon") > 10**9
    assert parse_day_from_maturity(None) > 10**9
    assert parse_day_from_maturity("Day X") > 10**9


def test_build_t_account_rows_sorting_by_maturity():
    sys = System()
    # Two agents with reciprocal delivery obligations at different days
    f1 = create_agent(type("Spec", (), {"id":"F1","kind":"firm","name":"Firm One"}))
    f2 = create_agent(type("Spec", (), {"id":"F2","kind":"firm","name":"Firm Two"}))
    sys.add_agent(f1)
    sys.add_agent(f2)

    # F1 owes F2: 10 items due Day 2
    sys.create_delivery_obligation("F1", "F2", sku="ITEM", quantity=10, unit_price=Decimal("5"), due_day=2)
    # F2 owes F1: 5 items due Day 1
    sys.create_delivery_obligation("F2", "F1", sku="ITEM", quantity=5, unit_price=Decimal("5"), due_day=1)

    acct_f1 = build_t_account_rows(sys, "F1")
    # For F1: assets should include receivable from F2 due Day 1 before inventory/financials; liabilities Day 2 obligation
    asset_names = [r.name for r in acct_f1.assets]
    liab_names = [r.name for r in acct_f1.liabilities]
    # Receivable row must be present
    assert any(n.endswith("receivable") for n in asset_names)
    # Obligation row must be present
    assert any(n.endswith("obligation") for n in liab_names)

    # Sorting by maturity: for obligations, Day 2 sorts after Day 1; for assets, receivable is a group keyed by day
    # Build keys using the same helper
    asset_due_days = [parse_day_from_maturity(r.maturity) for r in acct_f1.assets if r.name.endswith("receivable")]
    assert asset_due_days == sorted(asset_due_days)

```

---

### 🧪 tests/analysis/test_visualization.py

```python
"""Tests for the analysis/visualization module.

Tests cover:
- Balance sheet display functions (rich and simple formats)
- Event display functions
- Build helper functions (build_t_account_rows, etc.)
"""

from io import StringIO
from decimal import Decimal
import sys as python_sys

import pytest

from bilancio.engines.system import System
from bilancio.engines.simulation import run_day
from bilancio.domain.agents import CentralBank, Bank, Household, Firm
from bilancio.domain.instruments.credit import Payable
from bilancio.ops.banking import deposit_cash, client_payment
from bilancio.analysis.balances import agent_balance

from bilancio.analysis.visualization import (
    # Balance functions
    display_agent_balance_table,
    display_agent_balance_from_balance,
    display_multiple_agent_balances,
    build_t_account_rows,
    display_agent_balance_table_renderable,
    display_multiple_agent_balances_renderable,
    # Event functions
    display_events,
    display_events_table,
    display_events_table_renderable,
    display_events_for_day,
    display_events_renderable,
    display_events_for_day_renderable,
    # Phase functions
    display_events_tables_by_phase_renderables,
    # Common utilities
    RICH_AVAILABLE,
    BalanceRow,
    TAccount,
    parse_day_from_maturity,
)


# ============================================================================
# Fixtures
# ============================================================================


@pytest.fixture
def simple_system():
    """Create a simple system with bank and household for basic tests.

    Setup:
    - Central Bank (CB01)
    - Bank (BK01) with 5000 in reserves
    - Household (HH01) with 1000 cash, 600 deposited at bank
    """
    system = System()
    cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
    bank = Bank(id="BK01", name="Test Bank", kind="bank")
    household = Household(id="HH01", name="Test Household", kind="household")

    system.bootstrap_cb(cb)
    system.add_agent(bank)
    system.add_agent(household)

    # Mint reserves to bank
    system.mint_reserves("BK01", 5000)

    # Mint cash to household and deposit some
    system.mint_cash("HH01", 1000)
    deposit_cash(system, "HH01", "BK01", 600)

    return system


@pytest.fixture
def multi_agent_system():
    """Create a system with multiple agents for comparison tests.

    Setup:
    - Central Bank (CB01)
    - Two Banks (BK01, BK02) with reserves
    - Two Households (HH01, HH02) with deposits at different banks
    """
    system = System()
    cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
    bank1 = Bank(id="BK01", name="Bank One", kind="bank")
    bank2 = Bank(id="BK02", name="Bank Two", kind="bank")
    hh1 = Household(id="HH01", name="Household One", kind="household")
    hh2 = Household(id="HH02", name="Household Two", kind="household")

    system.bootstrap_cb(cb)
    system.add_agent(bank1)
    system.add_agent(bank2)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Setup reserves
    system.mint_reserves("BK01", 5000)
    system.mint_reserves("BK02", 3000)

    # Setup household deposits
    system.mint_cash("HH01", 2000)
    system.mint_cash("HH02", 1500)
    deposit_cash(system, "HH01", "BK01", 1500)
    deposit_cash(system, "HH02", "BK02", 1000)

    return system


@pytest.fixture
def system_with_events():
    """Create a system that has run a day simulation to generate events.

    This includes payables, payments, and interbank clearing.
    """
    system = System()
    cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
    bank1 = Bank(id="BK01", name="Bank One", kind="bank")
    bank2 = Bank(id="BK02", name="Bank Two", kind="bank")
    hh1 = Household(id="HH01", name="Alice", kind="household")
    hh2 = Household(id="HH02", name="Bob", kind="household")
    hh3 = Household(id="HH03", name="Charlie", kind="household")

    system.bootstrap_cb(cb)
    system.add_agent(bank1)
    system.add_agent(bank2)
    system.add_agent(hh1)
    system.add_agent(hh2)
    system.add_agent(hh3)

    # Banks get reserves
    system.mint_reserves("BK01", 500)
    system.mint_reserves("BK02", 500)

    # Households get cash and deposit
    system.mint_cash("HH01", 300)
    system.mint_cash("HH02", 200)
    system.mint_cash("HH03", 100)
    deposit_cash(system, "HH01", "BK01", 300)
    deposit_cash(system, "HH02", "BK01", 200)
    deposit_cash(system, "HH03", "BK02", 100)

    # Create a payable due today
    payable_id = system.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=100,
        denom="X",
        asset_holder_id="HH02",
        liability_issuer_id="HH01",
        due_day=system.state.day
    )
    system.add_contract(payable)

    # Create cross-bank payment
    client_payment(system, "HH02", "BK01", "HH03", "BK02", 50)

    # Run a day to generate phase events
    run_day(system)

    return system


# ============================================================================
# Tests for Balance Display Functions
# ============================================================================


class TestDisplayAgentBalanceTable:
    """Tests for display_agent_balance_table function."""

    def test_display_rich_format_runs_without_error(self, simple_system, capsys):
        """Test that rich format display executes without errors."""
        if not RICH_AVAILABLE:
            pytest.skip("Rich library not available")

        display_agent_balance_table(simple_system, "HH01", format='rich')
        # Just verify it runs - output goes to console
        captured = capsys.readouterr()
        # Rich output may or may not be captured depending on console setup

    def test_display_simple_format(self, simple_system, capsys):
        """Test that simple format produces text output."""
        display_agent_balance_table(simple_system, "HH01", format='simple')
        captured = capsys.readouterr()

        # Verify key elements are in output
        assert "HH01" in captured.out or "Test Household" in captured.out
        assert "ASSETS" in captured.out
        assert "LIABILITIES" in captured.out

    def test_display_with_custom_title(self, simple_system, capsys):
        """Test display with custom title."""
        custom_title = "Custom Balance Title"
        display_agent_balance_table(simple_system, "HH01", format='simple', title=custom_title)
        captured = capsys.readouterr()

        assert custom_title in captured.out

    def test_display_bank_balance(self, simple_system, capsys):
        """Test displaying bank balance (has both assets and liabilities)."""
        display_agent_balance_table(simple_system, "BK01", format='simple')
        captured = capsys.readouterr()

        # Bank should have reserves as assets and deposits as liabilities
        assert "ASSETS" in captured.out
        assert "LIABILITIES" in captured.out


class TestDisplayAgentBalanceFromBalance:
    """Tests for display_agent_balance_from_balance function."""

    def test_display_from_balance_object(self, simple_system, capsys):
        """Test displaying from a pre-computed AgentBalance object."""
        balance = agent_balance(simple_system, "HH01")
        display_agent_balance_from_balance(balance, format='simple')
        captured = capsys.readouterr()

        assert "ASSETS" in captured.out
        assert "LIABILITIES" in captured.out

    def test_display_from_balance_with_title(self, simple_system, capsys):
        """Test displaying from balance with custom title."""
        balance = agent_balance(simple_system, "BK01")
        display_agent_balance_from_balance(balance, format='simple', title="Bank Balance Sheet")
        captured = capsys.readouterr()

        assert "Bank Balance Sheet" in captured.out


class TestDisplayMultipleAgentBalances:
    """Tests for display_multiple_agent_balances function."""

    def test_display_multiple_by_id(self, multi_agent_system, capsys):
        """Test displaying multiple agents by ID."""
        display_multiple_agent_balances(
            multi_agent_system,
            ["HH01", "HH02"],
            format='simple'
        )
        captured = capsys.readouterr()

        # Both agents should appear in output
        assert "HH01" in captured.out or "Household One" in captured.out
        assert "HH02" in captured.out or "Household Two" in captured.out

    def test_display_multiple_by_balance_objects(self, multi_agent_system, capsys):
        """Test displaying multiple agents using AgentBalance objects."""
        balances = [
            agent_balance(multi_agent_system, "BK01"),
            agent_balance(multi_agent_system, "BK02")
        ]
        display_multiple_agent_balances(multi_agent_system, balances, format='simple')
        captured = capsys.readouterr()

        # Both banks should appear
        assert "BK01" in captured.out or "Bank One" in captured.out
        assert "BK02" in captured.out or "Bank Two" in captured.out

    def test_display_mixed_items(self, multi_agent_system, capsys):
        """Test displaying with mix of IDs and balance objects."""
        balance_hh1 = agent_balance(multi_agent_system, "HH01")
        display_multiple_agent_balances(
            multi_agent_system,
            [balance_hh1, "HH02"],
            format='simple'
        )
        captured = capsys.readouterr()

        # Both should appear
        assert "HH01" in captured.out or "Household One" in captured.out


# ============================================================================
# Tests for Balance Renderable Functions
# ============================================================================


class TestBalanceRenderables:
    """Tests for balance renderable functions."""

    def test_balance_table_renderable_rich(self, simple_system):
        """Test that renderable returns appropriate type for rich format."""
        if not RICH_AVAILABLE:
            pytest.skip("Rich library not available")

        result = display_agent_balance_table_renderable(
            simple_system, "HH01", format='rich'
        )
        # Should return a Rich Table
        assert result is not None
        # Rich Table has specific attributes
        assert hasattr(result, 'columns') or isinstance(result, str)

    def test_balance_table_renderable_simple(self, simple_system):
        """Test that renderable returns string for simple format."""
        result = display_agent_balance_table_renderable(
            simple_system, "HH01", format='simple'
        )
        assert isinstance(result, str)
        assert "ASSETS" in result

    def test_multiple_balances_renderable_simple(self, multi_agent_system):
        """Test multiple balances renderable in simple format."""
        result = display_multiple_agent_balances_renderable(
            multi_agent_system,
            ["HH01", "HH02"],
            format='simple'
        )
        assert isinstance(result, str)
        assert "HH01" in result or "Household One" in result


# ============================================================================
# Tests for Build Functions
# ============================================================================


class TestBuildTAccountRows:
    """Tests for build_t_account_rows function."""

    def test_returns_taccount_structure(self, simple_system):
        """Test that build_t_account_rows returns proper TAccount structure."""
        taccount = build_t_account_rows(simple_system, "HH01")

        assert isinstance(taccount, TAccount)
        assert isinstance(taccount.assets, list)
        assert isinstance(taccount.liabilities, list)

    def test_asset_rows_have_expected_fields(self, simple_system):
        """Test that asset rows contain expected BalanceRow fields."""
        taccount = build_t_account_rows(simple_system, "HH01")

        # Household should have assets (cash, deposit)
        assert len(taccount.assets) > 0

        for row in taccount.assets:
            assert isinstance(row, BalanceRow)
            assert row.name is not None
            # value_minor should be set for financial assets
            assert row.value_minor is not None or row.quantity is not None

    def test_liability_rows_for_bank(self, simple_system):
        """Test that bank liability rows are built correctly."""
        taccount = build_t_account_rows(simple_system, "BK01")

        # Bank should have liabilities (deposits from household)
        assert len(taccount.liabilities) > 0

        deposit_found = False
        for row in taccount.liabilities:
            if "bank_deposit" in row.name or "deposit" in row.name.lower():
                deposit_found = True
                assert row.value_minor == 600  # HH01 deposited 600

        assert deposit_found, "Bank should have deposit liability"

    def test_counterparty_info_present(self, simple_system):
        """Test that counterparty information is included in rows."""
        taccount = build_t_account_rows(simple_system, "HH01")

        # Find the bank deposit asset
        for row in taccount.assets:
            if "bank_deposit" in row.name:
                # Counterparty should be the bank
                assert row.counterparty_name is not None
                assert "BK01" in row.counterparty_name or "Test Bank" in row.counterparty_name

    def test_delivery_obligations_as_receivables(self, simple_system):
        """Test that delivery obligations appear as receivables on asset side."""
        # Add delivery obligation
        simple_system.create_delivery_obligation(
            "BK01", "HH01", sku="GOODS", quantity=10,
            unit_price=Decimal("5"), due_day=1
        )

        taccount = build_t_account_rows(simple_system, "HH01")

        # HH01 should now have a receivable (right to receive goods)
        receivable_found = any(
            "receivable" in row.name.lower()
            for row in taccount.assets
        )
        assert receivable_found, "Should have receivable for delivery obligation"

    def test_delivery_obligations_as_liabilities(self, simple_system):
        """Test that delivery obligations appear on liability side for issuer."""
        simple_system.create_delivery_obligation(
            "HH01", "BK01", sku="WIDGETS", quantity=5,
            unit_price=Decimal("10"), due_day=2
        )

        taccount = build_t_account_rows(simple_system, "HH01")

        # HH01 should have an obligation liability
        obligation_found = any(
            "obligation" in row.name.lower()
            for row in taccount.liabilities
        )
        assert obligation_found, "Should have obligation liability"


class TestParseDayFromMaturity:
    """Tests for parse_day_from_maturity helper function."""

    def test_parses_valid_day_string(self):
        """Test parsing valid 'Day N' format."""
        assert parse_day_from_maturity("Day 1") == 1
        assert parse_day_from_maturity("Day 10") == 10
        assert parse_day_from_maturity("Day 100") == 100

    def test_returns_infinity_for_invalid(self):
        """Test that invalid formats return infinity."""
        import math

        assert parse_day_from_maturity(None) == math.inf
        assert parse_day_from_maturity("") > 10**9
        assert parse_day_from_maturity("on-demand") > 10**9
        assert parse_day_from_maturity("Day X") > 10**9
        assert parse_day_from_maturity("Tomorrow") > 10**9


# ============================================================================
# Tests for Event Display Functions
# ============================================================================


class TestDisplayEvents:
    """Tests for display_events function."""

    def test_display_empty_events(self, capsys):
        """Test displaying empty event list."""
        display_events([], format='detailed')
        captured = capsys.readouterr()

        assert "No events" in captured.out

    def test_display_detailed_format(self, system_with_events, capsys):
        """Test detailed format includes phase information."""
        events = system_with_events.state.events
        display_events(events, format='detailed')
        captured = capsys.readouterr()

        # Should include phase labels
        assert "Phase" in captured.out or "Day" in captured.out

    def test_display_summary_format(self, system_with_events, capsys):
        """Test summary format shows condensed events."""
        events = system_with_events.state.events
        display_events(events, format='summary')
        # Should run without error - summary format may produce less output


class TestDisplayEventsTable:
    """Tests for display_events_table function."""

    def test_display_events_table_has_columns(self, system_with_events, capsys):
        """Test that events table includes expected columns."""
        events = system_with_events.state.events
        display_events_table(events)
        # Should run without error


class TestDisplayEventsTableRenderable:
    """Tests for display_events_table_renderable function."""

    def test_renderable_empty_events(self):
        """Test renderable with empty events returns appropriate message."""
        result = display_events_table_renderable([])

        if RICH_AVAILABLE:
            # Returns Rich Text or similar
            assert result is not None
        else:
            assert "No events" in str(result)

    def test_renderable_with_events(self, system_with_events):
        """Test renderable with actual events returns table structure."""
        events = system_with_events.state.events
        result = display_events_table_renderable(events)

        assert result is not None
        if RICH_AVAILABLE:
            # Should be a Rich Table with columns
            assert hasattr(result, 'columns') or isinstance(result, str)
        else:
            assert isinstance(result, str)


class TestDisplayEventsForDay:
    """Tests for display_events_for_day function."""

    def test_display_events_for_specific_day(self, system_with_events, capsys):
        """Test displaying events for a specific day."""
        # Day 0 should have events (run_day increments day)
        display_events_for_day(system_with_events, 0)
        captured = capsys.readouterr()

        # Should show day events or "no events" message
        assert len(captured.out) > 0

    def test_display_events_for_future_day(self, system_with_events, capsys):
        """Test displaying events for day with no events."""
        display_events_for_day(system_with_events, 999)
        captured = capsys.readouterr()

        assert "No events" in captured.out


class TestDisplayEventsRenderable:
    """Tests for display_events_renderable function."""

    def test_renderable_returns_list(self, system_with_events):
        """Test that renderable returns list of renderables."""
        events = system_with_events.state.events
        result = display_events_renderable(events, format='detailed')

        assert isinstance(result, list)

    def test_renderable_empty_events(self):
        """Test renderable with empty events."""
        result = display_events_renderable([])

        assert isinstance(result, list)
        assert len(result) > 0  # Should have "no events" message


class TestDisplayEventsForDayRenderable:
    """Tests for display_events_for_day_renderable function."""

    def test_renderable_for_day_with_events(self, system_with_events):
        """Test getting renderables for a day with events."""
        result = display_events_for_day_renderable(system_with_events, 0)

        assert isinstance(result, list)

    def test_renderable_for_empty_day(self, system_with_events):
        """Test getting renderables for a day without events."""
        result = display_events_for_day_renderable(system_with_events, 999)

        assert isinstance(result, list)
        assert len(result) > 0  # Should have "no events" message


# ============================================================================
# Tests for Phase Display Functions
# ============================================================================


class TestDisplayEventsTablesByPhase:
    """Tests for display_events_tables_by_phase_renderables function."""

    def test_phase_tables_returns_list(self, system_with_events):
        """Test that phase tables returns list of renderables."""
        # Get events for day 0
        day_events = [e for e in system_with_events.state.events if e.get("day") == 0]
        result = display_events_tables_by_phase_renderables(day_events, day=0)

        assert isinstance(result, list)

    def test_phase_tables_include_phases_b_and_c(self, system_with_events):
        """Test that result includes Phase B and C tables."""
        day_events = [e for e in system_with_events.state.events if e.get("day") == 0]
        result = display_events_tables_by_phase_renderables(day_events, day=0)

        # Should have at least 2 tables (Phase B and C, possibly A)
        assert len(result) >= 2

    def test_phase_tables_with_empty_events(self):
        """Test phase tables with empty events."""
        result = display_events_tables_by_phase_renderables([])

        assert isinstance(result, list)
        # Should still return phase table structures even if empty


# ============================================================================
# Tests for Common Types and Constants
# ============================================================================


class TestCommonTypes:
    """Tests for common types exported from the module."""

    def test_balance_row_dataclass(self):
        """Test BalanceRow dataclass creation."""
        row = BalanceRow(
            name="cash",
            quantity=None,
            value_minor=1000,
            counterparty_name="CB01",
            maturity="on-demand"
        )

        assert row.name == "cash"
        assert row.value_minor == 1000
        assert row.counterparty_name == "CB01"

    def test_balance_row_with_quantity(self):
        """Test BalanceRow with quantity for non-financial items."""
        row = BalanceRow(
            name="WIDGETS receivable",
            quantity=50,
            value_minor=5000,
            counterparty_name="Firm A",
            maturity="Day 5"
        )

        assert row.quantity == 50
        assert row.maturity == "Day 5"

    def test_taccount_dataclass(self):
        """Test TAccount dataclass creation."""
        assets = [
            BalanceRow("cash", None, 1000, "CB", "on-demand")
        ]
        liabilities = [
            BalanceRow("deposit", None, 500, "HH01", "on-demand")
        ]

        taccount = TAccount(assets=assets, liabilities=liabilities)

        assert len(taccount.assets) == 1
        assert len(taccount.liabilities) == 1
        assert taccount.assets[0].name == "cash"

    def test_rich_available_constant(self):
        """Test that RICH_AVAILABLE is a boolean."""
        assert isinstance(RICH_AVAILABLE, bool)


# ============================================================================
# Integration Tests
# ============================================================================


class TestVisualizationIntegration:
    """Integration tests combining multiple visualization functions."""

    def test_full_visualization_workflow(self, system_with_events, capsys):
        """Test a complete visualization workflow."""
        # Display balances for all households
        display_multiple_agent_balances(
            system_with_events,
            ["HH01", "HH02", "HH03"],
            format='simple'
        )

        # Display events for day 0
        display_events_for_day(system_with_events, 0)

        # Build T-accounts for bank
        taccount = build_t_account_rows(system_with_events, "BK01")

        captured = capsys.readouterr()

        # Verify all components ran
        assert "HH01" in captured.out or "Alice" in captured.out
        assert isinstance(taccount, TAccount)

    def test_display_before_and_after_adding_obligation(self, simple_system, capsys):
        """Test displaying state before and after adding delivery obligation."""
        # Display initial state
        display_agent_balance_table(simple_system, "HH01", format='simple')
        initial_output = capsys.readouterr().out

        # Add a delivery obligation (doesn't require complex settlement)
        simple_system.create_delivery_obligation(
            from_agent="HH01",
            to_agent="BK01",
            sku="WIDGETS",
            quantity=10,
            unit_price=Decimal("5"),
            due_day=1
        )

        # Display after state
        display_agent_balance_table(simple_system, "HH01", format='simple')
        after_output = capsys.readouterr().out

        # Verify both outputs were generated
        assert len(initial_output) > 0
        assert len(after_output) > 0

```

---

### 🧪 tests/cloud/__init__.py

```python
"""Tests for cloud execution module."""

```

---

### 🧪 tests/cloud/test_cloud_executor.py

```python
"""Unit tests for CloudExecutor (mocked Modal)."""

import sys
from pathlib import Path
from unittest.mock import MagicMock, patch

import pytest

from bilancio.runners.cloud_executor import CloudExecutor
from bilancio.runners.models import RunOptions
from bilancio.storage.models import RunStatus


class TestCloudExecutor:
    """Unit tests for CloudExecutor with mocked Modal functions."""

    def test_execute_success(self, tmp_path):
        """Test successful cloud execution."""
        # Setup mock function
        mock_func = MagicMock()
        mock_func.remote.return_value = {
            "run_id": "test_001",
            "status": "completed",
            "storage_type": "modal_volume",
            "storage_base": "exp/runs/test_001",
            "artifacts": {
                "events_jsonl": "out/events.jsonl",
                "balances_csv": "out/balances.csv",
            },
            "execution_time_ms": 5000,
            "error": None,
        }

        # Mock modal module
        mock_modal = MagicMock()
        mock_modal.Function.from_name.return_value = mock_func

        with patch.dict(sys.modules, {"modal": mock_modal}):
            executor = CloudExecutor(
                experiment_id="exp",
                download_artifacts=False,  # Don't try to download
            )

            result = executor.execute(
                scenario_config={"agents": []},
                run_id="test_001",
                output_dir=tmp_path / "test_001",
                options=RunOptions(),
            )

        assert result.status == RunStatus.COMPLETED
        assert result.run_id == "test_001"
        assert "events_jsonl" in result.artifacts

    def test_execute_failure(self, tmp_path):
        """Test failed cloud execution."""
        mock_func = MagicMock()
        mock_func.remote.return_value = {
            "run_id": "test_001",
            "status": "failed",
            "storage_type": "modal_volume",
            "storage_base": "exp/runs/test_001",
            "artifacts": {},
            "execution_time_ms": 1000,
            "error": "Simulation diverged",
        }

        mock_modal = MagicMock()
        mock_modal.Function.from_name.return_value = mock_func

        with patch.dict(sys.modules, {"modal": mock_modal}):
            executor = CloudExecutor(
                experiment_id="exp",
                download_artifacts=False,
            )

            result = executor.execute(
                scenario_config={"agents": []},
                run_id="test_001",
                output_dir=tmp_path / "test_001",
                options=RunOptions(),
            )

        assert result.status == RunStatus.FAILED
        assert result.error == "Simulation diverged"

    def test_options_serialization(self, tmp_path):
        """Test that RunOptions are properly serialized."""
        mock_func = MagicMock()
        mock_func.remote.return_value = {
            "run_id": "test_001",
            "status": "completed",
            "storage_type": "modal_volume",
            "storage_base": "exp/runs/test_001",
            "artifacts": {},
            "execution_time_ms": 1000,
            "error": None,
        }

        mock_modal = MagicMock()
        mock_modal.Function.from_name.return_value = mock_func

        with patch.dict(sys.modules, {"modal": mock_modal}):
            executor = CloudExecutor(
                experiment_id="exp",
                download_artifacts=False,
            )

            options = RunOptions(
                mode="fixed_days",
                max_days=10,
                quiet_days=3,
                check_invariants="end",
            )

            executor.execute(
                scenario_config={"agents": []},
                run_id="test_001",
                output_dir=tmp_path / "test_001",
                options=options,
            )

        # Verify the options were serialized correctly
        call_kwargs = mock_func.remote.call_args[1]
        assert call_kwargs["options"]["mode"] == "fixed_days"
        assert call_kwargs["options"]["max_days"] == 10
        assert call_kwargs["options"]["quiet_days"] == 3
        assert call_kwargs["options"]["check_invariants"] == "end"


class TestCloudConfig:
    """Tests for CloudConfig dataclass."""

    def test_default_values(self):
        """Test default configuration values."""
        from bilancio.cloud.config import CloudConfig

        config = CloudConfig()
        assert config.volume_name == "bilancio-results"
        assert config.timeout_seconds == 600
        assert config.memory_mb == 2048
        assert config.max_parallel == 50
        assert config.gpu is None

    def test_env_override(self, monkeypatch):
        """Test environment variable overrides."""
        from bilancio.cloud.config import CloudConfig

        monkeypatch.setenv("BILANCIO_MODAL_VOLUME", "custom-volume")
        monkeypatch.setenv("BILANCIO_CLOUD_TIMEOUT", "1200")
        monkeypatch.setenv("BILANCIO_CLOUD_MEMORY", "4096")

        config = CloudConfig()
        assert config.volume_name == "custom-volume"
        assert config.timeout_seconds == 1200
        assert config.memory_mb == 4096

```

---

### 🧪 tests/cloud/test_modal_artifact_loader.py

```python
"""Tests for ModalVolumeArtifactLoader."""

from pathlib import Path
from unittest.mock import MagicMock, patch
import subprocess

import pytest

from bilancio.storage.modal_artifact_loader import ModalVolumeArtifactLoader


class TestModalVolumeArtifactLoader:
    """Tests for ModalVolumeArtifactLoader."""

    def test_init_defaults(self):
        """Test default initialization."""
        loader = ModalVolumeArtifactLoader()
        assert loader.volume_name == "bilancio-results"
        assert loader.base_path == ""

    def test_init_custom(self, tmp_path):
        """Test custom initialization."""
        loader = ModalVolumeArtifactLoader(
            volume_name="custom-volume",
            base_path="exp/runs/run_001",
            cache_dir=tmp_path / "cache",
        )
        assert loader.volume_name == "custom-volume"
        assert loader.base_path == "exp/runs/run_001"

    @patch("bilancio.storage.modal_artifact_loader.subprocess.run")
    def test_load_text(self, mock_run, tmp_path):
        """Test loading text file."""
        cache_dir = tmp_path / "cache"
        cache_dir.mkdir()

        # Create cached file
        test_file = cache_dir / "out" / "events.jsonl"
        test_file.parent.mkdir(parents=True)
        test_file.write_text('{"event": "test"}\n')

        loader = ModalVolumeArtifactLoader(
            volume_name="test-volume",
            base_path="exp/runs/run_001",
            cache_dir=cache_dir,
        )

        # File exists in cache, so no download should happen
        content = loader.load_text("out/events.jsonl")
        assert content == '{"event": "test"}\n'
        mock_run.assert_not_called()

    @patch("bilancio.storage.modal_artifact_loader.subprocess.run")
    def test_load_text_downloads_if_not_cached(self, mock_run, tmp_path):
        """Test that file is downloaded if not in cache."""
        cache_dir = tmp_path / "cache"
        cache_dir.mkdir()

        # Mock successful download
        def side_effect(cmd, check, capture_output):
            # Create the file when modal volume get is called
            target = Path(cmd[5])  # The local path argument
            target.parent.mkdir(parents=True, exist_ok=True)
            target.write_text("downloaded content")
            return MagicMock(returncode=0)

        mock_run.side_effect = side_effect

        loader = ModalVolumeArtifactLoader(
            volume_name="test-volume",
            base_path="exp/runs/run_001",
            cache_dir=cache_dir,
        )

        content = loader.load_text("test.txt")
        assert content == "downloaded content"

        # Verify modal CLI was called
        mock_run.assert_called_once()
        call_args = mock_run.call_args[0][0]
        assert call_args[0] == "modal"
        assert call_args[1] == "volume"
        assert call_args[2] == "get"
        assert call_args[3] == "test-volume"
        assert "exp/runs/run_001/test.txt" in call_args[4]

    @patch("bilancio.storage.modal_artifact_loader.subprocess.run")
    def test_exists_true(self, mock_run):
        """Test exists returns True when file exists."""
        mock_run.return_value = MagicMock(returncode=0)

        loader = ModalVolumeArtifactLoader(
            volume_name="test-volume",
            base_path="exp/runs/run_001",
        )

        assert loader.exists("test.txt") is True

    @patch("bilancio.storage.modal_artifact_loader.subprocess.run")
    def test_exists_false(self, mock_run):
        """Test exists returns False when file doesn't exist."""
        mock_run.return_value = MagicMock(returncode=1)

        loader = ModalVolumeArtifactLoader(
            volume_name="test-volume",
            base_path="exp/runs/run_001",
        )

        assert loader.exists("nonexistent.txt") is False

    def test_clear_cache(self, tmp_path):
        """Test cache clearing."""
        cache_dir = tmp_path / "cache"
        cache_dir.mkdir()
        (cache_dir / "test.txt").write_text("cached")

        loader = ModalVolumeArtifactLoader(cache_dir=cache_dir)
        loader.clear_cache()

        # Directory should still exist but be empty
        assert cache_dir.exists()
        assert list(cache_dir.iterdir()) == []

```

---

### 🧪 tests/config/test_apply.py

```python
"""Tests for applying configuration to system."""

import pytest
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.config.models import ScenarioConfig, AgentSpec
from bilancio.config.apply import apply_to_system, create_agent, apply_action
from bilancio.domain.agents import Bank, Household, CentralBank, Firm


class TestCreateAgent:
    """Test agent creation from specification."""
    
    def test_create_central_bank(self):
        """Test creating a central bank agent."""
        spec = AgentSpec(id="CB", kind="central_bank", name="Central Bank")
        agent = create_agent(spec)
        assert isinstance(agent, CentralBank)
        assert agent.id == "CB"
        assert agent.name == "Central Bank"
        assert agent.kind == "central_bank"
    
    def test_create_bank(self):
        """Test creating a bank agent."""
        spec = AgentSpec(id="B1", kind="bank", name="First Bank")
        agent = create_agent(spec)
        assert isinstance(agent, Bank)
        assert agent.id == "B1"
        assert agent.name == "First Bank"
        assert agent.kind == "bank"
    
    def test_create_household(self):
        """Test creating a household agent."""
        spec = AgentSpec(id="H1", kind="household", name="Smith Family")
        agent = create_agent(spec)
        assert isinstance(agent, Household)
        assert agent.id == "H1"
        assert agent.name == "Smith Family"
        assert agent.kind == "household"
    
    def test_create_firm(self):
        """Test creating a firm agent."""
        spec = AgentSpec(id="F1", kind="firm", name="ABC Corp")
        agent = create_agent(spec)
        assert isinstance(agent, Firm)
        assert agent.id == "F1"
        assert agent.name == "ABC Corp"
        assert agent.kind == "firm"


class TestApplyToSystem:
    """Test applying configuration to system."""
    
    def test_apply_minimal_config(self):
        """Test applying minimal configuration."""
        config = ScenarioConfig(
            name="Minimal",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
                {"id": "B1", "kind": "bank", "name": "Bank"}
            ]
        )
        
        system = System()
        apply_to_system(config, system)
        
        # Check agents were added
        assert "CB" in system.state.agents
        assert "B1" in system.state.agents
        assert system.state.agents["CB"].kind == "central_bank"
        assert system.state.agents["B1"].kind == "bank"
        
        # System should pass invariants
        system.assert_invariants()
    
    def test_apply_with_initial_actions(self):
        """Test applying configuration with initial actions."""
        config = ScenarioConfig(
            name="With Actions",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
                {"id": "B1", "kind": "bank", "name": "Bank"},
                {"id": "H1", "kind": "household", "name": "Household"}
            ],
            initial_actions=[
                {"mint_reserves": {"to": "B1", "amount": 10000}},
                {"mint_cash": {"to": "H1", "amount": 1000}}
            ]
        )
        
        system = System()
        apply_to_system(config, system)
        
        # Check agents
        assert len(system.state.agents) == 3
        
        # Check that actions were executed
        # Bank should have reserves
        bank = system.state.agents["B1"]
        assert len(bank.asset_ids) > 0  # Should have reserve deposit
        
        # Household should have cash
        household = system.state.agents["H1"]
        assert len(household.asset_ids) > 0  # Should have cash
        
        # System should pass invariants
        system.assert_invariants()
    
    def test_apply_with_policy_overrides(self):
        """Test applying configuration with policy overrides."""
        config = ScenarioConfig(
            name="With Policy",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "CB"}
            ],
            policy_overrides={
                "mop_rank": {
                    "household": ["cash", "bank_deposit"],
                    "bank": ["reserve_deposit"]
                }
            }
        )
        
        system = System()
        apply_to_system(config, system)
        
        # Check policy was updated
        assert system.policy.mop_rank["household"] == ["cash", "bank_deposit"]
        assert system.policy.mop_rank["bank"] == ["reserve_deposit"]
    
    def test_apply_complex_scenario(self):
        """Test applying a complex scenario with multiple actions."""
        config = ScenarioConfig(
            name="Complex",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
                {"id": "B1", "kind": "bank", "name": "Bank 1"},
                {"id": "B2", "kind": "bank", "name": "Bank 2"},
                {"id": "H1", "kind": "household", "name": "Household 1"},
                {"id": "H2", "kind": "household", "name": "Household 2"},
                {"id": "F1", "kind": "firm", "name": "Firm 1"}
            ],
            initial_actions=[
                {"mint_reserves": {"to": "B1", "amount": 20000}},
                {"mint_reserves": {"to": "B2", "amount": 15000}},
                {"mint_cash": {"to": "H1", "amount": 5000}},
                {"mint_cash": {"to": "H2", "amount": 3000}},
                {"deposit_cash": {"customer": "H1", "bank": "B1", "amount": 4000}},
                {"deposit_cash": {"customer": "H2", "bank": "B2", "amount": 2000}},
                {"create_stock": {"owner": "F1", "sku": "WIDGET", "quantity": 100, "unit_price": "25"}},
                {"create_payable": {"from": "H1", "to": "H2", "amount": 500, "due_day": 1}}
            ]
        )
        
        system = System()
        apply_to_system(config, system)
        
        # Check all agents were created
        assert len(system.state.agents) == 6
        
        # Check stock was created
        assert len(system.state.stocks) > 0
        stocks = [s for s in system.state.stocks.values() if s.owner_id == "F1"]
        assert len(stocks) == 1
        assert stocks[0].sku == "WIDGET"
        assert stocks[0].quantity == 100
        
        # Check payable was created
        # Payable uses liability_issuer_id for the debtor
        payables = [c for c in system.state.contracts.values() 
                   if hasattr(c, 'liability_issuer_id') and c.liability_issuer_id == "H1"]
        assert len(payables) > 0
        
        # System should pass invariants
        system.assert_invariants()
    
    def test_apply_with_delivery_obligation(self):
        """Test applying configuration with delivery obligations."""
        config = ScenarioConfig(
            name="Delivery",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "CB"},
                {"id": "F1", "kind": "firm", "name": "Firm"},
                {"id": "H1", "kind": "household", "name": "Household"}
            ],
            initial_actions=[
                {"mint_cash": {"to": "F1", "amount": 1000}},
                {"mint_cash": {"to": "H1", "amount": 1000}},
                {"create_stock": {"owner": "F1", "sku": "ITEM", "quantity": 10, "unit_price": "50"}},
                {"create_delivery_obligation": {
                    "from": "F1", "to": "H1",
                    "sku": "ITEM", "quantity": 5,
                    "unit_price": "50", "due_day": 2
                }}
            ]
        )
        
        system = System()
        apply_to_system(config, system)
        
        # Check delivery obligation was created
        obligations = [c for c in system.state.contracts.values()
                      if hasattr(c, 'sku')]
        assert len(obligations) > 0
        
        # System should pass invariants
        system.assert_invariants()
```

---

### 🧪 tests/config/test_loaders.py

```python
"""Tests for YAML configuration loading."""

import pytest
import yaml
from pathlib import Path
from decimal import Decimal
import tempfile

from bilancio.config.loaders import load_yaml, parse_action, preprocess_config
from bilancio.config.models import (
    MintCash,
    MintReserves,
    DepositCash,
    CreateStock,
    CreateDeliveryObligation,
    CreatePayable
)


class TestParseAction:
    """Test action parsing from dictionaries."""
    
    def test_parse_mint_cash(self):
        """Test parsing mint_cash action."""
        action = parse_action({"mint_cash": {"to": "H1", "amount": 1000}})
        assert isinstance(action, MintCash)
        assert action.to == "H1"
        assert action.amount == 1000
    
    def test_parse_mint_reserves(self):
        """Test parsing mint_reserves action."""
        action = parse_action({"mint_reserves": {"to": "B1", "amount": 5000}})
        assert isinstance(action, MintReserves)
        assert action.to == "B1"
        assert action.amount == 5000
    
    def test_parse_deposit_cash(self):
        """Test parsing deposit_cash action."""
        action = parse_action({
            "deposit_cash": {"customer": "H1", "bank": "B1", "amount": 500}
        })
        assert isinstance(action, DepositCash)
        assert action.customer == "H1"
        assert action.bank == "B1"
        assert action.amount == 500
    
    def test_parse_create_stock(self):
        """Test parsing create_stock action."""
        action = parse_action({
            "create_stock": {
                "owner": "F1",
                "sku": "WIDGET",
                "quantity": 100,
                "unit_price": "25.50"
            }
        })
        assert isinstance(action, CreateStock)
        assert action.owner == "F1"
        assert action.sku == "WIDGET"
        assert action.quantity == 100
        assert action.unit_price == Decimal("25.50")
    
    def test_parse_delivery_obligation_with_aliases(self):
        """Test parsing delivery obligation with from/to aliases."""
        action = parse_action({
            "create_delivery_obligation": {
                "from": "F1",
                "to": "H1",
                "sku": "WIDGET",
                "quantity": 10,
                "unit_price": "25",
                "due_day": 3
            }
        })
        assert isinstance(action, CreateDeliveryObligation)
        assert action.from_agent == "F1"
        assert action.to_agent == "H1"
        assert action.sku == "WIDGET"
    
    def test_parse_payable_with_aliases(self):
        """Test parsing payable with from/to aliases."""
        action = parse_action({
            "create_payable": {
                "from": "H1",
                "to": "H2",
                "amount": 300,
                "due_day": 1
            }
        })
        assert isinstance(action, CreatePayable)
        assert action.from_agent == "H1"
        assert action.to_agent == "H2"
        assert action.amount == 300
    
    def test_parse_unknown_action(self):
        """Test that unknown action types raise error."""
        with pytest.raises(ValueError) as exc_info:
            parse_action({"unknown_action": {"data": "value"}})
        assert "Unknown action type" in str(exc_info.value)


class TestPreprocessConfig:
    """Test configuration preprocessing."""
    
    def test_convert_string_decimals(self):
        """Test conversion of string decimals."""
        data = {
            "amount": "123.45",
            "nested": {
                "price": "99.99"
            },
            "list": [
                {"value": "10.50"},
                {"value": "20.75"}
            ]
        }
        
        result = preprocess_config(data)
        
        assert result["amount"] == Decimal("123.45")
        assert result["nested"]["price"] == Decimal("99.99")
        assert result["list"][0]["value"] == Decimal("10.50")
        assert result["list"][1]["value"] == Decimal("20.75")
    
    def test_preserve_non_numeric_strings(self):
        """Test that non-numeric strings are preserved."""
        data = {
            "name": "Test Name",
            "id": "ABC123",
            "amount": "100.00",
            "description": "Some text with 123 numbers"
        }
        
        result = preprocess_config(data)
        
        assert result["name"] == "Test Name"
        assert result["id"] == "ABC123"
        assert result["amount"] == Decimal("100.00")
        assert result["description"] == "Some text with 123 numbers"


class TestLoadYaml:
    """Test YAML file loading."""
    
    def test_load_valid_yaml(self):
        """Test loading a valid YAML configuration."""
        yaml_content = """
version: 1
name: Test Scenario
description: A test scenario

agents:
  - id: CB
    kind: central_bank
    name: Central Bank
  - id: B1
    kind: bank
    name: First Bank

initial_actions:
  - mint_reserves: {to: B1, amount: 10000}
  - mint_cash: {to: H1, amount: 1000}

run:
  mode: until_stable
  max_days: 30
"""
        
        with tempfile.NamedTemporaryFile(mode='w', suffix='.yaml', delete=False) as f:
            f.write(yaml_content)
            temp_path = Path(f.name)
        
        try:
            config = load_yaml(temp_path)
            assert config.name == "Test Scenario"
            assert config.version == 1
            assert len(config.agents) == 2
            assert config.agents[0].id == "CB"
            assert config.agents[1].id == "B1"
            assert len(config.initial_actions) == 2
            assert config.run.mode == "until_stable"
            assert config.run.max_days == 30
        finally:
            temp_path.unlink()
    
    def test_load_file_not_found(self):
        """Test loading non-existent file."""
        with pytest.raises(FileNotFoundError):
            load_yaml(Path("nonexistent.yaml"))
    
    def test_load_invalid_yaml_syntax(self):
        """Test loading file with invalid YAML syntax."""
        yaml_content = """
version: 1
name: Bad YAML
  - this is invalid
    : syntax
"""
        
        with tempfile.NamedTemporaryFile(mode='w', suffix='.yaml', delete=False) as f:
            f.write(yaml_content)
            temp_path = Path(f.name)
        
        try:
            with pytest.raises(yaml.YAMLError):
                load_yaml(temp_path)
        finally:
            temp_path.unlink()
    
    def test_load_invalid_config_schema(self):
        """Test loading YAML with invalid configuration schema."""
        yaml_content = """
version: 1
name: Invalid Config
agents:
  - id: CB
    kind: invalid_kind
    name: Invalid Agent
"""
        
        with tempfile.NamedTemporaryFile(mode='w', suffix='.yaml', delete=False) as f:
            f.write(yaml_content)
            temp_path = Path(f.name)
        
        try:
            with pytest.raises(ValueError) as exc_info:
                load_yaml(temp_path)
            assert "validation failed" in str(exc_info.value).lower()
        finally:
            temp_path.unlink()
    
    def test_load_example_scenario(self):
        """Test loading one of the example scenarios."""
        example_path = Path("examples/scenarios/simple_bank.yaml")
        if example_path.exists():
            config = load_yaml(example_path)
            assert config.name == "Simple Banking System"
            assert len(config.agents) == 4  # CB, B1, H1, H2
            assert config.run.mode == "until_stable"
```

---

### 🧪 tests/config/test_models.py

```python
"""Tests for configuration models."""

import pytest
from decimal import Decimal
from pydantic import ValidationError

from bilancio.config.models import (
    AgentSpec,
    MintCash,
    MintReserves,
    DepositCash,
    CreateStock,
    CreateDeliveryObligation,
    CreatePayable,
    ScenarioConfig,
    RunConfig,
    PolicyOverrides
)


class TestAgentSpec:
    """Test AgentSpec model validation."""
    
    def test_valid_agent_spec(self):
        """Test creating a valid agent specification."""
        agent = AgentSpec(
            id="B1",
            kind="bank",
            name="First Bank"
        )
        assert agent.id == "B1"
        assert agent.kind == "bank"
        assert agent.name == "First Bank"
    
    def test_invalid_agent_kind(self):
        """Test that invalid agent kind raises error."""
        with pytest.raises(ValidationError):
            AgentSpec(
                id="X1",
                kind="invalid_kind",
                name="Invalid Agent"
            )


class TestActions:
    """Test action model validation."""
    
    def test_mint_cash_valid(self):
        """Test valid mint cash action."""
        action = MintCash(to="H1", amount=Decimal("1000"))
        assert action.to == "H1"
        assert action.amount == Decimal("1000")
        assert action.action == "mint_cash"
    
    def test_mint_cash_negative_amount(self):
        """Test that negative amounts are rejected."""
        with pytest.raises(ValidationError):
            MintCash(to="H1", amount=Decimal("-100"))
    
    def test_deposit_cash_valid(self):
        """Test valid deposit cash action."""
        action = DepositCash(
            customer="H1",
            bank="B1",
            amount=Decimal("500")
        )
        assert action.customer == "H1"
        assert action.bank == "B1"
        assert action.amount == Decimal("500")
    
    def test_create_stock_valid(self):
        """Test valid create stock action."""
        action = CreateStock(
            owner="F1",
            sku="WIDGET",
            quantity=100,
            unit_price=Decimal("25.50")
        )
        assert action.owner == "F1"
        assert action.sku == "WIDGET"
        assert action.quantity == 100
        assert action.unit_price == Decimal("25.50")
    
    def test_create_stock_invalid_quantity(self):
        """Test that zero or negative quantities are rejected."""
        with pytest.raises(ValidationError):
            CreateStock(
                owner="F1",
                sku="WIDGET",
                quantity=0,
                unit_price=Decimal("25")
            )
    
    def test_create_delivery_obligation_with_aliases(self):
        """Test delivery obligation with from/to aliases."""
        # Use the aliases 'from' and 'to' instead of from_agent/to_agent
        data = {
            "from": "F1",
            "to": "H1",
            "sku": "WIDGET",
            "quantity": 10,
            "unit_price": Decimal("25"),
            "due_day": 3
        }
        action = CreateDeliveryObligation(**data)
        assert action.from_agent == "F1"
        assert action.to_agent == "H1"
        assert action.due_day == 3
    
    def test_create_payable_valid(self):
        """Test valid create payable action."""
        # Use the aliases 'from' and 'to' instead of from_agent/to_agent
        data = {
            "from": "H1",
            "to": "H2",
            "amount": Decimal("300"),
            "due_day": 1
        }
        action = CreatePayable(**data)
        assert action.from_agent == "H1"
        assert action.to_agent == "H2"
        assert action.amount == Decimal("300")
        assert action.due_day == 1
    
    def test_create_payable_negative_due_day(self):
        """Test that negative due days are rejected."""
        with pytest.raises(ValidationError):
            CreatePayable(
                from_agent="H1",
                to_agent="H2",
                amount=Decimal("300"),
                due_day=-1
            )


class TestScenarioConfig:
    """Test ScenarioConfig model validation."""
    
    def test_minimal_valid_config(self):
        """Test minimal valid scenario configuration."""
        config = ScenarioConfig(
            name="Test Scenario",
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
                {"id": "B1", "kind": "bank", "name": "Bank 1"}
            ]
        )
        assert config.name == "Test Scenario"
        assert config.version == 1
        assert len(config.agents) == 2
        assert config.description is None
        assert config.initial_actions == []
    
    def test_config_with_all_fields(self):
        """Test scenario configuration with all fields."""
        config = ScenarioConfig(
            version=1,
            name="Full Scenario",
            description="A complete test scenario",
            policy_overrides={
                "mop_rank": {
                    "household": ["bank_deposit", "cash"]
                }
            },
            agents=[
                {"id": "CB", "kind": "central_bank", "name": "CB"},
                {"id": "B1", "kind": "bank", "name": "Bank"}
            ],
            initial_actions=[
                {"mint_reserves": {"to": "B1", "amount": 10000}}
            ],
            run={
                "mode": "until_stable",
                "max_days": 90,
                "quiet_days": 2,
                "show": {
                    "balances": ["CB", "B1"],
                    "events": "detailed"
                },
                "export": {
                    "balances_csv": "balances.csv",
                    "events_jsonl": "events.jsonl"
                }
            }
        )
        assert config.name == "Full Scenario"
        assert config.description == "A complete test scenario"
        assert config.policy_overrides.mop_rank["household"] == ["bank_deposit", "cash"]
        assert config.run.mode == "until_stable"
        assert config.run.max_days == 90
        assert config.run.default_handling == "fail-fast"
        assert config.run.export.balances_csv == "balances.csv"
    
    def test_duplicate_agent_ids_rejected(self):
        """Test that duplicate agent IDs are rejected."""
        with pytest.raises(ValidationError) as exc_info:
            ScenarioConfig(
                name="Invalid",
                agents=[
                    {"id": "B1", "kind": "bank", "name": "Bank 1"},
                    {"id": "B1", "kind": "bank", "name": "Bank 2"}
                ]
            )
        assert "unique" in str(exc_info.value).lower()
    
    def test_unsupported_version_rejected(self):
        """Test that unsupported versions are rejected."""
        with pytest.raises(ValidationError) as exc_info:
            ScenarioConfig(
                version=2,
                name="Future Version",
                agents=[
                    {"id": "CB", "kind": "central_bank", "name": "CB"}
                ]
            )
        assert "version" in str(exc_info.value).lower()


class TestRunConfig:
    """Test RunConfig model validation."""
    
    def test_default_run_config(self):
        """Test default run configuration values."""
        config = RunConfig()
        assert config.mode == "until_stable"
        assert config.max_days == 90
        assert config.quiet_days == 2
        assert config.default_handling == "fail-fast"
        assert config.show.events == "detailed"
        assert config.show.balances is None
        assert config.export.balances_csv is None
        assert config.export.events_jsonl is None

    def test_custom_run_config(self):
        """Test custom run configuration."""
        config = RunConfig(
            mode="step",
            max_days=30,
            quiet_days=5,
            default_handling="expel-agent",
            show={"balances": ["A1", "A2"], "events": "summary"},
            export={"balances_csv": "out.csv"}
        )
        assert config.mode == "step"
        assert config.max_days == 30
        assert config.quiet_days == 5
        assert config.default_handling == "expel-agent"
        assert config.show.balances == ["A1", "A2"]
        assert config.show.events == "summary"
        assert config.export.balances_csv == "out.csv"
    
    def test_negative_max_days_rejected(self):
        """Test that negative max_days is rejected."""
        with pytest.raises(ValidationError):
            RunConfig(max_days=-1)
    
    def test_negative_quiet_days_rejected(self):
        """Test that negative quiet_days is rejected."""
        with pytest.raises(ValidationError):
            RunConfig(quiet_days=-1)

```

---

### 🧪 tests/config/test_scheduled_alias_validation.py

```python
from pathlib import Path
import pytest

from bilancio.config.loaders import load_yaml
from bilancio.config.apply import validate_scheduled_aliases


def _write(tmp_path: Path, name: str, text: str) -> Path:
    p = tmp_path / name
    p.write_text(text)
    return p


BASE_AGENTS = """
version: 1
name: "Test"
agents:
  - {id: CB, kind: central_bank, name: CB}
  - {id: F1, kind: firm, name: F1}
  - {id: F2, kind: firm, name: F2}
initial_actions: []
run: {mode: until_stable, max_days: 5}
"""


def test_validate_scheduled_aliases_unknown_alias(tmp_path: Path):
    text = BASE_AGENTS + """
scheduled_actions:
  - {day: 1, action: {transfer_claim: {contract_alias: NOT_DEFINED, to_agent: F2}}}
"""
    cfg = load_yaml(_write(tmp_path, "c.yaml", text))
    with pytest.raises(ValueError):
        validate_scheduled_aliases(cfg)


def test_validate_scheduled_aliases_duplicate(tmp_path: Path):
    text = BASE_AGENTS + """
initial_actions:
  - {create_payable: {from: F1, to: F2, amount: 1, due_day: 1, alias: A1}}
scheduled_actions:
  - {day: 1, action: {create_delivery_obligation: {from: F2, to: F1, sku: X, quantity: 1, unit_price: "1", due_day: 1, alias: A1}}}
"""
    cfg = load_yaml(_write(tmp_path, "d.yaml", text))
    with pytest.raises(ValueError):
        validate_scheduled_aliases(cfg)


```

---

### 🧪 tests/config/test_transfer_claim_model.py

```python
import pytest
from pydantic import ValidationError

from bilancio.config.models import TransferClaim


def test_transfer_claim_requires_reference():
    with pytest.raises(ValidationError):
        TransferClaim(to_agent="F3")


def test_transfer_claim_accepts_alias_or_id():
    # alias only
    m1 = TransferClaim(contract_alias="ALIAS1", to_agent="F3")
    assert m1.contract_alias == "ALIAS1"
    assert m1.contract_id is None
    # id only
    m2 = TransferClaim(contract_id="C_123", to_agent="F3")
    assert m2.contract_id == "C_123"


def test_transfer_claim_alias_and_id_model_allows_both():
    # Model permits both present; apply layer enforces equality.
    m = TransferClaim(contract_alias="ALIASX", contract_id="C_YYY", to_agent="F3")
    assert m.contract_alias == "ALIASX"
    assert m.contract_id == "C_YYY"


```

---

### 🧪 tests/dealer/__init__.py

```python

```

---

### 🧪 tests/dealer/test_examples.py

```python
"""
Integration tests based on worked examples from the dealer specification.

These tests verify complete scenarios matching the examples document, ensuring
that the dealer implementation correctly handles:
- Interior trades (Events 1-2)
- Passthrough trades (Events 9-10)
- Capacity jumps across integers
- Guard regime at very low M
- Partial recovery defaults
- Quote bounds and feasibility

All tests use Decimal arithmetic and verify programmatic assertions C1-C6.

References:
- docs/dealer_ring/dealer_examples.pdf
- Specification Section 6 (Events)
- Specification Section 8 (L1 Kernel)
"""

import pytest
from decimal import Decimal
from copy import deepcopy

from bilancio.dealer import (
    Ticket,
    DealerState,
    VBTState,
    TraderState,
    KernelParams,
    recompute_dealer_state,
    can_interior_buy,
    can_interior_sell,
    TradeExecutor,
    EventLog,
    run_all_assertions,
    assert_c1_double_entry,
    assert_c4_passthrough_invariant,
    M_MIN,
)
from bilancio.core.ids import new_id


# Helper functions for test setup

def create_ticket(
    issuer_id: str,
    owner_id: str,
    face: Decimal = Decimal(1),
    maturity_day: int = 10,
    remaining_tau: int = 5,
    bucket_id: str = "mid",
    serial: int = 0,
) -> Ticket:
    """Create a ticket for testing."""
    return Ticket(
        id=new_id(),
        issuer_id=issuer_id,
        owner_id=owner_id,
        face=face,
        maturity_day=maturity_day,
        remaining_tau=remaining_tau,
        bucket_id=bucket_id,
        serial=serial,
    )


def setup_dealer_vbt_params(
    dealer_tickets: int = 2,
    dealer_cash: Decimal = Decimal(2),
    M: Decimal = Decimal("1.0"),
    O: Decimal = Decimal("0.30"),
    S: Decimal = Decimal(1),
) -> tuple[DealerState, VBTState, KernelParams]:
    """
    Create dealer, VBT, and params with standard configuration.

    Returns:
        Tuple of (dealer, vbt, params)
    """
    params = KernelParams(S=S)

    # Create VBT with anchors
    vbt = VBTState(
        bucket_id="mid",
        agent_id="vbt_mid",
        M=M,
        O=O,
    )
    vbt.recompute_quotes()

    # Create dealer with inventory
    dealer = DealerState(
        bucket_id="mid",
        agent_id="dealer_mid",
        cash=dealer_cash,
    )

    # Add tickets to dealer inventory
    for i in range(dealer_tickets):
        ticket = create_ticket(
            issuer_id=f"issuer_{i}",
            owner_id=dealer.agent_id,
            serial=i,
        )
        dealer.inventory.append(ticket)

    # Recompute dealer state
    recompute_dealer_state(dealer, vbt, params)

    return dealer, vbt, params


class TestExample5DealerEarns:
    """
    Example 5: Dealer earns spread over multiple trades.

    Initial state:
    - a=2, C=2, M=1.0, O=0.30
    - V=4, K*=4, X*=4

    Trade sequence:
    1. Customer SELL (dealer buys at bid 0.97)
    2. Customer BUY (dealer sells at ask 0.98)
    3. Customer SELL (dealer buys at bid 0.97)

    Final state:
    - a=3, C=1.04, V=4.04
    - Dealer earned 0.04 in equity
    """

    def test_initial_state(self):
        """Verify initial kernel computation matches Example 5."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
            M=Decimal("1.0"),
            O=Decimal("0.30"),
        )

        # Check initial state
        assert dealer.a == 2
        assert dealer.x == Decimal(2)
        assert dealer.cash == Decimal(2)
        assert dealer.V == Decimal(4)
        assert dealer.K_star == 4
        assert dealer.X_star == Decimal(4)
        assert dealer.N == 5
        assert dealer.lambda_ == Decimal("0.2")  # 1/5
        assert dealer.I == Decimal("0.06")  # 0.2 * 0.30

        # Check quotes at x=2
        assert dealer.midline == Decimal(1)  # p(2) = 1
        assert dealer.ask == Decimal("1.03")  # a(2) = 1.03
        assert dealer.bid == Decimal("0.97")  # b(2) = 0.97

        # Verify invariants
        run_all_assertions(dealer, vbt, params)

    def test_trade_sequence(self):
        """Execute three trades and verify dealer profit."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        executor = TradeExecutor(params)

        # Initial state
        initial_V = dealer.V
        assert initial_V == Decimal(4)

        # Trade 1: Customer SELL (dealer buys at bid)
        ticket1 = create_ticket(
            issuer_id="customer1",
            owner_id="customer1",
        )
        result1 = executor.execute_customer_sell(dealer, vbt, ticket1)

        assert result1.executed
        assert not result1.is_passthrough
        assert result1.price == Decimal("0.97")
        assert dealer.a == 3
        assert dealer.x == Decimal(3)
        assert dealer.cash == Decimal("1.03")  # 2 - 0.97
        assert dealer.V == Decimal("4.03")  # 3 + 1.03

        # Trade 2: Customer BUY (dealer sells at ask)
        result2 = executor.execute_customer_buy(dealer, vbt, "customer2")

        assert result2.executed
        assert not result2.is_passthrough
        assert result2.price == Decimal("0.98")
        assert dealer.a == 2
        assert dealer.x == Decimal(2)
        assert dealer.cash == Decimal("2.01")  # 1.03 + 0.98
        assert dealer.V == Decimal("4.01")  # 2 + 2.01

        # Trade 3: Customer SELL (dealer buys at bid)
        ticket3 = create_ticket(
            issuer_id="customer3",
            owner_id="customer3",
        )
        result3 = executor.execute_customer_sell(dealer, vbt, ticket3)

        assert result3.executed
        assert not result3.is_passthrough
        assert result3.price == Decimal("0.97")
        assert dealer.a == 3
        assert dealer.x == Decimal(3)
        assert dealer.cash == Decimal("1.04")  # 2.01 - 0.97
        assert dealer.V == Decimal("4.04")  # 3 + 1.04

        # Verify dealer earned profit
        profit = dealer.V - initial_V
        assert profit == Decimal("0.04")

    def test_invariants_after_each_trade(self):
        """Verify C2 and C5 hold after each trade."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        executor = TradeExecutor(params)

        # After each trade, verify invariants
        trades = [
            create_ticket(f"customer{i}", f"customer{i}")
            for i in range(3)
        ]

        # Trade 1: SELL
        executor.execute_customer_sell(dealer, vbt, trades[0])
        run_all_assertions(dealer, vbt, params)

        # Trade 2: BUY
        executor.execute_customer_buy(dealer, vbt, "customer2")
        run_all_assertions(dealer, vbt, params)

        # Trade 3: SELL
        executor.execute_customer_sell(dealer, vbt, trades[2])
        run_all_assertions(dealer, vbt, params)


class TestExample4InventoryLimit:
    """
    Example 4: Dealer depletes inventory and VBT layoff occurs.

    Initial state:
    - a=2, C=2, M=1.0, O=0.30
    - V=4, K*=4, X*=4, x=2

    Two customer BUYs deplete inventory to x=0.
    Third customer BUY: interior sell infeasible -> passthrough to VBT at A=1.15.
    Dealer state unchanged (C4 assertion).
    """

    def test_interior_sells_deplete_inventory(self):
        """Two sells bring inventory to zero."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        executor = TradeExecutor(params)

        # Initial: x=2
        assert dealer.x == Decimal(2)
        assert dealer.ask == Decimal("1.03")

        # First BUY: x=2 -> x=1
        result1 = executor.execute_customer_buy(dealer, vbt, "buyer1")
        assert result1.executed
        assert not result1.is_passthrough
        assert result1.price == Decimal("1.03")
        assert dealer.x == Decimal(1)
        assert dealer.ask == Decimal("1.08")  # p(1) = 1.05, a(1) = 1.08

        # Second BUY: x=1 -> x=0
        result2 = executor.execute_customer_buy(dealer, vbt, "buyer2")
        assert result2.executed
        assert not result2.is_passthrough
        assert result2.price == Decimal("1.08")
        assert dealer.x == Decimal(0)
        assert dealer.cash == Decimal("4.11")  # 2 + 1.03 + 1.08

    def test_passthrough_at_zero_inventory(self):
        """Third BUY routes to VBT at A when dealer has no inventory."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        # Add tickets to VBT for passthrough
        for i in range(10):
            ticket = create_ticket(
                issuer_id=f"vbt_issuer_{i}",
                owner_id=vbt.agent_id,
                serial=i,
            )
            vbt.inventory.append(ticket)

        executor = TradeExecutor(params)

        # Deplete dealer inventory
        executor.execute_customer_buy(dealer, vbt, "buyer1")
        executor.execute_customer_buy(dealer, vbt, "buyer2")

        assert dealer.x == Decimal(0)

        # Third BUY: must route to VBT at A=1.15
        dealer_snapshot = deepcopy(dealer)

        result3 = executor.execute_customer_buy(dealer, vbt, "buyer3")

        assert result3.executed
        assert result3.is_passthrough
        assert result3.price == vbt.A  # 1.15

        # Verify dealer unchanged (C4 assertion)
        assert dealer.x == dealer_snapshot.x
        assert dealer.cash == dealer_snapshot.cash

    def test_dealer_unchanged_in_passthrough(self):
        """Verify C4: dealer (x, C) unchanged in passthrough."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=0,  # Start with no inventory
            dealer_cash=Decimal("4.11"),
        )

        # Add tickets to VBT
        for i in range(5):
            ticket = create_ticket(
                issuer_id=f"vbt_issuer_{i}",
                owner_id=vbt.agent_id,
                serial=i,
            )
            vbt.inventory.append(ticket)

        executor = TradeExecutor(params)

        # Capture state before passthrough
        x_before = dealer.x
        cash_before = dealer.cash

        # Execute passthrough
        result = executor.execute_customer_buy(dealer, vbt, "buyer")

        assert result.is_passthrough
        assert dealer.x == x_before
        assert dealer.cash == cash_before


class TestExample6BidPassthrough:
    """
    Example 6: Capacity binding forces bid-side passthrough.

    Scenario: Dealer at capacity (x = X*) with low cash.
    Customer SELL cannot be absorbed -> routes to VBT at B=0.85.
    """

    def test_capacity_bound_at_x_equals_X_star(self):
        """x = X* means no room for interior buy."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal("0.10"),  # Low cash
        )

        # Dealer state: a=2, C=0.10
        # V = 2.10, K*=2, X*=2, x=2=X*
        assert dealer.a == 2
        assert dealer.x == Decimal(2)
        assert dealer.X_star == Decimal(2)
        assert dealer.cash == Decimal("0.10")

        # Check that interior buy is NOT feasible
        assert not can_interior_buy(dealer, params)

    def test_passthrough_at_outside_bid(self):
        """Customer SELL routes to VBT at B when capacity is full."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal("0.10"),
        )

        executor = TradeExecutor(params)

        # Snapshot dealer state
        dealer_snapshot = deepcopy(dealer)

        # Customer SELL
        ticket = create_ticket(
            issuer_id="customer",
            owner_id="customer",
        )

        result = executor.execute_customer_sell(dealer, vbt, ticket)

        # Should passthrough at outside bid B=0.85
        assert result.executed
        assert result.is_passthrough
        assert result.price == vbt.B  # 0.85

        # Dealer state unchanged (C4)
        assert dealer.x == dealer_snapshot.x
        assert dealer.cash == dealer_snapshot.cash


class TestCapacityJump:
    """
    Example 13: One-ticket trade pushes capacity across integer.

    Tests discrete jumps in K*, X*, λ, and I when trades cause
    V to cross integer thresholds.
    """

    def test_up_jump(self):
        """K*: 3 -> 4 after interior buy."""
        # Setup: a=2, C=1.97 => V=3.97, K*=3, X*=3
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal("1.97"),
        )

        # Initial state
        assert dealer.V == Decimal("3.97")
        assert dealer.K_star == 3
        assert dealer.X_star == Decimal(3)
        assert dealer.lambda_ == Decimal("0.25")  # 1/4
        assert dealer.I == Decimal("0.075")  # 0.25 * 0.30

        executor = TradeExecutor(params)

        # Customer SELL (dealer buys)
        ticket = create_ticket(
            issuer_id="customer",
            owner_id="customer",
        )

        result = executor.execute_customer_sell(dealer, vbt, ticket)

        # After buy: a=3, C=1.0375, V=4.0375
        # K* jumps 3->4
        assert result.executed
        assert dealer.a == 3
        assert dealer.V > Decimal(4)
        assert dealer.K_star == 4
        assert dealer.X_star == Decimal(4)

        # Width tightens after capacity increase
        assert dealer.lambda_ == Decimal("0.20")  # 1/5
        assert dealer.I == Decimal("0.06")  # 0.20 * 0.30

    def test_down_jump(self):
        """K*: 4 -> 3 after interior sell."""
        # Setup: a=4, C=0.02 => V=4.02, K*=4, X*=4
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=4,
            dealer_cash=Decimal("0.02"),
        )

        # Initial state
        assert dealer.V == Decimal("4.02")
        assert dealer.K_star == 4
        assert dealer.X_star == Decimal(4)
        assert dealer.lambda_ == Decimal("0.20")  # 1/5
        assert dealer.I == Decimal("0.06")

        executor = TradeExecutor(params)

        # Customer BUY (dealer sells)
        result = executor.execute_customer_buy(dealer, vbt, "buyer")

        # After sell: a=3, C=0.95, V=3.95
        # K* jumps 4->3
        assert result.executed
        assert dealer.a == 3
        assert dealer.V == Decimal("3.95")
        assert dealer.K_star == 3
        assert dealer.X_star == Decimal(3)

        # Width widens after capacity decrease
        assert dealer.lambda_ == Decimal("0.25")  # 1/4
        assert dealer.I == Decimal("0.075")  # 0.25 * 0.30

    def test_width_changes_with_capacity(self):
        """Verify λ and I change discretely when K* jumps."""
        # Test both directions
        dealer_up, vbt_up, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal("1.97"),
        )

        lambda_before_up = dealer_up.lambda_
        I_before_up = dealer_up.I

        executor = TradeExecutor(params)
        ticket = create_ticket("cust", "cust")
        executor.execute_customer_sell(dealer_up, vbt_up, ticket)

        # Lambda decreases (capacity increased)
        assert dealer_up.lambda_ < lambda_before_up
        assert dealer_up.I < I_before_up

        # Test down jump
        dealer_down, vbt_down, _ = setup_dealer_vbt_params(
            dealer_tickets=4,
            dealer_cash=Decimal("0.02"),
        )

        lambda_before_down = dealer_down.lambda_
        I_before_down = dealer_down.I

        executor.execute_customer_buy(dealer_down, vbt_down, "buyer")

        # Lambda increases (capacity decreased)
        assert dealer_down.lambda_ > lambda_before_down
        assert dealer_down.I > I_before_down


class TestGuardRegime:
    """
    Example 9: Guard at very low M <= M_min.

    When M <= 0.02, dealer enters guard regime:
    - X* := 0
    - Quotes pinned to outside (A, B)
    - All trades route to VBT (passthrough both sides)
    """

    def test_guard_pins_quotes(self):
        """Both quotes pinned when M <= M_min."""
        # Setup with very low M
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=3,
            dealer_cash=Decimal("2.00"),
            M=Decimal("0.01"),  # Below M_MIN = 0.02
            O=Decimal("0.01"),
        )

        # Guard should activate
        assert vbt.M <= M_MIN
        assert dealer.X_star == Decimal(0)
        assert dealer.is_pinned_ask
        assert dealer.is_pinned_bid
        assert dealer.ask == vbt.A
        assert dealer.bid == vbt.B

    def test_passthrough_both_sides(self):
        """All trades route to VBT in guard regime when dealer has no inventory."""
        # In guard regime, X*=0 means no capacity for BUYs
        # SELLs can still happen if dealer has inventory
        # To test full passthrough, start with no dealer inventory
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=0,  # No inventory
            dealer_cash=Decimal("2.00"),
            M=Decimal("0.01"),
            O=Decimal("0.01"),
        )

        # Add VBT inventory for passthrough
        for i in range(5):
            ticket = create_ticket(
                issuer_id=f"vbt_issuer_{i}",
                owner_id=vbt.agent_id,
                serial=i,
            )
            vbt.inventory.append(ticket)

        executor = TradeExecutor(params)

        # Test SELL passthrough (X*=0, cannot buy)
        ticket_sell = create_ticket("customer_sell", "customer_sell")
        dealer_x_before = dealer.x
        dealer_cash_before = dealer.cash

        result_sell = executor.execute_customer_sell(dealer, vbt, ticket_sell)

        assert result_sell.is_passthrough
        assert result_sell.price == vbt.B
        assert dealer.x == dealer_x_before  # Unchanged
        assert dealer.cash == dealer_cash_before  # Unchanged

        # Test BUY passthrough (x=0, no inventory)
        result_buy = executor.execute_customer_buy(dealer, vbt, "customer_buy")

        assert result_buy.is_passthrough
        assert result_buy.price == vbt.A
        assert dealer.x == dealer_x_before  # Still unchanged
        assert dealer.cash == dealer_cash_before  # Still unchanged


class TestPartialRecovery:
    """
    Example 10 & 12: Partial recovery default.

    Tests proportional recovery when issuer has insufficient cash:
    R = C/D when C < D

    Multiple claimants (dealer, VBT, trader) all receive proportional recovery.
    """

    def test_recovery_rate_computation(self):
        """R = C/D when C < D."""
        # Issuer has 3 units cash, owes 5 units
        # R = 3/5 = 0.6

        issuer_cash = Decimal(3)
        total_due = Decimal(5)

        recovery_rate = issuer_cash / total_due
        assert recovery_rate == Decimal("0.6")

        # Each holder receives proportional payout
        dealer_tickets = 2
        vbt_tickets = 2
        trader_tickets = 1

        dealer_payout = dealer_tickets * recovery_rate
        vbt_payout = vbt_tickets * recovery_rate
        trader_payout = trader_tickets * recovery_rate

        assert dealer_payout == Decimal("1.2")
        assert vbt_payout == Decimal("1.2")
        assert trader_payout == Decimal("0.6")

        # Total payout equals issuer cash
        total_payout = dealer_payout + vbt_payout + trader_payout
        assert total_payout == issuer_cash

    def test_multiple_claimants(self):
        """Dealer, VBT, and trader all receive proportional recovery."""
        # Setup scenario from Example 12
        recovery_rate = Decimal("0.6")

        # Create maturing tickets for each claimant type
        dealer_tickets = [
            create_ticket("issuer_I", "dealer", serial=i)
            for i in range(2)
        ]

        vbt_tickets = [
            create_ticket("issuer_I", "vbt", serial=i+2)
            for i in range(2)
        ]

        trader_tickets = [
            create_ticket("issuer_I", "trader", serial=4)
        ]

        # Calculate payouts
        dealer_payout = len(dealer_tickets) * recovery_rate
        vbt_payout = len(vbt_tickets) * recovery_rate
        trader_payout = len(trader_tickets) * recovery_rate

        # Verify equal per-ticket recovery
        assert dealer_payout == Decimal("1.2")
        assert vbt_payout == Decimal("1.2")
        assert trader_payout == Decimal("0.6")

        # Total
        total = dealer_payout + vbt_payout + trader_payout
        assert total == Decimal("3.0")


class TestQuoteBounds:
    """
    Test C2 assertion: quotes within outside bounds.

    Verifies that dealer interior quotes remain within VBT outside bounds
    at all inventory levels.
    """

    def test_quotes_within_bounds_at_all_levels(self):
        """Dealer quotes stay within [B, A] for all feasible x."""
        dealer, vbt, params = setup_dealer_vbt_params()

        # Test at various inventory levels
        for x in range(int(dealer.X_star) + 1):
            # Adjust dealer inventory to x
            dealer.inventory = [
                create_ticket(f"issuer_{i}", dealer.agent_id, serial=i)
                for i in range(x)
            ]
            recompute_dealer_state(dealer, vbt, params)

            # Verify bounds
            assert dealer.bid >= vbt.B, f"Bid {dealer.bid} < outside bid {vbt.B} at x={x}"
            assert dealer.ask <= vbt.A, f"Ask {dealer.ask} > outside ask {vbt.A} at x={x}"

            # Verify pin detection
            assert (dealer.bid == vbt.B) == dealer.is_pinned_bid
            assert (dealer.ask == vbt.A) == dealer.is_pinned_ask

    def test_no_interior_clipping(self):
        """Interior quotes never equal outside quotes (no clipping on interior rungs)."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        # At x=2 (balanced), quotes should be strictly inside
        assert dealer.x == Decimal(2)
        assert dealer.bid > vbt.B
        assert dealer.ask < vbt.A
        assert not dealer.is_pinned_bid
        assert not dealer.is_pinned_ask


class TestFeasibilityChecks:
    """
    Test C3 assertion: feasibility pre-checks.

    Verifies that trades are only executed when feasible:
    - BUY: x + S <= X* and C >= b_c(x)
    - SELL: x >= S
    """

    def test_interior_buy_feasibility(self):
        """Interior buy requires capacity and cash."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        # At x=2, X*=4: has capacity for buy
        assert dealer.x + params.S <= dealer.X_star
        assert dealer.cash >= dealer.bid
        assert can_interior_buy(dealer, params)

        # Test cash constraint: reduce cash below bid
        # But we need to know what the bid will be after recomputation
        dealer.cash = Decimal("0.90")
        recompute_dealer_state(dealer, vbt, params)

        # With less cash, may not have enough for bid
        # Check if cash is insufficient
        if dealer.cash < dealer.bid:
            assert not can_interior_buy(dealer, params)

        # Test capacity constraint: dealer at full capacity
        # Setup: a=2, C=0.10 => V=2.10, K*=2, X*=2, x=2=X*
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal("0.10"),
        )

        # At x=2=X*, no room for more
        assert dealer.x == Decimal(2)
        assert dealer.X_star == Decimal(2)
        assert dealer.x == dealer.X_star
        assert not can_interior_buy(dealer, params)

    def test_interior_sell_feasibility(self):
        """Interior sell requires inventory."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=2,
            dealer_cash=Decimal(2),
        )

        # Has inventory
        assert dealer.x >= params.S
        assert can_interior_sell(dealer, params)

        # Deplete inventory
        dealer.inventory = []
        recompute_dealer_state(dealer, vbt, params)

        # No inventory
        assert dealer.x == Decimal(0)
        assert not can_interior_sell(dealer, params)


class TestDoubleEntry:
    """
    Test C1 assertion: double-entry bookkeeping.

    For every trade, cash and ticket flows must balance across all parties.
    """

    def test_interior_trade_balance(self):
        """Interior trade: cash and tickets balance between customer and dealer."""
        dealer, vbt, params = setup_dealer_vbt_params()
        executor = TradeExecutor(params)

        # Customer SELL
        ticket = create_ticket("customer", "customer")
        result = executor.execute_customer_sell(dealer, vbt, ticket)

        # Manual verification (assertions run automatically in executor)
        price = result.price

        # Cash: customer +price, dealer -price => sum = 0
        assert_c1_double_entry(
            cash_changes={"customer": price, dealer.agent_id: -price},
            qty_changes={"customer": -1, dealer.agent_id: 1},
        )

    def test_passthrough_trade_balance(self):
        """Passthrough trade: cash and tickets balance between customer and VBT."""
        dealer, vbt, params = setup_dealer_vbt_params(
            dealer_tickets=0,  # Force passthrough
            dealer_cash=Decimal(2),
        )

        # Add VBT inventory
        for i in range(5):
            vbt.inventory.append(
                create_ticket(f"vbt_issuer_{i}", vbt.agent_id, serial=i)
            )

        executor = TradeExecutor(params)

        # Customer BUY (passthrough)
        result = executor.execute_customer_buy(dealer, vbt, "customer")

        assert result.is_passthrough
        price = result.price

        # Cash: customer -price, VBT +price, dealer 0 => sum = 0
        assert_c1_double_entry(
            cash_changes={"customer": -price, vbt.agent_id: price},
            qty_changes={"customer": 1, vbt.agent_id: -1},
        )


if __name__ == "__main__":
    pytest.main([__file__, "-v"])

```

---

### 🧪 tests/dealer/test_kernel.py

```python
"""
Unit tests for the L1 dealer pricing kernel.

This module verifies the dealer kernel formulas against the specification
using pytest and Decimal throughout. All numerical examples are from the
specification document.

References:
- Specification Section 8: L1 Dealer Pricing Formulas
- Examples Document: Balanced dealer state example
"""

import pytest
from decimal import Decimal
from copy import deepcopy

from bilancio.dealer import (
    Ticket,
    DealerState,
    VBTState,
    KernelParams,
    recompute_dealer_state,
    can_interior_buy,
    can_interior_sell,
    assert_c2_quote_bounds,
    assert_c5_equity_basis,
)
from bilancio.core.ids import new_id


# Helper function to create test fixtures
def make_dealer_vbt(
    a: int = 2,
    cash: Decimal = Decimal(2),
    M: Decimal = Decimal(1),
    O: Decimal = Decimal("0.30"),
    S: Decimal = Decimal(1),
) -> tuple[DealerState, VBTState, KernelParams]:
    """
    Create dealer/VBT with specified parameters for testing.

    Args:
        a: Number of tickets in dealer inventory
        cash: Dealer cash holdings
        M: VBT mid price
        O: VBT outside spread
        S: Standard ticket size (face value)

    Returns:
        Tuple of (DealerState, VBTState, KernelParams)
    """
    params = KernelParams(S=S)

    # Create VBT state
    vbt = VBTState(
        bucket_id="test",
        agent_id="vbt_agent",
        M=M,
        O=O,
    )
    vbt.recompute_quotes()

    # Create dealer state with inventory
    dealer = DealerState(
        bucket_id="test",
        agent_id="dealer_agent",
        cash=cash,
    )

    # Add tickets to inventory
    for i in range(a):
        ticket = Ticket(
            id=f"ticket_{i}",
            issuer_id="issuer_1",
            owner_id=dealer.agent_id,
            face=S,
            maturity_day=100,
            remaining_tau=10,
            bucket_id="test",
            serial=i,
        )
        dealer.inventory.append(ticket)

    # Recompute dealer state
    recompute_dealer_state(dealer, vbt, params)

    return dealer, vbt, params


class TestCapacityComputation:
    """Test K* = floor(V/M) and X* = S*K*."""

    def test_balanced_state(self):
        """Example: a=2, C=2, M=1 -> V=4, K*=4, X*=4."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # Check V = M*a + C = 1*2 + 2 = 4
        assert dealer.V == Decimal(4)

        # Check K* = floor(V/M) = floor(4/1) = 4
        assert dealer.K_star == 4

        # Check X* = S*K* = 1*4 = 4
        assert dealer.X_star == Decimal(4)

    def test_fractional_capacity(self):
        """V=3.97 -> K*=3 (floor), X*=3."""
        # Set up: a=2, C=1.97, M=1.0
        # V = M*a + C = 1.0*2 + 1.97 = 3.97
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal("1.97"),
            M=Decimal(1),
        )

        # Check V
        assert dealer.V == Decimal("3.97")

        # Check K* = floor(3.97/1.0) = floor(3.97) = 3
        assert dealer.K_star == 3

        # Check X* = S*K* = 1*3 = 3
        assert dealer.X_star == Decimal(3)

    def test_zero_cash(self):
        """a=2, C=0, M=1 -> V=2, K*=2."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(0),
            M=Decimal(1),
        )

        # Check V = M*a + C = 1*2 + 0 = 2
        assert dealer.V == Decimal(2)

        # Check K* = floor(2/1) = 2
        assert dealer.K_star == 2

        # Check X* = S*K* = 1*2 = 2
        assert dealer.X_star == Decimal(2)


class TestLayoffProbability:
    """Test λ = S/(X* + S)."""

    def test_standard_case(self):
        """X*=4, S=1 -> λ = 1/5 = 0.2."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # X* = 4, S = 1
        assert dealer.X_star == Decimal(4)

        # λ = S/(X*+S) = 1/(4+1) = 1/5 = 0.2
        expected_lambda = Decimal(1) / Decimal(5)
        assert dealer.lambda_ == expected_lambda

    def test_small_capacity(self):
        """X*=1, S=1 -> λ = 1/2 = 0.5."""
        # Set up: a=1, C=0, M=1 -> V=1, K*=1, X*=1
        dealer, vbt, params = make_dealer_vbt(
            a=1,
            cash=Decimal(0),
            M=Decimal(1),
        )

        assert dealer.X_star == Decimal(1)

        # λ = S/(X*+S) = 1/(1+1) = 1/2 = 0.5
        expected_lambda = Decimal(1) / Decimal(2)
        assert dealer.lambda_ == expected_lambda

    def test_zero_capacity(self):
        """X*=0 -> λ = 1 (degenerate case)."""
        # Set up: a=0, C=0, M=1 -> V=0, K*=0, X*=0
        dealer, vbt, params = make_dealer_vbt(
            a=0,
            cash=Decimal(0),
            M=Decimal(1),
        )

        assert dealer.X_star == Decimal(0)

        # λ = 1 (degenerate case)
        assert dealer.lambda_ == Decimal(1)


class TestInsideWidth:
    """Test I = λ * O."""

    def test_standard_case(self):
        """λ=0.2, O=0.30 -> I = 0.06."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # λ = 1/5 = 0.2
        assert dealer.lambda_ == Decimal(1) / Decimal(5)

        # I = λ*O = 0.2*0.30 = 0.06
        expected_I = Decimal("0.2") * Decimal("0.30")
        assert dealer.I == expected_I

    def test_width_shrinks_with_capacity(self):
        """Higher capacity -> lower λ -> narrower I."""
        # Low capacity case: a=1, C=0 -> X*=1, λ=0.5
        dealer_low, vbt_low, params_low = make_dealer_vbt(
            a=1,
            cash=Decimal(0),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # High capacity case: a=2, C=2 -> X*=4, λ=0.2
        dealer_high, vbt_high, params_high = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Verify λ decreases with capacity
        assert dealer_high.X_star > dealer_low.X_star
        assert dealer_high.lambda_ < dealer_low.lambda_

        # Verify I decreases with capacity
        assert dealer_high.I < dealer_low.I


class TestMidlineFormula:
    """Test p(x) = M - O/(X*+2S) * (x - X*/2)."""

    def test_balanced_inventory(self):
        """At x=X*/2=2 (balanced): p(2)=M=1.0."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # X* = 4, x = a*S = 2*1 = 2 = X*/2 (balanced)
        assert dealer.X_star == Decimal(4)
        assert dealer.x == Decimal(2)

        # At balanced inventory, p(x) = M
        assert dealer.midline == Decimal(1)

    def test_low_inventory(self):
        """At x=0: p(0) > M (dealer wants to buy, higher price)."""
        # Create dealer with zero inventory
        dealer, vbt, params = make_dealer_vbt(
            a=0,
            cash=Decimal(4),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # x=0, X*=4
        assert dealer.x == Decimal(0)
        assert dealer.X_star == Decimal(4)

        # p(0) = M - O/(X*+2S) * (0 - X*/2)
        #      = M - O/(X*+2S) * (-X*/2)
        #      = M + O*X* / (2*(X*+2S))
        #      > M (since O, X* > 0)
        assert dealer.midline > vbt.M

    def test_high_inventory(self):
        """At x=X*: p(X*) < M (dealer wants to sell, lower price)."""
        # Create dealer with x=X*=4 (full capacity)
        # Need a=4, C=0, M=1 -> V=4, K*=4, X*=4
        dealer, vbt, params = make_dealer_vbt(
            a=4,
            cash=Decimal(0),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # x=4, X*=4
        assert dealer.x == Decimal(4)
        assert dealer.X_star == Decimal(4)

        # p(4) = M - O/(X*+2S) * (4 - 4/2)
        #      = M - O/(X*+2S) * (4 - 2)
        #      = M - 2*O/(X*+2S)
        #      < M (since O > 0)
        assert dealer.midline < vbt.M

    def test_midline_slope(self):
        """Verify slope = O/(X*+2S)."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # X* = 4, S = 1
        # slope = O/(X*+2S) = 0.30/(4+2) = 0.30/6 = 0.05
        S = params.S
        expected_slope = vbt.O / (dealer.X_star + 2 * S)
        assert expected_slope == Decimal("0.05")

        # Verify the midline formula at specific points
        # p(x) = M - slope * (x - X*/2)

        # At x=0 (no inventory):
        x_test = Decimal(0)
        expected_p = vbt.M - expected_slope * (x_test - dealer.X_star / 2)

        # Create dealer with x=0 but same X* (maintain V=4 via cash)
        dealer_test, vbt_test, params_test = make_dealer_vbt(
            a=0,
            cash=Decimal(4),  # V = 0*1 + 4 = 4, K* = 4, X* = 4
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Verify X* is same
        assert dealer_test.X_star == dealer.X_star

        # Verify midline matches formula
        # At x=0: p(0) = M - slope * (0 - 2) = M + 2*slope
        expected_p_0 = vbt.M + 2 * expected_slope
        assert abs(dealer_test.midline - expected_p_0) < Decimal("1e-10")

        # At x=4 (full capacity):
        dealer_test2, vbt_test2, params_test2 = make_dealer_vbt(
            a=4,
            cash=Decimal(0),  # V = 4*1 + 0 = 4, K* = 4, X* = 4
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Verify X* is same
        assert dealer_test2.X_star == dealer.X_star

        # At x=4: p(4) = M - slope * (4 - 2) = M - 2*slope
        expected_p_4 = vbt.M - 2 * expected_slope
        assert abs(dealer_test2.midline - expected_p_4) < Decimal("1e-10")


class TestInteriorQuotes:
    """Test a(x) = p(x) + I/2, b(x) = p(x) - I/2."""

    def test_quotes_at_balanced(self):
        """At x=2: a(2)=1.03, b(2)=0.97."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # At balanced inventory (x=2), p(2) = M = 1.0
        # I = λ*O = 0.2*0.30 = 0.06
        # a(2) = p(2) + I/2 = 1.0 + 0.03 = 1.03
        # b(2) = p(2) - I/2 = 1.0 - 0.03 = 0.97

        assert dealer.midline == Decimal(1)
        assert dealer.I == Decimal("0.06")

        # Since interior quotes aren't clipped in this case:
        # ask = a(x) = p(x) + I/2
        # bid = b(x) = p(x) - I/2
        half_I = dealer.I / 2
        expected_ask = dealer.midline + half_I
        expected_bid = dealer.midline - half_I

        # Verify quotes (accounting for possible clipping)
        # In this case, A = M + O/2 = 1.0 + 0.15 = 1.15
        # B = M - O/2 = 1.0 - 0.15 = 0.85
        # So a(2) = 1.03 < 1.15 = A (not clipped)
        # And b(2) = 0.97 > 0.85 = B (not clipped)

        assert dealer.ask == expected_ask
        assert dealer.bid == expected_bid

        # Check exact values from spec
        assert dealer.ask == Decimal("1.03")
        assert dealer.bid == Decimal("0.97")

    def test_spread_equals_inside_width(self):
        """a(x) - b(x) = I."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Spread should equal I (assuming no clipping)
        spread = dealer.ask - dealer.bid
        assert spread == dealer.I


class TestClippedQuotes:
    """Test a_c(x) = min(A, a(x)), b_c(x) = max(B, b(x))."""

    def test_no_clipping_in_normal_case(self):
        """Interior quotes stay within outside bounds."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # A = M + O/2 = 1.0 + 0.15 = 1.15
        # B = M - O/2 = 1.0 - 0.15 = 0.85
        assert vbt.A == Decimal("1.15")
        assert vbt.B == Decimal("0.85")

        # a(2) = 1.03 < 1.15, so no clipping
        # b(2) = 0.97 > 0.85, so no clipping
        assert dealer.ask < vbt.A
        assert dealer.bid > vbt.B

        # Verify not pinned
        assert not dealer.is_pinned_ask
        assert not dealer.is_pinned_bid

    def test_quotes_never_exceed_bounds(self):
        """Property: b_c >= B and a_c <= A always."""
        # Test various inventory levels
        for a in [0, 1, 2, 3, 4]:
            dealer, vbt, params = make_dealer_vbt(
                a=a,
                cash=Decimal(2),
                M=Decimal(1),
                O=Decimal("0.30"),
            )

            # Quotes must be within bounds
            assert dealer.bid >= vbt.B
            assert dealer.ask <= vbt.A


class TestPinDetection:
    """Test pin flags consistency."""

    def test_not_pinned_normal(self):
        """Normal case: not pinned."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # In balanced state with sufficient capacity, should not be pinned
        assert not dealer.is_pinned_ask
        assert not dealer.is_pinned_bid

    def test_pin_detection_consistency(self):
        """is_pinned_ask iff ask == A."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Check consistency
        assert dealer.is_pinned_ask == (dealer.ask == vbt.A)
        assert dealer.is_pinned_bid == (dealer.bid == vbt.B)


class TestGuardRegime:
    """Test M <= M_MIN behavior."""

    def test_guard_activates(self):
        """When M <= 0.02, X*=0 and quotes pinned."""
        from bilancio.dealer import M_MIN

        # Set M = M_MIN = 0.02
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=M_MIN,
            O=Decimal("0.30"),
        )

        # In guard regime: X* = 0
        assert dealer.X_star == Decimal(0)

        # Quotes pinned to outside
        assert dealer.is_pinned_ask
        assert dealer.is_pinned_bid

    def test_guard_pins_both_quotes(self):
        """Both ask and bid pinned to outside in guard."""
        from bilancio.dealer import M_MIN

        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=M_MIN - Decimal("0.01"),  # Below threshold
            O=Decimal("0.30"),
        )

        # Quotes must equal outside quotes
        assert dealer.ask == vbt.A
        assert dealer.bid == vbt.B


class TestFeasibilityChecks:
    """Test can_interior_buy and can_interior_sell."""

    def test_interior_buy_feasible(self):
        """x + S <= X* and C >= b_c(x)."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # x=2, X*=4, so x+S=3 <= 4 ✓
        # C=2 >= b_c(2)=0.97 ✓
        assert can_interior_buy(dealer, params)

    def test_interior_buy_capacity_fails(self):
        """x + S > X* -> infeasible."""
        # Set up: a=4, C=0 -> x=4, X*=4
        dealer, vbt, params = make_dealer_vbt(
            a=4,
            cash=Decimal(0),
            M=Decimal(1),
        )

        # x=4, X*=4, so x+S=5 > 4 ✗
        assert not can_interior_buy(dealer, params)

    def test_interior_buy_cash_fails(self):
        """C < b_c(x) -> infeasible."""
        # Set up: a=2, C=0.50 (insufficient cash)
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal("0.50"),
            M=Decimal(1),
        )

        # bid = 0.97, cash = 0.50, so 0.50 < 0.97 ✗
        assert not can_interior_buy(dealer, params)

    def test_interior_sell_feasible(self):
        """x >= S."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # x=2, S=1, so 2 >= 1 ✓
        assert can_interior_sell(dealer, params)

    def test_interior_sell_no_inventory(self):
        """x < S -> infeasible."""
        # Set up: a=0 -> x=0
        dealer, vbt, params = make_dealer_vbt(
            a=0,
            cash=Decimal(4),
            M=Decimal(1),
        )

        # x=0, S=1, so 0 < 1 ✗
        assert not can_interior_sell(dealer, params)


class TestInvariants:
    """Test C2 and C5 invariants hold after kernel computation."""

    def test_c2_quote_bounds(self):
        """Quotes within outside bounds."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal("0.30"),
        )

        # Should not raise
        assert_c2_quote_bounds(dealer, vbt)

    def test_c2_quote_bounds_various_states(self):
        """Test C2 across various inventory states."""
        for a in [0, 1, 2, 3, 4]:
            for cash in [Decimal(0), Decimal(1), Decimal(2), Decimal(5)]:
                dealer, vbt, params = make_dealer_vbt(
                    a=a,
                    cash=cash,
                    M=Decimal(1),
                    O=Decimal("0.30"),
                )

                # Should never violate C2
                assert_c2_quote_bounds(dealer, vbt)

    def test_c5_equity_basis(self):
        """V = C + M*a."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # Should not raise
        assert_c5_equity_basis(dealer, vbt)

    def test_c5_equity_basis_various_states(self):
        """Test C5 across various states."""
        for a in [0, 1, 2, 3, 4]:
            for cash in [Decimal(0), Decimal(1), Decimal(2), Decimal(5)]:
                for M in [Decimal("0.5"), Decimal(1), Decimal("1.5")]:
                    dealer, vbt, params = make_dealer_vbt(
                        a=a,
                        cash=cash,
                        M=M,
                        O=Decimal("0.30"),
                    )

                    # Should never violate C5
                    assert_c5_equity_basis(dealer, vbt)


class TestEdgeCases:
    """Test edge cases and boundary conditions."""

    def test_zero_inventory_zero_cash(self):
        """Empty dealer: a=0, C=0."""
        dealer, vbt, params = make_dealer_vbt(
            a=0,
            cash=Decimal(0),
            M=Decimal(1),
        )

        assert dealer.V == Decimal(0)
        assert dealer.K_star == 0
        assert dealer.X_star == Decimal(0)

    def test_large_inventory(self):
        """Large inventory: a=100."""
        dealer, vbt, params = make_dealer_vbt(
            a=100,
            cash=Decimal(0),
            M=Decimal(1),
        )

        # V = 100, K* = 100, X* = 100
        assert dealer.V == Decimal(100)
        assert dealer.K_star == 100
        assert dealer.X_star == Decimal(100)

        # λ should be small with large capacity
        assert dealer.lambda_ < Decimal("0.01")

    def test_high_outside_spread(self):
        """Wide outside spread: O=1.0."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
            O=Decimal(1),
        )

        # I should be larger with wider O
        assert dealer.I == dealer.lambda_ * Decimal(1)

    def test_low_mid_price(self):
        """Low VBT mid: M=0.10."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal("0.10"),
            O=Decimal("0.05"),
        )

        # V = M*a + C = 0.10*2 + 2 = 2.20
        assert dealer.V == Decimal("2.20")

        # K* = floor(2.20 / 0.10) = floor(22) = 22
        assert dealer.K_star == 22

        # X* = 1 * 22 = 22
        assert dealer.X_star == Decimal(22)


class TestKernelRecomputation:
    """Test that kernel recomputation is idempotent and consistent."""

    def test_idempotency(self):
        """Recomputing twice should give same result."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # Save state after first computation
        V_1 = dealer.V
        ask_1 = dealer.ask
        bid_1 = dealer.bid

        # Recompute again
        recompute_dealer_state(dealer, vbt, params)

        # Should be identical
        assert dealer.V == V_1
        assert dealer.ask == ask_1
        assert dealer.bid == bid_1

    def test_consistency_after_inventory_change(self):
        """Adding inventory should update all derived quantities."""
        dealer, vbt, params = make_dealer_vbt(
            a=2,
            cash=Decimal(2),
            M=Decimal(1),
        )

        # Save initial state
        x_before = dealer.x
        V_before = dealer.V

        # Add one ticket
        ticket = Ticket(
            id="ticket_new",
            issuer_id="issuer_1",
            owner_id=dealer.agent_id,
            face=params.S,
            maturity_day=100,
            remaining_tau=10,
            bucket_id="test",
            serial=999,
        )
        dealer.inventory.append(ticket)

        # Recompute
        recompute_dealer_state(dealer, vbt, params)

        # Verify changes
        assert dealer.x == x_before + params.S
        assert dealer.a == 3
        assert dealer.V > V_before  # V increased (assuming M > 0)

```

---

### 🧪 tests/dealer/test_metrics.py

```python
"""Tests for dealer metrics (Section 8 of the functional dealer specification).

Tests verify the metrics tracking infrastructure for:
- Trade log with pre/post state (8.1)
- Dealer P&L and profitability (8.2)
- Trader investment returns and liquidity use (8.3)
- Repayment-priority diagnostics (8.4)
"""

import pytest
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.domain.agents import Household, CentralBank
from bilancio.domain.instruments.credit import Payable
from bilancio.engines.dealer_integration import (
    initialize_dealer_subsystem,
    run_dealer_trading_phase,
)
from bilancio.dealer.simulation import DealerRingConfig
from bilancio.dealer.models import DEFAULT_BUCKETS
from bilancio.dealer.metrics import (
    RunMetrics,
    TradeRecord,
    DealerSnapshot,
    TraderSnapshot,
    TicketOutcome,
    compute_safety_margin,
)


def create_test_system_with_ring():
    """Create a test system with a Kalecki ring of debts.

    Creates 5 households with:
    - 100 cash each
    - Ring of debts: h0->h1->h2->h3->h4->h0 (50 each, due day 5)
    """
    sys = System()

    # Add central bank
    cb = CentralBank(id="CB", name="Central Bank", kind="central_bank")
    sys.add_agent(cb)

    # Create households
    households = []
    for i in range(5):
        h = Household(id=f"h{i}", name=f"Household {i}", kind="household")
        sys.add_agent(h)
        sys.mint_cash(h.id, 100)
        households.append(h)

    # Create ring of debt (each owes 50 to the next)
    for i in range(5):
        creditor_id = households[(i + 1) % 5].id
        debtor_id = households[i].id

        p_id = sys.new_contract_id("P")
        payable = Payable(
            id=p_id,
            kind="payable",
            amount=50,
            denom="USD",
            asset_holder_id=creditor_id,
            liability_issuer_id=debtor_id,
            due_day=5,
        )
        sys.add_contract(payable)

    return sys, households


def create_dealer_config():
    """Create a test dealer configuration."""
    return DealerRingConfig(
        ticket_size=Decimal(1),
        buckets=list(DEFAULT_BUCKETS),
        dealer_share=Decimal("0.25"),
        vbt_share=Decimal("0.50"),
        vbt_anchors={
            "short": (Decimal("1.0"), Decimal("0.20")),
            "mid": (Decimal("1.0"), Decimal("0.30")),
            "long": (Decimal("1.0"), Decimal("0.40")),
        },
        phi_M=Decimal("0.1"),
        phi_O=Decimal("0.1"),
        clip_nonneg_B=True,
        seed=42,
    )


class TestMetricsInitialization:
    """Test metrics are properly initialized."""

    def test_initial_equity_captured(self):
        """Test that initial equity is captured for each bucket."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Should have initial equity for each bucket
        assert len(subsystem.metrics.initial_equity_by_bucket) == 3
        assert "short" in subsystem.metrics.initial_equity_by_bucket
        assert "mid" in subsystem.metrics.initial_equity_by_bucket
        assert "long" in subsystem.metrics.initial_equity_by_bucket

        # Initial equity should be positive (dealer has cash)
        for bucket_id, equity in subsystem.metrics.initial_equity_by_bucket.items():
            assert equity > 0, f"Initial equity for {bucket_id} should be positive"

    def test_metrics_object_created(self):
        """Test that RunMetrics object is created."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        assert subsystem.metrics is not None
        assert isinstance(subsystem.metrics, RunMetrics)
        assert len(subsystem.metrics.trades) == 0  # No trades yet
        assert len(subsystem.metrics.dealer_snapshots) == 0  # No snapshots yet


class TestTradeLogging:
    """Test trade log captures (Section 8.1)."""

    def test_dealer_snapshots_captured_each_day(self):
        """Test dealer snapshots are captured each trading day."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading for 3 days
        for day in range(1, 4):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # Should have 3 snapshots per bucket (3 buckets * 3 days = 9)
        assert len(subsystem.metrics.dealer_snapshots) == 9

        # Each snapshot should have correct structure
        for snapshot in subsystem.metrics.dealer_snapshots:
            assert isinstance(snapshot, DealerSnapshot)
            assert snapshot.day >= 1
            assert snapshot.bucket in ["short", "mid", "long"]
            assert snapshot.inventory >= 0
            assert snapshot.cash >= 0

    def test_trader_snapshots_captured_each_day(self):
        """Test trader snapshots are captured each trading day."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading for 2 days
        for day in range(1, 3):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # Should have snapshots for each trader each day (5 traders * 2 days = 10)
        assert len(subsystem.metrics.trader_snapshots) == 10

        # Each snapshot should have correct structure
        for snapshot in subsystem.metrics.trader_snapshots:
            assert isinstance(snapshot, TraderSnapshot)
            assert snapshot.trader_id.startswith("h")
            assert snapshot.cash >= 0


class TestDealerProfitability:
    """Test dealer profitability metrics (Section 8.2)."""

    def test_pnl_computation(self):
        """Test P&L computation after trading."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run several trading days
        for day in range(1, 6):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # Get P&L by bucket
        pnl = subsystem.metrics.dealer_pnl_by_bucket()

        assert isinstance(pnl, dict)
        assert "short" in pnl or "mid" in pnl or "long" in pnl

    def test_return_computation(self):
        """Test return computation after trading."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading
        for day in range(1, 6):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # Get returns by bucket
        returns = subsystem.metrics.dealer_return_by_bucket()

        assert isinstance(returns, dict)
        # Returns should be in reasonable range (-1 to +1)
        for bucket_id, ret in returns.items():
            assert ret >= -1 and ret <= 1, f"Return for {bucket_id} should be reasonable"

    def test_summary_includes_profitability(self):
        """Test summary includes profitability metrics."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        summary = subsystem.metrics.summary()

        assert "dealer_total_pnl" in summary
        assert "dealer_total_return" in summary
        assert "dealer_profitable" in summary
        assert "dealer_pnl_by_bucket" in summary


class TestSafetyMargin:
    """Test repayment-priority diagnostics (Section 8.4)."""

    def test_safety_margin_computation(self):
        """Test safety margin computation for a trader."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading to generate snapshots
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        # Check trader snapshots have safety margins
        for snapshot in subsystem.metrics.trader_snapshots:
            # Safety margin should be computed
            assert snapshot.safety_margin is not None

            # For our setup: cash=100, obligations=50
            # Safety margin = cash + saleable_value - obligations
            # Should be positive initially since cash > obligations
            assert snapshot.safety_margin > Decimal(-200)  # Reasonable lower bound

    def test_summary_includes_safety_metrics(self):
        """Test summary includes safety margin metrics."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        summary = subsystem.metrics.summary()

        assert "unsafe_buy_count" in summary
        assert "fraction_unsafe_buys" in summary


class TestLiquidityMetrics:
    """Test liquidity-driven sales metrics (Section 8.3)."""

    def test_liquidity_driven_flag_tracked(self):
        """Test that liquidity-driven flag is tracked on trades."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run multiple days to potentially generate trades
        for day in range(1, 6):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # If there are trades, check they have the flag
        for trade in subsystem.metrics.trades:
            assert hasattr(trade, "is_liquidity_driven")

    def test_summary_includes_liquidity_metrics(self):
        """Test summary includes liquidity metrics."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        summary = subsystem.metrics.summary()

        assert "liquidity_driven_sales" in summary
        assert "rescue_events" in summary
        assert "total_trades" in summary


class TestSummaryStatistics:
    """Test experiment-level summary statistics (Section 8.5)."""

    def test_summary_completeness(self):
        """Test that summary includes all required metrics."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run a few days
        for day in range(1, 4):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        summary = subsystem.metrics.summary()

        # Section 8.2: Dealer profitability
        assert "dealer_total_pnl" in summary
        assert "dealer_total_return" in summary
        assert "dealer_profitable" in summary
        assert "dealer_pnl_by_bucket" in summary
        assert "dealer_return_by_bucket" in summary
        assert "spread_income_total" in summary
        assert "interior_trades" in summary
        assert "passthrough_trades" in summary

        # Section 8.3: Trader returns
        assert "mean_trader_return" in summary
        assert "fraction_profitable_traders" in summary
        assert "liquidity_driven_sales" in summary
        assert "rescue_events" in summary

        # Section 8.4: Repayment priority
        assert "unsafe_buy_count" in summary
        assert "fraction_unsafe_buys" in summary
        assert "mean_margin_at_default" in summary

        # Trade counts
        assert "total_trades" in summary
        assert "total_sell_trades" in summary
        assert "total_buy_trades" in summary

    def test_summary_values_valid(self):
        """Test that summary values are valid types."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        summary = subsystem.metrics.summary()

        # All values should be JSON-serializable
        import json
        try:
            json.dumps(summary)
        except (TypeError, ValueError) as e:
            pytest.fail(f"Summary should be JSON serializable: {e}")


class TestMarkToMidEquity:
    """Test mark-to-mid equity calculation."""

    def test_equity_calculation(self):
        """Test mark-to-mid equity is computed correctly."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=10,
            cash=Decimal(100),
            bid=Decimal("0.9"),
            ask=Decimal("1.1"),
            midline=Decimal(1),
            vbt_mid=Decimal(1),
            vbt_spread=Decimal("0.2"),
            ticket_size=Decimal(1),
        )

        # E = C + M * a * S = 100 + 1 * 10 * 1 = 110
        assert snapshot.mark_to_mid_equity == Decimal(110)

    def test_equity_with_zero_inventory(self):
        """Test equity equals cash when no inventory."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=0,
            cash=Decimal(100),
            bid=Decimal("0.9"),
            ask=Decimal("1.1"),
            midline=Decimal(1),
            vbt_mid=Decimal(1),
            vbt_spread=Decimal("0.2"),
            ticket_size=Decimal(1),
        )

        # E = C + M * a * S = 100 + 1 * 0 * 1 = 100
        assert snapshot.mark_to_mid_equity == Decimal(100)


class TestDealerPremiumMetrics:
    """Test dealer and VBT premium/discount metrics (Plan 020 - Phase A.3)."""

    def test_dealer_premium_at_par(self):
        """Test dealer premium is 0 when midline equals face value."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=0,
            cash=Decimal(100),
            bid=Decimal("0.95"),
            ask=Decimal("1.05"),
            midline=Decimal("1.0"),  # At par
            vbt_mid=Decimal("1.0"),  # At par
            vbt_spread=Decimal("0.10"),
            ticket_size=Decimal(1),
        )

        assert snapshot.dealer_premium_vs_face == Decimal(0)
        assert snapshot.dealer_premium_pct == Decimal(0)
        assert snapshot.vbt_premium_vs_face == Decimal(0)
        assert snapshot.vbt_premium_pct == Decimal(0)

    def test_dealer_premium_above_par(self):
        """Test premium is positive when midline above face value."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=0,
            cash=Decimal(100),
            bid=Decimal("1.00"),
            ask=Decimal("1.10"),
            midline=Decimal("1.05"),  # 5% above par
            vbt_mid=Decimal("1.02"),  # 2% above par
            vbt_spread=Decimal("0.10"),
            ticket_size=Decimal(1),
        )

        assert snapshot.dealer_premium_vs_face == Decimal("0.05")
        assert snapshot.dealer_premium_pct == Decimal("5")  # 5%
        assert snapshot.vbt_premium_vs_face == Decimal("0.02")
        assert snapshot.vbt_premium_pct == Decimal("2")  # 2%

    def test_dealer_discount_below_par(self):
        """Test premium is negative (discount) when midline below face value."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=0,
            cash=Decimal(100),
            bid=Decimal("0.80"),
            ask=Decimal("0.90"),
            midline=Decimal("0.85"),  # 15% below par
            vbt_mid=Decimal("0.90"),  # 10% below par
            vbt_spread=Decimal("0.10"),
            ticket_size=Decimal(1),
        )

        assert snapshot.dealer_premium_vs_face == Decimal("-0.15")
        assert snapshot.dealer_premium_pct == Decimal("-15")  # -15%
        assert snapshot.vbt_premium_vs_face == Decimal("-0.10")
        assert snapshot.vbt_premium_pct == Decimal("-10")  # -10%

    def test_to_dict_includes_premium_fields(self):
        """Test that to_dict includes premium fields."""
        snapshot = DealerSnapshot(
            day=1,
            bucket="short",
            inventory=0,
            cash=Decimal(100),
            bid=Decimal("0.90"),
            ask=Decimal("1.10"),
            midline=Decimal("1.0"),
            vbt_mid=Decimal("0.98"),
            vbt_spread=Decimal("0.20"),
            ticket_size=Decimal(1),
        )

        d = snapshot.to_dict()

        assert "dealer_premium_pct" in d
        assert "vbt_premium_pct" in d
        # Compare as floats to handle Decimal formatting differences
        assert float(d["dealer_premium_pct"]) == 0.0
        assert float(d["vbt_premium_pct"]) == -2.0


class TestDebtToMoneyRatio:
    """Test debt-to-money ratio metric (Plan 020 - Phase B)."""

    def test_debt_to_money_ratio_computation(self):
        """Test debt-to-money ratio is computed correctly."""
        metrics = RunMetrics()
        metrics.initial_total_debt = Decimal(10000)
        metrics.initial_total_money = Decimal(5000)

        # Ratio = 10000 / 5000 = 2
        assert metrics.debt_to_money_ratio == Decimal(2)

    def test_debt_to_money_ratio_zero_money(self):
        """Test debt-to-money ratio with zero money returns 0."""
        metrics = RunMetrics()
        metrics.initial_total_debt = Decimal(10000)
        metrics.initial_total_money = Decimal(0)

        assert metrics.debt_to_money_ratio == Decimal(0)

    def test_debt_to_money_captured_on_init(self):
        """Test that debt and money are captured at initialization."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Should have captured initial debt and money
        assert subsystem.metrics.initial_total_debt > 0
        assert subsystem.metrics.initial_total_money > 0

        # For our test setup: 5 payables * 50 = 250 total debt
        # 5 households * 100 cash = 500 total money
        assert subsystem.metrics.initial_total_debt == Decimal(250)
        assert subsystem.metrics.initial_total_money == Decimal(500)

        # Ratio should be 250/500 = 0.5
        assert subsystem.metrics.debt_to_money_ratio == Decimal("0.5")

    def test_summary_includes_debt_to_money(self):
        """Test summary includes debt-to-money metrics."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        summary = subsystem.metrics.summary()

        assert "initial_total_debt" in summary
        assert "initial_total_money" in summary
        assert "debt_to_money_ratio" in summary
        assert summary["initial_total_debt"] == 250.0
        assert summary["initial_total_money"] == 500.0
        assert summary["debt_to_money_ratio"] == 0.5


class TestMidPriceTimeSeries:
    """Test mid price time series methods (Plan 020 - Phase A.2)."""

    def test_dealer_mid_timeseries(self):
        """Test dealer mid time series extraction."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading for 3 days
        for day in range(1, 4):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        timeseries = subsystem.metrics.dealer_mid_timeseries()

        # Should have entries for each day
        assert len(timeseries) == 3
        assert 1 in timeseries
        assert 2 in timeseries
        assert 3 in timeseries

        # Each day should have entries for each bucket
        for day, buckets in timeseries.items():
            assert len(buckets) == 3
            assert "short" in buckets or "mid" in buckets or "long" in buckets

    def test_vbt_mid_timeseries(self):
        """Test VBT mid time series extraction."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading for 2 days
        for day in range(1, 3):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        timeseries = subsystem.metrics.vbt_mid_timeseries()

        # Should have entries for each day
        assert len(timeseries) == 2

    def test_premium_timeseries(self):
        """Test premium time series extraction."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)
        run_dealer_trading_phase(subsystem, sys, current_day=1)

        dealer_premium = subsystem.metrics.dealer_premium_timeseries()
        vbt_premium = subsystem.metrics.vbt_premium_timeseries()

        assert len(dealer_premium) >= 1
        assert len(vbt_premium) >= 1

    def test_final_mids_in_summary(self):
        """Test summary includes final mid prices."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading
        for day in range(1, 4):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        summary = subsystem.metrics.summary()

        assert "dealer_mid_final" in summary
        assert "vbt_mid_final" in summary
        assert "dealer_premium_final_pct" in summary
        assert "vbt_premium_final_pct" in summary

        # These should be dicts with bucket keys
        assert isinstance(summary["dealer_mid_final"], dict)
        assert isinstance(summary["vbt_mid_final"], dict)


class TestMidTimeseriesCSVExport:
    """Test CSV export of mid price time series."""

    def test_mid_timeseries_csv_export(self, tmp_path):
        """Test exporting mid time series to CSV."""
        sys, _ = create_test_system_with_ring()
        config = create_dealer_config()

        subsystem = initialize_dealer_subsystem(sys, config, current_day=1)

        # Run trading for 2 days
        for day in range(1, 3):
            run_dealer_trading_phase(subsystem, sys, current_day=day)

        # Export to CSV
        csv_path = tmp_path / "mid_timeseries.csv"
        subsystem.metrics.to_mid_timeseries_csv(str(csv_path))

        # Verify file exists
        assert csv_path.exists()

        # Read and verify contents
        import csv
        with open(csv_path, "r") as f:
            reader = csv.DictReader(f)
            rows = list(reader)

        # Should have rows (2 days * 3 buckets = 6 rows)
        assert len(rows) == 6

        # Check header fields
        assert "day" in rows[0]
        assert "bucket" in rows[0]
        assert "dealer_midline" in rows[0]
        assert "vbt_mid" in rows[0]
        assert "dealer_premium_pct" in rows[0]
        assert "vbt_premium_pct" in rows[0]

```

---

### 🧪 tests/dealer/test_report.py

```python
"""Tests for dealer ring HTML report generation."""

import pytest
from decimal import Decimal
from pathlib import Path
import tempfile

from bilancio.dealer import (
    DealerRingConfig,
    DealerRingSimulation,
    Ticket,
    TraderState,
    generate_dealer_ring_html,
    export_dealer_ring_html,
)


class TestReportGeneration:
    """Test basic HTML report generation."""

    def test_generate_html_basic(self):
        """Generate HTML report from minimal simulation."""
        config = DealerRingConfig(
            N_max=0,  # No random order flow
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        # Set up minimal ring
        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])
        sim.run(max_days=1)

        # Generate HTML
        html = generate_dealer_ring_html(
            sim.snapshots,
            sim.config,
            title="Test Report",
            subtitle="Minimal test",
        )

        # Basic structure checks
        assert "<!DOCTYPE html>" in html
        assert "<title>Test Report</title>" in html
        assert "Minimal test" in html
        assert "Day 0 (Setup)" in html
        assert "Day 1" in html
        assert "Dealer:" in html
        assert "VBT:" in html

    def test_generate_html_with_trades(self):
        """Verify trade events are rendered."""
        config = DealerRingConfig(
            N_max=0,
            dealer_share=Decimal("0.5"),
            vbt_share=Decimal("0.25"),
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        # Create a trader with shortfall to trigger sell
        trader = TraderState(agent_id="T1", cash=Decimal(0))

        # Create tickets
        tickets = []
        for i in range(4):
            ticket = Ticket(
                id=f"ticket_{i}",
                issuer_id="T1",
                owner_id="T1",
                face=Decimal(1),
                maturity_day=20,
                remaining_tau=15,  # long bucket
            )
            trader.obligations.append(ticket)
            tickets.append(ticket)

        sim.setup_ring([trader], tickets)

        # Manually trigger a trade by executing sell
        from bilancio.dealer import recompute_dealer_state
        dealer = sim.dealers["long"]
        vbt = sim.vbts["long"]
        recompute_dealer_state(dealer, vbt, sim.params)

        # Execute a customer sell if dealer has inventory
        if dealer.inventory:
            ticket_to_sell = dealer.inventory[0]
            result = sim.executor.execute_customer_sell(dealer, vbt, ticket_to_sell)
            sim.events.log_trade(
                day=1,
                side="SELL",
                trader_id="T1",
                ticket_id=ticket_to_sell.id,
                bucket="long",
                price=result.price,
                is_passthrough=result.is_passthrough,
            )

        sim.run(max_days=1)

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # Should contain quote events at minimum
        assert "quote" in html

    def test_generate_html_dealer_state_displayed(self):
        """Verify dealer state parameters are displayed."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # Check dealer parameters are shown
        assert "Tickets (a)" in html
        assert "Face inventory (x)" in html
        assert "Cash (C)" in html
        assert "Mid-valued (V)" in html
        assert "Max tickets (K*)" in html
        assert "Layoff prob" in html
        assert "Midline p(x)" in html
        assert "Bid" in html
        assert "Ask" in html

    def test_generate_html_vbt_state_displayed(self):
        """Verify VBT state parameters are displayed."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # Check VBT parameters are shown
        assert "Mid anchor (M)" in html
        assert "Spread anchor (O)" in html
        assert "Ask (A = M + O/2)" in html
        assert "Bid (B = M - O/2)" in html

    def test_generate_html_trader_balance_displayed(self):
        """Verify trader balance sheet is displayed."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="TestTrader", cash=Decimal("5.50"))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="TestTrader",
            owner_id="TestTrader",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # Check trader info is shown
        assert "TestTrader" in html
        assert "Assets" in html
        assert "Liabilities" in html
        assert "Cash" in html


class TestExportToFile:
    """Test HTML export to file."""

    def test_export_creates_file(self):
        """Export HTML report to file."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        with tempfile.TemporaryDirectory() as tmpdir:
            path = Path(tmpdir) / "test_report.html"
            export_dealer_ring_html(sim.snapshots, sim.config, path)

            assert path.exists()
            content = path.read_text()
            assert "<!DOCTYPE html>" in content

    def test_export_creates_parent_dirs(self):
        """Export creates parent directories if needed."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        with tempfile.TemporaryDirectory() as tmpdir:
            path = Path(tmpdir) / "nested" / "dirs" / "test_report.html"
            export_dealer_ring_html(sim.snapshots, sim.config, path)

            assert path.exists()

    def test_simulation_to_html_method(self):
        """Test simulation's to_html() convenience method."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])
        sim.run(max_days=1)

        with tempfile.TemporaryDirectory() as tmpdir:
            path = Path(tmpdir) / "report.html"
            sim.to_html(path, title="Via Method", subtitle="Test subtitle")

            assert path.exists()
            content = path.read_text()
            assert "Via Method" in content
            assert "Test subtitle" in content


class TestHTMLEscaping:
    """Test HTML escaping for security."""

    def test_agent_id_escaped(self):
        """Agent IDs with special characters are escaped."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        # Use agent ID with HTML special characters
        trader = TraderState(agent_id="<xss>alert('test')</xss>", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id=trader.agent_id,
            owner_id=trader.agent_id,
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # XSS tag should be escaped (using xss to avoid false positive from script in CSS)
        assert "<xss>" not in html
        assert "&lt;xss&gt;" in html

    def test_title_escaped(self):
        """Title with special characters is escaped."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        html = generate_dealer_ring_html(
            sim.snapshots,
            sim.config,
            title="Test & Report <bold>",
            subtitle='Quote: "test"',
        )

        assert "&amp;" in html
        assert "&lt;bold&gt;" in html
        assert "&quot;test&quot;" in html


class TestSnapshotCapture:
    """Test that snapshots are properly captured."""

    def test_snapshot_captured_on_setup(self):
        """Snapshot is captured after setup_ring (Day 0)."""
        config = DealerRingConfig(N_max=0, max_days=0)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        # Before setup - no snapshots
        assert len(sim.snapshots) == 0

        sim.setup_ring([trader], [ticket])

        # After setup - Day 0 snapshot
        assert len(sim.snapshots) == 1
        assert sim.snapshots[0].day == 0

    def test_snapshot_captured_each_day(self):
        """Snapshots are captured at end of each day."""
        config = DealerRingConfig(N_max=0, max_days=3)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])
        sim.run(max_days=3)

        # Should have Day 0 + Days 1,2,3 = 4 snapshots
        assert len(sim.snapshots) == 4
        assert [s.day for s in sim.snapshots] == [0, 1, 2, 3]

    def test_snapshot_contains_dealer_state(self):
        """Snapshot captures dealer state correctly."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        snapshot = sim.snapshots[0]

        # Check dealer data is present
        assert "long" in snapshot.dealers
        dealer = snapshot.dealers["long"]
        assert "a" in dealer
        assert "cash" in dealer
        assert "bid" in dealer
        assert "ask" in dealer

    def test_snapshot_contains_trader_state(self):
        """Snapshot captures trader state correctly."""
        config = DealerRingConfig(N_max=0, max_days=1)
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="TestTrader", cash=Decimal("5.50"))
        ticket = Ticket(
            id="ticket_1",
            issuer_id="TestTrader",
            owner_id="TestTrader",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=15,
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])

        snapshot = sim.snapshots[0]

        # Check trader data is present
        assert "TestTrader" in snapshot.traders
        trader_data = snapshot.traders["TestTrader"]
        assert trader_data["cash"] == Decimal("5.50")
        assert len(trader_data["obligations"]) == 1


class TestRebucketEventRendering:
    """Test rebucket events are rendered correctly."""

    def test_rebucket_event_in_html(self):
        """Rebucket events appear in HTML output."""
        config = DealerRingConfig(
            N_max=0,
            dealer_share=Decimal("1.0"),  # All to dealer for rebucketing
            vbt_share=Decimal("0"),
            max_days=2,
        )
        sim = DealerRingSimulation(config)

        trader = TraderState(agent_id="T1", cash=Decimal(10))

        # Create ticket at boundary (tau=9 is long, tau=8 is mid)
        ticket = Ticket(
            id="boundary_ticket",
            issuer_id="T1",
            owner_id="T1",
            face=Decimal(1),
            maturity_day=20,
            remaining_tau=9,  # Will become 8 after day 1 update
        )
        trader.obligations.append(ticket)

        sim.setup_ring([trader], [ticket])
        sim.run(max_days=1)  # This should trigger rebucket

        html = generate_dealer_ring_html(sim.snapshots, sim.config)

        # Should see rebucket event if ticket was in dealer inventory
        # The exact presence depends on allocation
        assert "Day 1" in html

```

---

### 🧪 tests/dealer/test_simulation.py

```python
"""
Integration tests for dealer ring simulation.

These tests verify the complete event loop per Section 11 of the specification:
- Phase 1: Maturity updates and rebucketing (Events 11-12)
- Phase 2: Dealer pre-computation
- Phase 3: Sell/buy eligibility sets
- Phase 4: Randomized order flow
- Phase 5: Settlement with proportional recovery
- Phase 6: VBT anchor updates

Tests are based on worked examples from the specification:
- Example 1: Rebucketing with dealer-held tickets
- Example 2: Maturing debt and cross-bucket reallocation
- Example 14: Event loop harness for arrivals
- Examples 10 & 12: Partial recovery defaults

References:
- docs/dealer_ring/dealer_examples.pdf
- docs/dealer_ring/dealer_specification.pdf
"""

import pytest
from decimal import Decimal
from copy import deepcopy

from bilancio.dealer import (
    Ticket,
    DealerState,
    VBTState,
    TraderState,
    KernelParams,
    DealerRingConfig,
    DealerRingSimulation,
    recompute_dealer_state,
    run_all_assertions,
)
from bilancio.core.ids import new_id


# =========================================================================
# Test Fixtures and Helpers
# =========================================================================

def create_ticket(
    issuer_id: str,
    owner_id: str,
    face: Decimal = Decimal(1),
    maturity_day: int = 10,
    remaining_tau: int = 5,
    bucket_id: str | None = None,
    serial: int = 0,
) -> Ticket:
    """Create a ticket for testing."""
    return Ticket(
        id=new_id(),
        issuer_id=issuer_id,
        owner_id=owner_id,
        face=face,
        maturity_day=maturity_day,
        remaining_tau=remaining_tau,
        bucket_id=bucket_id,
        serial=serial,
    )


def create_trader(
    agent_id: str | None = None,
    cash: Decimal = Decimal(10),
) -> TraderState:
    """Create a trader for testing."""
    return TraderState(
        agent_id=agent_id or new_id("trader"),
        cash=cash,
    )


def create_ring_traders(n: int, cash_per_trader: Decimal = Decimal(10)) -> list[TraderState]:
    """Create a ring of traders."""
    traders = []
    for i in range(n):
        traders.append(TraderState(
            agent_id=new_id(f"trader_{i}"),
            cash=cash_per_trader,
        ))
    return traders


def create_ring_tickets(
    traders: list[TraderState],
    tickets_per_trader: int = 2,
    starting_tau: int = 10,
    starting_maturity: int = 10,
) -> list[Ticket]:
    """
    Create tickets for a ring of traders.

    Each trader issues tickets_per_trader tickets, distributed to the next traders
    in the ring (creating claims/obligations around the ring).
    """
    tickets = []
    n = len(traders)

    for i, trader in enumerate(traders):
        for j in range(tickets_per_trader):
            # Issuer is the current trader, holder is next in ring
            # (This simulates creditor-debtor relationships around the ring)
            holder_idx = (i + 1 + j) % n

            ticket = Ticket(
                id=new_id(),
                issuer_id=trader.agent_id,
                owner_id=traders[holder_idx].agent_id,
                face=Decimal(1),
                maturity_day=starting_maturity + j,
                remaining_tau=starting_tau + j,
                bucket_id=None,  # Will be assigned by simulation
                serial=j,
            )
            tickets.append(ticket)

            # Track obligation on issuer
            trader.obligations.append(ticket)

    return tickets


# =========================================================================
# Test: Simulation Initialization
# =========================================================================

class TestSimulationInit:
    """Tests for simulation initialization."""

    def test_default_config(self):
        """Verify default configuration creates valid simulation."""
        config = DealerRingConfig()
        sim = DealerRingSimulation(config)

        assert sim.day == 0
        assert len(sim.dealers) == 3  # short, mid, long
        assert len(sim.vbts) == 3
        assert len(sim.traders) == 0

    def test_dealers_initialized_per_bucket(self):
        """Each bucket gets one dealer."""
        config = DealerRingConfig()
        sim = DealerRingSimulation(config)

        assert "short" in sim.dealers
        assert "mid" in sim.dealers
        assert "long" in sim.dealers

    def test_vbts_initialized_with_anchors(self):
        """VBTs initialized with configured anchors."""
        config = DealerRingConfig(
            vbt_anchors={
                "short": (Decimal("1.0"), Decimal("0.20")),
                "mid": (Decimal("1.0"), Decimal("0.30")),
                "long": (Decimal("1.0"), Decimal("0.40")),
            }
        )
        sim = DealerRingSimulation(config)

        # Check short VBT
        assert sim.vbts["short"].M == Decimal("1.0")
        assert sim.vbts["short"].O == Decimal("0.20")
        assert sim.vbts["short"].A == Decimal("1.10")  # M + O/2
        assert sim.vbts["short"].B == Decimal("0.90")  # M - O/2

        # Check mid VBT
        assert sim.vbts["mid"].M == Decimal("1.0")
        assert sim.vbts["mid"].O == Decimal("0.30")
        assert sim.vbts["mid"].A == Decimal("1.15")
        assert sim.vbts["mid"].B == Decimal("0.85")


# =========================================================================
# Test: Ring Setup
# =========================================================================

class TestRingSetup:
    """Tests for setting up the ring with traders and tickets."""

    def test_setup_registers_traders(self):
        """Traders are registered in simulation."""
        config = DealerRingConfig()
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(5)
        tickets = create_ring_tickets(traders, tickets_per_trader=2, starting_tau=5)

        sim.setup_ring(traders, tickets)

        assert len(sim.traders) == 5
        for trader in traders:
            assert trader.agent_id in sim.traders

    def test_setup_allocates_tickets(self):
        """Tickets are allocated to dealers, VBTs, and traders."""
        config = DealerRingConfig(
            dealer_share=Decimal("0.25"),
            vbt_share=Decimal("0.50"),
        )
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(5)
        # Create tickets all in mid bucket (remaining_tau in [4-8])
        tickets = []
        for i, trader in enumerate(traders):
            ticket = create_ticket(
                issuer_id=trader.agent_id,
                owner_id=trader.agent_id,
                remaining_tau=5,  # Mid bucket
                maturity_day=10,
            )
            tickets.append(ticket)
            trader.obligations.append(ticket)

        sim.setup_ring(traders, tickets)

        # All tickets should be in the all_tickets registry
        assert len(sim.all_tickets) == 5

        # With 5 tickets and 25%/50% allocation:
        # dealer gets 1 (floor(5 * 0.25))
        # vbt gets 2 (floor(5 * 0.50))
        # traders get 2 (remainder)
        mid_dealer = sim.dealers["mid"]
        mid_vbt = sim.vbts["mid"]

        # Check total allocation matches
        total_allocated = (
            len(mid_dealer.inventory) +
            len(mid_vbt.inventory) +
            sum(len(t.tickets_owned) for t in sim.traders.values())
        )
        assert total_allocated == 5

    def test_bucket_assignment(self):
        """Tickets are assigned to correct buckets based on remaining_tau."""
        config = DealerRingConfig()
        sim = DealerRingSimulation(config)

        traders = [create_trader()]

        # Create tickets for different buckets
        short_ticket = create_ticket(traders[0].agent_id, traders[0].agent_id, remaining_tau=2)
        mid_ticket = create_ticket(traders[0].agent_id, traders[0].agent_id, remaining_tau=6)
        long_ticket = create_ticket(traders[0].agent_id, traders[0].agent_id, remaining_tau=12)

        tickets = [short_ticket, mid_ticket, long_ticket]

        sim.setup_ring(traders, tickets)

        # Check bucket assignment
        assert sim.all_tickets[short_ticket.id].bucket_id == "short"
        assert sim.all_tickets[mid_ticket.id].bucket_id == "mid"
        assert sim.all_tickets[long_ticket.id].bucket_id == "long"


# =========================================================================
# Test: Phase 1 - Maturity Updates and Rebucketing
# =========================================================================

class TestPhase1MaturityUpdates:
    """Tests for maturity updates and rebucketing (Phase 1)."""

    def test_maturity_decrements_each_day(self):
        """Remaining tau decrements by 1 each day."""
        config = DealerRingConfig(max_days=1)
        sim = DealerRingSimulation(config)

        traders = [create_trader()]
        ticket = create_ticket(
            traders[0].agent_id,
            traders[0].agent_id,
            remaining_tau=10,
            maturity_day=20,
        )

        sim.setup_ring(traders, [ticket])

        # Run one day
        sim.run_day()

        # Maturity should have decremented
        assert sim.all_tickets[ticket.id].remaining_tau == 9

    def test_rebucket_long_to_mid(self):
        """
        Example 1: Ticket migrates Long -> Mid when remaining_tau crosses boundary.

        At tau=9, ticket is in Long. When tau decrements to 8, it moves to Mid.
        """
        config = DealerRingConfig(
            dealer_share=Decimal(0),  # No dealer allocation
            vbt_share=Decimal(0),      # No VBT allocation
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        traders = [create_trader()]
        # Ticket at tau=9 (Long bucket boundary)
        ticket = create_ticket(
            traders[0].agent_id,
            traders[0].agent_id,
            remaining_tau=9,  # Long bucket (tau >= 9)
            maturity_day=20,
        )

        sim.setup_ring(traders, [ticket])

        # Verify initial bucket
        assert sim.all_tickets[ticket.id].bucket_id == "long"

        # Run one day
        sim.run_day()

        # Verify rebucketed to mid (tau=8, which is in [4,8])
        assert sim.all_tickets[ticket.id].remaining_tau == 8
        assert sim.all_tickets[ticket.id].bucket_id == "mid"

    def test_rebucket_mid_to_short(self):
        """Ticket migrates Mid -> Short when remaining_tau crosses boundary."""
        config = DealerRingConfig(
            dealer_share=Decimal(0),
            vbt_share=Decimal(0),
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        traders = [create_trader()]
        # Ticket at tau=4 (Mid bucket boundary)
        ticket = create_ticket(
            traders[0].agent_id,
            traders[0].agent_id,
            remaining_tau=4,  # Mid bucket boundary
            maturity_day=20,
        )

        sim.setup_ring(traders, [ticket])

        # Verify initial bucket
        assert sim.all_tickets[ticket.id].bucket_id == "mid"

        # Run one day
        sim.run_day()

        # Verify rebucketed to short (tau=3, which is in [1,3])
        assert sim.all_tickets[ticket.id].remaining_tau == 3
        assert sim.all_tickets[ticket.id].bucket_id == "short"


class TestDealerRebucketing:
    """
    Test Event 11: Dealer-to-dealer internal sale at rebucketing.

    Example 1: When dealer holds a ticket that crosses bucket boundary,
    an internal sale occurs between the old-bucket dealer and new-bucket dealer.
    """

    def test_dealer_rebucket_transfers_at_ask(self):
        """
        Dealer-held ticket rebuckets via internal sale at old-bucket ask.

        This implements Event 11 from the spec.
        """
        config = DealerRingConfig(
            dealer_share=Decimal(1),  # All to dealer
            vbt_share=Decimal(0),
            N_max=0,  # Disable order flow to isolate rebucketing
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        traders = [create_trader(cash=Decimal(100))]
        # Single ticket at Long/Mid boundary with maturity far in future
        ticket = create_ticket(
            traders[0].agent_id,
            traders[0].agent_id,
            remaining_tau=9,  # Long bucket, will become Mid (tau=8)
            maturity_day=100,  # Far future - won't settle during test
        )

        # Pre-fund dealers with cash (need enough for the transfer price)
        sim.dealers["long"].cash = Decimal("2.0")
        sim.dealers["mid"].cash = Decimal("2.0")

        sim.setup_ring(traders, [ticket])

        # Ticket should be allocated to long dealer
        long_dealer = sim.dealers["long"]
        mid_dealer = sim.dealers["mid"]

        assert len(long_dealer.inventory) == 1
        assert len(mid_dealer.inventory) == 0

        # Snapshot balances before rebucketing
        long_cash_before = long_dealer.cash
        mid_cash_before = mid_dealer.cash

        # Run one day (triggers rebucketing)
        sim.run_day()

        # Ticket should now be in mid dealer's inventory
        assert len(long_dealer.inventory) == 0
        assert len(mid_dealer.inventory) == 1

        # Cash should have moved between dealers
        # (Long dealer received cash, mid dealer paid cash)
        assert long_dealer.cash > long_cash_before
        assert mid_dealer.cash < mid_cash_before


# =========================================================================
# Test: Phase 3 - Eligibility Sets
# =========================================================================

class TestPhase3Eligibility:
    """Tests for sell/buy eligibility computation (Phase 3)."""

    def test_sell_eligible_has_shortfall_and_tickets(self):
        """Trader with shortfall > 0 and tickets is sell-eligible."""
        config = DealerRingConfig()
        sim = DealerRingSimulation(config)

        # Trader with obligation due today (day 1)
        trader = create_trader(cash=Decimal("0.5"))  # Less than face=1
        obligation = create_ticket(
            trader.agent_id,
            "holder",
            remaining_tau=1,
            maturity_day=1,  # Due on day 1
        )
        trader.obligations.append(obligation)

        # Give trader a ticket to sell
        owned_ticket = create_ticket("other_issuer", trader.agent_id, remaining_tau=5)
        trader.tickets_owned.append(owned_ticket)

        sim.traders[trader.agent_id] = trader
        sim.all_tickets[owned_ticket.id] = owned_ticket
        sim.all_tickets[obligation.id] = obligation
        sim.day = 1  # Set current day to match obligation

        # Compute eligibility
        sell_eligible = sim._compute_sell_eligible()

        # Trader should be sell-eligible (shortfall = 1 - 0.5 = 0.5 > 0)
        assert trader.agent_id in sell_eligible

    def test_buy_eligible_has_buffer_and_horizon(self):
        """Trader with cash > buffer and horizon >= H is buy-eligible."""
        config = DealerRingConfig(
            buffer_B=Decimal(1),
            horizon_H=3,
        )
        sim = DealerRingSimulation(config)

        # Trader with excess cash and distant liabilities
        trader = create_trader(cash=Decimal(5))  # > buffer_B

        # Obligation due in 10 days (horizon = 10 >= H = 3)
        obligation = create_ticket(
            trader.agent_id,
            "holder",
            remaining_tau=10,
            maturity_day=sim.day + 10,
        )
        trader.obligations.append(obligation)

        sim.traders[trader.agent_id] = trader

        # Compute eligibility
        buy_eligible = sim._compute_buy_eligible()

        # Trader should be buy-eligible
        assert trader.agent_id in buy_eligible

    def test_not_buy_eligible_insufficient_cash(self):
        """Trader with cash <= buffer is not buy-eligible."""
        config = DealerRingConfig(buffer_B=Decimal(1))
        sim = DealerRingSimulation(config)

        trader = create_trader(cash=Decimal("0.5"))  # < buffer_B
        sim.traders[trader.agent_id] = trader

        buy_eligible = sim._compute_buy_eligible()

        assert trader.agent_id not in buy_eligible


# =========================================================================
# Test: Phase 5 - Settlement with Proportional Recovery
# =========================================================================

class TestPhase5Settlement:
    """
    Tests for settlement phase with proportional recovery.

    Based on Examples 10 & 12: Partial recovery default with multiple claimant types.
    """

    def test_full_recovery_when_cash_sufficient(self):
        """Settlement pays full face when issuer has enough cash."""
        config = DealerRingConfig(
            dealer_share=Decimal(0),
            vbt_share=Decimal(0),
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        # Issuer with enough cash
        issuer = create_trader(cash=Decimal(5))
        holder = create_trader(cash=Decimal(0))

        # Register traders directly (skip setup_ring allocation)
        sim.traders[issuer.agent_id] = issuer
        sim.traders[holder.agent_id] = holder

        # Ticket maturing today (day 1 after one run_day)
        ticket = create_ticket(
            issuer.agent_id,
            holder.agent_id,
            face=Decimal(1),
            remaining_tau=1,
            maturity_day=1,
            bucket_id="short",  # Short bucket for tau=1
        )
        issuer.obligations.append(ticket)
        holder.tickets_owned.append(ticket)

        # Register ticket in simulation
        sim.all_tickets[ticket.id] = ticket

        # Track initial cash
        holder_cash_before = holder.cash
        issuer_cash_before = issuer.cash

        # Run one day (triggers settlement)
        sim.run_day()

        # Holder should receive full payment
        payment_received = holder.cash - holder_cash_before
        assert payment_received == Decimal(1)  # Full recovery

    def test_partial_recovery_when_cash_insufficient(self):
        """
        Settlement pays proportional recovery when issuer has insufficient cash.

        Example 12: R = C/D = 3/5 = 0.6 when issuer has 3 and owes 5.
        """
        config = DealerRingConfig(
            dealer_share=Decimal(0),
            vbt_share=Decimal(0),
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        # Issuer with insufficient cash
        issuer = create_trader(cash=Decimal(3))  # Has 3
        sim.traders[issuer.agent_id] = issuer

        # Create 5 holders, each with 1 ticket (total due = 5)
        holders = [create_trader(cash=Decimal(0)) for _ in range(5)]

        tickets = []
        for i, holder in enumerate(holders):
            sim.traders[holder.agent_id] = holder

            ticket = create_ticket(
                issuer.agent_id,
                holder.agent_id,
                face=Decimal(1),
                remaining_tau=1,
                maturity_day=1,
                bucket_id="short",
                serial=i,
            )
            tickets.append(ticket)
            issuer.obligations.append(ticket)
            holder.tickets_owned.append(ticket)
            sim.all_tickets[ticket.id] = ticket

        # Run one day (triggers settlement)
        sim.run_day()

        # Each holder should receive R * face = 0.6 * 1 = 0.6
        expected_payment = Decimal("0.6")
        for holder in holders:
            assert holder.cash == expected_payment

        # Issuer should have cash = 0 (all distributed)
        assert issuer.cash == Decimal(0)

    def test_issuer_marked_defaulted_on_partial_recovery(self):
        """Issuer is marked as defaulted when R < 1."""
        config = DealerRingConfig(
            dealer_share=Decimal(0),
            vbt_share=Decimal(0),
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        issuer = create_trader(cash=Decimal(3))
        holder = create_trader(cash=Decimal(0))

        # Register traders directly
        sim.traders[issuer.agent_id] = issuer
        sim.traders[holder.agent_id] = holder

        ticket = create_ticket(
            issuer.agent_id,
            holder.agent_id,
            face=Decimal(5),  # Due 5, have 3 -> R = 0.6
            remaining_tau=1,
            maturity_day=1,
            bucket_id="short",
        )
        issuer.obligations.append(ticket)
        holder.tickets_owned.append(ticket)
        sim.all_tickets[ticket.id] = ticket

        # Issuer not defaulted initially
        assert not issuer.defaulted

        # Run one day
        sim.run_day()

        # Issuer should be marked defaulted
        assert issuer.defaulted


# =========================================================================
# Test: Phase 6 - VBT Anchor Updates
# =========================================================================

class TestPhase6VBTAnchorUpdates:
    """
    Tests for VBT anchor updates based on bucket loss rates.

    Based on Example 3 (outside bid clipping) and Example 10.
    """

    def test_vbt_anchors_update_after_default(self):
        """
        VBT anchors adjust based on bucket loss rate.

        M_new = M_old - phi_M * loss_rate
        O_new = O_old + phi_O * loss_rate
        """
        config = DealerRingConfig(
            dealer_share=Decimal(0),
            vbt_share=Decimal(0),
            phi_M=Decimal(1),       # M drops by loss_rate
            phi_O=Decimal("0.6"),   # O increases by 0.6 * loss_rate
            enable_vbt_anchor_updates=True,
            max_days=1,
        )
        sim = DealerRingSimulation(config)

        # Initial anchors for short bucket (where our ticket will be)
        short_M_initial = sim.vbts["short"].M
        short_O_initial = sim.vbts["short"].O

        # Create a default scenario in short bucket
        issuer = create_trader(cash=Decimal(0))  # No cash -> R = 0, loss = 100%
        holder = create_trader(cash=Decimal(0))

        # Register traders directly
        sim.traders[issuer.agent_id] = issuer
        sim.traders[holder.agent_id] = holder

        # Ticket in short bucket (remaining_tau=1)
        ticket = create_ticket(
            issuer.agent_id,
            holder.agent_id,
            face=Decimal(1),
            remaining_tau=1,  # Short bucket
            maturity_day=1,
            bucket_id="short",
        )
        issuer.obligations.append(ticket)
        holder.tickets_owned.append(ticket)
        sim.all_tickets[ticket.id] = ticket

        # Run one day
        sim.run_day()

        # Check VBT anchors updated
        # Loss rate = 1 - R = 1 - 0 = 1 (total loss)
        expected_M = short_M_initial - config.phi_M * Decimal(1)
        expected_O = short_O_initial + config.phi_O * Decimal(1)

        assert sim.vbts["short"].M == expected_M
        assert sim.vbts["short"].O == expected_O


# =========================================================================
# Test: Full Event Loop
# =========================================================================

class TestFullEventLoop:
    """
    Integration tests for complete simulation runs.

    Based on Example 14: Minimal event loop harness.
    """

    def test_multi_day_simulation(self):
        """Run multiple days without errors."""
        config = DealerRingConfig(
            seed=42,
            max_days=5,
        )
        sim = DealerRingSimulation(config)

        # Create a small ring with tickets in mid bucket (far from settlement)
        traders = create_ring_traders(5, cash_per_trader=Decimal(20))
        tickets = create_ring_tickets(traders, tickets_per_trader=2, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)

        # Run simulation
        sim.run()

        # Verify simulation completed
        assert sim.day == 5

        # Verify event log has events
        assert len(sim.events.events) > 0

    def test_order_flow_executes(self):
        """Order flow produces trades during simulation."""
        config = DealerRingConfig(
            seed=42,
            N_max=3,
            max_days=3,
        )
        sim = DealerRingSimulation(config)

        # Create ring with sufficient cash for trading
        traders = create_ring_traders(5, cash_per_trader=Decimal(50))
        tickets = create_ring_tickets(traders, tickets_per_trader=3, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)

        # Add cash to dealers/VBTs for trading
        for dealer in sim.dealers.values():
            dealer.cash = Decimal(10)
        for vbt in sim.vbts.values():
            vbt.cash = Decimal(20)

        # Run simulation
        sim.run()

        # Check for quote events at minimum (quotes are logged each day)
        quote_events = [e for e in sim.events.events if e.get("kind") == "quote"]
        # 3 buckets * 3 days = 9 quote events minimum
        assert len(quote_events) >= 9

    def test_simulation_runs_multiple_days(self):
        """Simulation completes multiple days without errors."""
        config = DealerRingConfig(seed=12345, max_days=5)
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(5, cash_per_trader=Decimal(20))
        tickets = create_ring_tickets(traders, tickets_per_trader=2, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)
        sim.run()

        # Verify simulation completed all days
        assert sim.day == 5

        # Verify all traders still exist
        assert len(sim.traders) == 5

        # Verify some events were logged
        assert len(sim.events.events) > 0


# =========================================================================
# Test: Assertions Integration
# =========================================================================

class TestAssertionsIntegration:
    """Verify that programmatic assertions (C1-C6) pass during simulation."""

    def test_c5_equity_basis_holds(self):
        """C5: V = C + M*a holds for dealers throughout simulation."""
        config = DealerRingConfig(max_days=3)
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(3, cash_per_trader=Decimal(10))
        tickets = create_ring_tickets(traders, tickets_per_trader=2, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)

        # Run simulation and check invariants after each day
        for day in range(3):
            sim.run_day()

            # Verify V = C + M*a for each dealer
            for bucket_id, dealer in sim.dealers.items():
                vbt = sim.vbts[bucket_id]
                expected_V = dealer.cash + vbt.M * dealer.a
                assert dealer.V == expected_V, f"C5 failed for {bucket_id}: V={dealer.V}, expected={expected_V}"


# =========================================================================
# Test: Event Logging
# =========================================================================

class TestEventLogging:
    """Tests for event logging system."""

    def test_events_logged_during_simulation(self):
        """Events are captured in the event log."""
        config = DealerRingConfig(max_days=3)
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(3, cash_per_trader=Decimal(10))
        tickets = create_ring_tickets(traders, tickets_per_trader=2, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)
        sim.run()

        # Should have day_start events
        day_starts = [e for e in sim.events.events if e.get("kind") == "day_start"]
        assert len(day_starts) == 3

    def test_quote_events_logged(self):
        """Quote states are logged at start of each day."""
        config = DealerRingConfig(max_days=2)
        sim = DealerRingSimulation(config)

        traders = create_ring_traders(3, cash_per_trader=Decimal(10))
        tickets = create_ring_tickets(traders, tickets_per_trader=1, starting_tau=50, starting_maturity=100)

        sim.setup_ring(traders, tickets)
        sim.run()

        # Should have quote events for each bucket each day
        quote_events = [e for e in sim.events.events if e.get("kind") == "quote"]
        # 3 buckets * 2 days = 6 quote events
        assert len(quote_events) == 6


if __name__ == "__main__":
    pytest.main([__file__, "-v"])

```

---

### 🧪 tests/engines/test_dealer_subsystem.py

```python
"""
Tests for dealer subsystem integration with main simulation engine.

This module tests the bridge between the main bilancio system (Payables)
and the dealer module (Tickets) through the DealerSubsystem wrapper.
"""

import pytest
from decimal import Decimal

from bilancio.engines.dealer_integration import (
    DealerSubsystem,
    initialize_dealer_subsystem,
    run_dealer_trading_phase,
    sync_dealer_to_system,
)
from bilancio.engines.system import System
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.household import Household
from bilancio.domain.instruments.credit import Payable
from bilancio.dealer.simulation import DealerRingConfig


def test_dealer_subsystem_initialization():
    """Test that dealer subsystem initializes correctly from system state."""
    # Setup system with payables
    system = System()
    cb = CentralBank(id='CB', name='Central Bank', kind='central_bank')
    hh1 = Household(id='HH1', name='Household 1', kind='household')
    hh2 = Household(id='HH2', name='Household 2', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Create payables
    p1 = Payable(
        id='P1', kind='payable', amount=100, denom='USD',
        asset_holder_id='HH1', liability_issuer_id='HH2', due_day=5
    )
    p2 = Payable(
        id='P2', kind='payable', amount=200, denom='USD',
        asset_holder_id='HH2', liability_issuer_id='HH1', due_day=10
    )
    system.add_contract(p1)
    system.add_contract(p2)

    # Initialize dealer subsystem
    config = DealerRingConfig(
        ticket_size=Decimal(1),
        dealer_share=Decimal('0.25'),
        vbt_share=Decimal('0.50'),
        seed=42
    )
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Verify subsystem state
    assert len(subsystem.tickets) == 2, "Should have 2 tickets"
    assert len(subsystem.dealers) == 3, "Should have 3 dealer buckets (short/mid/long)"
    assert len(subsystem.vbts) == 3, "Should have 3 VBT buckets"
    assert len(subsystem.traders) == 2, "Should have 2 traders (HH1, HH2)"

    # Verify ticket-payable mapping
    assert len(subsystem.ticket_to_payable) == 2
    assert len(subsystem.payable_to_ticket) == 2
    assert 'P1' in subsystem.payable_to_ticket
    assert 'P2' in subsystem.payable_to_ticket

    # Verify ticket properties
    for ticket in subsystem.tickets.values():
        assert ticket.face > 0
        assert ticket.bucket_id in ['short', 'mid', 'long']
        assert ticket.remaining_tau >= 0


def test_ticket_bucket_assignment():
    """Test that tickets are assigned to correct maturity buckets."""
    system = System()
    cb = CentralBank(id='CB', name='CB', kind='central_bank')
    hh1 = Household(id='HH1', name='HH1', kind='household')
    hh2 = Household(id='HH2', name='HH2', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Create payables with different maturities
    # short: tau in {1,2,3}
    # mid: tau in {4,...,8}
    # long: tau >= 9
    payables = [
        ('P1', 2, 'short'),   # tau=2 -> short
        ('P2', 5, 'mid'),     # tau=5 -> mid
        ('P3', 10, 'long'),   # tau=10 -> long
    ]

    for pid, due_day, expected_bucket in payables:
        p = Payable(
            id=pid, kind='payable', amount=100, denom='USD',
            asset_holder_id='HH1', liability_issuer_id='HH2', due_day=due_day
        )
        system.add_contract(p)

    # Initialize subsystem
    config = DealerRingConfig(seed=42)
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Verify bucket assignments
    for pid, due_day, expected_bucket in payables:
        ticket_id = subsystem.payable_to_ticket[pid]
        ticket = subsystem.tickets[ticket_id]
        assert ticket.bucket_id == expected_bucket, \
            f"Payable {pid} with due_day={due_day} should be in {expected_bucket} bucket"


def test_run_dealer_trading_phase():
    """Test that trading phase executes without errors."""
    system = System()
    cb = CentralBank(id='CB', name='CB', kind='central_bank')
    hh1 = Household(id='HH1', name='HH1', kind='household')
    hh2 = Household(id='HH2', name='HH2', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Create payables
    p1 = Payable(
        id='P1', kind='payable', amount=100, denom='USD',
        asset_holder_id='HH1', liability_issuer_id='HH2', due_day=5
    )
    system.add_contract(p1)

    # Initialize subsystem
    config = DealerRingConfig(seed=42)
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Run trading phase
    events = run_dealer_trading_phase(subsystem, system, current_day=0)

    # Should execute without errors (may have 0 events if no eligible traders)
    assert isinstance(events, list)
    for event in events:
        assert 'kind' in event
        assert event['kind'] == 'dealer_trade'
        assert 'trader' in event
        assert 'side' in event
        assert 'price' in event


def test_subsystem_enabled_flag():
    """Test that subsystem respects enabled flag."""
    system = System()
    cb = CentralBank(id='CB', name='CB', kind='central_bank')
    hh1 = Household(id='HH1', name='HH1', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)

    # Initialize subsystem
    config = DealerRingConfig(seed=42)
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Disable subsystem
    subsystem.enabled = False

    # Run trading phase - should return empty list
    events = run_dealer_trading_phase(subsystem, system, current_day=0)
    assert events == [], "Disabled subsystem should generate no events"

    # Re-enable
    subsystem.enabled = True
    events = run_dealer_trading_phase(subsystem, system, current_day=0)
    # Should work normally (may still be empty if no eligible trades)
    assert isinstance(events, list)


def test_sync_dealer_to_system():
    """Test that sync_dealer_to_system updates payable ownership."""
    system = System()
    cb = CentralBank(id='CB', name='CB', kind='central_bank')
    hh1 = Household(id='HH1', name='HH1', kind='household')
    hh2 = Household(id='HH2', name='HH2', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Create payable
    p1 = Payable(
        id='P1', kind='payable', amount=100, denom='USD',
        asset_holder_id='HH1', liability_issuer_id='HH2', due_day=5
    )
    system.add_contract(p1)

    # Initialize subsystem
    config = DealerRingConfig(seed=42)
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Manually simulate a trade (change ticket ownership)
    ticket_id = subsystem.payable_to_ticket['P1']
    ticket = subsystem.tickets[ticket_id]
    original_owner = ticket.owner_id
    ticket.owner_id = 'HH2'  # Simulate transfer

    # Sync back to system
    sync_dealer_to_system(subsystem, system)

    # Verify payable holder updated
    payable = system.state.contracts['P1']
    assert payable.holder_id == 'HH2', "Payable holder should be updated after sync"


def test_multiple_trading_phases():
    """Test running multiple trading phases in sequence."""
    system = System()
    cb = CentralBank(id='CB', name='CB', kind='central_bank')
    hh1 = Household(id='HH1', name='HH1', kind='household')
    hh2 = Household(id='HH2', name='HH2', kind='household')

    system.add_agent(cb)
    system.add_agent(hh1)
    system.add_agent(hh2)

    # Create payables at different maturities
    p1 = Payable(
        id='P1', kind='payable', amount=100, denom='USD',
        asset_holder_id='HH1', liability_issuer_id='HH2', due_day=5
    )
    p2 = Payable(
        id='P2', kind='payable', amount=200, denom='USD',
        asset_holder_id='HH2', liability_issuer_id='HH1', due_day=10
    )
    system.add_contract(p1)
    system.add_contract(p2)

    # Initialize subsystem
    config = DealerRingConfig(seed=42)
    subsystem = initialize_dealer_subsystem(system, config, current_day=0)

    # Run multiple trading phases
    all_events = []
    for day in range(5):
        events = run_dealer_trading_phase(subsystem, system, current_day=day)
        all_events.extend(events)

    # Should execute without errors
    assert isinstance(all_events, list)

    # Verify tickets updated their remaining_tau
    for ticket in subsystem.tickets.values():
        # After processing day 4, tickets should have tau reduced
        assert ticket.remaining_tau == max(0, ticket.maturity_day - 4)

```

---

### 🧪 tests/engines/test_default_handling.py

```python
import pytest

from bilancio.core.errors import DefaultError
from bilancio.domain.instruments.credit import Payable
from bilancio.engines.settlement import settle_due
from bilancio.engines.system import System
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.firm import Firm


def _basic_system(default_mode: str = "fail-fast"):
    system = System(default_mode=default_mode)
    cb = CentralBank(id="CB", name="Central Bank", kind="central_bank")
    debtor = Firm(id="D1", name="Debtor", kind="firm")
    creditor = Firm(id="C1", name="Creditor", kind="firm")
    system.add_agent(cb)
    system.add_agent(debtor)
    system.add_agent(creditor)
    return system, cb, debtor, creditor


def _make_payable(system: System, debtor: Firm, creditor: Firm, amount: int, due_day: int) -> Payable:
    payable = Payable(
        id=system.new_contract_id("PAY"),
        kind="payable",
        amount=amount,
        denom="X",
        asset_holder_id=creditor.id,
        liability_issuer_id=debtor.id,
        due_day=due_day,
    )
    system.add_contract(payable)
    return payable


def test_fail_fast_mode_raises_default():
    system, _, debtor, creditor = _basic_system()
    _make_payable(system, debtor, creditor, amount=100, due_day=1)

    with pytest.raises(DefaultError):
        settle_due(system, 1)


def test_expel_mode_handles_partial_payment_and_marks_agent():
    system, _, debtor, creditor = _basic_system(default_mode="expel-agent")
    payable = _make_payable(system, debtor, creditor, amount=100, due_day=1)
    trailing_payable = _make_payable(system, debtor, creditor, amount=50, due_day=2)

    system.state.aliases["PAY1"] = payable.id

    # Provide partial liquidity (60 of required 100)
    system.mint_cash(debtor.id, 60)

    # Scheduled action involving debtor should be cancelled once defaulted
    system.state.scheduled_actions_by_day[2] = [
        {"mint_cash": {"to": debtor.id, "amount": 10}}
    ]
    system.state.scheduled_actions_by_day[3] = [
        {"transfer_claim": {"contract_alias": "PAY1", "to_agent": creditor.id}}
    ]

    settle_due(system, 1)

    assert payable.id not in system.state.contracts
    assert trailing_payable.id not in system.state.contracts
    assert debtor.defaulted is True
    assert debtor.id in system.state.defaulted_agent_ids
    assert creditor.asset_ids.count(payable.id) == 0
    assert creditor.asset_ids.count(trailing_payable.id) == 0
    assert not system.state.scheduled_actions_by_day
    assert "PAY1" not in system.state.aliases

    kinds = [event["kind"] for event in system.state.events]
    assert "PartialSettlement" in kinds
    assert "ObligationDefaulted" in kinds
    assert "AgentDefaulted" in kinds
    assert "ScheduledActionCancelled" in kinds
    assert "ObligationWrittenOff" in kinds

    cancelled_events = [e for e in system.state.events if e["kind"] == "ScheduledActionCancelled"]
    assert len(cancelled_events) == 2
    for evt in cancelled_events:
        assert evt["day"] == system.state.day
    scheduled_days = sorted(evt["scheduled_day"] for evt in cancelled_events)
    assert scheduled_days == [2, 3]

    partial_event = next(e for e in system.state.events if e["kind"] == "PartialSettlement")
    assert partial_event["amount_paid"] == 60
    assert partial_event["shortfall"] == 40
    assert partial_event["contract_id"] == payable.id
    assert partial_event["distribution"] == [{"method": "cash", "amount": 60}]

    default_event = next(e for e in system.state.events if e["kind"] == "ObligationDefaulted")
    assert default_event["contract_id"] == payable.id
    assert default_event["shortfall"] == 40
    assert default_event["amount"] == 40

    written_off_ids = [e["contract_id"] for e in system.state.events if e["kind"] == "ObligationWrittenOff"]
    assert trailing_payable.id in written_off_ids

    agent_event = next(e for e in system.state.events if e["kind"] == "AgentDefaulted")
    assert agent_event["frm"] == debtor.id

```

---

### 🧪 tests/engines/test_phase_b1_scheduling.py

```python
from pathlib import Path

from bilancio.config.loaders import load_yaml
from bilancio.config.apply import apply_to_system
from bilancio.engines.system import System
from bilancio.engines.simulation import run_day


SCENARIO = """
version: 1
name: B1-before-B2
agents:
  - {id: CB, kind: central_bank, name: CB}
  - {id: F1, kind: firm, name: F1}
  - {id: F2, kind: firm, name: F2}
initial_actions:
  - {mint_cash: {to: F1, amount: 100}}
  - {create_stock: {owner: F2, sku: X, quantity: 1, unit_price: "100"}}
run: {mode: until_stable, max_days: 5}
"""


def test_b1_executes_before_b2(tmp_path: Path):
    # Create config file
    p = tmp_path / "s.yaml"
    p.write_text(SCENARIO)
    cfg = load_yaml(p)
    sys = System()
    apply_to_system(cfg, sys)

    # Schedule actions for current day (0): create obligations due today
    sys.state.scheduled_actions_by_day[0] = [
        {"create_delivery_obligation": {"from": "F2", "to": "F1", "sku": "X", "quantity": 1, "unit_price": "100", "due_day": 0}},
        {"create_payable": {"from": "F1", "to": "F2", "amount": 100, "due_day": 0}},
    ]

    # Run day 0 and verify obligations were settled same day
    run_day(sys)
    # No open obligations should remain
    assert not any(c.kind in ("payable", "delivery_obligation") for c in sys.state.contracts.values())
    # And events should include settled events for day 0
    day0_events = [e for e in sys.state.events if e.get("day") == 0]
    kinds = {e.get("kind") for e in day0_events}
    assert "DeliveryObligationSettled" in kinds
    assert "PayableSettled" in kinds


```

---

### 🧪 tests/experiments/__init__.py

```python
# Tests for bilancio.experiments module

```

---

### 🧪 tests/experiments/test_sweep_runners.py

```python
"""Tests for experiment sweep runners and sampling functions.

This module tests:
- RingSweepRunner grid and LHS execution
- Sampling functions: generate_grid_params, generate_lhs_params, generate_frontier_params
- Registry CSV creation
"""

from __future__ import annotations

from decimal import Decimal
from pathlib import Path
from typing import Optional
from unittest.mock import patch, MagicMock

import pytest

from bilancio.experiments.sampling import (
    generate_grid_params,
    generate_lhs_params,
    generate_frontier_params,
)


# =============================================================================
# Tests for generate_grid_params
# =============================================================================


class TestGenerateGridParams:
    """Tests for Cartesian product grid sampling."""

    def test_basic_2x2_grid(self):
        """A 2x2x1x1 grid produces 4 combinations."""
        kappas = [Decimal("1"), Decimal("2")]
        concentrations = [Decimal("0.5"), Decimal("1")]
        mus = [Decimal("0")]
        monotonicities = [Decimal("0")]

        result = list(generate_grid_params(kappas, concentrations, mus, monotonicities))

        assert len(result) == 4
        # Check that all combinations are present
        expected = [
            (Decimal("1"), Decimal("0.5"), Decimal("0"), Decimal("0")),
            (Decimal("1"), Decimal("1"), Decimal("0"), Decimal("0")),
            (Decimal("2"), Decimal("0.5"), Decimal("0"), Decimal("0")),
            (Decimal("2"), Decimal("1"), Decimal("0"), Decimal("0")),
        ]
        assert set(result) == set(expected)

    def test_single_values(self):
        """Grid with single values per dimension produces one combination."""
        kappas = [Decimal("1")]
        concentrations = [Decimal("0.5")]
        mus = [Decimal("0.25")]
        monotonicities = [Decimal("0")]

        result = list(generate_grid_params(kappas, concentrations, mus, monotonicities))

        assert len(result) == 1
        assert result[0] == (Decimal("1"), Decimal("0.5"), Decimal("0.25"), Decimal("0"))

    def test_empty_dimension(self):
        """Grid with empty dimension produces no combinations."""
        kappas = []
        concentrations = [Decimal("0.5")]
        mus = [Decimal("0")]
        monotonicities = [Decimal("0")]

        result = list(generate_grid_params(kappas, concentrations, mus, monotonicities))

        assert len(result) == 0

    def test_full_grid_count(self):
        """Grid count equals product of dimensions."""
        kappas = [Decimal("1"), Decimal("2"), Decimal("4")]
        concentrations = [Decimal("0.5"), Decimal("1")]
        mus = [Decimal("0"), Decimal("0.5"), Decimal("1")]
        monotonicities = [Decimal("0"), Decimal("0.5")]

        result = list(generate_grid_params(kappas, concentrations, mus, monotonicities))

        expected_count = 3 * 2 * 3 * 2  # 36
        assert len(result) == expected_count

    def test_iterator_returns_tuples_of_decimals(self):
        """All returned values are Decimal tuples."""
        kappas = [Decimal("1")]
        concentrations = [Decimal("0.5")]
        mus = [Decimal("0")]
        monotonicities = [Decimal("0")]

        result = list(generate_grid_params(kappas, concentrations, mus, monotonicities))

        assert len(result) == 1
        kappa, concentration, mu, monotonicity = result[0]
        assert isinstance(kappa, Decimal)
        assert isinstance(concentration, Decimal)
        assert isinstance(mu, Decimal)
        assert isinstance(monotonicity, Decimal)


# =============================================================================
# Tests for generate_lhs_params
# =============================================================================


class TestGenerateLHSParams:
    """Tests for Latin Hypercube Sampling."""

    def test_count_matches_request(self):
        """LHS generates exactly the requested number of samples."""
        count = 10
        result = list(generate_lhs_params(
            count,
            kappa_range=(Decimal("0.5"), Decimal("4")),
            concentration_range=(Decimal("0.1"), Decimal("5")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0.5")),
            seed=42,
        ))

        assert len(result) == count

    def test_zero_count_returns_empty(self):
        """LHS with count=0 returns empty iterator."""
        result = list(generate_lhs_params(
            0,
            kappa_range=(Decimal("0.5"), Decimal("4")),
            concentration_range=(Decimal("0.1"), Decimal("5")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0.5")),
            seed=42,
        ))

        assert len(result) == 0

    def test_values_within_range(self):
        """All LHS samples fall within specified ranges."""
        count = 20
        kappa_range = (Decimal("0.5"), Decimal("4"))
        concentration_range = (Decimal("0.1"), Decimal("5"))
        mu_range = (Decimal("0"), Decimal("1"))
        monotonicity_range = (Decimal("-0.5"), Decimal("0.5"))

        result = list(generate_lhs_params(
            count,
            kappa_range=kappa_range,
            concentration_range=concentration_range,
            mu_range=mu_range,
            monotonicity_range=monotonicity_range,
            seed=42,
        ))

        for kappa, concentration, mu, monotonicity in result:
            assert kappa_range[0] <= kappa <= kappa_range[1]
            assert concentration_range[0] <= concentration <= concentration_range[1]
            assert mu_range[0] <= mu <= mu_range[1]
            assert monotonicity_range[0] <= monotonicity <= monotonicity_range[1]

    def test_reproducibility_with_same_seed(self):
        """Same seed produces identical samples."""
        kwargs = dict(
            count=5,
            kappa_range=(Decimal("0.5"), Decimal("4")),
            concentration_range=(Decimal("0.1"), Decimal("5")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0.5")),
            seed=12345,
        )

        result1 = list(generate_lhs_params(**kwargs))
        result2 = list(generate_lhs_params(**kwargs))

        assert result1 == result2

    def test_different_seeds_produce_different_samples(self):
        """Different seeds produce different samples."""
        base_kwargs = dict(
            count=5,
            kappa_range=(Decimal("0.5"), Decimal("4")),
            concentration_range=(Decimal("0.1"), Decimal("5")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0.5")),
        )

        result1 = list(generate_lhs_params(**base_kwargs, seed=42))
        result2 = list(generate_lhs_params(**base_kwargs, seed=43))

        assert result1 != result2

    def test_returns_decimal_tuples(self):
        """All returned values are Decimal tuples."""
        result = list(generate_lhs_params(
            1,
            kappa_range=(Decimal("1"), Decimal("2")),
            concentration_range=(Decimal("0.5"), Decimal("1")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0")),
            seed=42,
        ))

        assert len(result) == 1
        kappa, concentration, mu, monotonicity = result[0]
        assert isinstance(kappa, Decimal)
        assert isinstance(concentration, Decimal)
        assert isinstance(mu, Decimal)
        assert isinstance(monotonicity, Decimal)


# =============================================================================
# Tests for generate_frontier_params
# =============================================================================


class TestGenerateFrontierParams:
    """Tests for frontier/binary search sampling."""

    def test_calls_execute_fn(self):
        """Frontier sampling calls execute_fn for each test."""
        calls = []

        def mock_execute(label: str, kappa: Decimal, concentration: Decimal, mu: Decimal, monotonicity: Decimal) -> Optional[Decimal]:
            calls.append((label, kappa, concentration, mu, monotonicity))
            # Return stable for high kappa, unstable for low
            if kappa >= Decimal("2"):
                return Decimal("0.01")  # Stable
            return Decimal("1.0")  # Unstable

        generate_frontier_params(
            concentrations=[Decimal("1")],
            mus=[Decimal("0.5")],
            monotonicities=[Decimal("0")],
            kappa_low=Decimal("0.5"),
            kappa_high=Decimal("4"),
            tolerance=Decimal("0.1"),
            max_iterations=3,
            execute_fn=mock_execute,
        )

        # Should have called execute_fn multiple times
        assert len(calls) > 0
        # First call should be with kappa_low
        assert calls[0][1] == Decimal("0.5")  # kappa_low

    def test_frontier_stops_if_low_is_stable(self):
        """Frontier stops immediately if kappa_low is already stable."""
        calls = []

        def mock_execute(label: str, kappa: Decimal, concentration: Decimal, mu: Decimal, monotonicity: Decimal) -> Optional[Decimal]:
            calls.append((label, kappa, concentration, mu, monotonicity))
            # Always stable
            return Decimal("0.01")

        generate_frontier_params(
            concentrations=[Decimal("1")],
            mus=[Decimal("0.5")],
            monotonicities=[Decimal("0")],
            kappa_low=Decimal("0.5"),
            kappa_high=Decimal("4"),
            tolerance=Decimal("0.1"),
            max_iterations=10,
            execute_fn=mock_execute,
        )

        # Should only call once for kappa_low since it's already stable
        assert len(calls) == 1
        assert calls[0][0] == "low"  # label

    def test_frontier_iterates_over_all_cells(self):
        """Frontier iterates over all (concentration, mu, monotonicity) combinations."""
        cells_visited = set()

        def mock_execute(label: str, kappa: Decimal, concentration: Decimal, mu: Decimal, monotonicity: Decimal) -> Optional[Decimal]:
            cells_visited.add((concentration, mu, monotonicity))
            return Decimal("0.01")  # Always stable

        generate_frontier_params(
            concentrations=[Decimal("1"), Decimal("2")],
            mus=[Decimal("0"), Decimal("0.5")],
            monotonicities=[Decimal("0")],
            kappa_low=Decimal("0.5"),
            kappa_high=Decimal("4"),
            tolerance=Decimal("0.1"),
            max_iterations=3,
            execute_fn=mock_execute,
        )

        # Should have visited 2*2*1 = 4 cells
        expected_cells = {
            (Decimal("1"), Decimal("0"), Decimal("0")),
            (Decimal("1"), Decimal("0.5"), Decimal("0")),
            (Decimal("2"), Decimal("0"), Decimal("0")),
            (Decimal("2"), Decimal("0.5"), Decimal("0")),
        }
        assert cells_visited == expected_cells

    def test_frontier_handles_failed_runs(self):
        """Frontier continues when execute_fn returns None (failed run)."""
        calls = []

        def mock_execute(label: str, kappa: Decimal, concentration: Decimal, mu: Decimal, monotonicity: Decimal) -> Optional[Decimal]:
            calls.append(label)
            # Return None for low (failed), stable for high
            if kappa < Decimal("2"):
                return None  # Failed
            return Decimal("0.01")  # Stable

        generate_frontier_params(
            concentrations=[Decimal("1")],
            mus=[Decimal("0.5")],
            monotonicities=[Decimal("0")],
            kappa_low=Decimal("0.5"),
            kappa_high=Decimal("4"),
            tolerance=Decimal("0.1"),
            max_iterations=3,
            execute_fn=mock_execute,
        )

        # Should have tried low, then high, then some mid points
        assert "low" in calls
        assert "high" in calls


# =============================================================================
# Tests for RingSweepRunner (mocked to avoid full simulation)
# =============================================================================


class TestRingSweepRunnerSetup:
    """Tests for RingSweepRunner initialization and configuration."""

    def test_creates_output_directories(self, tmp_path: Path):
        """RingSweepRunner creates registry, runs, and aggregate directories."""
        from bilancio.experiments.ring import RingSweepRunner

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        assert (tmp_path / "registry").exists()
        assert (tmp_path / "runs").exists()
        assert (tmp_path / "aggregate").exists()

    def test_creates_empty_registry_csv(self, tmp_path: Path):
        """RingSweepRunner creates registry CSV with headers."""
        from bilancio.experiments.ring import RingSweepRunner

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        registry_path = tmp_path / "registry" / "experiments.csv"
        assert registry_path.exists()

        # Check headers
        content = registry_path.read_text()
        assert "run_id" in content
        assert "kappa" in content
        assert "status" in content

    def test_seed_increments(self, tmp_path: Path):
        """Seed counter increments with each call to _next_seed()."""
        from bilancio.experiments.ring import RingSweepRunner

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=100,
        )

        assert runner._next_seed() == 100
        assert runner._next_seed() == 101
        assert runner._next_seed() == 102


class TestRingSweepRunnerGridMocked:
    """Tests for RingSweepRunner.run_grid with mocked execution."""

    def test_run_grid_calls_execute_for_each_combination(self, tmp_path: Path):
        """run_grid calls _execute_run for each parameter combination."""
        from bilancio.experiments.ring import RingSweepRunner, RingRunSummary

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        # Mock _execute_run to avoid actual simulation
        calls = []

        def mock_execute(phase, kappa, concentration, mu, monotonicity, seed, **kwargs):
            calls.append((kappa, concentration, mu, monotonicity))
            return RingRunSummary(
                run_id=f"test_{len(calls)}",
                phase=phase,
                kappa=kappa,
                concentration=concentration,
                mu=mu,
                monotonicity=monotonicity,
                delta_total=Decimal("0.1"),
                phi_total=Decimal("0.5"),
                time_to_stability=5,
            )

        with patch.object(runner, "_execute_run", mock_execute):
            kappas = [Decimal("1"), Decimal("2")]
            concentrations = [Decimal("0.5"), Decimal("1")]
            mus = [Decimal("0")]
            monotonicities = [Decimal("0")]

            summaries = runner.run_grid(kappas, concentrations, mus, monotonicities)

        # Should have 2*2*1*1 = 4 calls
        assert len(calls) == 4
        assert len(summaries) == 4

    def test_run_grid_returns_summaries(self, tmp_path: Path):
        """run_grid returns list of RingRunSummary objects."""
        from bilancio.experiments.ring import RingSweepRunner, RingRunSummary

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        def mock_execute(phase, kappa, concentration, mu, monotonicity, seed, **kwargs):
            return RingRunSummary(
                run_id=f"test_{seed}",
                phase=phase,
                kappa=kappa,
                concentration=concentration,
                mu=mu,
                monotonicity=monotonicity,
                delta_total=Decimal("0.1"),
                phi_total=Decimal("0.5"),
                time_to_stability=5,
            )

        with patch.object(runner, "_execute_run", mock_execute):
            summaries = runner.run_grid(
                [Decimal("1")],
                [Decimal("0.5")],
                [Decimal("0")],
                [Decimal("0")],
            )

        assert len(summaries) == 1
        assert isinstance(summaries[0], RingRunSummary)
        assert summaries[0].kappa == Decimal("1")


class TestRingSweepRunnerLHSMocked:
    """Tests for RingSweepRunner.run_lhs with mocked execution."""

    def test_run_lhs_generates_requested_count(self, tmp_path: Path):
        """run_lhs generates exactly the requested number of samples."""
        from bilancio.experiments.ring import RingSweepRunner, RingRunSummary

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        call_count = [0]

        def mock_execute(phase, kappa, concentration, mu, monotonicity, seed, **kwargs):
            call_count[0] += 1
            return RingRunSummary(
                run_id=f"test_{seed}",
                phase=phase,
                kappa=kappa,
                concentration=concentration,
                mu=mu,
                monotonicity=monotonicity,
                delta_total=Decimal("0.1"),
                phi_total=Decimal("0.5"),
                time_to_stability=5,
            )

        with patch.object(runner, "_execute_run", mock_execute):
            summaries = runner.run_lhs(
                count=5,
                kappa_range=(Decimal("0.5"), Decimal("4")),
                concentration_range=(Decimal("0.1"), Decimal("5")),
                mu_range=(Decimal("0"), Decimal("1")),
                monotonicity_range=(Decimal("0"), Decimal("0.5")),
            )

        assert call_count[0] == 5
        assert len(summaries) == 5

    def test_run_lhs_zero_count_returns_empty(self, tmp_path: Path):
        """run_lhs with count=0 returns empty list without executing."""
        from bilancio.experiments.ring import RingSweepRunner

        runner = RingSweepRunner(
            out_dir=tmp_path,
            name_prefix="Test",
            n_agents=2,
            maturity_days=3,
            Q_total=Decimal("100"),
            liquidity_mode="uniform",
            liquidity_agent=None,
            base_seed=42,
        )

        # Should not need to mock since no runs should happen
        summaries = runner.run_lhs(
            count=0,
            kappa_range=(Decimal("0.5"), Decimal("4")),
            concentration_range=(Decimal("0.1"), Decimal("5")),
            mu_range=(Decimal("0"), Decimal("1")),
            monotonicity_range=(Decimal("0"), Decimal("0.5")),
        )

        assert summaries == []


# =============================================================================
# Tests for RingSweepConfig loading
# =============================================================================


class TestRingSweepConfigLoading:
    """Tests for loading sweep configuration from YAML."""

    def test_load_valid_grid_config(self, tmp_path: Path):
        """Valid grid config loads correctly."""
        from bilancio.experiments.ring import load_ring_sweep_config

        config_yaml = """
version: 1
out_dir: ./output
grid:
  enabled: true
  kappas: [0.5, 1, 2]
  concentrations: [0.5, 1]
  mus: [0, 0.5]
runner:
  n_agents: 50
  maturity_days: 5
  q_total: 5000
  liquidity_mode: uniform
  base_seed: 100
"""
        config_path = tmp_path / "sweep.yaml"
        config_path.write_text(config_yaml)

        config = load_ring_sweep_config(config_path)

        assert config.version == 1
        assert config.grid is not None
        assert config.grid.enabled is True
        assert len(config.grid.kappas) == 3
        assert config.runner.n_agents == 50

    def test_load_config_file_not_found(self, tmp_path: Path):
        """Missing config file raises FileNotFoundError."""
        from bilancio.experiments.ring import load_ring_sweep_config

        with pytest.raises(FileNotFoundError):
            load_ring_sweep_config(tmp_path / "nonexistent.yaml")

    def test_load_config_invalid_version(self, tmp_path: Path):
        """Invalid version raises ValueError."""
        from bilancio.experiments.ring import load_ring_sweep_config

        config_yaml = """
version: 99
grid:
  enabled: true
  kappas: [1]
  concentrations: [1]
  mus: [0]
"""
        config_path = tmp_path / "sweep.yaml"
        config_path.write_text(config_yaml)

        with pytest.raises(ValueError, match="Unsupported sweep config version"):
            load_ring_sweep_config(config_path)


# =============================================================================
# Tests for ComparisonSweepRunner setup
# =============================================================================


class TestComparisonSweepRunnerSetup:
    """Tests for ComparisonSweepRunner initialization."""

    def test_creates_output_directories(self, tmp_path: Path):
        """ComparisonSweepRunner creates control, treatment, and aggregate directories."""
        from bilancio.experiments.comparison import ComparisonSweepRunner, ComparisonSweepConfig

        config = ComparisonSweepConfig(
            n_agents=5,
            maturity_days=3,
            kappas=[Decimal("1")],
            concentrations=[Decimal("1")],
            mus=[Decimal("0")],
        )

        runner = ComparisonSweepRunner(config, tmp_path)

        assert (tmp_path / "control").exists()
        assert (tmp_path / "treatment").exists()
        assert (tmp_path / "aggregate").exists()


# =============================================================================
# Tests for BalancedComparisonRunner setup
# =============================================================================


class TestBalancedComparisonRunnerSetup:
    """Tests for BalancedComparisonRunner initialization."""

    def test_creates_output_directories(self, tmp_path: Path):
        """BalancedComparisonRunner creates passive, active, and aggregate directories."""
        from bilancio.experiments.balanced_comparison import BalancedComparisonRunner, BalancedComparisonConfig

        config = BalancedComparisonConfig(
            n_agents=5,
            maturity_days=3,
            kappas=[Decimal("1")],
            concentrations=[Decimal("1")],
            mus=[Decimal("0")],
            outside_mid_ratios=[Decimal("0.75")],
        )

        runner = BalancedComparisonRunner(config, tmp_path)

        assert (tmp_path / "passive").exists()
        assert (tmp_path / "active").exists()
        assert (tmp_path / "aggregate").exists()


# =============================================================================
# Tests for ComparisonResult and BalancedComparisonResult
# =============================================================================


class TestComparisonResult:
    """Tests for ComparisonResult dataclass."""

    def test_delta_reduction_calculation(self):
        """delta_reduction is control minus treatment."""
        from bilancio.experiments.comparison import ComparisonResult

        result = ComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            delta_control=Decimal("0.5"),
            phi_control=Decimal("1"),
            control_run_id="c1",
            control_status="completed",
            delta_treatment=Decimal("0.3"),
            phi_treatment=Decimal("0.8"),
            treatment_run_id="t1",
            treatment_status="completed",
        )

        assert result.delta_reduction == Decimal("0.2")

    def test_relief_ratio_calculation(self):
        """relief_ratio is reduction divided by control."""
        from bilancio.experiments.comparison import ComparisonResult

        result = ComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            delta_control=Decimal("0.5"),
            phi_control=Decimal("1"),
            control_run_id="c1",
            control_status="completed",
            delta_treatment=Decimal("0.25"),
            phi_treatment=Decimal("0.8"),
            treatment_run_id="t1",
            treatment_status="completed",
        )

        assert result.relief_ratio == Decimal("0.5")

    def test_relief_ratio_zero_control(self):
        """relief_ratio is 0 when control has no defaults."""
        from bilancio.experiments.comparison import ComparisonResult

        result = ComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            delta_control=Decimal("0"),
            phi_control=Decimal("1"),
            control_run_id="c1",
            control_status="completed",
            delta_treatment=Decimal("0"),
            phi_treatment=Decimal("1"),
            treatment_run_id="t1",
            treatment_status="completed",
        )

        assert result.relief_ratio == Decimal("0")

    def test_delta_reduction_none_when_missing(self):
        """delta_reduction is None when control or treatment is None."""
        from bilancio.experiments.comparison import ComparisonResult

        result = ComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            delta_control=None,
            phi_control=None,
            control_run_id="c1",
            control_status="failed",
            delta_treatment=Decimal("0.3"),
            phi_treatment=Decimal("0.8"),
            treatment_run_id="t1",
            treatment_status="completed",
        )

        assert result.delta_reduction is None
        assert result.relief_ratio is None


class TestBalancedComparisonResult:
    """Tests for BalancedComparisonResult dataclass."""

    def test_trading_effect_calculation(self):
        """trading_effect is passive minus active."""
        from bilancio.experiments.balanced_comparison import BalancedComparisonResult

        result = BalancedComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            face_value=Decimal("20"),
            outside_mid_ratio=Decimal("0.75"),
            big_entity_share=Decimal("0.25"),
            delta_passive=Decimal("0.5"),
            phi_passive=Decimal("1"),
            passive_run_id="p1",
            passive_status="completed",
            delta_active=Decimal("0.3"),
            phi_active=Decimal("0.8"),
            active_run_id="a1",
            active_status="completed",
        )

        assert result.trading_effect == Decimal("0.2")

    def test_trading_relief_ratio_calculation(self):
        """trading_relief_ratio is effect divided by passive."""
        from bilancio.experiments.balanced_comparison import BalancedComparisonResult

        result = BalancedComparisonResult(
            kappa=Decimal("1"),
            concentration=Decimal("1"),
            mu=Decimal("0"),
            monotonicity=Decimal("0"),
            seed=42,
            face_value=Decimal("20"),
            outside_mid_ratio=Decimal("0.75"),
            big_entity_share=Decimal("0.25"),
            delta_passive=Decimal("0.5"),
            phi_passive=Decimal("1"),
            passive_run_id="p1",
            passive_status="completed",
            delta_active=Decimal("0.25"),
            phi_active=Decimal("0.8"),
            active_run_id="a1",
            active_status="completed",
        )

        assert result.trading_relief_ratio == Decimal("0.5")

```

---

### 🧪 tests/integration/test_banking_ops.py

```python
import pytest
from bilancio.engines.system import System
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.household import Household
from bilancio.core.errors import ValidationError
from bilancio.ops.banking import deposit_cash, withdraw_cash, client_payment


def test_deposit_cash():
    """Test depositing cash from customer to bank creates bank deposit."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    
    # CB mints cash to H1
    sys.mint_cash("H1", 120)
    
    # H1 deposits 120 to B1
    dep_id = deposit_cash(sys, "H1", "B1", 120)
    
    # Check cash moved H1→B1
    h1_cash = sum(sys.state.contracts[cid].amount for cid in h1.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    b1_cash = sum(sys.state.contracts[cid].amount for cid in b1.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 0
    assert b1_cash == 120
    
    # Check H1 has deposit 120 at B1
    assert sys.total_deposit("H1", "B1") == 120
    
    # Check event logged
    events = [e for e in sys.state.events if e["kind"] == "CashDeposited"]
    assert len(events) == 1
    assert events[0]["customer"] == "H1"
    assert events[0]["bank"] == "B1"
    assert events[0]["amount"] == 120
    
    # Invariants hold
    sys.assert_invariants()


def test_withdraw_cash():
    """Test withdrawing cash from bank deposit."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    
    # Setup: H1 has 120 deposit at B1
    sys.mint_cash("H1", 120)
    deposit_cash(sys, "H1", "B1", 120)
    
    # Withdraw 70
    withdraw_cash(sys, "H1", "B1", 70)
    
    # Check H1 deposit now 50
    assert sys.total_deposit("H1", "B1") == 50
    
    # Check H1 cash +70
    h1_cash = sum(sys.state.contracts[cid].amount for cid in h1.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 70
    
    # Check bank cash -70
    b1_cash = sum(sys.state.contracts[cid].amount for cid in b1.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert b1_cash == 50
    
    # Check event logged
    events = [e for e in sys.state.events if e["kind"] == "CashWithdrawn"]
    assert len(events) == 1
    assert events[0]["customer"] == "H1"
    assert events[0]["bank"] == "B1"
    assert events[0]["amount"] == 70
    
    sys.assert_invariants()


def test_withdraw_insufficient_bank_cash():
    """Test error when bank doesn't have enough cash on hand."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    
    # Setup: H1 deposits 100, but B1 only has 50 cash
    sys.mint_cash("H1", 100)
    deposit_cash(sys, "H1", "B1", 100)
    
    # Bank transfers 50 cash away (simulating it being used elsewhere)
    sys.mint_cash("B1", 0)  # B1 now has 100 cash from deposit
    # Transfer 60 away to simulate shortage
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    sys.add_agent(b2)
    sys.transfer_cash("B1", "B2", 60)
    
    # Try to withdraw 50 (should fail since B1 only has 40 cash)
    with pytest.raises(ValidationError, match="insufficient cash on hand"):
        withdraw_cash(sys, "H1", "B1", 50)
    
    # Deposit should remain unchanged
    assert sys.total_deposit("H1", "B1") == 100
    
    sys.assert_invariants()


def test_same_bank_payment():
    """Test payment between customers at same bank."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has 100 deposit at B1
    sys.mint_cash("H1", 100)
    deposit_cash(sys, "H1", "B1", 100)
    
    # H1@B1 pays H2@B1, 40
    client_payment(sys, "H1", "B1", "H2", "B1", 40)
    
    # Check H1 deposit -40
    assert sys.total_deposit("H1", "B1") == 60
    
    # Check H2 deposit +40
    assert sys.total_deposit("H2", "B1") == 40
    
    # No ClientPayment event (same bank)
    events = [e for e in sys.state.events if e["kind"] == "ClientPayment"]
    assert len(events) == 0
    
    sys.assert_invariants()


def test_cross_bank_payment():
    """Test payment between customers at different banks."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h3)
    
    # Setup: H1 has 100 deposit at B1
    sys.mint_cash("H1", 100)
    deposit_cash(sys, "H1", "B1", 100)
    
    # H1@B1 pays H3@B2, 30
    client_payment(sys, "H1", "B1", "H3", "B2", 30)
    
    # Check H1 deposit -30
    assert sys.total_deposit("H1", "B1") == 70
    
    # Check H3 deposit +30 at B2
    assert sys.total_deposit("H3", "B2") == 30
    
    # ClientPayment event recorded
    events = [e for e in sys.state.events if e["kind"] == "ClientPayment"]
    assert len(events) == 1
    assert events[0]["payer"] == "H1"
    assert events[0]["payer_bank"] == "B1"
    assert events[0]["payee"] == "H3"
    assert events[0]["payee_bank"] == "B2"
    assert events[0]["amount"] == 30
    
    # No reserves moved (deferred to clearing)
    # Banks don't have reserve deposits yet
    
    sys.assert_invariants()


def test_insufficient_deposit_payment():
    """Test payment fails with insufficient deposit, succeeds with cash fallback."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has 30 deposit at B1 and 50 cash
    sys.mint_cash("H1", 80)
    deposit_cash(sys, "H1", "B1", 30)
    
    # Try to pay 60 (more than deposit) - should fail
    with pytest.raises(ValidationError, match="insufficient funds"):
        client_payment(sys, "H1", "B1", "H2", "B2", 60)
    
    # Balances unchanged
    assert sys.total_deposit("H1", "B1") == 30
    h1_from_sys = sys.state.agents["H1"]
    h1_cash = sum(sys.state.contracts[cid].amount for cid in h1_from_sys.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 50
    
    # Re-run with allow_cash_fallback=True
    client_payment(sys, "H1", "B1", "H2", "B2", 60, allow_cash_fallback=True)
    
    # H1 deposit should be 0 (used 30)
    assert sys.total_deposit("H1", "B1") == 0
    
    # H1 cash should be 20 (used 30 from 50)
    h1_from_sys = sys.state.agents["H1"]
    h1_cash = sum(sys.state.contracts[cid].amount for cid in h1_from_sys.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 20
    
    # H2 should have 30 cash (from fallback) and 30 deposit (from H1's deposit)
    h2_from_sys = sys.state.agents["H2"]
    h2_cash = sum(sys.state.contracts[cid].amount for cid in h2_from_sys.asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h2_cash == 30  # from cash fallback
    assert sys.total_deposit("H2", "B2") == 30  # only the deposit portion
    
    sys.assert_invariants()


def test_deposit_coalescing():
    """Test that multiple deposits for same customer-bank pair are coalesced."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Multiple deposits from H1 to B1
    sys.mint_cash("H1", 150)
    deposit_cash(sys, "H1", "B1", 50)
    deposit_cash(sys, "H1", "B1", 30)
    deposit_cash(sys, "H1", "B1", 20)
    
    # Total should be 100
    assert sys.total_deposit("H1", "B1") == 100
    
    # Should have just one deposit instrument (coalesced)
    dep_ids = sys.deposit_ids("H1", "B1")
    assert len(dep_ids) == 1
    
    # Multiple payments to H2 should also coalesce
    client_payment(sys, "H1", "B1", "H2", "B1", 10)
    client_payment(sys, "H1", "B1", "H2", "B1", 15)
    client_payment(sys, "H1", "B1", "H2", "B1", 5)
    
    # H2 should have 30 total in one instrument
    assert sys.total_deposit("H2", "B1") == 30
    h2_deps = sys.deposit_ids("H2", "B1")
    assert len(h2_deps) == 1
    
    sys.assert_invariants()


def test_no_deposit_at_bank_error():
    """Test error when trying to withdraw from bank with no deposit."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    
    # H1 has no deposits
    with pytest.raises(ValidationError, match="no deposit at this bank"):
        withdraw_cash(sys, "H1", "B1", 50)
    
    sys.assert_invariants()


def test_insufficient_deposit_for_withdrawal():
    """Test error when trying to withdraw more than deposit balance."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    
    # Setup: H1 has 50 deposit at B1
    sys.mint_cash("H1", 50)
    deposit_cash(sys, "H1", "B1", 50)
    
    # Try to withdraw 100
    with pytest.raises(ValidationError, match="insufficient deposit balance"):
        withdraw_cash(sys, "H1", "B1", 100)
    
    # Deposit unchanged
    assert sys.total_deposit("H1", "B1") == 50
    
    sys.assert_invariants()
```

---

### 🧪 tests/integration/test_clearing_phase_c.py

```python
import pytest
from bilancio.engines.system import System
from bilancio.engines.clearing import settle_intraday_nets, compute_intraday_nets
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.household import Household
from bilancio.ops.banking import deposit_cash, client_payment


def test_phase_c_netting_reserves():
    """Test Phase C clearing nets multiple cross-bank payments correctly using reserves."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    h4 = Household(id="H4", name="Household 4", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h2)
    sys.add_agent(h3)
    sys.add_agent(h4)
    
    # Setup: Both banks have reserves
    sys.mint_reserves("B1", 1000)
    sys.mint_reserves("B2", 1000)
    
    # Setup: Customers have deposits
    sys.mint_cash("H1", 200)
    sys.mint_cash("H2", 150)
    sys.mint_cash("H3", 300)
    sys.mint_cash("H4", 100)
    deposit_cash(sys, "H1", "B1", 200)  # H1@B1
    deposit_cash(sys, "H2", "B1", 150)  # H2@B1
    deposit_cash(sys, "H3", "B2", 300)  # H3@B2
    deposit_cash(sys, "H4", "B2", 100)  # H4@B2
    
    # Create cross-bank payments that will net out partially:
    # H1@B1 pays H3@B2: 80 (B1 owes B2: 80)
    client_payment(sys, "H1", "B1", "H3", "B2", 80)
    # H2@B1 pays H4@B2: 50 (B1 owes B2: 50 more, total 130)
    client_payment(sys, "H2", "B1", "H4", "B2", 50)
    # H3@B2 pays H1@B1: 60 (B2 owes B1: 60, nets against 130, so B1 still owes B2: 70)
    client_payment(sys, "H3", "B2", "H1", "B1", 60)
    
    current_day = sys.state.day
    
    # Test compute_intraday_nets
    nets = compute_intraday_nets(sys, current_day)
    
    # With lexical ordering: B1 < B2, so nets should be positive (B1 owes B2)
    assert len(nets) == 1
    assert nets[("B1", "B2")] == 70  # 80 + 50 - 60 = 70
    
    # Phase C: Settle intraday nets
    settle_intraday_nets(sys, current_day)
    
    # Check B1 reserves reduced by 70
    b1_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves == 930  # 1000 - 70
    
    # Check B2 reserves increased by 70
    b2_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B2"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b2_reserves == 1070  # 1000 + 70
    
    # Check InterbankCleared event logged
    events = [e for e in sys.state.events if e["kind"] == "InterbankCleared"]
    assert len(events) == 1
    assert events[0]["debtor_bank"] == "B1"
    assert events[0]["creditor_bank"] == "B2"
    assert events[0]["amount"] == 70
    
    # No overnight payables created
    overnight_events = [e for e in sys.state.events if e["kind"] == "InterbankOvernightCreated"]
    assert len(overnight_events) == 0
    
    sys.assert_invariants()


def test_phase_c_overnight_creation():
    """Test Phase C clearing creates overnight payable when insufficient reserves."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h3)
    
    # Setup: B1 has insufficient reserves (only 30), B2 has plenty
    sys.mint_reserves("B1", 30)
    sys.mint_reserves("B2", 1000)
    
    # Setup: Customers have deposits
    sys.mint_cash("H1", 200)
    sys.mint_cash("H3", 100)
    deposit_cash(sys, "H1", "B1", 200)  # H1@B1
    deposit_cash(sys, "H3", "B2", 100)  # H3@B2
    
    # Create cross-bank payment: H1@B1 pays H3@B2: 100 (needs 100 in reserves)
    client_payment(sys, "H1", "B1", "H3", "B2", 100)
    
    current_day = sys.state.day
    
    # Phase C: Settle intraday nets (should create overnight payable)
    settle_intraday_nets(sys, current_day)
    
    # Check B1 reserves unchanged (insufficient to cover 100)
    b1_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves == 30  # unchanged
    
    # Check B2 reserves unchanged
    b2_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B2"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b2_reserves == 1000  # unchanged
    
    # Check overnight payable created: B1 owes B2, due tomorrow
    payables = [c for c in sys.state.contracts.values() if c.kind == "payable"]
    assert len(payables) == 1
    overnight_payable = payables[0]
    assert overnight_payable.liability_issuer_id == "B1"
    assert overnight_payable.asset_holder_id == "B2"
    assert overnight_payable.amount == 100
    assert overnight_payable.due_day == current_day + 1
    
    # Check InterbankOvernightCreated event logged
    overnight_events = [e for e in sys.state.events if e["kind"] == "InterbankOvernightCreated"]
    assert len(overnight_events) == 1
    assert overnight_events[0]["debtor_bank"] == "B1"
    assert overnight_events[0]["creditor_bank"] == "B2"
    assert overnight_events[0]["amount"] == 100
    assert overnight_events[0]["due_day"] == current_day + 1
    
    # No InterbankCleared event
    cleared_events = [e for e in sys.state.events if e["kind"] == "InterbankCleared"]
    assert len(cleared_events) == 0
    
    sys.assert_invariants()


def test_phase_c_no_nets_for_same_bank():
    """Test Phase C clearing does not create nets for same-bank payments."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    sys.add_agent(h3)
    
    # Setup: All customers at same bank
    sys.mint_cash("H1", 150)
    sys.mint_cash("H2", 200)
    sys.mint_cash("H3", 100)
    deposit_cash(sys, "H1", "B1", 150)  # H1@B1
    deposit_cash(sys, "H2", "B1", 200)  # H2@B1
    deposit_cash(sys, "H3", "B1", 100)  # H3@B1
    
    # Create same-bank payments (should not generate ClientPayment events)
    client_payment(sys, "H1", "B1", "H2", "B1", 50)  # H1 pays H2
    client_payment(sys, "H2", "B1", "H3", "B1", 80)  # H2 pays H3
    client_payment(sys, "H3", "B1", "H1", "B1", 30)  # H3 pays H1
    
    current_day = sys.state.day
    
    # Check no ClientPayment events (all same bank)
    client_payment_events = [e for e in sys.state.events if e["kind"] == "ClientPayment"]
    assert len(client_payment_events) == 0
    
    # Test compute_intraday_nets - should be empty
    nets = compute_intraday_nets(sys, current_day)
    assert len(nets) == 0
    
    # Phase C: Settle intraday nets (should be no-op)
    settle_intraday_nets(sys, current_day)
    
    # Check no interbank events
    interbank_events = [e for e in sys.state.events 
                       if e["kind"] in ["InterbankCleared", "InterbankOvernightCreated"]]
    assert len(interbank_events) == 0
    
    # Check no payables created
    payables = [c for c in sys.state.contracts.values() if c.kind == "payable"]
    assert len(payables) == 0
    
    # Check deposit balances (from same-bank transfers)
    assert sys.total_deposit("H1", "B1") == 130  # 150 - 50 + 30
    assert sys.total_deposit("H2", "B1") == 170  # 200 + 50 - 80
    assert sys.total_deposit("H3", "B1") == 150  # 100 + 80 - 30
    
    sys.assert_invariants()
```

---

### 🧪 tests/integration/test_day_simulation.py

```python
import pytest
from bilancio.engines.system import System
from bilancio.engines.simulation import run_day
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.household import Household
from bilancio.domain.instruments.credit import Payable
from bilancio.domain.policy import PolicyEngine
from bilancio.ops.banking import deposit_cash, client_payment


def test_run_day_basic():
    """Test basic day simulation with all phases working together."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h2)
    sys.add_agent(h3)
    
    # Setup: Banks have reserves
    sys.mint_reserves("B1", 500)
    sys.mint_reserves("B2", 500)
    
    # Setup: Households have deposits
    sys.mint_cash("H1", 300)
    sys.mint_cash("H2", 200)
    sys.mint_cash("H3", 100)
    deposit_cash(sys, "H1", "B1", 300)  # H1@B1
    deposit_cash(sys, "H2", "B1", 200)  # H2@B1
    deposit_cash(sys, "H3", "B2", 100)  # H3@B2
    
    # Create payable due today: H1 owes H2 amount 150
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=150,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Create some cross-bank payments during the day
    client_payment(sys, "H2", "B1", "H3", "B2", 80)  # B1 owes B2: 80
    
    initial_day = sys.state.day
    
    # Run the day simulation
    run_day(sys)
    
    # Check day incremented
    assert sys.state.day == initial_day + 1
    
    # Phase A: Check PhaseA event logged
    phase_a_events = [e for e in sys.state.events if e["kind"] == "PhaseA"]
    assert len(phase_a_events) == 1
    assert phase_a_events[0]["day"] == initial_day
    
    # Phase B: Check payable was settled
    assert payable_id not in sys.state.contracts
    
    # Check PayableSettled event
    settled_events = [e for e in sys.state.events if e["kind"] == "PayableSettled"]
    assert len(settled_events) == 1
    assert settled_events[0]["debtor"] == "H1"
    assert settled_events[0]["creditor"] == "H2"
    assert settled_events[0]["amount"] == 150
    
    # Check H1 and H2 balances after settlement (same bank)
    assert sys.total_deposit("H1", "B1") == 150  # 300 - 150 
    assert sys.total_deposit("H2", "B1") == 270  # 200 + 150 - 80 (paid to H3)
    assert sys.total_deposit("H3", "B2") == 180  # 100 + 80
    
    # Phase C: Check reserves transferred for cross-bank net
    # B1 owed B2: 80, should be settled with reserves
    b1_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    b2_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B2"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves == 420  # 500 - 80
    assert b2_reserves == 580  # 500 + 80
    
    # Check InterbankCleared event
    cleared_events = [e for e in sys.state.events if e["kind"] == "InterbankCleared"]
    assert len(cleared_events) == 1
    assert cleared_events[0]["debtor_bank"] == "B1"
    assert cleared_events[0]["creditor_bank"] == "B2"
    assert cleared_events[0]["amount"] == 80
    
    sys.assert_invariants()


def test_overnight_settlement_next_day():
    """Test overnight payables from day t are settled on day t+1."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h3)
    
    # Setup: B1 has insufficient reserves, B2 has plenty
    sys.mint_reserves("B1", 30)
    sys.mint_reserves("B2", 500)
    
    # Setup: Customers have deposits
    sys.mint_cash("H1", 200)
    sys.mint_cash("H3", 100)
    deposit_cash(sys, "H1", "B1", 200)  # H1@B1
    deposit_cash(sys, "H3", "B2", 100)  # H3@B2
    
    # Create cross-bank payment that will require overnight payable
    client_payment(sys, "H1", "B1", "H3", "B2", 100)  # B1 owes B2: 100
    
    day_0 = sys.state.day
    
    # Run day 0 - should create overnight payable
    run_day(sys)
    
    # Check overnight payable created
    payables = [c for c in sys.state.contracts.values() if c.kind == "payable"]
    assert len(payables) == 1
    overnight_payable = payables[0]
    assert overnight_payable.liability_issuer_id == "B1"
    assert overnight_payable.asset_holder_id == "B2"
    assert overnight_payable.amount == 100
    assert overnight_payable.due_day == day_0 + 1  # due tomorrow
    
    # Check reserves unchanged on day 0 (insufficient)
    b1_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves == 30  # unchanged
    
    # Now add more reserves to B1 for next day settlement
    sys.mint_reserves("B1", 200)  # B1 now has 230 total
    
    # Run day 1 - overnight payable should be settled
    run_day(sys)
    
    # Check overnight payable settled and removed
    payables_after = [c for c in sys.state.contracts.values() if c.kind == "payable"]
    assert len(payables_after) == 0
    
    # Check reserves transferred on day 1
    b1_reserves_final = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                           if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    b2_reserves_final = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B2"].asset_ids 
                           if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves_final == 130  # 230 - 100
    assert b2_reserves_final == 600  # 500 + 100
    
    # Check PayableSettled event on day 1
    settled_events = [e for e in sys.state.events if e["kind"] == "PayableSettled" and e["day"] == day_0 + 1]
    assert len(settled_events) == 1
    assert settled_events[0]["debtor"] == "B1"
    assert settled_events[0]["creditor"] == "B2"
    assert settled_events[0]["amount"] == 100
    
    sys.assert_invariants()


def test_policy_order_drives_payment_choice():
    """Test that policy order determines payment method preference."""
    # Create custom policy that prioritizes cash over deposits for households
    custom_policy = PolicyEngine.default()
    custom_policy.mop_rank["household"] = ["cash", "bank_deposit"]  # cash first!
    
    sys = System(policy=custom_policy)
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has both cash and deposit
    sys.mint_cash("H1", 200)
    deposit_cash(sys, "H1", "B1", 100)  # H1 still has 100 cash + 100 deposit
    
    # Create payable: H1 owes H2 amount 80, due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=80,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Run the day
    run_day(sys)
    
    # Check payable settled
    assert payable_id not in sys.state.contracts
    
    # With custom policy (cash first), H1 should have used cash, not deposit
    # H1 deposit should be unchanged
    assert sys.total_deposit("H1", "B1") == 100  # unchanged
    
    # H1 cash should be reduced by 80
    h1_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H1"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 20  # 100 - 80
    
    # H2 should have received 80 cash (direct transfer)
    h2_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H2"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h2_cash == 80
    
    # H2 should have no deposits (received cash directly)
    assert sys.total_deposit("H2", "B1") == 0
    
    sys.assert_invariants()


def test_policy_order_drives_payment_choice_default():
    """Test default policy (deposits first) for comparison."""
    sys = System()  # default policy: deposits first
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has both cash and deposit (identical to above test)
    sys.mint_cash("H1", 200)
    deposit_cash(sys, "H1", "B1", 100)  # H1 still has 100 cash + 100 deposit
    
    # Create payable: H1 owes H2 amount 80, due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=80,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Run the day
    run_day(sys)
    
    # Check payable settled
    assert payable_id not in sys.state.contracts
    
    # With default policy (deposits first), H1 should have used deposit, not cash
    # H1 deposit should be reduced by 80
    assert sys.total_deposit("H1", "B1") == 20  # 100 - 80
    
    # H1 cash should be unchanged
    h1_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H1"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 100  # unchanged
    
    # H2 should have received 80 as deposit (same bank transfer)
    assert sys.total_deposit("H2", "B1") == 80
    
    # H2 should have no cash (received deposit)
    h2_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H2"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h2_cash == 0
    
    sys.assert_invariants()
```

---

### 🧪 tests/integration/test_dealer_integration.py

```python
"""Integration tests for dealer-Kalecki integration.

Tests verify the integration between the dealer ring subsystem and the main
Bilancio simulation engine, including:
- Initialization from system state
- Trading phase execution
- Synchronization back to main system
- Settlement with transferred payables
"""

import pytest
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.domain.agents import Bank, Household, CentralBank
from bilancio.domain.instruments.credit import Payable
from bilancio.engines.simulation import run_day
from bilancio.engines.dealer_integration import (
    DealerSubsystem,
    initialize_dealer_subsystem,
    run_dealer_trading_phase,
    sync_dealer_to_system,
)
from bilancio.dealer.simulation import DealerRingConfig
from bilancio.dealer.models import BucketConfig, DEFAULT_BUCKETS


def create_test_system_with_payables():
    """Create a minimal test system with agents, cash, and payables."""
    sys = System()

    # Add agents
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    bank = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    h3 = Household(id="H3", name="Household 3", kind="household")

    sys.add_agent(cb)
    sys.add_agent(bank)
    sys.add_agent(h1)
    sys.add_agent(h2)
    sys.add_agent(h3)

    # Give households some cash
    sys.mint_cash("H1", 100)
    sys.mint_cash("H2", 100)
    sys.mint_cash("H3", 100)

    # Create payables between households
    # H1 owes H2, due in 2 days
    p1_id = sys.new_contract_id("P")
    p1 = Payable(
        id=p1_id,
        kind="payable",
        amount=50,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day + 2,
    )
    sys.add_contract(p1)

    # H2 owes H3, due in 5 days
    p2_id = sys.new_contract_id("P")
    p2 = Payable(
        id=p2_id,
        kind="payable",
        amount=30,
        denom="X",
        asset_holder_id="H3",
        liability_issuer_id="H2",
        due_day=sys.state.day + 5,
    )
    sys.add_contract(p2)

    # H3 owes H1, due in 10 days
    p3_id = sys.new_contract_id("P")
    p3 = Payable(
        id=p3_id,
        kind="payable",
        amount=20,
        denom="X",
        asset_holder_id="H1",
        liability_issuer_id="H3",
        due_day=sys.state.day + 10,
    )
    sys.add_contract(p3)

    return sys


def create_dealer_config():
    """Create a test dealer configuration."""
    return DealerRingConfig(
        ticket_size=Decimal(1),
        buckets=list(DEFAULT_BUCKETS),
        dealer_share=Decimal("0.25"),
        vbt_share=Decimal("0.50"),
        vbt_anchors={
            "short": (Decimal("1.0"), Decimal("0.20")),
            "mid": (Decimal("1.0"), Decimal("0.30")),
            "long": (Decimal("1.0"), Decimal("0.40")),
        },
        phi_M=Decimal("0.1"),
        phi_O=Decimal("0.1"),
        clip_nonneg_B=True,
        seed=42,
    )


def test_initialize_dealer_subsystem():
    """Test initialization of dealer subsystem from system state.

    Verifies:
    - Tickets are created from payables
    - Dealers and VBTs are created for each bucket
    - Traders are created for households
    - Tickets are assigned to correct buckets based on maturity
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize dealer subsystem
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)

    # Verify tickets were created from payables (3 payables)
    assert len(subsystem.tickets) == 3, "Should create 3 tickets from 3 payables"

    # Verify bidirectional mappings exist
    assert len(subsystem.ticket_to_payable) == 3
    assert len(subsystem.payable_to_ticket) == 3

    # Verify dealers and VBTs created for each bucket
    assert len(subsystem.dealers) == 3, "Should have 3 dealers (short, mid, long)"
    assert len(subsystem.vbts) == 3, "Should have 3 VBTs (short, mid, long)"
    assert "short" in subsystem.dealers
    assert "mid" in subsystem.dealers
    assert "long" in subsystem.dealers

    # Verify traders created for households (3 households)
    assert len(subsystem.traders) == 3, "Should have 3 traders for 3 households"
    assert "H1" in subsystem.traders
    assert "H2" in subsystem.traders
    assert "H3" in subsystem.traders

    # Verify tickets assigned to correct buckets
    # tau=2 -> short, tau=5 -> mid, tau=10 -> long
    bucket_counts = {"short": 0, "mid": 0, "long": 0}
    for ticket in subsystem.tickets.values():
        bucket_counts[ticket.bucket_id] += 1

    assert bucket_counts["short"] == 1, "Should have 1 ticket in short bucket (tau=2)"
    assert bucket_counts["mid"] == 1, "Should have 1 ticket in mid bucket (tau=5)"
    assert bucket_counts["long"] == 1, "Should have 1 ticket in long bucket (tau=10)"

    # Verify traders have correct ownership links
    for trader_id, trader in subsystem.traders.items():
        # Each trader should have tickets they own (as creditor) and obligations (as debtor)
        owned_count = len(trader.tickets_owned)
        obligations_count = len(trader.obligations)
        # In our setup, each household is both a creditor and a debtor
        assert owned_count + obligations_count > 0, f"Trader {trader_id} should have tickets or obligations"

    # Verify executor was created
    assert subsystem.executor is not None, "Trade executor should be initialized"


def test_dealer_trading_phase_executes():
    """Test that dealer trading phase executes and returns events.

    Verifies:
    - Trading phase runs without errors
    - Events are returned (may be empty if no eligible trades)
    - Dealer quotes are computed
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize dealer subsystem
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)

    # Run trading phase
    events = run_dealer_trading_phase(subsystem, sys, current_day=0)

    # Verify events list is returned (even if empty)
    assert isinstance(events, list), "Should return a list of events"

    # Verify all dealers have computed quotes
    for bucket_id, dealer in subsystem.dealers.items():
        # Dealer state should be initialized with quotes
        # (quotes may be None if no inventory, but state should exist)
        assert dealer is not None, f"Dealer for {bucket_id} should exist"

    # If there are events, verify they have expected structure
    for event in events:
        assert "kind" in event, "Event should have 'kind' field"
        assert "day" in event, "Event should have 'day' field"
        if event["kind"] == "dealer_trade":
            assert "trader" in event, "Trade event should have 'trader' field"
            assert "side" in event, "Trade event should have 'side' field"
            assert event["side"] in ["buy", "sell"], "Side should be buy or sell"


def test_run_day_with_dealer_enabled():
    """Test that run_day executes dealer phase when enabled.

    Verifies:
    - SubphaseB_Dealer event is logged
    - Dealer trading phase runs within main simulation loop
    - System day advances correctly
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize dealer subsystem and attach to state
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)
    sys.state.dealer_subsystem = subsystem

    initial_day = sys.state.day

    # Run day with dealer enabled
    run_day(sys, enable_dealer=True)

    # Verify day advanced
    assert sys.state.day == initial_day + 1, "Day should advance by 1"

    # Verify SubphaseB_Dealer event was logged
    dealer_events = [e for e in sys.state.events if e.get("kind") == "SubphaseB_Dealer"]
    assert len(dealer_events) == 1, "Should log exactly one SubphaseB_Dealer event"
    assert dealer_events[0]["day"] == initial_day, "Dealer event should be for the correct day"


def test_run_day_without_dealer():
    """Test that run_day skips dealer phase when disabled.

    Verifies:
    - NO SubphaseB_Dealer event is logged
    - Normal simulation phases still run
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize dealer subsystem and attach to state
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)
    sys.state.dealer_subsystem = subsystem

    initial_day = sys.state.day

    # Run day WITHOUT dealer enabled
    run_day(sys, enable_dealer=False)

    # Verify day advanced
    assert sys.state.day == initial_day + 1, "Day should advance by 1"

    # Verify NO SubphaseB_Dealer event was logged
    dealer_events = [e for e in sys.state.events if e.get("kind") == "SubphaseB_Dealer"]
    assert len(dealer_events) == 0, "Should NOT log SubphaseB_Dealer event when disabled"

    # Verify other phases still ran
    phase_a_events = [e for e in sys.state.events if e.get("kind") == "PhaseA"]
    assert len(phase_a_events) >= 1, "PhaseA should still run"


def test_payable_holder_id_updated_after_trade():
    """Test that payable.holder_id is updated after dealer trades.

    Verifies:
    - After sync_dealer_to_system, payable.holder_id reflects ticket ownership
    - Ownership transfers are properly tracked
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize dealer subsystem
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)

    # Get a ticket and manually change its ownership to simulate a trade
    ticket = list(subsystem.tickets.values())[0]
    original_owner = ticket.owner_id
    ticket.owner_id = "H3"  # Transfer to H3

    # Sync back to system
    sync_dealer_to_system(subsystem, sys)

    # Find corresponding payable
    payable_id = subsystem.ticket_to_payable[ticket.id]
    payable = sys.state.contracts[payable_id]

    # Verify holder_id was updated
    assert payable.holder_id == "H3", "Payable holder_id should be updated to new owner"
    assert payable.effective_creditor == "H3", "Effective creditor should be the new holder"
    assert payable.asset_holder_id == original_owner, "Original creditor should remain unchanged"


def test_settlement_pays_effective_creditor():
    """Test that settlement pays the current holder, not original creditor.

    Verifies:
    - When payable has holder_id set (transferred in secondary market)
    - Settlement pays holder_id, not original asset_holder_id
    - Cash/deposits transfer to correct agent
    """
    sys = create_test_system_with_payables()

    # Create a payable due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=25,
        denom="X",
        asset_holder_id="H2",  # Original creditor
        liability_issuer_id="H1",  # Debtor
        due_day=sys.state.day,
        holder_id="H3",  # Transferred to H3 in secondary market
    )
    sys.add_contract(payable)

    # Verify setup
    assert payable.effective_creditor == "H3", "Effective creditor should be H3"
    assert payable.asset_holder_id == "H2", "Original creditor should be H2"

    # Get initial cash balances
    h1_cash_before = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H1"].asset_ids
        if sys.state.contracts[cid].kind == "cash"
    )
    h2_cash_before = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H2"].asset_ids
        if sys.state.contracts[cid].kind == "cash"
    )
    h3_cash_before = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H3"].asset_ids
        if sys.state.contracts[cid].kind == "cash"
    )

    # Run settlement
    run_day(sys)

    # Get final cash balances
    h1_cash_after = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H1"].asset_ids
        if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash"
    )
    h2_cash_after = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H2"].asset_ids
        if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash"
    )
    h3_cash_after = sum(
        sys.state.contracts[cid].amount
        for cid in sys.state.agents["H3"].asset_ids
        if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash"
    )

    # Verify H1 (debtor) paid 25
    assert h1_cash_after == h1_cash_before - 25, "Debtor should pay 25"

    # Verify H3 (holder) received 25, not H2 (original creditor)
    assert h3_cash_after == h3_cash_before + 25, "Current holder H3 should receive payment"
    assert h2_cash_after == h2_cash_before, "Original creditor H2 should NOT receive payment"

    # Verify payable was removed after settlement
    assert payable_id not in sys.state.contracts, "Payable should be removed after settlement"

    # Verify PayableSettled event logged with correct creditor
    settled_events = [e for e in sys.state.events if e.get("kind") == "PayableSettled"]
    assert len(settled_events) == 1, "Should have one PayableSettled event"
    # Note: This assertion may need adjustment based on what field is logged
    # The settlement code should log the effective_creditor, not asset_holder_id


def test_dealer_subsystem_disabled():
    """Test that trading phase returns empty list when disabled.

    Verifies:
    - Disabled subsystem doesn't execute trades
    - Returns empty event list
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)
    subsystem.enabled = False

    # Run trading phase on disabled subsystem
    events = run_dealer_trading_phase(subsystem, sys, current_day=0)

    # Should return empty list
    assert events == [], "Disabled subsystem should return no events"


def test_ticket_bucket_reassignment():
    """Test that tickets are reassigned to correct buckets as maturity approaches.

    Verifies:
    - Tickets move between buckets as remaining_tau decreases
    - Dealer/VBT inventories are updated correctly
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize subsystem
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)

    # Find the long-maturity ticket (tau=10 initially)
    long_ticket = None
    for ticket in subsystem.tickets.values():
        if ticket.remaining_tau == 10:
            long_ticket = ticket
            break

    assert long_ticket is not None, "Should find ticket with tau=10"
    assert long_ticket.bucket_id == "long", "Initial bucket should be 'long'"

    # Advance 5 days (tau goes from 10 to 5)
    # This should move ticket from 'long' to 'mid' bucket
    run_dealer_trading_phase(subsystem, sys, current_day=5)

    # Verify bucket changed
    assert long_ticket.remaining_tau == 5, "Remaining tau should be 5"
    assert long_ticket.bucket_id == "mid", "Ticket should now be in 'mid' bucket"

    # Advance 3 more days (tau goes from 5 to 2)
    # This should move ticket from 'mid' to 'short' bucket
    run_dealer_trading_phase(subsystem, sys, current_day=8)

    # Verify bucket changed again
    assert long_ticket.remaining_tau == 2, "Remaining tau should be 2"
    assert long_ticket.bucket_id == "short", "Ticket should now be in 'short' bucket"


def test_integration_multiple_days_with_dealer():
    """Integration test: run multiple days with dealer enabled.

    Verifies:
    - System runs multiple days without errors
    - Dealer subsystem updates each day
    - Payables settle when due
    - Events are logged correctly
    """
    sys = create_test_system_with_payables()
    config = create_dealer_config()

    # Initialize and attach dealer subsystem
    subsystem = initialize_dealer_subsystem(sys, config, current_day=0)
    sys.state.dealer_subsystem = subsystem

    initial_payable_count = len([c for c in sys.state.contracts.values() if c.kind == "payable"])
    assert initial_payable_count == 3, "Should start with 3 payables"

    # Run 5 days with dealer enabled
    for day in range(5):
        run_day(sys, enable_dealer=True)

    # Verify we're at day 5
    assert sys.state.day == 5, "Should be at day 5"

    # Verify dealer events logged each day
    dealer_events = [e for e in sys.state.events if e.get("kind") == "SubphaseB_Dealer"]
    assert len(dealer_events) == 5, "Should have dealer events for 5 days"

    # Verify at least one payable has settled (due_day=2)
    final_payable_count = len([c for c in sys.state.contracts.values() if c.kind == "payable"])
    assert final_payable_count < initial_payable_count, "Some payables should have settled"

    # Verify settlement events logged
    settled_events = [e for e in sys.state.events if e.get("kind") == "PayableSettled"]
    assert len(settled_events) >= 1, "Should have at least one settlement event"

    # System invariants should hold
    sys.assert_invariants()

```

---

### 🧪 tests/integration/test_settlement_phase_b.py

```python
import pytest
from bilancio.engines.system import System
from bilancio.engines.settlement import settle_due
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.household import Household
from bilancio.domain.instruments.credit import Payable
from bilancio.domain.policy import PolicyEngine
from bilancio.ops.banking import deposit_cash, client_payment
from bilancio.core.errors import DefaultError


def test_phase_b_same_bank_settlement():
    """Test Phase B settlement when debtor and creditor use the same bank."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has 200 deposit at B1
    sys.mint_cash("H1", 200)
    deposit_cash(sys, "H1", "B1", 200)
    
    # Create payable: H1 owes H2 amount 150, due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable", 
        amount=150,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Phase B: Settle due payables
    settle_due(sys, sys.state.day)
    
    # Check H1 deposit reduced by 150
    assert sys.total_deposit("H1", "B1") == 50
    
    # Check H2 deposit increased by 150
    assert sys.total_deposit("H2", "B1") == 150
    
    # Check payable was removed
    assert payable_id not in sys.state.contracts
    
    # Check PayableSettled event logged
    events = [e for e in sys.state.events if e["kind"] == "PayableSettled"]
    assert len(events) == 1
    assert events[0]["debtor"] == "H1"
    assert events[0]["creditor"] == "H2"
    assert events[0]["amount"] == 150
    
    # No ClientPayment event (same bank)
    client_payment_events = [e for e in sys.state.events if e["kind"] == "ClientPayment"]
    assert len(client_payment_events) == 0
    
    sys.assert_invariants()


def test_phase_b_cross_bank_settlement_logs_client_payment():
    """Test Phase B settlement logs ClientPayment when debtor and creditor use different banks."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has 300 deposit at B1, H2 has 1 deposit at B2 to establish bank relationship
    sys.mint_cash("H1", 300)
    sys.mint_cash("H2", 1)
    deposit_cash(sys, "H1", "B1", 300)
    deposit_cash(sys, "H2", "B2", 1)
    
    # Create payable: H1 owes H2 amount 100, due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=100, 
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Phase B: Settle due payables
    settle_due(sys, sys.state.day)
    
    # Check H1 deposit reduced by 100
    assert sys.total_deposit("H1", "B1") == 200
    
    # Check H2 deposit increased by 100 at B2 (1 initial + 100 from payment)
    assert sys.total_deposit("H2", "B2") == 101
    
    # Check payable was removed
    assert payable_id not in sys.state.contracts
    
    # Check ClientPayment event logged (cross-bank payment)
    client_payment_events = [e for e in sys.state.events if e["kind"] == "ClientPayment"]
    assert len(client_payment_events) == 1
    assert client_payment_events[0]["payer"] == "H1"
    assert client_payment_events[0]["payer_bank"] == "B1"
    assert client_payment_events[0]["payee"] == "H2"
    assert client_payment_events[0]["payee_bank"] == "B2"
    assert client_payment_events[0]["amount"] == 100
    
    sys.assert_invariants()


def test_phase_b_cash_fallback():
    """Test Phase B settlement uses cash when deposits insufficient but policy allows."""
    # Create custom policy that allows cash fallback for households
    custom_policy = PolicyEngine.default()
    custom_policy.mop_rank["household"] = ["bank_deposit", "cash"]
    
    sys = System(policy=custom_policy)
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has 60 deposit at B1 and 80 cash
    sys.mint_cash("H1", 140)
    deposit_cash(sys, "H1", "B1", 60)
    
    # Create payable: H1 owes H2 amount 100, due today (more than deposit)
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=100,
        denom="X",
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Phase B: Settle due payables
    settle_due(sys, sys.state.day)
    
    # Check H1 deposit is now 0 (used all 60)
    assert sys.total_deposit("H1", "B1") == 0
    
    # Check H1 cash reduced by 40 (100 - 60 from deposit)
    h1_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H1"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 40  # 80 - 40 used for payment
    
    # Check H2 has 60 deposit at B1 and 40 cash
    assert sys.total_deposit("H2", "B1") == 60  # from H1's deposit portion
    h2_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H2"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h2_cash == 40  # from H1's cash portion
    
    # Check payable was removed
    assert payable_id not in sys.state.contracts
    
    sys.assert_invariants()


def test_phase_b_default_on_insufficient_means():
    """Test Phase B settlement raises DefaultError when no sufficient funds available."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="Household 1", kind="household")
    h2 = Household(id="H2", name="Household 2", kind="household")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Setup: H1 has only 30 deposit at B1 and 20 cash = 50 total
    sys.mint_cash("H1", 50)
    deposit_cash(sys, "H1", "B1", 30)
    
    # Create payable: H1 owes H2 amount 100, due today (more than available)
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=100,
        denom="X", 
        asset_holder_id="H2",
        liability_issuer_id="H1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Phase B: Settle due payables should fail
    with pytest.raises(DefaultError, match="Insufficient funds to settle payable"):
        settle_due(sys, sys.state.day)
    
    # Check payable still exists (settlement failed)
    assert payable_id in sys.state.contracts
    assert sys.state.contracts[payable_id].amount == 100
    
    # Check balances unchanged
    assert sys.total_deposit("H1", "B1") == 30
    h1_cash = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["H1"].asset_ids 
                  if cid in sys.state.contracts and sys.state.contracts[cid].kind == "cash")
    assert h1_cash == 20
    
    sys.assert_invariants()


def test_phase_b_bank_to_bank_reserves():
    """Test Phase B settlement between banks using reserves."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    
    # Setup: B1 has 500 reserves
    sys.mint_reserves("B1", 500)
    
    # Create payable: B1 owes B2 amount 200, due today
    payable_id = sys.new_contract_id("P")
    payable = Payable(
        id=payable_id,
        kind="payable",
        amount=200,
        denom="X",
        asset_holder_id="B2", 
        liability_issuer_id="B1",
        due_day=sys.state.day
    )
    sys.add_contract(payable)
    
    # Phase B: Settle due payables
    settle_due(sys, sys.state.day)
    
    # Check B1 reserves reduced by 200
    b1_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B1"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b1_reserves == 300
    
    # Check B2 reserves increased by 200
    b2_reserves = sum(sys.state.contracts[cid].amount for cid in sys.state.agents["B2"].asset_ids 
                      if cid in sys.state.contracts and sys.state.contracts[cid].kind == "reserve_deposit")
    assert b2_reserves == 200
    
    # Check payable was removed
    assert payable_id not in sys.state.contracts
    
    # Check PayableSettled event logged
    events = [e for e in sys.state.events if e["kind"] == "PayableSettled"]
    assert len(events) == 1
    assert events[0]["debtor"] == "B1"
    assert events[0]["creditor"] == "B2"
    assert events[0]["amount"] == 200
    
    sys.assert_invariants()
```

---

### 🧪 tests/ops/test_alias_helpers.py

```python
from bilancio.engines.system import System
from bilancio.ops.aliases import get_alias_for_id, get_id_for_alias


def test_alias_helpers_roundtrip():
    sys = System()
    sys.state.aliases["AL1"] = "C_001"
    assert get_id_for_alias(sys, "AL1") == "C_001"
    assert get_alias_for_id(sys, "C_001") == "AL1"
    assert get_id_for_alias(sys, "MISSING") is None
    assert get_alias_for_id(sys, "C_XXX") is None


```

---

### 🧪 tests/runners/__init__.py

```python
# Tests for bilancio.runners module

```

---

### 🧪 tests/runners/test_local_executor.py

```python
"""Tests for LocalExecutor simulation execution.

This module tests:
- Basic execution and result handling
- Output file creation
- Error handling
- Directory management

Note: Metrics computation is NOT tested here because LocalExecutor
no longer computes metrics. That's MetricsComputer's job.
"""

from __future__ import annotations

from pathlib import Path
from typing import Dict, Any

import pytest

from bilancio.runners.local_executor import LocalExecutor
from bilancio.runners.models import RunOptions, ExecutionResult
from bilancio.storage.models import RunStatus


# Minimal scenario configuration for testing
MINIMAL_SCENARIO: Dict[str, Any] = {
    "version": 1,
    "name": "Test Scenario",
    "description": "Minimal test scenario",
    "agents": [
        {"id": "bank", "kind": "bank", "name": "Test Bank"},
        {"id": "firm1", "kind": "firm", "name": "Test Firm 1"},
        {"id": "firm2", "kind": "firm", "name": "Test Firm 2"},
    ],
    "initial_actions": [],
    "run": {"max_days": 5},
}

# Scenario with activity that produces events
SCENARIO_WITH_ACTIVITY: Dict[str, Any] = {
    "version": 1,
    "name": "Activity Test Scenario",
    "description": "Scenario with payment activity to generate events",
    "agents": [
        {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
        {"id": "bank", "kind": "bank", "name": "Test Bank"},
        {"id": "firm1", "kind": "firm", "name": "Test Firm 1"},
        {"id": "firm2", "kind": "firm", "name": "Test Firm 2"},
    ],
    "initial_actions": [
        {"mint_reserves": {"to": "bank", "amount": 10000}},
        {"mint_cash": {"to": "firm1", "amount": 2000}},
        {"mint_cash": {"to": "firm2", "amount": 1500}},
        {"deposit_cash": {"customer": "firm1", "bank": "bank", "amount": 1800}},
        {"deposit_cash": {"customer": "firm2", "bank": "bank", "amount": 1000}},
        {"create_payable": {"from": "firm1", "to": "firm2", "amount": 500, "due_day": 1}},
    ],
    "run": {"max_days": 10},
}


class TestLocalExecutorBasicExecution:
    """Tests for basic LocalExecutor.execute functionality."""

    @pytest.mark.slow
    def test_execute_returns_execution_result(self, tmp_path: Path):
        """execute() returns an ExecutionResult object."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_basic_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert isinstance(result, ExecutionResult)
        assert result.run_id == "test_basic_001"

    @pytest.mark.slow
    def test_execute_simple_scenario_returns_completed_status(self, tmp_path: Path):
        """execute() with valid scenario returns COMPLETED status."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_completed_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.status == RunStatus.COMPLETED
        assert result.error is None

    @pytest.mark.slow
    def test_execute_populates_execution_time(self, tmp_path: Path):
        """execute() populates execution_time_ms."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_time_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.execution_time_ms is not None
        assert result.execution_time_ms > 0

    @pytest.mark.slow
    def test_execute_returns_local_storage_type(self, tmp_path: Path):
        """execute() returns storage_type='local'."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_storage_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.storage_type == "local"

    @pytest.mark.slow
    def test_execute_returns_absolute_storage_base(self, tmp_path: Path):
        """execute() returns absolute path as storage_base."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_storage_base_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.storage_base == str(tmp_path.resolve())


class TestLocalExecutorOutputFiles:
    """Tests for output file creation."""

    @pytest.mark.slow
    def test_execute_creates_scenario_yaml(self, tmp_path: Path):
        """execute() creates scenario.yaml file."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_yaml_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        scenario_path = tmp_path / "scenario.yaml"
        assert scenario_path.exists()
        assert result.artifacts.get("scenario_yaml") == "scenario.yaml"

    @pytest.mark.slow
    def test_execute_creates_exports_directory(self, tmp_path: Path):
        """execute() creates out/ exports directory."""
        executor = LocalExecutor()
        executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_exports_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        exports_dir = tmp_path / "out"
        assert exports_dir.exists()
        assert exports_dir.is_dir()

    @pytest.mark.slow
    def test_execute_creates_balances_csv(self, tmp_path: Path):
        """execute() creates balances.csv file."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_balances_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        balances_path = tmp_path / "out" / "balances.csv"
        assert balances_path.exists()
        assert result.artifacts.get("balances_csv") == "out/balances.csv"

    @pytest.mark.slow
    def test_execute_creates_events_jsonl(self, tmp_path: Path):
        """execute() creates events.jsonl file."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_events_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        events_path = tmp_path / "out" / "events.jsonl"
        assert events_path.exists()
        assert result.artifacts.get("events_jsonl") == "out/events.jsonl"

    @pytest.mark.slow
    def test_execute_creates_run_html(self, tmp_path: Path):
        """execute() creates run.html file."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_html_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        html_path = tmp_path / "run.html"
        assert html_path.exists()
        assert result.artifacts.get("run_html") == "run.html"

    @pytest.mark.slow
    def test_artifacts_are_relative_paths(self, tmp_path: Path):
        """execute() returns artifacts as relative paths."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_relative_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        # All artifact paths should be relative (not starting with /)
        for key, path in result.artifacts.items():
            assert not path.startswith("/"), f"Artifact {key} should be relative: {path}"


class TestLocalExecutorErrorHandling:
    """Tests for error handling in LocalExecutor."""

    @pytest.mark.slow
    def test_execute_returns_failed_status_on_invalid_scenario(self, tmp_path: Path):
        """execute() returns FAILED status when scenario is invalid."""
        executor = LocalExecutor()

        # Invalid scenario - missing required fields
        invalid_scenario: Dict[str, Any] = {
            "agents": "not_a_list",  # Should be a list
            "setup": [],
        }

        result = executor.execute(
            scenario_config=invalid_scenario,
            run_id="test_failed_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.status == RunStatus.FAILED

    @pytest.mark.slow
    def test_execute_returns_error_message_on_failure(self, tmp_path: Path):
        """execute() includes error message when simulation fails."""
        executor = LocalExecutor()

        # Invalid scenario configuration
        invalid_scenario: Dict[str, Any] = {
            "agents": [{"id": "bank"}],  # Missing 'kind'
            "setup": [],
        }

        result = executor.execute(
            scenario_config=invalid_scenario,
            run_id="test_error_msg_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.status == RunStatus.FAILED
        assert result.error is not None
        assert len(result.error) > 0

    @pytest.mark.slow
    def test_execute_records_execution_time_on_failure(self, tmp_path: Path):
        """execute() records execution_time_ms even on failure."""
        executor = LocalExecutor()

        invalid_scenario: Dict[str, Any] = {
            "agents": "invalid",
            "setup": [],
        }

        result = executor.execute(
            scenario_config=invalid_scenario,
            run_id="test_time_fail_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.execution_time_ms is not None
        assert result.execution_time_ms >= 0

    @pytest.mark.slow
    def test_failed_execution_still_includes_scenario_yaml(self, tmp_path: Path):
        """execute() includes scenario_yaml artifact even on failure."""
        executor = LocalExecutor()

        invalid_scenario: Dict[str, Any] = {
            "agents": "invalid",
            "setup": [],
        }

        result = executor.execute(
            scenario_config=invalid_scenario,
            run_id="test_yaml_fail_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        # scenario.yaml should still be written and referenced
        assert "scenario_yaml" in result.artifacts
        scenario_path = tmp_path / result.artifacts["scenario_yaml"]
        assert scenario_path.exists()


class TestLocalExecutorDirectoryManagement:
    """Tests for output directory management."""

    @pytest.mark.slow
    def test_output_dir_parameter_is_respected(self, tmp_path: Path):
        """execute() uses provided output_dir."""
        executor = LocalExecutor()
        custom_dir = tmp_path / "custom_output"
        custom_dir.mkdir()

        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_custom_dir_001",
            output_dir=custom_dir,
            options=RunOptions(max_days=5),
        )

        # storage_base should be the custom directory
        assert str(custom_dir.resolve()) in result.storage_base

    @pytest.mark.slow
    def test_output_dir_created_if_not_exists(self, tmp_path: Path):
        """execute() creates output_dir if it doesn't exist."""
        executor = LocalExecutor()
        new_dir = tmp_path / "new_output_dir"

        # Directory should not exist yet
        assert not new_dir.exists()

        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_create_dir_001",
            output_dir=new_dir,
            options=RunOptions(max_days=5),
        )

        # Directory should now exist
        assert new_dir.exists()
        assert result.status == RunStatus.COMPLETED

    @pytest.mark.slow
    def test_nested_output_dir_created(self, tmp_path: Path):
        """execute() creates nested output directories."""
        executor = LocalExecutor()
        nested_dir = tmp_path / "level1" / "level2" / "level3"

        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_nested_dir_001",
            output_dir=nested_dir,
            options=RunOptions(max_days=5),
        )

        assert nested_dir.exists()
        assert result.status == RunStatus.COMPLETED


class TestLocalExecutorRunIdHandling:
    """Tests for run_id handling in results."""

    @pytest.mark.slow
    def test_run_id_preserved_in_result(self, tmp_path: Path):
        """execute() preserves run_id in result."""
        executor = LocalExecutor()
        custom_run_id = "unique_run_id_12345"

        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id=custom_run_id,
            output_dir=tmp_path,
            options=RunOptions(max_days=5),
        )

        assert result.run_id == custom_run_id


class TestLocalExecutorRunOptions:
    """Tests for RunOptions parameter handling."""

    @pytest.mark.slow
    def test_options_max_days_is_used(self, tmp_path: Path):
        """execute() uses max_days from RunOptions."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_options_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=3),
        )

        assert result.status == RunStatus.COMPLETED

    @pytest.mark.slow
    def test_options_mode_is_used(self, tmp_path: Path):
        """execute() uses mode from RunOptions."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_mode_001",
            output_dir=tmp_path,
            options=RunOptions(mode="until_stable", max_days=5),
        )

        assert result.status == RunStatus.COMPLETED

    @pytest.mark.slow
    def test_default_options_work(self, tmp_path: Path):
        """execute() works with default RunOptions."""
        executor = LocalExecutor()
        result = executor.execute(
            scenario_config=MINIMAL_SCENARIO,
            run_id="test_defaults_001",
            output_dir=tmp_path,
            options=RunOptions(),
        )

        assert result.status == RunStatus.COMPLETED


class TestLocalExecutorScenarioWithActivity:
    """Tests with scenarios that have actual activity."""

    @pytest.mark.slow
    def test_scenario_with_obligations_produces_events(self, tmp_path: Path):
        """Scenario with setup events produces events.jsonl."""
        executor = LocalExecutor()

        result = executor.execute(
            scenario_config=SCENARIO_WITH_ACTIVITY,
            run_id="test_activity_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=10),
        )

        assert result.status == RunStatus.COMPLETED
        # Events file should be created
        events_path = tmp_path / "out" / "events.jsonl"
        assert events_path.exists()
        # And it should have content
        assert events_path.stat().st_size > 0

    @pytest.mark.slow
    def test_result_artifacts_are_relative(self, tmp_path: Path):
        """execute() returns artifacts as relative paths for active scenario."""
        executor = LocalExecutor()

        result = executor.execute(
            scenario_config=SCENARIO_WITH_ACTIVITY,
            run_id="test_artifacts_001",
            output_dir=tmp_path,
            options=RunOptions(max_days=10),
        )

        assert isinstance(result, ExecutionResult)

        # All artifact paths should be relative
        for key, path in result.artifacts.items():
            assert not path.startswith("/"), f"{key} should be relative"
            # And should resolve to existing files
            full_path = tmp_path / path
            assert full_path.exists(), f"{key} at {path} should exist"

```

---

### 🧪 tests/runners/test_models.py

```python
"""Tests for runner data models."""

import pytest

from bilancio.runners.models import RunOptions, ExecutionResult
from bilancio.storage.models import RunStatus


class TestRunOptionsDefaults:
    """Tests for RunOptions default values."""

    def test_mode_defaults_to_until_stable(self):
        """mode defaults to 'until_stable'."""
        options = RunOptions()
        assert options.mode == "until_stable"

    def test_max_days_defaults_to_90(self):
        """max_days defaults to 90."""
        options = RunOptions()
        assert options.max_days == 90

    def test_quiet_days_defaults_to_2(self):
        """quiet_days defaults to 2."""
        options = RunOptions()
        assert options.quiet_days == 2

    def test_check_invariants_defaults_to_daily(self):
        """check_invariants defaults to 'daily'."""
        options = RunOptions()
        assert options.check_invariants == "daily"

    def test_default_handling_defaults_to_fail_fast(self):
        """default_handling defaults to 'fail-fast'."""
        options = RunOptions()
        assert options.default_handling == "fail-fast"

    def test_show_events_defaults_to_detailed(self):
        """show_events defaults to 'detailed'."""
        options = RunOptions()
        assert options.show_events == "detailed"

    def test_show_balances_defaults_to_none(self):
        """show_balances defaults to None."""
        options = RunOptions()
        assert options.show_balances is None

    def test_t_account_defaults_to_false(self):
        """t_account defaults to False."""
        options = RunOptions()
        assert options.t_account is False

    def test_detailed_dealer_logging_defaults_to_false(self):
        """detailed_dealer_logging defaults to False."""
        options = RunOptions()
        assert options.detailed_dealer_logging is False

    def test_run_id_defaults_to_none(self):
        """run_id defaults to None."""
        options = RunOptions()
        assert options.run_id is None

    def test_regime_defaults_to_none(self):
        """regime defaults to None."""
        options = RunOptions()
        assert options.regime is None


class TestRunOptionsCustomization:
    """Tests for customizing RunOptions."""

    def test_mode_can_be_customized(self):
        """mode can be set to custom value."""
        options = RunOptions(mode="fixed_days")
        assert options.mode == "fixed_days"

    def test_max_days_can_be_customized(self):
        """max_days can be set to custom value."""
        options = RunOptions(max_days=30)
        assert options.max_days == 30

    def test_quiet_days_can_be_customized(self):
        """quiet_days can be set to custom value."""
        options = RunOptions(quiet_days=5)
        assert options.quiet_days == 5

    def test_check_invariants_can_be_customized(self):
        """check_invariants can be set to custom value."""
        options = RunOptions(check_invariants="end")
        assert options.check_invariants == "end"

    def test_default_handling_can_be_customized(self):
        """default_handling can be set to custom value."""
        options = RunOptions(default_handling="continue")
        assert options.default_handling == "continue"

    def test_show_events_can_be_customized(self):
        """show_events can be set to custom value."""
        options = RunOptions(show_events="summary")
        assert options.show_events == "summary"

    def test_show_balances_can_be_customized(self):
        """show_balances can be set to list of agent names."""
        options = RunOptions(show_balances=["Bank1", "Firm1"])
        assert options.show_balances == ["Bank1", "Firm1"]

    def test_t_account_can_be_customized(self):
        """t_account can be set to True."""
        options = RunOptions(t_account=True)
        assert options.t_account is True

    def test_detailed_dealer_logging_can_be_customized(self):
        """detailed_dealer_logging can be set to True."""
        options = RunOptions(detailed_dealer_logging=True)
        assert options.detailed_dealer_logging is True

    def test_run_id_can_be_customized(self):
        """run_id can be set to custom value."""
        options = RunOptions(run_id="custom_run_001")
        assert options.run_id == "custom_run_001"

    def test_regime_can_be_customized(self):
        """regime can be set to custom value."""
        options = RunOptions(regime="baseline")
        assert options.regime == "baseline"

    def test_multiple_options_can_be_customized(self):
        """Multiple options can be customized at once."""
        options = RunOptions(
            mode="continuous",
            max_days=100,
            quiet_days=3,
            check_invariants="never",
            default_handling="continue",
            show_events="none",
            show_balances=["Bank1"],
            t_account=True,
            detailed_dealer_logging=True,
            run_id="test_run",
            regime="treatment",
        )

        assert options.mode == "continuous"
        assert options.max_days == 100
        assert options.quiet_days == 3
        assert options.check_invariants == "never"
        assert options.default_handling == "continue"
        assert options.show_events == "none"
        assert options.show_balances == ["Bank1"]
        assert options.t_account is True
        assert options.detailed_dealer_logging is True
        assert options.run_id == "test_run"
        assert options.regime == "treatment"


class TestExecutionResultCreation:
    """Tests for ExecutionResult creation."""

    def test_creation_with_all_required_fields(self):
        """ExecutionResult can be created with all required fields."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path/to/run",
        )

        assert result.run_id == "run_001"
        assert result.status == RunStatus.COMPLETED
        assert result.storage_type == "local"
        assert result.storage_base == "/path/to/run"

    def test_creation_with_failed_status(self):
        """ExecutionResult can be created with FAILED status."""
        result = ExecutionResult(
            run_id="run_fail",
            status=RunStatus.FAILED,
            storage_type="local",
            storage_base="/path/to/run",
            error="Simulation diverged",
        )

        assert result.status == RunStatus.FAILED
        assert result.error == "Simulation diverged"

    def test_creation_with_all_fields(self):
        """ExecutionResult can be created with all fields."""
        result = ExecutionResult(
            run_id="run_002",
            status=RunStatus.COMPLETED,
            storage_type="s3",
            storage_base="s3://bucket/prefix",
            artifacts={
                "events_jsonl": "out/events.jsonl",
                "balances_csv": "out/balances.csv",
            },
            error=None,
            execution_time_ms=5000,
        )

        assert result.run_id == "run_002"
        assert result.status == RunStatus.COMPLETED
        assert result.storage_type == "s3"
        assert result.storage_base == "s3://bucket/prefix"
        assert result.artifacts["events_jsonl"] == "out/events.jsonl"
        assert result.artifacts["balances_csv"] == "out/balances.csv"
        assert result.error is None
        assert result.execution_time_ms == 5000


class TestExecutionResultDefaults:
    """Tests for ExecutionResult default values."""

    def test_artifacts_defaults_to_empty_dict(self):
        """artifacts defaults to empty dict."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path",
        )
        assert result.artifacts == {}

    def test_error_defaults_to_none(self):
        """error defaults to None."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path",
        )
        assert result.error is None

    def test_execution_time_ms_defaults_to_none(self):
        """execution_time_ms defaults to None."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path",
        )
        assert result.execution_time_ms is None


class TestExecutionResultArtifacts:
    """Tests for ExecutionResult artifacts handling."""

    def test_artifacts_can_store_multiple_paths(self):
        """artifacts can store multiple artifact paths."""
        artifacts = {
            "scenario_yaml": "scenario.yaml",
            "events_jsonl": "out/events.jsonl",
            "balances_csv": "out/balances.csv",
            "run_html": "run.html",
            "metrics_csv": "out/metrics.csv",
        }

        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path",
            artifacts=artifacts,
        )

        assert len(result.artifacts) == 5
        assert result.artifacts["scenario_yaml"] == "scenario.yaml"
        assert result.artifacts["events_jsonl"] == "out/events.jsonl"

    def test_artifacts_can_be_modified(self):
        """artifacts dict can be modified after creation."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/path",
        )

        result.artifacts["new_artifact"] = "path/to/artifact"
        assert result.artifacts["new_artifact"] == "path/to/artifact"


class TestExecutionResultStorageTypes:
    """Tests for ExecutionResult storage type variants."""

    def test_local_storage_type(self):
        """ExecutionResult supports 'local' storage type."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="local",
            storage_base="/Users/test/experiments/run_001",
        )
        assert result.storage_type == "local"

    def test_s3_storage_type(self):
        """ExecutionResult supports 's3' storage type."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="s3",
            storage_base="s3://my-bucket/experiments/run_001",
        )
        assert result.storage_type == "s3"

    def test_gcs_storage_type(self):
        """ExecutionResult supports 'gcs' storage type."""
        result = ExecutionResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            storage_type="gcs",
            storage_base="gs://my-bucket/experiments/run_001",
        )
        assert result.storage_type == "gcs"

```

---

### 🧪 tests/runners/test_protocols.py

```python
"""Tests for simulation executor protocol definitions.

This module tests:
- Protocol structure validation
- Protocol conformance checking
"""

from __future__ import annotations

from pathlib import Path
from typing import Dict, Any, Optional

import pytest

from bilancio.runners.protocols import SimulationExecutor, JobExecutor
from bilancio.runners.local_executor import LocalExecutor
from bilancio.runners.models import RunOptions, ExecutionResult
from bilancio.storage.models import RunResult, RunStatus


class TestSimulationExecutorProtocol:
    """Tests for SimulationExecutor protocol definition."""

    def test_local_executor_is_instance_of_protocol(self):
        """LocalExecutor should satisfy SimulationExecutor protocol."""
        executor = LocalExecutor()
        assert isinstance(executor, SimulationExecutor)

    def test_protocol_has_execute_method(self):
        """SimulationExecutor protocol requires execute method."""
        # Check that the protocol has the execute method defined
        assert hasattr(SimulationExecutor, "execute")

    def test_custom_class_satisfying_protocol(self):
        """A custom class with execute method should satisfy the protocol."""

        class CustomExecutor:
            def execute(
                self,
                scenario_config: Dict[str, Any],
                run_id: str,
                output_dir: Path,
                options: RunOptions,
            ) -> ExecutionResult:
                return ExecutionResult(
                    run_id=run_id,
                    status=RunStatus.COMPLETED,
                    storage_type="local",
                    storage_base=str(output_dir),
                    artifacts={},
                )

        executor = CustomExecutor()
        assert isinstance(executor, SimulationExecutor)

    def test_class_missing_execute_does_not_satisfy_protocol(self):
        """A class without execute method should not satisfy the protocol."""

        class IncompleteExecutor:
            pass

        executor = IncompleteExecutor()
        assert not isinstance(executor, SimulationExecutor)

    def test_class_with_wrong_signature_still_satisfies_protocol(self):
        """Protocol checking is structural, not signature-exact at runtime."""
        # Note: Python's Protocol runtime checking only checks method existence,
        # not exact signatures. This is a known limitation.

        class WrongSignatureExecutor:
            def execute(self):
                pass

        executor = WrongSignatureExecutor()
        # This will still pass isinstance check because Python only checks
        # method existence at runtime, not the full signature
        assert isinstance(executor, SimulationExecutor)


class TestJobExecutorProtocol:
    """Tests for JobExecutor protocol definition."""

    def test_protocol_has_required_methods(self):
        """JobExecutor protocol requires submit, status, result, and cancel methods."""
        assert hasattr(JobExecutor, "submit")
        assert hasattr(JobExecutor, "status")
        assert hasattr(JobExecutor, "result")
        assert hasattr(JobExecutor, "cancel")

    def test_custom_class_satisfying_job_executor_protocol(self):
        """A custom class with all required methods should satisfy the protocol."""

        class CustomJobExecutor:
            def submit(self, scenario_config: Dict[str, Any], run_id: str) -> str:
                return "job_123"

            def status(self, job_id: str) -> RunStatus:
                return RunStatus.RUNNING

            def result(self, job_id: str) -> Optional[RunResult]:
                return None

            def cancel(self, job_id: str) -> bool:
                return True

        executor = CustomJobExecutor()
        assert isinstance(executor, JobExecutor)

    def test_class_missing_method_does_not_satisfy_protocol(self):
        """A class missing any required method should not satisfy the protocol."""

        class IncompleteJobExecutor:
            def submit(self, scenario_config: Dict[str, Any], run_id: str) -> str:
                return "job_123"

            # Missing: status, result, cancel

        executor = IncompleteJobExecutor()
        assert not isinstance(executor, JobExecutor)

    def test_local_executor_does_not_satisfy_job_executor(self):
        """LocalExecutor should not satisfy JobExecutor protocol."""
        executor = LocalExecutor()
        assert not isinstance(executor, JobExecutor)

```

---

### 🧪 tests/scenarios/test_ring_explorer.py

```python
import json
from decimal import Decimal
from pathlib import Path

from bilancio.config.loaders import load_yaml
from bilancio.config.models import RingExplorerGeneratorConfig
from bilancio.scenarios import compile_ring_explorer


def _sum_amounts(actions, key):
    total = Decimal("0")
    for action in actions:
        if key in action:
            total += action[key]["amount"]
    return total


def _payable_amounts(actions):
    return [
        Decimal(str(action["create_payable"]["amount"]))
        for action in actions
        if "create_payable" in action
    ]


def test_compile_ring_explorer_basic(tmp_path):
    generator = RingExplorerGeneratorConfig.model_validate(
        {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": "Test Sweep",
            "params": {
                "n_agents": 4,
                "seed": 7,
                "kappa": "2",
                "Q_total": "400",
                "inequality": {"scheme": "dirichlet", "concentration": "1"},
                "maturity": {"days": 2, "mode": "lead_lag", "mu": "0"},
                "liquidity": {"allocation": {"mode": "single_at", "agent": "H1"}},
            },
            "compile": {"emit_yaml": False},
        }
    )

    scenario = compile_ring_explorer(generator, source_path=None)
    assert scenario["version"] == 1
    assert len(scenario["agents"]) == 5  # CB + 4 households

    S1 = _sum_amounts(scenario["initial_actions"], "create_payable")
    L0 = _sum_amounts(scenario["initial_actions"], "mint_cash")

    assert S1 == Decimal("400")
    assert L0 == Decimal("200")  # kappa = S1 / L0 -> 2

    due_days = [action["create_payable"]["due_day"] for action in scenario["initial_actions"] if "create_payable" in action]
    assert set(due_days) == {1}


def test_compile_ring_explorer_vector_allocation(tmp_path):
    generator = RingExplorerGeneratorConfig.model_validate(
        {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": "Vector Sweep",
            "params": {
                "n_agents": 3,
                "seed": 3,
                "kappa": "1.5",
                "Q_total": "150",
                "liquidity": {
                    "total": "120",
                    "allocation": {"mode": "vector", "vector": [1, 2, 3]},
                },
                "inequality": {"scheme": "dirichlet", "concentration": "2"},
                "maturity": {"days": 3, "mode": "lead_lag", "mu": "0.5"},
            },
            "compile": {"emit_yaml": False},
        }
    )

    scenario = compile_ring_explorer(generator, source_path=None)

    cash_actions = [action["mint_cash"] for action in scenario["initial_actions"] if "mint_cash" in action]
    amounts = [Decimal(str(entry["amount"])) for entry in cash_actions]
    assert len(amounts) == 3
    # Expect ratios 1:2:3 scaled to 120
    assert sum(amounts) == Decimal("120")
    assert amounts[1] > amounts[0]
    assert amounts[2] > amounts[1]


def test_load_yaml_compiles_generator(tmp_path):
    spec = {
        "version": 1,
        "generator": "ring_explorer_v1",
        "name_prefix": "Spec Sweep",
        "params": {
            "n_agents": 3,
            "seed": 9,
            "kappa": "1",
            "Q_total": "90",
            "inequality": {"scheme": "dirichlet", "concentration": "1"},
            "maturity": {"days": 2, "mode": "lead_lag", "mu": "1"},
            "liquidity": {"allocation": {"mode": "uniform"}},
        },
        "compile": {"emit_yaml": True, "out_dir": str(tmp_path)},
    }

    spec_path = tmp_path / "ring_spec.yaml"
    spec_path.write_text(json.dumps(spec))

    config = load_yaml(spec_path)
    assert config.name.startswith("Spec Sweep")
    assert len(config.initial_actions) > 0
    compiled_yaml = list(tmp_path.glob("*.yaml"))
    assert compiled_yaml, "expected emitted scenario YAML"


def test_monotonicity_extremes():
    base_params = {
        "n_agents": 5,
        "seed": 17,
        "kappa": "1",
        "Q_total": "500",
        "liquidity": {"allocation": {"mode": "uniform"}},
        "maturity": {"days": 2, "mode": "lead_lag", "mu": "0"},
    }

    descending = RingExplorerGeneratorConfig.model_validate(
        {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": "Mono Desc",
            "params": {
                **base_params,
                "inequality": {
                    "scheme": "dirichlet",
                    "concentration": "1",
                    "monotonicity": "1",
                },
            },
            "compile": {"emit_yaml": False},
        }
    )
    asc = RingExplorerGeneratorConfig.model_validate(
        {
            "version": 1,
            "generator": "ring_explorer_v1",
            "name_prefix": "Mono Asc",
            "params": {
                **base_params,
                "inequality": {
                    "scheme": "dirichlet",
                    "concentration": "1",
                    "monotonicity": "-1",
                },
            },
            "compile": {"emit_yaml": False},
        }
    )

    descending_amounts = _payable_amounts(compile_ring_explorer(descending, source_path=None)["initial_actions"])
    ascending_amounts = _payable_amounts(compile_ring_explorer(asc, source_path=None)["initial_actions"])

    assert descending_amounts == sorted(descending_amounts, reverse=True)
    assert ascending_amounts == sorted(ascending_amounts, reverse=False)
    assert all(amount > Decimal("0") for amount in descending_amounts)
    assert all(amount > Decimal("0") for amount in ascending_amounts)

```

---

### 🧪 tests/storage/__init__.py

```python

```

---

### 🧪 tests/storage/test_artifact_loaders.py

```python
"""Tests for artifact loader implementations."""

import pytest
from pathlib import Path

from bilancio.storage.artifact_loaders import ArtifactLoader, LocalArtifactLoader


class TestLocalArtifactLoaderLoadText:
    """Tests for LocalArtifactLoader.load_text()."""

    def test_load_text_returns_file_contents(self, tmp_path: Path):
        """load_text() returns text content of a file."""
        test_file = tmp_path / "test.txt"
        test_file.write_text("Hello, World!")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_text("test.txt")

        assert result == "Hello, World!"

    def test_load_text_handles_unicode(self, tmp_path: Path):
        """load_text() correctly handles unicode content."""
        test_file = tmp_path / "unicode.txt"
        test_file.write_text("Hello, \u4e16\u754c! \u00e9\u00e8\u00ea")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_text("unicode.txt")

        assert result == "Hello, \u4e16\u754c! \u00e9\u00e8\u00ea"

    def test_load_text_handles_multiline_content(self, tmp_path: Path):
        """load_text() preserves multiline content."""
        test_file = tmp_path / "multiline.txt"
        content = "line1\nline2\nline3"
        test_file.write_text(content)

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_text("multiline.txt")

        assert result == content

    def test_load_text_raises_for_missing_file(self, tmp_path: Path):
        """load_text() raises FileNotFoundError for missing files."""
        loader = LocalArtifactLoader(tmp_path)

        with pytest.raises(FileNotFoundError):
            loader.load_text("nonexistent.txt")

    def test_load_text_nested_path(self, tmp_path: Path):
        """load_text() handles nested path references."""
        nested_dir = tmp_path / "subdir" / "deeper"
        nested_dir.mkdir(parents=True)
        test_file = nested_dir / "nested.txt"
        test_file.write_text("nested content")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_text("subdir/deeper/nested.txt")

        assert result == "nested content"


class TestLocalArtifactLoaderLoadBytes:
    """Tests for LocalArtifactLoader.load_bytes()."""

    def test_load_bytes_returns_file_contents(self, tmp_path: Path):
        """load_bytes() returns binary content of a file."""
        test_file = tmp_path / "test.bin"
        test_file.write_bytes(b"\x00\x01\x02\x03")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_bytes("test.bin")

        assert result == b"\x00\x01\x02\x03"

    def test_load_bytes_handles_text_files(self, tmp_path: Path):
        """load_bytes() can read text files as bytes."""
        test_file = tmp_path / "text.txt"
        test_file.write_text("Hello, World!")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_bytes("text.txt")

        assert result == b"Hello, World!"

    def test_load_bytes_raises_for_missing_file(self, tmp_path: Path):
        """load_bytes() raises FileNotFoundError for missing files."""
        loader = LocalArtifactLoader(tmp_path)

        with pytest.raises(FileNotFoundError):
            loader.load_bytes("nonexistent.bin")

    def test_load_bytes_nested_path(self, tmp_path: Path):
        """load_bytes() handles nested path references."""
        nested_dir = tmp_path / "data"
        nested_dir.mkdir()
        test_file = nested_dir / "file.bin"
        test_file.write_bytes(b"\xff\xfe")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.load_bytes("data/file.bin")

        assert result == b"\xff\xfe"


class TestLocalArtifactLoaderExists:
    """Tests for LocalArtifactLoader.exists()."""

    def test_exists_returns_true_for_existing_file(self, tmp_path: Path):
        """exists() returns True when file exists."""
        test_file = tmp_path / "exists.txt"
        test_file.write_text("content")

        loader = LocalArtifactLoader(tmp_path)
        result = loader.exists("exists.txt")

        assert result is True

    def test_exists_returns_false_for_missing_file(self, tmp_path: Path):
        """exists() returns False when file does not exist."""
        loader = LocalArtifactLoader(tmp_path)
        result = loader.exists("nonexistent.txt")

        assert result is False

    def test_exists_handles_nested_paths(self, tmp_path: Path):
        """exists() handles nested path references."""
        nested_dir = tmp_path / "subdir"
        nested_dir.mkdir()
        test_file = nested_dir / "file.txt"
        test_file.write_text("content")

        loader = LocalArtifactLoader(tmp_path)

        assert loader.exists("subdir/file.txt") is True
        assert loader.exists("subdir/missing.txt") is False

    def test_exists_returns_false_for_directory(self, tmp_path: Path):
        """exists() returns True for directory (matches Path.exists behavior)."""
        subdir = tmp_path / "subdir"
        subdir.mkdir()

        loader = LocalArtifactLoader(tmp_path)
        # Note: Path.exists() returns True for directories
        assert loader.exists("subdir") is True


class TestLocalArtifactLoaderInit:
    """Tests for LocalArtifactLoader initialization."""

    def test_init_stores_base_path(self, tmp_path: Path):
        """__init__ stores base_path as Path object."""
        loader = LocalArtifactLoader(tmp_path)
        assert loader.base_path == tmp_path

    def test_init_converts_string_to_path(self, tmp_path: Path):
        """__init__ converts string path to Path object."""
        loader = LocalArtifactLoader(str(tmp_path))
        assert isinstance(loader.base_path, Path)
        assert loader.base_path == tmp_path

    def test_base_path_not_required_to_exist(self):
        """__init__ does not require base_path to exist."""
        # This should not raise
        loader = LocalArtifactLoader(Path("/nonexistent/path"))
        assert loader.base_path == Path("/nonexistent/path")


class TestLocalArtifactLoaderProtocol:
    """Tests for LocalArtifactLoader implementing ArtifactLoader protocol."""

    def test_implements_artifact_loader_protocol(self, tmp_path: Path):
        """LocalArtifactLoader implements ArtifactLoader protocol."""
        loader = LocalArtifactLoader(tmp_path)
        # ArtifactLoader is a runtime_checkable Protocol
        assert isinstance(loader, ArtifactLoader)

    def test_has_load_text_method(self, tmp_path: Path):
        """LocalArtifactLoader has load_text method."""
        loader = LocalArtifactLoader(tmp_path)
        assert hasattr(loader, "load_text")
        assert callable(loader.load_text)

    def test_has_load_bytes_method(self, tmp_path: Path):
        """LocalArtifactLoader has load_bytes method."""
        loader = LocalArtifactLoader(tmp_path)
        assert hasattr(loader, "load_bytes")
        assert callable(loader.load_bytes)

    def test_has_exists_method(self, tmp_path: Path):
        """LocalArtifactLoader has exists method."""
        loader = LocalArtifactLoader(tmp_path)
        assert hasattr(loader, "exists")
        assert callable(loader.exists)

```

---

### 🧪 tests/storage/test_file_store.py

```python
"""Tests for file-based storage implementations."""

import json
import csv
import pytest
from pathlib import Path

from bilancio.storage.models import (
    RunStatus,
    RunArtifacts,
    RunResult,
    RegistryEntry,
)
from bilancio.storage.file_store import FileResultStore, FileRegistryStore


class TestFileResultStore:
    """Tests for FileResultStore."""

    def test_init_creates_base_dir(self, tmp_path):
        """Test that initialization creates the base directory."""
        base_dir = tmp_path / "results"
        assert not base_dir.exists()
        store = FileResultStore(base_dir)
        assert base_dir.exists()

    def test_init_accepts_string_path(self, tmp_path):
        """Test that initialization accepts string path."""
        base_dir = str(tmp_path / "results")
        store = FileResultStore(base_dir)
        assert Path(base_dir).exists()

    def test_save_artifact_creates_correct_structure(self, tmp_path):
        """Test that save_artifact creates correct directory structure."""
        store = FileResultStore(tmp_path)
        content = b"test content"

        store.save_artifact(
            experiment_id="exp_001",
            run_id="run_001",
            name="events.jsonl",
            content=content,
        )

        # Check that the file exists in the correct location
        expected_path = tmp_path / "exp_001" / "runs" / "run_001" / "out" / "events.jsonl"
        assert expected_path.exists()
        assert expected_path.read_bytes() == content

    def test_save_artifact_scenario_yaml_at_run_level(self, tmp_path):
        """Test that scenario.yaml is saved at run level, not in out/."""
        store = FileResultStore(tmp_path)
        content = b"scenario: test"

        store.save_artifact(
            experiment_id="exp_001",
            run_id="run_001",
            name="scenario.yaml",
            content=content,
        )

        # scenario.yaml should be at run level, not in out/
        expected_path = tmp_path / "exp_001" / "runs" / "run_001" / "scenario.yaml"
        assert expected_path.exists()
        out_path = tmp_path / "exp_001" / "runs" / "run_001" / "out" / "scenario.yaml"
        assert not out_path.exists()

    def test_save_artifact_returns_relative_path(self, tmp_path):
        """Test that save_artifact returns correct relative path."""
        store = FileResultStore(tmp_path)

        rel_path = store.save_artifact(
            experiment_id="exp_001",
            run_id="run_001",
            name="events.jsonl",
            content=b"test",
        )

        assert rel_path == "exp_001/runs/run_001/out/events.jsonl"

    def test_save_artifact_scenario_returns_relative_path(self, tmp_path):
        """Test that save_artifact returns correct relative path for scenario."""
        store = FileResultStore(tmp_path)

        rel_path = store.save_artifact(
            experiment_id="exp_001",
            run_id="run_001",
            name="scenario.yaml",
            content=b"test",
        )

        assert rel_path == "exp_001/runs/run_001/scenario.yaml"

    def test_save_run_creates_result_json(self, tmp_path):
        """Test that save_run creates result.json with correct format."""
        store = FileResultStore(tmp_path)
        result = RunResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "kappa": 0.1},
            metrics={"phi_total": 100.0},
            artifacts=RunArtifacts(scenario_yaml="exp/runs/run_001/scenario.yaml"),
            execution_time_ms=5000,
        )

        store.save_run("exp_001", result)

        result_path = tmp_path / "exp_001" / "runs" / "run_001" / "result.json"
        assert result_path.exists()

        data = json.loads(result_path.read_text())
        assert data["run_id"] == "run_001"
        assert data["status"] == "completed"
        assert data["parameters"] == {"seed": 42, "kappa": 0.1}
        assert data["metrics"] == {"phi_total": 100.0}
        assert data["artifacts"]["scenario_yaml"] == "exp/runs/run_001/scenario.yaml"
        assert data["execution_time_ms"] == 5000
        assert data["error"] is None

    def test_save_run_with_error(self, tmp_path):
        """Test that save_run correctly saves error field."""
        store = FileResultStore(tmp_path)
        result = RunResult(
            run_id="run_fail",
            status=RunStatus.FAILED,
            error="Simulation diverged",
        )

        store.save_run("exp_001", result)

        result_path = tmp_path / "exp_001" / "runs" / "run_fail" / "result.json"
        data = json.loads(result_path.read_text())
        assert data["status"] == "failed"
        assert data["error"] == "Simulation diverged"

    def test_load_run_returns_none_for_nonexistent(self, tmp_path):
        """Test that load_run returns None for non-existent run."""
        store = FileResultStore(tmp_path)
        result = store.load_run("exp_001", "nonexistent_run")
        assert result is None

    def test_load_run_returns_none_for_nonexistent_experiment(self, tmp_path):
        """Test that load_run returns None for non-existent experiment."""
        store = FileResultStore(tmp_path)
        result = store.load_run("nonexistent_exp", "run_001")
        assert result is None

    def test_load_run_correctly_deserializes(self, tmp_path):
        """Test that load_run correctly deserializes saved run."""
        store = FileResultStore(tmp_path)
        original = RunResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "kappa": 0.1},
            metrics={"phi_total": 100.0, "delta_total": 50.0},
            artifacts=RunArtifacts(
                scenario_yaml="exp/runs/run_001/scenario.yaml",
                events_jsonl="exp/runs/run_001/out/events.jsonl",
            ),
            execution_time_ms=5000,
        )

        store.save_run("exp_001", original)
        loaded = store.load_run("exp_001", "run_001")

        assert loaded is not None
        assert loaded.run_id == original.run_id
        assert loaded.status == original.status
        assert loaded.parameters == original.parameters
        assert loaded.metrics == original.metrics
        assert loaded.artifacts.scenario_yaml == original.artifacts.scenario_yaml
        assert loaded.artifacts.events_jsonl == original.artifacts.events_jsonl
        assert loaded.execution_time_ms == original.execution_time_ms

    def test_load_artifact_returns_correct_content(self, tmp_path):
        """Test that load_artifact returns correct content."""
        store = FileResultStore(tmp_path)
        content = b"test artifact content"

        rel_path = store.save_artifact(
            experiment_id="exp_001",
            run_id="run_001",
            name="events.jsonl",
            content=content,
        )

        loaded_content = store.load_artifact(rel_path)
        assert loaded_content == content

    def test_roundtrip_save_then_load(self, tmp_path):
        """Test complete round-trip: save then load preserves all data."""
        store = FileResultStore(tmp_path)

        # Save artifacts
        scenario_content = b"agents:\n  - name: Bank1"
        events_content = b'{"day": 1, "event": "payment"}\n'

        scenario_path = store.save_artifact(
            "exp_001", "run_001", "scenario.yaml", scenario_content
        )
        events_path = store.save_artifact(
            "exp_001", "run_001", "events.jsonl", events_content
        )

        # Save run result
        original = RunResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "kappa": 0.15, "n_agents": 10},
            metrics={"phi_total": 150.0, "delta_total": 75.0, "time_to_stability": 5},
            artifacts=RunArtifacts(
                scenario_yaml=scenario_path,
                events_jsonl=events_path,
            ),
            execution_time_ms=10000,
        )
        store.save_run("exp_001", original)

        # Load everything back
        loaded = store.load_run("exp_001", "run_001")
        loaded_scenario = store.load_artifact(loaded.artifacts.scenario_yaml)
        loaded_events = store.load_artifact(loaded.artifacts.events_jsonl)

        # Verify everything matches
        assert loaded.run_id == original.run_id
        assert loaded.status == original.status
        assert loaded.parameters == original.parameters
        assert loaded.metrics == original.metrics
        assert loaded.execution_time_ms == original.execution_time_ms
        assert loaded_scenario == scenario_content
        assert loaded_events == events_content


class TestFileRegistryStore:
    """Tests for FileRegistryStore."""

    def test_upsert_creates_registry_file_and_directory(self, tmp_path):
        """Test that upsert creates registry file and directory structure."""
        store = FileRegistryStore(tmp_path)
        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
        )

        store.upsert(entry)

        registry_path = tmp_path / "exp_001" / "registry" / "experiments.csv"
        assert registry_path.exists()

    def test_upsert_updates_existing_entry(self, tmp_path):
        """Test that upsert updates existing entry (not duplicates)."""
        store = FileRegistryStore(tmp_path)

        # First upsert
        entry1 = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.RUNNING,
            parameters={"seed": 42},
        )
        store.upsert(entry1)

        # Second upsert with same run_id
        entry2 = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42},
            metrics={"phi_total": 100.0},
        )
        store.upsert(entry2)

        # Should only have one entry
        run_ids = store.list_runs("exp_001")
        assert len(run_ids) == 1
        assert run_ids[0] == "run_001"

        # Entry should be updated
        loaded = store.get("exp_001", "run_001")
        assert loaded.status == RunStatus.COMPLETED

    def test_get_returns_none_for_nonexistent_entry(self, tmp_path):
        """Test that get returns None for non-existent entry."""
        store = FileRegistryStore(tmp_path)
        result = store.get("exp_001", "nonexistent_run")
        assert result is None

    def test_get_returns_none_for_nonexistent_experiment(self, tmp_path):
        """Test that get returns None for non-existent experiment."""
        store = FileRegistryStore(tmp_path)
        result = store.get("nonexistent_exp", "run_001")
        assert result is None

    def test_get_returns_correct_entry(self, tmp_path):
        """Test that get returns correct entry."""
        store = FileRegistryStore(tmp_path)
        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "kappa": 0.1},
            metrics={"phi_total": 100.0},
            artifact_paths={"scenario_yaml": "exp_001/runs/run_001/scenario.yaml"},
        )
        store.upsert(entry)

        loaded = store.get("exp_001", "run_001")

        assert loaded is not None
        assert loaded.run_id == "run_001"
        assert loaded.experiment_id == "exp_001"
        assert loaded.status == RunStatus.COMPLETED
        assert loaded.parameters["seed"] == 42

    def test_list_runs_returns_all_run_ids(self, tmp_path):
        """Test that list_runs returns all run IDs."""
        store = FileRegistryStore(tmp_path)

        # Add multiple entries
        for i in range(5):
            entry = RegistryEntry(
                run_id=f"run_{i:03d}",
                experiment_id="exp_001",
                status=RunStatus.COMPLETED,
            )
            store.upsert(entry)

        run_ids = store.list_runs("exp_001")

        assert len(run_ids) == 5
        assert set(run_ids) == {"run_000", "run_001", "run_002", "run_003", "run_004"}

    def test_list_runs_returns_empty_for_nonexistent_experiment(self, tmp_path):
        """Test that list_runs returns empty list for non-existent experiment."""
        store = FileRegistryStore(tmp_path)
        run_ids = store.list_runs("nonexistent_exp")
        assert run_ids == []

    def test_get_completed_keys_returns_correct_keys(self, tmp_path):
        """Test that get_completed_keys returns correct keys."""
        store = FileRegistryStore(tmp_path)

        # Add some completed entries
        for seed in [1, 2, 3]:
            for kappa in [0.1, 0.2]:
                entry = RegistryEntry(
                    run_id=f"run_s{seed}_k{kappa}",
                    experiment_id="exp_001",
                    status=RunStatus.COMPLETED,
                    parameters={"seed": seed, "kappa": kappa, "concentration": 0.5},
                )
                store.upsert(entry)

        completed = store.get_completed_keys("exp_001")

        # Default key_fields is ["seed", "kappa", "concentration"]
        assert len(completed) == 6
        assert (1, 0.1, 0.5) in completed
        assert (2, 0.2, 0.5) in completed

    def test_get_completed_keys_excludes_non_completed(self, tmp_path):
        """Test that get_completed_keys excludes non-completed runs."""
        store = FileRegistryStore(tmp_path)

        # Add completed entry
        entry1 = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 1, "kappa": 0.1, "concentration": 0.5},
        )
        store.upsert(entry1)

        # Add failed entry
        entry2 = RegistryEntry(
            run_id="run_002",
            experiment_id="exp_001",
            status=RunStatus.FAILED,
            parameters={"seed": 2, "kappa": 0.1, "concentration": 0.5},
        )
        store.upsert(entry2)

        completed = store.get_completed_keys("exp_001")

        assert len(completed) == 1
        assert (1, 0.1, 0.5) in completed
        assert (2, 0.1, 0.5) not in completed

    def test_get_completed_keys_with_custom_key_fields(self, tmp_path):
        """Test that get_completed_keys works with custom key_fields."""
        store = FileRegistryStore(tmp_path)

        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "n_agents": 10, "mu": 0.5},
        )
        store.upsert(entry)

        completed = store.get_completed_keys("exp_001", key_fields=["seed", "n_agents"])

        assert len(completed) == 1
        assert (42, 10) in completed

    def test_get_completed_keys_returns_empty_for_nonexistent(self, tmp_path):
        """Test that get_completed_keys returns empty set for non-existent experiment."""
        store = FileRegistryStore(tmp_path)
        completed = store.get_completed_keys("nonexistent_exp")
        assert completed == set()

    def test_query_with_no_filters_returns_all(self, tmp_path):
        """Test that query with no filters returns all entries."""
        store = FileRegistryStore(tmp_path)

        # Add multiple entries with different statuses
        for i, status in enumerate([RunStatus.COMPLETED, RunStatus.FAILED, RunStatus.COMPLETED]):
            entry = RegistryEntry(
                run_id=f"run_{i:03d}",
                experiment_id="exp_001",
                status=status,
            )
            store.upsert(entry)

        results = store.query("exp_001")

        assert len(results) == 3
        run_ids = {r.run_id for r in results}
        assert run_ids == {"run_000", "run_001", "run_002"}

    def test_query_with_filters_returns_matching(self, tmp_path):
        """Test that query with filters returns matching entries only."""
        store = FileRegistryStore(tmp_path)

        # Add entries with different parameters
        for seed in [1, 2, 3]:
            for kappa in [0.1, 0.2]:
                entry = RegistryEntry(
                    run_id=f"run_s{seed}_k{kappa}",
                    experiment_id="exp_001",
                    status=RunStatus.COMPLETED,
                    parameters={"seed": seed, "kappa": kappa},
                )
                store.upsert(entry)

        # Filter by kappa
        results = store.query("exp_001", filters={"kappa": 0.1})

        assert len(results) == 3
        for r in results:
            assert r.parameters["kappa"] == 0.1

    def test_query_with_status_filter(self, tmp_path):
        """Test that query can filter by status."""
        store = FileRegistryStore(tmp_path)

        # Add entries with different statuses
        entry1 = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
        )
        entry2 = RegistryEntry(
            run_id="run_002",
            experiment_id="exp_001",
            status=RunStatus.FAILED,
        )
        entry3 = RegistryEntry(
            run_id="run_003",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
        )
        store.upsert(entry1)
        store.upsert(entry2)
        store.upsert(entry3)

        results = store.query("exp_001", filters={"status": "completed"})

        assert len(results) == 2
        assert all(r.status == RunStatus.COMPLETED for r in results)

    def test_query_returns_empty_for_nonexistent_experiment(self, tmp_path):
        """Test that query returns empty list for non-existent experiment."""
        store = FileRegistryStore(tmp_path)
        results = store.query("nonexistent_exp")
        assert results == []

    def test_query_with_multiple_filters(self, tmp_path):
        """Test that query with multiple filters works correctly."""
        store = FileRegistryStore(tmp_path)

        # Add various entries
        for seed in [1, 2]:
            for kappa in [0.1, 0.2]:
                for status in [RunStatus.COMPLETED, RunStatus.FAILED]:
                    entry = RegistryEntry(
                        run_id=f"run_s{seed}_k{kappa}_{status.value}",
                        experiment_id="exp_001",
                        status=status,
                        parameters={"seed": seed, "kappa": kappa},
                    )
                    store.upsert(entry)

        # Filter by multiple criteria
        results = store.query(
            "exp_001",
            filters={"seed": 1, "status": "completed"}
        )

        assert len(results) == 2
        for r in results:
            assert r.parameters["seed"] == 1
            assert r.status == RunStatus.COMPLETED

    def test_upsert_preserves_existing_entries(self, tmp_path):
        """Test that upsert preserves other entries when adding new ones."""
        store = FileRegistryStore(tmp_path)

        # Add first entry
        entry1 = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 1},
        )
        store.upsert(entry1)

        # Add second entry
        entry2 = RegistryEntry(
            run_id="run_002",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 2},
        )
        store.upsert(entry2)

        # Both entries should exist
        loaded1 = store.get("exp_001", "run_001")
        loaded2 = store.get("exp_001", "run_002")

        assert loaded1 is not None
        assert loaded1.parameters["seed"] == 1
        assert loaded2 is not None
        assert loaded2.parameters["seed"] == 2

    def test_dynamic_fields_are_preserved(self, tmp_path):
        """Test that dynamically added fields are preserved in registry."""
        store = FileRegistryStore(tmp_path)

        # Add entry with non-standard parameters
        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"custom_param": "custom_value", "another_param": 123},
        )
        store.upsert(entry)

        # Load it back
        loaded = store.get("exp_001", "run_001")

        assert loaded is not None
        assert "custom_param" in loaded.parameters
        assert loaded.parameters["custom_param"] == "custom_value"

    def test_metrics_roundtrip_through_csv(self, tmp_path):
        """Test that metrics are correctly stored and retrieved from CSV.

        This test verifies the fix for the bug where metrics were incorrectly
        assigned to parameters instead of metrics dict in _row_to_entry.
        """
        store = FileRegistryStore(tmp_path)

        # Create entry with all standard metrics
        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
            parameters={"seed": 42, "kappa": 0.1},
            metrics={
                "phi_total": 150.5,
                "delta_total": 75.25,
                "time_to_stability": 12.0,
            },
        )
        store.upsert(entry)

        # Load it back
        loaded = store.get("exp_001", "run_001")

        assert loaded is not None
        # Verify metrics are in metrics dict (not parameters)
        assert "phi_total" in loaded.metrics
        assert "delta_total" in loaded.metrics
        assert "time_to_stability" in loaded.metrics
        assert loaded.metrics["phi_total"] == 150.5
        assert loaded.metrics["delta_total"] == 75.25
        assert loaded.metrics["time_to_stability"] == 12.0

        # Verify metrics are NOT in parameters
        assert "phi_total" not in loaded.parameters
        assert "delta_total" not in loaded.parameters
        assert "time_to_stability" not in loaded.parameters

        # Verify parameters are still in parameters dict
        assert loaded.parameters["seed"] == 42
        assert loaded.parameters["kappa"] == 0.1


class TestFileStoreSecurityValidation:
    """Tests for security validations in file stores."""

    def test_load_artifact_rejects_path_traversal(self, tmp_path):
        """Test that load_artifact rejects path traversal attempts."""
        store = FileResultStore(tmp_path)

        # Create a legitimate file
        (tmp_path / "test.txt").write_bytes(b"test")

        # Try to traverse outside base_dir
        with pytest.raises(ValueError, match="path traversal detected"):
            store.load_artifact("../../../etc/passwd")

    def test_load_artifact_rejects_absolute_path_traversal(self, tmp_path):
        """Test that load_artifact rejects absolute path traversal."""
        store = FileResultStore(tmp_path)

        with pytest.raises(ValueError, match="path traversal detected"):
            store.load_artifact("foo/../../../etc/passwd")

    def test_save_artifact_rejects_invalid_experiment_id(self, tmp_path):
        """Test that save_artifact rejects invalid experiment_id."""
        store = FileResultStore(tmp_path)

        with pytest.raises(ValueError, match="Invalid experiment_id"):
            store.save_artifact(
                experiment_id="../malicious",
                run_id="run_001",
                name="test.txt",
                content=b"test",
            )

    def test_save_artifact_rejects_invalid_run_id(self, tmp_path):
        """Test that save_artifact rejects invalid run_id."""
        store = FileResultStore(tmp_path)

        with pytest.raises(ValueError, match="Invalid run_id"):
            store.save_artifact(
                experiment_id="exp_001",
                run_id="../../../etc",
                name="test.txt",
                content=b"test",
            )

    def test_registry_rejects_invalid_experiment_id(self, tmp_path):
        """Test that registry operations reject invalid experiment_id."""
        store = FileRegistryStore(tmp_path)

        with pytest.raises(ValueError, match="Invalid experiment_id"):
            store.get("../malicious", "run_001")

    def test_valid_ids_with_special_chars_allowed(self, tmp_path):
        """Test that valid IDs with dashes, underscores, dots are allowed."""
        store = FileResultStore(tmp_path)

        # These should all work
        ref = store.save_artifact(
            experiment_id="exp-001_test.v2",
            run_id="run.001-abc_123",
            name="test.txt",
            content=b"test",
        )
        assert "exp-001_test.v2" in ref
        assert "run.001-abc_123" in ref

```

---

### 🧪 tests/storage/test_models.py

```python
"""Tests for storage data models."""

import pytest

from bilancio.storage.models import (
    RunStatus,
    RunArtifacts,
    RunResult,
    RegistryEntry,
)


class TestRunStatus:
    """Tests for RunStatus enum."""

    def test_pending_value(self):
        """Test PENDING enum has correct value."""
        assert RunStatus.PENDING.value == "pending"

    def test_running_value(self):
        """Test RUNNING enum has correct value."""
        assert RunStatus.RUNNING.value == "running"

    def test_completed_value(self):
        """Test COMPLETED enum has correct value."""
        assert RunStatus.COMPLETED.value == "completed"

    def test_failed_value(self):
        """Test FAILED enum has correct value."""
        assert RunStatus.FAILED.value == "failed"

    def test_all_statuses_exist(self):
        """Test all expected statuses exist."""
        statuses = {s.value for s in RunStatus}
        assert statuses == {"pending", "running", "completed", "failed"}

    def test_status_from_string(self):
        """Test creating status from string value."""
        assert RunStatus("completed") == RunStatus.COMPLETED
        assert RunStatus("failed") == RunStatus.FAILED


class TestRunArtifacts:
    """Tests for RunArtifacts dataclass."""

    def test_defaults_all_none(self):
        """Test all fields default to None."""
        artifacts = RunArtifacts()
        assert artifacts.scenario_yaml is None
        assert artifacts.events_jsonl is None
        assert artifacts.balances_csv is None
        assert artifacts.metrics_csv is None
        assert artifacts.metrics_json is None
        assert artifacts.run_html is None
        assert artifacts.dealer_metrics_json is None
        assert artifacts.trades_csv is None
        assert artifacts.repayment_events_csv is None

    def test_with_some_values(self):
        """Test creating with specific values."""
        artifacts = RunArtifacts(
            scenario_yaml="path/to/scenario.yaml",
            events_jsonl="path/to/events.jsonl",
        )
        assert artifacts.scenario_yaml == "path/to/scenario.yaml"
        assert artifacts.events_jsonl == "path/to/events.jsonl"
        assert artifacts.balances_csv is None

    def test_with_all_values(self):
        """Test creating with all values set."""
        artifacts = RunArtifacts(
            scenario_yaml="scenario.yaml",
            events_jsonl="events.jsonl",
            balances_csv="balances.csv",
            metrics_csv="metrics.csv",
            metrics_json="metrics.json",
            run_html="run.html",
            dealer_metrics_json="dealer_metrics.json",
            trades_csv="trades.csv",
            repayment_events_csv="repayment_events.csv",
        )
        assert artifacts.scenario_yaml == "scenario.yaml"
        assert artifacts.events_jsonl == "events.jsonl"
        assert artifacts.balances_csv == "balances.csv"
        assert artifacts.metrics_csv == "metrics.csv"
        assert artifacts.metrics_json == "metrics.json"
        assert artifacts.run_html == "run.html"
        assert artifacts.dealer_metrics_json == "dealer_metrics.json"
        assert artifacts.trades_csv == "trades.csv"
        assert artifacts.repayment_events_csv == "repayment_events.csv"


class TestRunResult:
    """Tests for RunResult dataclass."""

    def test_minimal_creation(self):
        """Test creating with only required fields."""
        result = RunResult(
            run_id="run_001",
            status=RunStatus.COMPLETED,
        )
        assert result.run_id == "run_001"
        assert result.status == RunStatus.COMPLETED
        assert result.parameters == {}
        assert result.metrics == {}
        assert isinstance(result.artifacts, RunArtifacts)
        assert result.error is None
        assert result.execution_time_ms is None

    def test_full_creation(self):
        """Test creating with all fields."""
        artifacts = RunArtifacts(scenario_yaml="scenario.yaml")
        result = RunResult(
            run_id="run_002",
            status=RunStatus.FAILED,
            parameters={"seed": 42, "kappa": 0.1},
            metrics={"phi_total": 100.5},
            artifacts=artifacts,
            error="Simulation diverged",
            execution_time_ms=5000,
        )
        assert result.run_id == "run_002"
        assert result.status == RunStatus.FAILED
        assert result.parameters == {"seed": 42, "kappa": 0.1}
        assert result.metrics == {"phi_total": 100.5}
        assert result.artifacts.scenario_yaml == "scenario.yaml"
        assert result.error == "Simulation diverged"
        assert result.execution_time_ms == 5000

    def test_field_access(self):
        """Test accessing various field types."""
        result = RunResult(
            run_id="test_run",
            status=RunStatus.RUNNING,
            parameters={"n_agents": 10, "mu": 0.5},
            metrics={"delta_total": 42.0},
        )
        # Access parameters
        assert result.parameters["n_agents"] == 10
        assert result.parameters["mu"] == 0.5
        # Access metrics
        assert result.metrics["delta_total"] == 42.0
        # Status comparison
        assert result.status == RunStatus.RUNNING
        assert result.status.value == "running"


class TestRegistryEntry:
    """Tests for RegistryEntry dataclass."""

    def test_minimal_creation(self):
        """Test creating with only required fields."""
        entry = RegistryEntry(
            run_id="run_001",
            experiment_id="exp_001",
            status=RunStatus.COMPLETED,
        )
        assert entry.run_id == "run_001"
        assert entry.experiment_id == "exp_001"
        assert entry.status == RunStatus.COMPLETED
        assert entry.parameters == {}
        assert entry.metrics == {}
        assert entry.artifact_paths == {}
        assert entry.error is None

    def test_full_creation(self):
        """Test creating with all fields."""
        entry = RegistryEntry(
            run_id="run_002",
            experiment_id="exp_001",
            status=RunStatus.FAILED,
            parameters={"seed": 123, "kappa": 0.2},
            metrics={"phi_total": 50.0, "delta_total": 25.0},
            artifact_paths={
                "scenario_yaml": "exp_001/runs/run_002/scenario.yaml",
                "events_jsonl": "exp_001/runs/run_002/out/events.jsonl",
            },
            error="OOM error",
        )
        assert entry.run_id == "run_002"
        assert entry.experiment_id == "exp_001"
        assert entry.status == RunStatus.FAILED
        assert entry.parameters == {"seed": 123, "kappa": 0.2}
        assert entry.metrics == {"phi_total": 50.0, "delta_total": 25.0}
        assert "scenario_yaml" in entry.artifact_paths
        assert entry.error == "OOM error"

    def test_field_access(self):
        """Test accessing entry fields."""
        entry = RegistryEntry(
            run_id="test_run",
            experiment_id="test_exp",
            status=RunStatus.PENDING,
            parameters={"concentration": 0.8},
            artifact_paths={"run_html": "path/to/run.html"},
        )
        # Access by key
        assert entry.parameters["concentration"] == 0.8
        assert entry.artifact_paths["run_html"] == "path/to/run.html"
        # Status value
        assert entry.status.value == "pending"

```

---

### 🧪 tests/test_smoke.py

```python
"""Smoke tests to verify basic installation and imports."""

import pytest
from decimal import Decimal


def test_core_imports():
    """Test that core modules can be imported."""
    from bilancio.core.time import TimeCoordinate, TimeInterval, now
    from bilancio.core.errors import (
        BilancioError,
        ValidationError,
        CalculationError,
        ConfigurationError,
    )
    from bilancio.core.atomic import AtomicValue, Money, Quantity, Rate
    
    # Basic instantiation tests
    t = TimeCoordinate(0.0)
    assert t.t == 0.0
    
    interval = TimeInterval(TimeCoordinate(0.0), TimeCoordinate(1.0))
    assert interval.start.t == 0.0
    assert interval.end.t == 1.0
    
    current_time = now()
    assert current_time.t == 0.0
    
    # Test Money
    money = Money(Decimal("100.50"), "USD")
    assert money.amount == Decimal("100.50")
    assert money.currency == "USD"
    assert money.value == Decimal("100.50")  # AtomicValue protocol
    
    # Test Quantity
    qty = Quantity(10.5, "kg")
    assert qty.value == 10.5
    assert qty.unit == "kg"
    
    # Test Rate
    rate = Rate(Decimal("0.05"), "annual")
    assert rate.value == Decimal("0.05")
    assert rate.basis == "annual"


def test_domain_imports():
    """Test that domain modules can be imported."""
    from bilancio.domain.agent import Agent
    from bilancio.domain.instruments.contract import Contract, BaseContract
    from bilancio.domain.instruments.policy import Policy, BasePolicy
    
    # Test that base classes exist
    assert Agent is not None
    assert Contract is not None
    assert BaseContract is not None
    assert Policy is not None
    assert BasePolicy is not None


def test_ops_imports():
    """Test that ops modules can be imported."""
    from bilancio.ops.cashflows import CashFlow, CashFlowStream
    from bilancio.core.atomic import Money
    from bilancio.core.time import TimeCoordinate
    
    # Simple test - we can't create CashFlow without Agent instances
    # but we can test the CashFlowStream
    stream = CashFlowStream()
    assert len(stream) == 0
    assert stream.get_all_flows() == []


def test_engines_imports():
    """Test that engine modules can be imported."""
    from bilancio.engines.valuation import ValuationEngine, SimpleValuationEngine
    from bilancio.engines.simulation import SimulationEngine, MonteCarloEngine
    from bilancio.core.atomic import Money
    
    # Test basic instantiation
    val_engine = SimpleValuationEngine(discount_rate=0.05)
    assert val_engine.discount_rate == 0.05
    
    monte_carlo = MonteCarloEngine(n_simulations=1000)
    assert monte_carlo.n_simulations == 1000


def test_analysis_imports():
    """Test that analysis modules can be imported."""
    from bilancio.analysis.metrics import calculate_npv, calculate_irr
    
    # These are placeholders so they should raise NotImplementedError
    with pytest.raises(NotImplementedError):
        calculate_npv([], 0.05)
    
    with pytest.raises(NotImplementedError):
        calculate_irr([])


def test_package_metadata():
    """Test that package metadata is accessible."""
    import bilancio
    
    assert bilancio.__version__ == "0.1.0"
    
    # Test that basic imports from __init__ work
    from bilancio import TimeCoordinate, TimeInterval, now
    from bilancio import BilancioError, ValidationError
    
    assert TimeCoordinate is not None
    assert BilancioError is not None
```

---

### 🧪 tests/ui/test_cli.py

```python
"""Tests for CLI functionality."""

import pytest
from pathlib import Path
from click.testing import CliRunner
import tempfile
import yaml

from bilancio.ui.cli import cli


class TestCLI:
    """Test CLI commands."""
    
    def test_cli_help(self):
        """Test that CLI help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['--help'])
        assert result.exit_code == 0
        assert 'Bilancio' in result.output
        assert 'simulation' in result.output.lower()
    
    def test_run_help(self):
        """Test that run command help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['run', '--help'])
        assert result.exit_code == 0
        assert 'scenario' in result.output.lower()
        assert '--max-days' in result.output
        assert '--mode' in result.output
    
    def test_new_help(self):
        """Test that new command help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['new', '--help'])
        assert result.exit_code == 0
        assert 'scenario' in result.output.lower()
        assert '--output' in result.output or '-o' in result.output
    
    def test_run_nonexistent_file(self):
        """Test running with non-existent file."""
        runner = CliRunner()
        result = runner.invoke(cli, ['run', 'nonexistent.yaml'])
        assert result.exit_code != 0
        assert 'not found' in result.output.lower() or 'does not exist' in result.output.lower()
    
    def test_run_simple_scenario(self):
        """Test running a simple scenario."""
        # Create a minimal scenario file
        scenario = {
            "version": 1,
            "name": "Test Scenario",
            "agents": [
                {"id": "CB", "kind": "central_bank", "name": "Central Bank"},
                {"id": "B1", "kind": "bank", "name": "Bank"}
            ],
            "initial_actions": [
                {"mint_reserves": {"to": "B1", "amount": 1000}}
            ],
            "run": {
                "mode": "until_stable",
                "max_days": 5,
                "quiet_days": 1
            }
        }
        
        with tempfile.NamedTemporaryFile(mode='w', suffix='.yaml', delete=False) as f:
            yaml.dump(scenario, f)
            temp_path = Path(f.name)
        
        try:
            runner = CliRunner()
            result = runner.invoke(cli, [
                'run', str(temp_path),
                '--mode', 'until-stable',
                '--max-days', '5'
            ])
            
            # Check that it ran without crashing
            assert result.exit_code == 0
            assert 'Test Scenario' in result.output
            assert 'Day' in result.output
            
        finally:
            temp_path.unlink()
    
    def test_new_scenario_creation(self):
        """Test creating a new scenario file."""
        with tempfile.TemporaryDirectory() as tmpdir:
            output_path = Path(tmpdir) / "new_scenario.yaml"
            
            runner = CliRunner()
            # Use the template option to avoid interactive prompts
            result = runner.invoke(cli, [
                'new',
                '-o', str(output_path),
                '--from', 'simple'
            ])
            
            # Check file was created
            assert output_path.exists()
            
            # Load and validate the created file
            with open(output_path) as f:
                config = yaml.safe_load(f)
            
            # When using template, it uses default name "My Scenario"
            assert config['name'] == "My Scenario"
            assert config['version'] == 1
            assert len(config['agents']) > 0
    
    def test_run_with_export(self):
        """Test running scenario with export options."""
        scenario = {
            "version": 1,
            "name": "Export Test",
            "agents": [
                {"id": "CB", "kind": "central_bank", "name": "CB"},
                {"id": "B1", "kind": "bank", "name": "Bank"}
            ],
            "initial_actions": [
                {"mint_reserves": {"to": "B1", "amount": 1000}}
            ],
            "run": {
                "mode": "until_stable",
                "max_days": 2
            }
        }
        
        with tempfile.TemporaryDirectory() as tmpdir:
            # Create scenario file
            scenario_path = Path(tmpdir) / "scenario.yaml"
            with open(scenario_path, 'w') as f:
                yaml.dump(scenario, f)
            
            # Set export paths
            balances_path = Path(tmpdir) / "balances.csv"
            events_path = Path(tmpdir) / "events.jsonl"
            
            runner = CliRunner()
            result = runner.invoke(cli, [
                'run', str(scenario_path),
                '--export-balances', str(balances_path),
                '--export-events', str(events_path),
                '--max-days', '2'
            ])
            
            assert result.exit_code == 0
            
            # Check export files were created
            assert balances_path.exists()
            assert events_path.exists()
            
            # Check files have content
            assert balances_path.stat().st_size > 0
            assert events_path.stat().st_size > 0

    def test_run_with_html_export(self, tmp_path):
        """Test running scenario with --html export option."""
        scenario = {
            "version": 1,
            "name": "HTML Export Test",
            "agents": [
                {"id": "CB", "kind": "central_bank", "name": "CB"},
                {"id": "H1", "kind": "household", "name": "Alice"}
            ],
            "initial_actions": [
                {"mint_cash": {"to": "H1", "amount": 1000}}
            ],
            "run": {
                "mode": "until_stable",
                "max_days": 1,
                "quiet_days": 1,
                "show": {
                    "balances": ["CB", "H1"]
                }
            }
        }

        scenario_path = tmp_path / "scenario.yaml"
        html_path = tmp_path / "out.html"

        import yaml
        with open(scenario_path, 'w') as f:
            yaml.dump(scenario, f)

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '1',
            '--quiet-days', '1',
            '--html', str(html_path)
        ])

        assert result.exit_code == 0
        assert html_path.exists()
        content = html_path.read_text(encoding='utf-8')
        assert 'Bilancio Simulation' in content

```

---

### 🧪 tests/ui/test_cli_html_export.py

```python
"""Test CLI HTML export functionality."""

import pytest
from pathlib import Path
import tempfile
from bilancio.engines.system import System
from bilancio.config import ScenarioConfig
from bilancio.ui.run import run_scenario


def test_html_export_creates_file(tmp_path):
    """Test that HTML export creates a file with expected content."""
    # Create a minimal scenario config
    config_data = {
        "name": "Test Scenario",
        "description": "Test HTML export",
        "agents": {
            "bank1": {
                "kind": "bank",
                "name": "Test Bank"
            },
            "household1": {
                "kind": "household", 
                "name": "Test Household"
            }
        },
        "setup": {
            "operations": [
                {
                    "type": "mint_cash",
                    "bank": "bank1",
                    "amount": 1000
                }
            ]
        },
        "simulation": {},
        "run": {
            "mode": "until_stable",
            "max_days": 1,
            "quiet_days": 1,
            "show": {
                "events": "detailed",
                "balances": ["bank1", "household1"]
            },
            "export": {}
        }
    }
    
    # Write config to temp file
    config_file = tmp_path / "test_scenario.yaml"
    import yaml
    with open(config_file, 'w') as f:
        yaml.dump(config_data, f)
    
    # Run scenario with HTML export
    html_output = tmp_path / "output.html"
    
    # Note: This would require mocking or a lighter test since run_scenario
    # is a high-level function. For now, we'll test the lower-level components
    
    # Test that we can create an HTML export path
    assert not html_output.exists()
    
    # Create a simple HTML content to verify path handling
    html_output.write_text("<html><body>Test</body></html>")
    assert html_output.exists()
    assert "Test" in html_output.read_text()


def test_console_record_html_export():
    """Test that Console with record=True can export HTML."""
    from rich.console import Console
    from rich.table import Table
    from rich.terminal_theme import MONOKAI
    
    # Create a console with recording enabled
    console = Console(record=True, width=100)
    
    # Print some content
    table = Table(title="Test Table")
    table.add_column("Column 1")
    table.add_column("Column 2")
    table.add_row("Value 1", "Value 2")
    
    console.print(table)
    console.print("[bold green]Success![/bold green]")
    
    # Export to HTML
    html = console.export_html(theme=MONOKAI)
    
    # Verify HTML content
    assert html is not None
    assert "<html>" in html
    assert "Test Table" in html
    assert "Value 1" in html
    assert "Value 2" in html
    # Rich converts the markup to HTML
    assert "Success!" in html


def test_renderable_functions_return_correct_types():
    """Test that renderable functions return expected types."""
    from bilancio.ui.display import (
        show_scenario_header_renderable,
        show_simulation_summary_renderable
    )
    from bilancio.engines.system import System
    
    # Test scenario header
    panel = show_scenario_header_renderable("Test", "Description")
    assert panel is not None
    
    # Test simulation summary
    system = System()
    summary = show_simulation_summary_renderable(system)
    assert summary is not None
```

---

### 🧪 tests/ui/test_cli_integration.py

```python
"""Integration tests for CLI module.

Tests the CLI commands work correctly with real scenario files.
Uses Click's CliRunner for testing.
"""

import pytest
from pathlib import Path
from click.testing import CliRunner

from bilancio.ui.cli import cli


# Path to example scenarios
EXAMPLES_DIR = Path(__file__).parent.parent.parent / "examples" / "scenarios"


class TestCLIHelp:
    """Test CLI help output for all commands."""

    def test_main_help_shows_expected_commands(self):
        """Test that main --help shows all expected commands."""
        runner = CliRunner()
        result = runner.invoke(cli, ['--help'])

        assert result.exit_code == 0
        assert 'run' in result.output
        assert 'validate' in result.output
        assert 'new' in result.output
        assert 'analyze' in result.output
        assert 'sweep' in result.output

    def test_validate_help(self):
        """Test that validate command help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['validate', '--help'])

        assert result.exit_code == 0
        assert 'Validate' in result.output
        assert 'scenario' in result.output.lower()

    def test_analyze_help(self):
        """Test that analyze command help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['analyze', '--help'])

        assert result.exit_code == 0
        assert '--events' in result.output
        assert '--balances' in result.output
        assert '--out-csv' in result.output

    def test_sweep_help_shows_subcommands(self):
        """Test that sweep --help shows sweep subcommands."""
        runner = CliRunner()
        result = runner.invoke(cli, ['sweep', '--help'])

        assert result.exit_code == 0
        assert 'ring' in result.output
        assert 'comparison' in result.output
        assert 'balanced' in result.output

    def test_sweep_ring_help_shows_options(self):
        """Test that sweep ring --help shows ring options."""
        runner = CliRunner()
        result = runner.invoke(cli, ['sweep', 'ring', '--help'])

        assert result.exit_code == 0
        assert '--config' in result.output
        assert '--out-dir' in result.output
        assert '--kappas' in result.output
        assert '--n-agents' in result.output
        assert '--grid' in result.output

    def test_sweep_comparison_help(self):
        """Test that sweep comparison --help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['sweep', 'comparison', '--help'])

        assert result.exit_code == 0
        assert '--out-dir' in result.output
        assert '--n-agents' in result.output
        assert '--dealer-share' in result.output

    def test_sweep_balanced_help(self):
        """Test that sweep balanced --help works."""
        runner = CliRunner()
        result = runner.invoke(cli, ['sweep', 'balanced', '--help'])

        assert result.exit_code == 0
        assert '--out-dir' in result.output
        assert '--face-value' in result.output
        assert '--big-entity-share' in result.output


class TestValidateCommand:
    """Test the validate command with real scenarios."""

    def test_validate_simple_bank_scenario(self):
        """Test validating the simple_bank.yaml scenario."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, ['validate', str(scenario_path)])

        assert result.exit_code == 0
        assert 'valid' in result.output.lower()

    def test_validate_two_banks_scenario(self):
        """Test validating the two_banks_interbank.yaml scenario."""
        scenario_path = EXAMPLES_DIR / "two_banks_interbank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, ['validate', str(scenario_path)])

        assert result.exit_code == 0
        assert 'valid' in result.output.lower()

    def test_validate_nonexistent_file(self):
        """Test validate with non-existent file."""
        runner = CliRunner()
        result = runner.invoke(cli, ['validate', 'nonexistent_file.yaml'])

        assert result.exit_code != 0


class TestRunCommand:
    """Test the run command with real scenarios."""

    def test_run_simple_bank_with_max_days(self):
        """Test running simple_bank.yaml with --max-days limit."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '3'
        ])

        assert result.exit_code == 0
        # Check that the scenario name appears
        assert 'Simple Banking System' in result.output

    def test_run_with_show_summary(self):
        """Test running with --show summary option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--show', 'summary'
        ])

        assert result.exit_code == 0

    def test_run_with_agent_filter(self):
        """Test running with --agents filter option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--agents', 'CB,B1'
        ])

        assert result.exit_code == 0

    def test_run_with_check_invariants_none(self):
        """Test running with --check-invariants none."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--check-invariants', 'none'
        ])

        assert result.exit_code == 0

    def test_run_t_account_option(self):
        """Test running with --t-account option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--t-account'
        ])

        assert result.exit_code == 0


class TestRunWithExport:
    """Test run command with export options."""

    def test_run_with_export_balances(self, tmp_path):
        """Test running with --export-balances option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        balances_file = tmp_path / "balances.csv"

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--export-balances', str(balances_file)
        ])

        assert result.exit_code == 0
        assert balances_file.exists()
        assert balances_file.stat().st_size > 0

    def test_run_with_export_events(self, tmp_path):
        """Test running with --export-events option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        events_file = tmp_path / "events.jsonl"

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--export-events', str(events_file)
        ])

        assert result.exit_code == 0
        assert events_file.exists()
        assert events_file.stat().st_size > 0

    def test_run_with_html_export(self, tmp_path):
        """Test running with --html export option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        html_file = tmp_path / "output.html"

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--max-days', '2',
            '--html', str(html_file)
        ])

        assert result.exit_code == 0
        assert html_file.exists()
        content = html_file.read_text()
        assert 'html' in content.lower()


class TestErrorHandling:
    """Test CLI error handling."""

    def test_run_invalid_mode(self):
        """Test running with invalid --mode option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--mode', 'invalid-mode'
        ])

        # Click should reject invalid choice
        assert result.exit_code != 0

    def test_run_invalid_show(self):
        """Test running with invalid --show option."""
        scenario_path = EXAMPLES_DIR / "simple_bank.yaml"
        if not scenario_path.exists():
            pytest.skip(f"Scenario file not found: {scenario_path}")

        runner = CliRunner()
        result = runner.invoke(cli, [
            'run', str(scenario_path),
            '--show', 'invalid-show'
        ])

        # Click should reject invalid choice
        assert result.exit_code != 0

    def test_unknown_command(self):
        """Test invoking unknown command."""
        runner = CliRunner()
        result = runner.invoke(cli, ['unknown-command'])

        assert result.exit_code != 0

    def test_sweep_unknown_subcommand(self):
        """Test invoking unknown sweep subcommand."""
        runner = CliRunner()
        result = runner.invoke(cli, ['sweep', 'unknown-subcommand'])

        assert result.exit_code != 0

```

---

### 🧪 tests/ui/test_html_export.py

```python
"""Unit tests for semantic HTML export."""

from pathlib import Path
from decimal import Decimal

from bilancio.engines.system import System
from bilancio.config.apply import create_agent
from bilancio.analysis.balances import agent_balance
from bilancio.ui.html_export import export_pretty_html


def test_export_pretty_html_minimal(tmp_path: Path):
    sys = System()
    cb = create_agent(type("Spec", (), {"id":"CB","kind":"central_bank","name":"Central Bank"}))
    h1 = create_agent(type("Spec", (), {"id":"H1","kind":"household","name":"Alice"}))
    sys.add_agent(cb)
    sys.add_agent(h1)
    # seed a simple cash position
    sys.mint_cash("H1", 1000)

    out = tmp_path / "report.html"

    # Prepare initial data
    agent_ids = ["CB", "H1"]
    initial_balances = {aid: agent_balance(sys, aid) for aid in agent_ids}

    # No days_data yet; just ensure file writes and contains headers
    export_pretty_html(
        system=sys,
        out_path=out,
        scenario_name="Unit Test",
        description="Testing export",
        agent_ids=agent_ids,
        initial_balances=initial_balances,
        days_data=[],
        max_days=1,
        quiet_days=1,
    )

    assert out.exists()
    html = out.read_text(encoding="utf-8")
    # Basic sanity checks
    assert "Bilancio Simulation" in html
    assert "Agents" in html
    assert "Day 0 (Setup)" in html
    assert "Central Bank" in html and "Alice" in html


def test_export_pretty_html_handles_numeric_strings(tmp_path: Path):
    sys = System()
    f1 = create_agent(type("Spec", (), {"id":"F1","kind":"firm","name":"Firm One"}))
    sys.add_agent(f1)

    out = tmp_path / "report2.html"
    agent_ids = ["F1"]
    # Manually craft a balance-like object via agent_balance and then tweak days_data to include numbers-as-strings
    initial_balances = {"F1": agent_balance(sys, "F1")}

    # days_data with an event that includes formatted numeric strings
    days_data = [
        {
            "day": 1,
            "events": [
                {"kind": "PhaseB"},
                {"kind": "ClientPayment", "payer": "F1", "payee": "F1", "amount": "1,000"},
            ],
            "balances": {"F1": agent_balance(sys, "F1")},
        }
    ]

    export_pretty_html(
        system=sys,
        out_path=out,
        scenario_name="Numeric Test",
        description=None,
        agent_ids=agent_ids,
        initial_balances=initial_balances,
        days_data=days_data,
        max_days=2,
        quiet_days=1,
    )

    assert out.exists()
    html = out.read_text(encoding="utf-8")
    assert "Numeric Test" in html
    # amount should be present in some formatted form
    assert "1,000" in html

```

---

### 🧪 tests/ui/test_render_builders.py

```python
"""Test Rich builders for rendering."""

import pytest
from decimal import Decimal
from bilancio.ui.render.models import (
    BalanceItemView,
    AgentBalanceView,
    EventView,
    DayEventsView
)
from bilancio.ui.render.rich_builders import (
    build_agent_balance_table,
    build_multiple_agent_balances,
    build_events_panel,
    convert_raw_event_to_view
)


def test_build_agent_balance_table():
    """Test building a Rich table for agent balance."""
    # Create a sample balance view
    balance_view = AgentBalanceView(
        agent_id="bank1",
        agent_name="Central Bank",
        agent_kind="bank",
        items=[
            BalanceItemView(
                category="asset",
                instrument="reserves",
                amount=10000,
                value=Decimal("10000")
            ),
            BalanceItemView(
                category="liability",
                instrument="deposits",
                amount=5000,
                value=Decimal("5000")
            )
        ]
    )
    
    # Build table
    table = build_agent_balance_table(balance_view)
    
    # Verify it's a Table (or string if Rich not available)
    assert table is not None
    if not isinstance(table, str):
        # Rich is available, check it's a Table
        from rich.table import Table
        assert isinstance(table, Table)


def test_build_multiple_agent_balances():
    """Test building columns for multiple agent balances."""
    # Create sample balance views
    balances = [
        AgentBalanceView(
            agent_id="bank1",
            agent_name="Bank One",
            agent_kind="bank",
            items=[
                BalanceItemView(
                    category="asset",
                    instrument="cash",
                    amount=1000,
                    value=Decimal("1000")
                )
            ]
        ),
        AgentBalanceView(
            agent_id="household1",
            agent_name="Household One",
            agent_kind="household",
            items=[
                BalanceItemView(
                    category="asset",
                    instrument="deposits",
                    amount=500,
                    value=Decimal("500")
                )
            ]
        )
    ]
    
    # Build columns
    columns = build_multiple_agent_balances(balances)
    
    # Verify result
    assert columns is not None
    if not isinstance(columns, str):
        # Rich is available, check it's Columns
        from rich.columns import Columns
        assert isinstance(columns, Columns)


def test_build_events_panel():
    """Test building a panel for day events."""
    # Create sample day events view
    day_view = DayEventsView(
        day=1,
        phases={
            "A": [
                EventView(
                    kind="PhaseA",
                    title="Day begins",
                    lines=["Starting day 1"],
                    icon="⏰",
                    raw_event={"kind": "PhaseA", "day": 1}
                )
            ],
            "B": [
                EventView(
                    kind="CashTransferred",
                    title="Cash transferred",
                    lines=["bank1 → household1: $100"],
                    icon="💵",
                    raw_event={"kind": "CashTransferred", "day": 1}
                )
            ],
            "C": []
        }
    )
    
    # Build panel
    panel = build_events_panel(day_view)
    
    # Verify result
    assert panel is not None
    if not isinstance(panel, str):
        # Rich is available, check it's a Panel
        from rich.panel import Panel
        assert isinstance(panel, Panel)


def test_convert_raw_event_to_view():
    """Test converting raw event dict to EventView."""
    # Test with a CashTransferred event
    raw_event = {
        "kind": "CashTransferred",
        "frm": "bank1",
        "to": "household1",
        "amount": 1000,
        "day": 1
    }
    
    event_view = convert_raw_event_to_view(raw_event)
    
    assert isinstance(event_view, EventView)
    assert "Cash Transfer" in event_view.title
    assert event_view.lines[0] == "bank1 → household1"
    assert event_view.icon == "💰"
    assert event_view.raw_event == raw_event


def test_convert_unknown_event_to_view():
    """Test converting unknown event type to EventView."""
    raw_event = {
        "kind": "CustomEvent",
        "data": "some value"
    }
    
    event_view = convert_raw_event_to_view(raw_event)
    
    assert isinstance(event_view, EventView)
    assert "CustomEvent" in event_view.title
    assert event_view.icon == "❓"
```

---

### 🧪 tests/ui/test_render_formatters.py

```python
"""Test event formatters and registry."""

import pytest
from bilancio.ui.render.formatters import EventFormatterRegistry, registry


def test_event_formatter_registry():
    """Test that event formatter registry works correctly."""
    registry = EventFormatterRegistry()
    
    # Test registration
    @registry.register("TestEvent")
    def test_formatter(event):
        return "Test Event", ["Test line"], "🧪"
    
    # Test formatting with registered event
    event = {"kind": "TestEvent", "data": "test"}
    title, lines, icon = registry.format(event)
    assert title == "Test Event"
    assert lines == ["Test line"]
    assert icon == "🧪"


def test_format_event_with_known_kind():
    """Test formatting known event kinds."""
    # Test CashTransferred
    event = {
        "kind": "CashTransferred",
        "frm": "bank1",
        "to": "household1",
        "amount": 1000
    }
    title, lines, icon = registry.format(event)
    assert "Cash Transfer" in title
    assert lines[0] == "bank1 → household1"
    assert icon == "💰"
    
    # Test StockTransferred
    event = {
        "kind": "StockTransferred",
        "frm": "firm1",
        "to": "household1",
        "qty": 10,
        "sku": "BREAD"
    }
    title, lines, icon = registry.format(event)
    assert "Stock Transfer" in title
    assert lines[0] == "firm1 → household1"
    assert icon == "📦"


def test_format_event_with_unknown_kind():
    """Test formatting unknown event kinds."""
    event = {
        "kind": "UnknownEventType",
        "some_data": "value"
    }
    title, lines, icon = registry.format(event)
    assert "UnknownEventType Event" in title
    assert len(lines) > 0
    assert icon == "❓"


def test_format_event_missing_fields():
    """Test formatting events with missing expected fields."""
    # CashTransferred with missing amount
    event = {
        "kind": "CashTransferred",
        "frm": "bank1",
        "to": "household1"
    }
    title, lines, icon = registry.format(event)
    assert "Cash Transfer" in title
    assert lines[0] == "bank1 → household1"  # Should handle missing amount gracefully
    
    # StockTransferred with missing qty
    event = {
        "kind": "StockTransferred",
        "frm": "firm1",
        "to": "household1",
        "sku": "BREAD"
    }
    title, lines, icon = registry.format(event)
    assert "Stock Transfer" in title
    assert lines[0] == "firm1 → household1"  # Should handle missing qty gracefully


def test_all_event_kinds_have_formatters():
    """Test that common event kinds have formatters."""
    common_kinds = [
        "CashTransferred",
        "StockTransferred",
        "PayableSettled",
        "DeliveryObligationSettled",
        "CashMinted",
        "StockCreated",
        "PhaseA",
        "PhaseB",
        "PhaseC"
    ]
    
    for kind in common_kinds:
        event = {"kind": kind}
        title, lines, icon = registry.format(event)
        # Should not fall back to generic formatter
        assert "Event:" not in title or kind in ["PhaseA", "PhaseB", "PhaseC"]
```

---

### 🧪 tests/unit/test_balances.py

```python
"""Tests for balance analysis functionality."""
from decimal import Decimal

import pytest

from bilancio.analysis.balances import AgentBalance, TrialBalance, agent_balance, as_rows, system_trial_balance
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.household import Household
from bilancio.engines.system import System


class TestAgentBalance:
    """Test agent balance calculations."""
    
    def test_agent_balance_with_financial_instruments(self):
        """Test agent balance calculation with financial instruments."""
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        hh = Household(id="HH01", name="Household", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(hh)
        
        # Mint cash to household
        system.mint_cash("HH01", 1000)
        
        # Check household balance
        balance = agent_balance(system, "HH01")
        assert balance.agent_id == "HH01"
        assert balance.total_financial_assets == 1000
        assert balance.total_financial_liabilities == 0
        assert balance.net_financial == 1000
        assert balance.assets_by_kind == {"cash": 1000}
        assert balance.liabilities_by_kind == {}
        
        # Check central bank balance
        cb_balance = agent_balance(system, "CB01")
        assert cb_balance.agent_id == "CB01"
        assert cb_balance.total_financial_assets == 0
        assert cb_balance.total_financial_liabilities == 1000
        assert cb_balance.net_financial == -1000
        assert cb_balance.assets_by_kind == {}
        assert cb_balance.liabilities_by_kind == {"cash": 1000}
    
    def test_agent_balance_with_mixed_instruments(self):
        """Test agent balance calculation with both financial and non-financial instruments."""
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        hh1 = Household(id="HH01", name="Household 1", kind="household")
        hh2 = Household(id="HH02", name="Household 2", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(hh1)
        system.add_agent(hh2)
        
        # Mint cash (financial)
        system.mint_cash("HH01", 1000)
        
        # Create stock lot (non-financial asset for HH01)
        system.create_stock("HH01", "APPLES", 50, Decimal("0"))
        
        # Create delivery obligation (HH01 owes to HH02)
        system.create_delivery_obligation("HH01", "HH02", "ORANGES", 30, Decimal("0"), due_day=1)
        
        # Check HH01 balance (has financial assets, some stock, and delivery obligation liability)
        hh1_balance = agent_balance(system, "HH01")
        assert hh1_balance.total_financial_assets == 1000  # Only cash
        assert hh1_balance.total_financial_liabilities == 0  # Delivery obligation liability is non-financial
        assert hh1_balance.net_financial == 1000
        assert hh1_balance.assets_by_kind == {"cash": 1000}
        assert hh1_balance.liabilities_by_kind == {"delivery_obligation": 30}
        
        # Check HH02 balance (has delivery obligation asset only)
        hh2_balance = agent_balance(system, "HH02")
        assert hh2_balance.total_financial_assets == 0  # Delivery obligation asset is non-financial
        assert hh2_balance.total_financial_liabilities == 0
        assert hh2_balance.net_financial == 0
        assert hh2_balance.assets_by_kind == {"delivery_obligation": 30}
        assert hh2_balance.liabilities_by_kind == {}


class TestSystemTrialBalance:
    """Test system-wide trial balance calculations."""
    
    def test_system_trial_balance_balances(self):
        """Test that system trial balance shows equal assets and liabilities."""
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        hh = Household(id="HH01", name="Household", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(hh)
        
        # Mint cash
        system.mint_cash("HH01", 1000)
        
        trial = system_trial_balance(system)
        assert trial.total_financial_assets == trial.total_financial_liabilities == 1000
        assert trial.assets_by_kind == trial.liabilities_by_kind == {"cash": 1000}
    
    def test_system_trial_balance_with_mixed_instruments(self):
        """Test system trial balance with financial and non-financial instruments."""
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        hh1 = Household(id="HH01", name="Household 1", kind="household")
        hh2 = Household(id="HH02", name="Household 2", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(hh1)
        system.add_agent(hh2)
        
        # Create mixed instruments
        system.mint_cash("HH01", 1000)
        # Create stock for HH01 (non-financial asset, no liability)
        system.create_stock("HH01", "APPLES", 50, Decimal("0"))
        # Create delivery obligation HH01 → HH02 (bilateral obligation)
        system.create_delivery_obligation("HH01", "HH02", "ORANGES", 30, Decimal("0"), due_day=1)
        
        trial = system_trial_balance(system)
        assert trial.total_financial_assets == trial.total_financial_liabilities == 1000
        assert trial.assets_by_kind == {"cash": 1000, "delivery_obligation": 30}
        assert trial.liabilities_by_kind == {"cash": 1000, "delivery_obligation": 30}


class TestAsRows:
    """Test as_rows function for tabular output."""
    
    def test_as_rows_format(self):
        """Test as_rows returns correct format."""
        system = System()
        cb = CentralBank(id="CB01", name="Central Bank", kind="central_bank")
        hh = Household(id="HH01", name="Household", kind="household")
        
        system.bootstrap_cb(cb)
        system.add_agent(hh)
        system.mint_cash("HH01", 1000)
        
        rows = as_rows(system)
        assert len(rows) == 3  # CB, HH, SYSTEM
        
        # Check agent rows exist
        agent_ids = {row["agent_id"] for row in rows}
        assert agent_ids == {"CB01", "HH01", "SYSTEM"}
        
        # Check SYSTEM row has zero net financial (should always balance)
        system_row = next(row for row in rows if row["agent_id"] == "SYSTEM")
        assert system_row["net_financial"] == 0
        assert system_row["total_financial_assets"] == system_row["total_financial_liabilities"]
        
        # Check individual agent rows have proper totals
        hh_row = next(row for row in rows if row["agent_id"] == "HH01")
        assert hh_row["total_financial_assets"] == 1000
        assert hh_row["total_financial_liabilities"] == 0
        assert hh_row["net_financial"] == 1000
        assert hh_row["assets_cash"] == 1000
        
        cb_row = next(row for row in rows if row["agent_id"] == "CB01")
        assert cb_row["total_financial_assets"] == 0
        assert cb_row["total_financial_liabilities"] == 1000
        assert cb_row["net_financial"] == -1000
        assert cb_row["liabilities_cash"] == 1000
```

---

### 🧪 tests/unit/test_domain_system.py

```python
from bilancio.engines.system import System
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.domain.agents.household import Household
from bilancio.domain.agents.treasury import Treasury
from bilancio.domain.instruments.means_of_payment import Cash, BankDeposit, ReserveDeposit
from bilancio.domain.instruments.credit import Payable

def test_create_agents_and_deposit_invariants():
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    h1 = Household(id="H1", name="HH 1", kind="household")
    sys.add_agent(cb); sys.add_agent(b1); sys.add_agent(h1)

    d = BankDeposit(id="D1", kind="bank_deposit", amount=100, denom="X",
                    asset_holder_id="H1", liability_issuer_id="B1")
    sys.add_contract(d)
    sys.assert_invariants()

def test_policy_allows_and_blocks_expected_cases():
    sys = System()
    cb = CentralBank(id="CB1", name="CB", kind="central_bank")
    b1 = Bank(id="B1", name="B1", kind="bank")
    h1 = Household(id="H1", name="H1", kind="household")
    t1 = Treasury(id="T1", name="T1", kind="treasury")
    sys.add_agent(cb); sys.add_agent(b1); sys.add_agent(h1); sys.add_agent(t1)

    # HH can hold bank deposit; bank issues it
    sys.add_contract(BankDeposit(id="d", kind="bank_deposit", amount=10, denom="X",
                                 asset_holder_id="H1", liability_issuer_id="B1"))

    # Treasury can hold reserves, not required to test now, but ensure creation passes
    # Use mint_reserves to maintain invariants
    sys.mint_reserves("B1", 5)

    # Any agent can issue a payable in MVP
    sys.add_contract(Payable(id="p", kind="payable", amount=7, denom="X",
                             asset_holder_id="B1", liability_issuer_id="H1", due_day=0))
    sys.assert_invariants()
```

---

### 🧪 tests/unit/test_jobs.py

```python
"""Unit tests for the job system."""

import json
import tempfile
from datetime import datetime
from decimal import Decimal
from pathlib import Path

import pytest

from bilancio.jobs import (
    Job,
    JobConfig,
    JobEvent,
    JobManager,
    JobStatus,
    generate_job_id,
    validate_job_id,
)


class TestJobId:
    """Tests for job ID generation and validation."""

    def test_generate_job_id_format(self):
        """Test generate_job_id returns correct format (4 words, hyphen-separated)."""
        job_id = generate_job_id()
        parts = job_id.split("-")
        assert len(parts) == 4
        assert all(part.isalpha() and part.islower() for part in parts)

    def test_validate_job_id_accepts_valid_ids(self):
        """Test validate_job_id accepts valid IDs."""
        assert validate_job_id("castle-river-mountain-forest") is True
        assert validate_job_id("bright-ocean-swift-tiger") is True
        assert validate_job_id("alpha-beta") is True  # Minimum 2 words

    def test_validate_job_id_rejects_empty(self):
        """Test validate_job_id rejects empty strings."""
        assert validate_job_id("") is False

    def test_validate_job_id_rejects_single_word(self):
        """Test validate_job_id rejects single word IDs."""
        assert validate_job_id("castle") is False
        assert validate_job_id("river") is False

    def test_validate_job_id_rejects_uppercase(self):
        """Test validate_job_id rejects IDs with uppercase letters."""
        assert validate_job_id("Castle-river-mountain-forest") is False
        assert validate_job_id("castle-RIVER-mountain-forest") is False
        assert validate_job_id("CASTLE-RIVER-MOUNTAIN-FOREST") is False

    def test_validate_job_id_rejects_numbers(self):
        """Test validate_job_id rejects IDs with numbers."""
        assert validate_job_id("castle-river-123-forest") is False
        assert validate_job_id("castle1-river-mountain-forest") is False
        assert validate_job_id("1castle-river-mountain-forest") is False

    def test_validate_job_id_rejects_special_characters(self):
        """Test validate_job_id rejects IDs with special characters."""
        assert validate_job_id("castle_river_mountain_forest") is False
        assert validate_job_id("castle.river.mountain.forest") is False
        assert validate_job_id("castle river mountain forest") is False

    def test_uniqueness_over_multiple_generations(self):
        """Test uniqueness over multiple generations."""
        # Generate many IDs and check for uniqueness
        job_ids = [generate_job_id() for _ in range(100)]
        # With 597 words choosing 4, there are many combinations
        # 100 IDs should all be unique (collision probability is very low)
        assert len(set(job_ids)) == len(job_ids)

    def test_generated_ids_are_valid(self):
        """Test that all generated IDs pass validation."""
        for _ in range(20):
            job_id = generate_job_id()
            assert validate_job_id(job_id) is True


class TestJobConfig:
    """Tests for JobConfig serialization."""

    def test_to_dict_from_dict_round_trip(self):
        """Test to_dict/from_dict round-trip preserves data."""
        config = JobConfig(
            sweep_type="balanced",
            n_agents=100,
            kappas=[Decimal("0.5"), Decimal("1.0"), Decimal("2.0")],
            concentrations=[Decimal("0.5"), Decimal("1.0")],
            mus=[Decimal("0"), Decimal("0.5"), Decimal("1.0")],
            cloud=True,
            outside_mid_ratios=[Decimal("0.8"), Decimal("1.0")],
            maturity_days=10,
            seeds=[42, 123, 456],
        )

        data = config.to_dict()
        restored = JobConfig.from_dict(data)

        assert restored.sweep_type == config.sweep_type
        assert restored.n_agents == config.n_agents
        assert restored.kappas == config.kappas
        assert restored.concentrations == config.concentrations
        assert restored.mus == config.mus
        assert restored.cloud == config.cloud
        assert restored.outside_mid_ratios == config.outside_mid_ratios
        assert restored.maturity_days == config.maturity_days
        assert restored.seeds == config.seeds

    def test_defaults(self):
        """Test JobConfig defaults are applied correctly."""
        config = JobConfig(
            sweep_type="ring",
            n_agents=50,
            kappas=[Decimal("1")],
            concentrations=[Decimal("1")],
            mus=[Decimal("0.5")],
        )

        assert config.cloud is False
        assert config.outside_mid_ratios == [Decimal("1")]
        assert config.maturity_days == 5
        assert config.seeds == [42]

    def test_from_dict_uses_defaults_for_missing_keys(self):
        """Test from_dict uses defaults for missing optional keys."""
        data = {
            "sweep_type": "ring",
            "n_agents": 50,
            "kappas": ["1"],
            "concentrations": ["1"],
            "mus": ["0.5"],
        }

        config = JobConfig.from_dict(data)

        assert config.cloud is False
        assert config.outside_mid_ratios == [Decimal("1")]
        assert config.maturity_days == 5
        assert config.seeds == [42]

    def test_to_dict_serializes_decimals_as_strings(self):
        """Test to_dict converts Decimals to strings for JSON compatibility."""
        config = JobConfig(
            sweep_type="ring",
            n_agents=50,
            kappas=[Decimal("0.25")],
            concentrations=[Decimal("0.5")],
            mus=[Decimal("0.75")],
            outside_mid_ratios=[Decimal("0.9")],
        )

        data = config.to_dict()

        assert data["kappas"] == ["0.25"]
        assert data["concentrations"] == ["0.5"]
        assert data["mus"] == ["0.75"]
        assert data["outside_mid_ratios"] == ["0.9"]


class TestJobEvent:
    """Tests for JobEvent serialization."""

    def test_to_dict_from_dict_round_trip(self):
        """Test to_dict/from_dict round-trip preserves data."""
        timestamp = datetime(2025, 1, 12, 10, 30, 45)
        event = JobEvent(
            job_id="castle-river-mountain-forest",
            event_type="progress",
            timestamp=timestamp,
            details={"run_id": "run_001", "metrics": {"delta_total": 0.05}},
        )

        data = event.to_dict()
        restored = JobEvent.from_dict(data)

        assert restored.job_id == event.job_id
        assert restored.event_type == event.event_type
        assert restored.timestamp == event.timestamp
        assert restored.details == event.details

    def test_to_dict_serializes_timestamp_as_iso(self):
        """Test to_dict converts timestamp to ISO format string."""
        timestamp = datetime(2025, 1, 12, 10, 30, 45)
        event = JobEvent(
            job_id="test-job",
            event_type="created",
            timestamp=timestamp,
        )

        data = event.to_dict()

        assert data["timestamp"] == "2025-01-12T10:30:45"

    def test_from_dict_uses_empty_dict_for_missing_details(self):
        """Test from_dict uses empty dict when details is missing."""
        data = {
            "job_id": "test-job",
            "event_type": "started",
            "timestamp": "2025-01-12T10:30:45",
        }

        event = JobEvent.from_dict(data)

        assert event.details == {}


class TestJob:
    """Tests for Job serialization."""

    def _create_sample_config(self) -> JobConfig:
        """Create a sample JobConfig for testing."""
        return JobConfig(
            sweep_type="balanced",
            n_agents=100,
            kappas=[Decimal("0.5"), Decimal("1.0")],
            concentrations=[Decimal("1.0")],
            mus=[Decimal("0.5")],
            cloud=True,
        )

    def test_to_dict_from_dict_round_trip(self):
        """Test to_dict/from_dict round-trip preserves data."""
        config = self._create_sample_config()
        created_at = datetime(2025, 1, 12, 10, 0, 0)
        completed_at = datetime(2025, 1, 12, 11, 30, 0)

        event = JobEvent(
            job_id="test-id",
            event_type="created",
            timestamp=created_at,
        )

        job = Job(
            job_id="test-id",
            created_at=created_at,
            status=JobStatus.COMPLETED,
            description="Test simulation",
            config=config,
            run_ids=["run_001", "run_002"],
            completed_at=completed_at,
            error=None,
            notes="Some notes",
            events=[event],
        )

        data = job.to_dict()
        restored = Job.from_dict(data)

        assert restored.job_id == job.job_id
        assert restored.created_at == job.created_at
        assert restored.status == job.status
        assert restored.description == job.description
        assert restored.config.sweep_type == job.config.sweep_type
        assert restored.config.n_agents == job.config.n_agents
        assert restored.run_ids == job.run_ids
        assert restored.completed_at == job.completed_at
        assert restored.error == job.error
        assert restored.notes == job.notes
        assert len(restored.events) == len(job.events)
        assert restored.events[0].event_type == job.events[0].event_type

    def test_to_dict_handles_none_values(self):
        """Test to_dict correctly handles None for optional fields."""
        config = self._create_sample_config()
        job = Job(
            job_id="test-id",
            created_at=datetime(2025, 1, 12, 10, 0, 0),
            status=JobStatus.PENDING,
            description="Test",
            config=config,
        )

        data = job.to_dict()

        assert data["completed_at"] is None
        assert data["error"] is None
        assert data["notes"] is None
        assert data["run_ids"] == []
        assert data["events"] == []

    def test_from_dict_handles_missing_optional_fields(self):
        """Test from_dict handles missing optional fields."""
        config = self._create_sample_config()
        data = {
            "job_id": "test-id",
            "created_at": "2025-01-12T10:00:00",
            "status": "pending",
            "description": "Test",
            "config": config.to_dict(),
        }

        job = Job.from_dict(data)

        assert job.run_ids == []
        assert job.completed_at is None
        assert job.error is None
        assert job.notes is None
        assert job.events == []

    def test_status_serialization(self):
        """Test JobStatus is serialized/deserialized correctly."""
        config = self._create_sample_config()

        for status in JobStatus:
            job = Job(
                job_id="test-id",
                created_at=datetime(2025, 1, 12, 10, 0, 0),
                status=status,
                description="Test",
                config=config,
            )

            data = job.to_dict()
            assert data["status"] == status.value

            restored = Job.from_dict(data)
            assert restored.status == status


class TestJobManager:
    """Tests for JobManager functionality."""

    def _create_sample_config(self) -> JobConfig:
        """Create a sample JobConfig for testing."""
        return JobConfig(
            sweep_type="ring",
            n_agents=50,
            kappas=[Decimal("1.0")],
            concentrations=[Decimal("1.0")],
            mus=[Decimal("0.5")],
        )

    def test_create_job_auto_generates_id(self):
        """Test create_job auto-generates ID when not provided."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test simulation",
            config=config,
        )

        # Should have a valid auto-generated ID
        assert validate_job_id(job.job_id) is True
        assert job.status == JobStatus.PENDING
        assert job.description == "Test simulation"

    def test_create_job_with_custom_id(self):
        """Test create_job with custom ID."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test simulation",
            config=config,
            job_id="custom-test-job-id",
        )

        assert job.job_id == "custom-test-job-id"

    def test_create_job_adds_created_event(self):
        """Test create_job adds a 'created' event."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test simulation",
            config=config,
        )

        assert len(job.events) == 1
        assert job.events[0].event_type == "created"
        assert job.events[0].job_id == job.job_id

    def test_start_job_updates_status(self):
        """Test start_job updates status to RUNNING."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test",
            config=config,
        )
        assert job.status == JobStatus.PENDING

        manager.start_job(job.job_id)

        updated_job = manager.get_job(job.job_id)
        assert updated_job.status == JobStatus.RUNNING
        assert len(updated_job.events) == 2
        assert updated_job.events[1].event_type == "started"

    def test_start_job_raises_for_unknown_id(self):
        """Test start_job raises KeyError for unknown job ID."""
        manager = JobManager()

        with pytest.raises(KeyError, match="Job not found"):
            manager.start_job("nonexistent-job-id")

    def test_record_progress_adds_run_id(self):
        """Test record_progress adds run_id to the job."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test",
            config=config,
        )
        manager.start_job(job.job_id)

        manager.record_progress(job.job_id, "run_001", {"delta_total": 0.05})
        manager.record_progress(job.job_id, "run_002", {"delta_total": 0.03})

        updated_job = manager.get_job(job.job_id)
        assert updated_job.run_ids == ["run_001", "run_002"]
        assert len(updated_job.events) == 4  # created, started, progress, progress
        assert updated_job.events[2].event_type == "progress"
        assert updated_job.events[2].details["run_id"] == "run_001"

    def test_record_progress_raises_for_unknown_id(self):
        """Test record_progress raises KeyError for unknown job ID."""
        manager = JobManager()

        with pytest.raises(KeyError, match="Job not found"):
            manager.record_progress("nonexistent-job-id", "run_001")

    def test_complete_job_sets_completed_at(self):
        """Test complete_job sets completed_at timestamp."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test",
            config=config,
        )
        manager.start_job(job.job_id)

        manager.complete_job(job.job_id, {"total_runs": 10})

        updated_job = manager.get_job(job.job_id)
        assert updated_job.status == JobStatus.COMPLETED
        assert updated_job.completed_at is not None
        assert updated_job.events[-1].event_type == "completed"
        assert updated_job.events[-1].details["summary"] == {"total_runs": 10}

    def test_complete_job_raises_for_unknown_id(self):
        """Test complete_job raises KeyError for unknown job ID."""
        manager = JobManager()

        with pytest.raises(KeyError, match="Job not found"):
            manager.complete_job("nonexistent-job-id")

    def test_fail_job_sets_error(self):
        """Test fail_job sets error message and status."""
        manager = JobManager()
        config = self._create_sample_config()

        job = manager.create_job(
            description="Test",
            config=config,
        )
        manager.start_job(job.job_id)

        manager.fail_job(job.job_id, "Connection timeout")

        updated_job = manager.get_job(job.job_id)
        assert updated_job.status == JobStatus.FAILED
        assert updated_job.error == "Connection timeout"
        assert updated_job.completed_at is not None
        assert updated_job.events[-1].event_type == "failed"
        assert updated_job.events[-1].details["error"] == "Connection timeout"

    def test_fail_job_raises_for_unknown_id(self):
        """Test fail_job raises KeyError for unknown job ID."""
        manager = JobManager()

        with pytest.raises(KeyError, match="Job not found"):
            manager.fail_job("nonexistent-job-id", "Some error")

    def test_get_job_returns_none_for_unknown_id(self):
        """Test get_job returns None for unknown ID."""
        manager = JobManager()

        result = manager.get_job("nonexistent-job-id")

        assert result is None

    def test_get_job_returns_job_by_id(self):
        """Test get_job returns the correct job by ID."""
        manager = JobManager()
        config = self._create_sample_config()

        job1 = manager.create_job(description="Job 1", config=config)
        job2 = manager.create_job(description="Job 2", config=config)

        retrieved = manager.get_job(job1.job_id)
        assert retrieved.job_id == job1.job_id
        assert retrieved.description == "Job 1"

        retrieved = manager.get_job(job2.job_id)
        assert retrieved.job_id == job2.job_id
        assert retrieved.description == "Job 2"

    def test_list_jobs_returns_all_jobs(self):
        """Test list_jobs returns all created jobs."""
        manager = JobManager()
        config = self._create_sample_config()

        job1 = manager.create_job(description="Job 1", config=config)
        job2 = manager.create_job(description="Job 2", config=config)
        job3 = manager.create_job(description="Job 3", config=config)

        jobs = manager.list_jobs()

        assert len(jobs) == 3
        job_ids = {j.job_id for j in jobs}
        assert job1.job_id in job_ids
        assert job2.job_id in job_ids
        assert job3.job_id in job_ids


class TestJobManagerPersistence:
    """Tests for JobManager persistence to disk."""

    def _create_sample_config(self) -> JobConfig:
        """Create a sample JobConfig for testing."""
        return JobConfig(
            sweep_type="ring",
            n_agents=50,
            kappas=[Decimal("1.0")],
            concentrations=[Decimal("1.0")],
            mus=[Decimal("0.5")],
        )

    def test_save_and_load_job_from_disk(self):
        """Test persistence: save job and load from disk."""
        with tempfile.TemporaryDirectory() as tmpdir:
            jobs_dir = Path(tmpdir)
            config = self._create_sample_config()

            # Create job with first manager
            manager1 = JobManager(jobs_dir=jobs_dir)
            job = manager1.create_job(
                description="Persistent job",
                config=config,
                job_id="test-persistent-job-id",
            )
            manager1.start_job(job.job_id)
            manager1.record_progress(job.job_id, "run_001")
            manager1.complete_job(job.job_id)

            # Verify manifest file was created
            manifest_path = jobs_dir / "test-persistent-job-id" / "job_manifest.json"
            assert manifest_path.exists()

            # Load with new manager instance
            manager2 = JobManager(jobs_dir=jobs_dir)
            loaded_job = manager2.get_job("test-persistent-job-id")

            assert loaded_job is not None
            assert loaded_job.job_id == "test-persistent-job-id"
            assert loaded_job.description == "Persistent job"
            assert loaded_job.status == JobStatus.COMPLETED
            assert loaded_job.run_ids == ["run_001"]
            assert len(loaded_job.events) == 4  # created, started, progress, completed

    def test_list_jobs_loads_from_disk(self):
        """Test list_jobs loads jobs from disk."""
        with tempfile.TemporaryDirectory() as tmpdir:
            jobs_dir = Path(tmpdir)
            config = self._create_sample_config()

            # Create jobs with first manager
            manager1 = JobManager(jobs_dir=jobs_dir)
            manager1.create_job(description="Job A", config=config, job_id="job-a-id")
            manager1.create_job(description="Job B", config=config, job_id="job-b-id")

            # List with new manager instance (should load from disk)
            manager2 = JobManager(jobs_dir=jobs_dir)
            jobs = manager2.list_jobs()

            assert len(jobs) == 2
            job_ids = {j.job_id for j in jobs}
            assert "job-a-id" in job_ids
            assert "job-b-id" in job_ids

    def test_manifest_json_structure(self):
        """Test manifest JSON file has correct structure."""
        with tempfile.TemporaryDirectory() as tmpdir:
            jobs_dir = Path(tmpdir)
            config = self._create_sample_config()

            manager = JobManager(jobs_dir=jobs_dir)
            job = manager.create_job(
                description="Test job",
                config=config,
                job_id="test-structure-job",
                notes="Test notes",
            )

            manifest_path = jobs_dir / "test-structure-job" / "job_manifest.json"
            with open(manifest_path) as f:
                data = json.load(f)

            assert data["job_id"] == "test-structure-job"
            assert data["description"] == "Test job"
            assert data["status"] == "pending"
            assert data["notes"] == "Test notes"
            assert "config" in data
            assert data["config"]["sweep_type"] == "ring"
            assert data["config"]["n_agents"] == 50
            assert "created_at" in data
            assert "events" in data

    def test_in_memory_only_when_no_jobs_dir(self):
        """Test jobs are in-memory only when jobs_dir is None."""
        config = self._create_sample_config()

        manager = JobManager(jobs_dir=None)
        job = manager.create_job(
            description="In-memory job",
            config=config,
        )

        # Should be retrievable from in-memory cache
        retrieved = manager.get_job(job.job_id)
        assert retrieved is not None
        assert retrieved.description == "In-memory job"

    def test_updates_persist_to_disk(self):
        """Test that job updates are persisted to disk."""
        with tempfile.TemporaryDirectory() as tmpdir:
            jobs_dir = Path(tmpdir)
            config = self._create_sample_config()

            manager = JobManager(jobs_dir=jobs_dir)
            job = manager.create_job(
                description="Test",
                config=config,
                job_id="test-updates-id",
            )

            # Initial state
            manifest_path = jobs_dir / "test-updates-id" / "job_manifest.json"
            with open(manifest_path) as f:
                data = json.load(f)
            assert data["status"] == "pending"

            # After start
            manager.start_job(job.job_id)
            with open(manifest_path) as f:
                data = json.load(f)
            assert data["status"] == "running"

            # After completion
            manager.complete_job(job.job_id)
            with open(manifest_path) as f:
                data = json.load(f)
            assert data["status"] == "completed"
            assert data["completed_at"] is not None

```

---

### 🧪 tests/unit/test_reserves.py

```python
import pytest
from bilancio.engines.system import System
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.agents.bank import Bank
from bilancio.core.errors import ValidationError


def test_mint_reserves():
    """Test minting reserves to a bank."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Mint 100 units of reserves to B1
    reserve_id = sys.mint_reserves("B1", 100)
    
    # Check CB outstanding
    assert sys.state.cb_reserves_outstanding == 100
    
    # Check B1 has the reserves
    assert reserve_id in b1.asset_ids
    reserve_instr = sys.state.contracts[reserve_id]
    assert reserve_instr.amount == 100
    assert reserve_instr.asset_holder_id == "B1"
    assert reserve_instr.liability_issuer_id == "CB1"
    assert reserve_instr.kind == "reserve_deposit"
    
    # Check CB liability
    assert reserve_id in cb.liability_ids
    
    # Check invariants
    sys.assert_invariants()


def test_transfer_reserves():
    """Test transferring reserves between banks."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    
    # Mint reserves to B1
    sys.mint_reserves("B1", 150)
    
    # Transfer 60 reserves from B1 to B2
    sys.transfer_reserves("B1", "B2", 60)
    
    # Check B1 has 90, B2 has 60
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    b2_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b2.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 90
    assert b2_reserves == 60
    
    # Check CB outstanding unchanged
    assert sys.state.cb_reserves_outstanding == 150
    
    # Check invariants
    sys.assert_invariants()


def test_convert_reserves_to_cash():
    """Test converting reserves to cash."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Setup bank with reserves
    sys.mint_reserves("B1", 200)
    
    # Convert 80 reserves to cash
    sys.convert_reserves_to_cash("B1", 80)
    
    # Check reserves decreased
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 120
    
    # Check cash increased
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert b1_cash == 80
    
    # Check both CB counters updated
    assert sys.state.cb_reserves_outstanding == 120
    assert sys.state.cb_cash_outstanding == 80
    
    # Check invariants
    sys.assert_invariants()


def test_convert_cash_to_reserves():
    """Test converting cash to reserves."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Setup bank with cash
    sys.mint_cash("B1", 120)
    
    # Convert 50 cash to reserves
    sys.convert_cash_to_reserves("B1", 50)
    
    # Check cash decreased
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert b1_cash == 70
    
    # Check reserves increased
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 50
    
    # Check both CB counters updated
    assert sys.state.cb_cash_outstanding == 70
    assert sys.state.cb_reserves_outstanding == 50
    
    # Check invariants
    sys.assert_invariants()


def test_reserves_roundtrip():
    """Test round-trip conversion: reserves to cash and back."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Start with 100 reserves
    sys.mint_reserves("B1", 100)
    initial_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    
    # Convert all reserves to cash
    sys.convert_reserves_to_cash("B1", 100)
    
    # Verify we have cash, no reserves
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_cash == 100
    assert b1_reserves == 0
    
    # Convert all cash back to reserves
    sys.convert_cash_to_reserves("B1", 100)
    
    # Verify amounts preserved
    final_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    final_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert final_reserves == initial_reserves
    assert final_cash == 0
    
    # Check CB counters are back to original state
    assert sys.state.cb_reserves_outstanding == 100
    assert sys.state.cb_cash_outstanding == 0
    
    # Check invariants
    sys.assert_invariants()


def test_transfer_insufficient_reserves():
    """Test error handling for insufficient reserves transfer."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    
    # Mint only 50 reserves to B1
    sys.mint_reserves("B1", 50)
    
    # Try to transfer more reserves than available
    with pytest.raises(ValidationError, match="insufficient reserves"):
        sys.transfer_reserves("B1", "B2", 100)
    
    # Check state unchanged after failure (atomic rollback means B1 still has all 50)
    assert sys.state.cb_reserves_outstanding == 50
    # Get agents from system state (they may have been rolled back)
    b1_from_sys = sys.state.agents["B1"]
    b2_from_sys = sys.state.agents["B2"]
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    b2_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b2_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 50
    assert b2_reserves == 0
    
    # Check invariants
    sys.assert_invariants()


def test_convert_insufficient_reserves_to_cash():
    """Test error handling for insufficient reserves conversion."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Mint only 30 reserves
    sys.mint_reserves("B1", 30)
    
    # Try to convert more reserves than available
    with pytest.raises(ValidationError, match="insufficient reserves"):
        sys.convert_reserves_to_cash("B1", 50)
    
    # Check state unchanged after atomic rollback
    assert sys.state.cb_reserves_outstanding == 30
    assert sys.state.cb_cash_outstanding == 0
    # Get agent from system state (may have been rolled back)
    b1_from_sys = sys.state.agents["B1"]
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert b1_reserves == 30
    assert b1_cash == 0
    
    # Check invariants
    sys.assert_invariants()


def test_convert_insufficient_cash_to_reserves():
    """Test error handling for insufficient cash conversion."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Mint only 40 cash
    sys.mint_cash("B1", 40)
    
    # Try to convert more cash than available
    with pytest.raises(ValidationError, match="insufficient cash"):
        sys.convert_cash_to_reserves("B1", 60)
    
    # Check state unchanged after atomic rollback
    assert sys.state.cb_cash_outstanding == 40
    assert sys.state.cb_reserves_outstanding == 0
    # Get agent from system state (may have been rolled back)
    b1_from_sys = sys.state.agents["B1"]
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1_from_sys.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_cash == 40
    assert b1_reserves == 0
    
    # Check invariants
    sys.assert_invariants()


def test_no_op_reserve_transfer():
    """Test error handling for no-op reserve transfer."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Mint reserves to B1
    sys.mint_reserves("B1", 100)
    
    # Try to transfer to same bank
    with pytest.raises(ValidationError, match="no-op transfer"):
        sys.transfer_reserves("B1", "B1", 50)
    
    # Check state unchanged
    assert sys.state.cb_reserves_outstanding == 100
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 100
    
    # Check invariants
    sys.assert_invariants()


def test_multiple_reserve_transfers_with_coalescing():
    """Test multiple reserve transfers result in proper coalescing."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    b2 = Bank(id="B2", name="Bank 2", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    sys.add_agent(b2)
    
    # Mint reserves to B1 in multiple chunks
    sys.mint_reserves("B1", 30)
    sys.mint_reserves("B1", 40)
    sys.mint_reserves("B1", 30)
    
    # B1 has 3 reserve instruments totaling 100
    b1_reserve_ids = [cid for cid in b1.asset_ids 
                     if sys.state.contracts[cid].kind == "reserve_deposit"]
    assert len(b1_reserve_ids) == 3
    assert sum(sys.state.contracts[cid].amount for cid in b1_reserve_ids) == 100
    
    # Transfer all to B2 in parts
    sys.transfer_reserves("B1", "B2", 25)
    sys.transfer_reserves("B1", "B2", 35)
    sys.transfer_reserves("B1", "B2", 40)
    
    # B2 should have merged reserve instruments
    b2_reserve_ids = [cid for cid in b2.asset_ids 
                     if sys.state.contracts[cid].kind == "reserve_deposit"]
    # Should be consolidated to fewer instruments (ideally 1)
    assert len(b2_reserve_ids) <= 3
    assert sum(sys.state.contracts[cid].amount for cid in b2_reserve_ids) == 100
    
    # B1 should have no reserves
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    assert b1_reserves == 0
    
    # Check invariants
    sys.assert_invariants()


def test_partial_reserve_conversion():
    """Test partial conversion of reserves to cash and back."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    b1 = Bank(id="B1", name="Bank 1", kind="bank")
    sys.add_agent(cb)
    sys.add_agent(b1)
    
    # Start with 200 reserves
    sys.mint_reserves("B1", 200)
    
    # Convert 75 reserves to cash
    sys.convert_reserves_to_cash("B1", 75)
    
    # Check mixed holdings
    b1_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    b1_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert b1_reserves == 125
    assert b1_cash == 75
    
    # Convert 25 cash back to reserves
    sys.convert_cash_to_reserves("B1", 25)
    
    # Check final state
    final_reserves = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "reserve_deposit"
    )
    final_cash = sum(
        sys.state.contracts[cid].amount 
        for cid in b1.asset_ids 
        if sys.state.contracts[cid].kind == "cash"
    )
    assert final_reserves == 150
    assert final_cash == 50
    
    # Check CB counters
    assert sys.state.cb_reserves_outstanding == 150
    assert sys.state.cb_cash_outstanding == 50
    
    # Check invariants
    sys.assert_invariants()
```

---

### 🧪 tests/unit/test_settle_obligation.py

```python
import pytest
from decimal import Decimal
from bilancio.engines.system import System
from bilancio.domain.agents.household import Household
from bilancio.domain.agents.central_bank import CentralBank
from bilancio.domain.instruments.credit import Payable
from bilancio.domain.instruments.delivery import DeliveryObligation
from bilancio.core.errors import ValidationError


def test_settle_deliverable_obligation():
    """Test settling a delivery obligation (e.g., promise to deliver goods)."""
    sys = System()
    seller = Household(id="SELLER", name="Seller", kind="household")
    buyer = Household(id="BUYER", name="Buyer", kind="household")
    sys.add_agent(seller)
    sys.add_agent(buyer)
    
    # Create a promise to deliver 10 chairs
    promise_id = sys.create_delivery_obligation(
        from_agent="SELLER",  # Seller has liability to deliver
        to_agent="BUYER",     # Buyer has claim to receive
        sku="CHAIR",
        quantity=10,
        unit_price=Decimal("0"),
        due_day=1
    )
    
    # Verify the obligation exists
    assert promise_id in sys.state.contracts
    assert promise_id in buyer.asset_ids
    assert promise_id in seller.liability_ids
    
    # Settle the obligation (e.g., after chairs are delivered)
    sys.settle_obligation(promise_id)
    
    # Verify the obligation is extinguished
    assert promise_id not in sys.state.contracts
    assert promise_id not in buyer.asset_ids
    assert promise_id not in seller.liability_ids
    
    # Verify invariants still hold
    sys.assert_invariants()


def test_settle_payable_obligation():
    """Test settling a payable obligation."""
    sys = System()
    debtor = Household(id="DEBTOR", name="Debtor", kind="household")
    creditor = Household(id="CREDITOR", name="Creditor", kind="household")
    sys.add_agent(debtor)
    sys.add_agent(creditor)
    
    # Create a payable
    payable = Payable(
        id="PAY1",
        kind="payable",
        amount=100,
        denom="USD",
        asset_holder_id="CREDITOR",
        liability_issuer_id="DEBTOR",
        due_day=1
    )
    sys.add_contract(payable)
    
    # Verify the payable exists
    assert "PAY1" in sys.state.contracts
    assert "PAY1" in creditor.asset_ids
    assert "PAY1" in debtor.liability_ids
    
    # Settle the payable (e.g., after payment is made)
    sys.settle_obligation("PAY1")
    
    # Verify the payable is extinguished
    assert "PAY1" not in sys.state.contracts
    assert "PAY1" not in creditor.asset_ids
    assert "PAY1" not in debtor.liability_ids
    
    sys.assert_invariants()


def test_settle_nonexistent_contract_fails():
    """Test that settling a non-existent contract raises an error."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    sys.add_agent(h1)
    
    with pytest.raises(ValidationError, match="Contract FAKE123 not found"):
        sys.settle_obligation("FAKE123")


def test_settle_contract_not_in_holder_assets_fails():
    """Test error when contract is not in holder's assets (data inconsistency)."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    h2 = Household(id="H2", name="H2", kind="household")
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Create a delivery obligation
    d_id = sys.create_delivery_obligation("H1", "H2", "ITEM", 1, Decimal("0"), due_day=1)
    
    # Manually corrupt the data by removing from holder's assets
    h2.asset_ids.remove(d_id)
    
    # Should fail with validation error
    with pytest.raises(ValidationError, match="not in holder's assets"):
        sys.settle_obligation(d_id)


def test_settle_contract_not_in_issuer_liabilities_fails():
    """Test error when contract is not in issuer's liabilities (data inconsistency)."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    h2 = Household(id="H2", name="H2", kind="household")
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Create a delivery obligation
    d_id = sys.create_delivery_obligation("H1", "H2", "ITEM", 1, Decimal("0"), due_day=1)
    
    # Manually corrupt the data by removing from issuer's liabilities
    h1.liability_ids.remove(d_id)
    
    # Should fail with validation error
    with pytest.raises(ValidationError, match="not in issuer's liabilities"):
        sys.settle_obligation(d_id)


def test_settle_obligation_is_atomic():
    """Test that settle_obligation is atomic - failures roll back all changes."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    h2 = Household(id="H2", name="H2", kind="household")
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Create a delivery obligation
    d_id = sys.create_delivery_obligation("H1", "H2", "ITEM", 5, Decimal("0"), due_day=1)
    
    # Corrupt data to force failure partway through
    original_assets = h2.asset_ids.copy()
    original_liabilities = h1.liability_ids.copy()
    h1.liability_ids.remove(d_id)  # This will cause settle to fail
    
    # Attempt to settle (should fail)
    with pytest.raises(ValidationError):
        sys.settle_obligation(d_id)
    
    # Verify nothing changed (atomic rollback)
    assert d_id in sys.state.contracts
    # Need to get the agent from sys.state after rollback
    h2_from_sys = sys.state.agents["H2"]
    assert d_id in h2_from_sys.asset_ids  # Should still be there despite partial execution
    # Note: h1.liability_ids was manually corrupted, so we can't check that
    
    # Fix the corruption and verify we can still settle properly
    h1_from_sys = sys.state.agents["H1"]
    h1_from_sys.liability_ids.append(d_id)
    sys.settle_obligation(d_id)
    assert d_id not in sys.state.contracts


def test_settle_obligation_logs_event():
    """Test that settling an obligation logs the appropriate event."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    h2 = Household(id="H2", name="H2", kind="household")
    sys.add_agent(h1)
    sys.add_agent(h2)
    
    # Create a delivery obligation
    d_id = sys.create_delivery_obligation("H1", "H2", "WIDGET", 3, Decimal("0"), due_day=1)
    
    # Clear existing events to make test cleaner
    sys.state.events.clear()
    
    # Settle the obligation
    sys.settle_obligation(d_id)
    
    # Check that an ObligationSettled event was logged
    assert len(sys.state.events) == 1
    event = sys.state.events[0]
    assert event["kind"] == "ObligationSettled"
    assert event["contract_id"] == d_id
    assert event["holder_id"] == "H2"
    assert event["issuer_id"] == "H1"
    assert event["contract_kind"] == "delivery_obligation"
    assert event["amount"] == 3


def test_complete_chair_transaction_with_settlement():
    """Test the complete chair transaction example with settlement."""
    sys = System()
    cb = CentralBank(id="CB1", name="Central Bank", kind="central_bank")
    seller = Household(id="YOU", name="Chair Seller", kind="household")
    buyer = Household(id="ME", name="Chair Buyer", kind="household")
    
    sys.add_agent(cb)
    sys.add_agent(seller)
    sys.add_agent(buyer)
    
    # Step 1: Give buyer cash to pay
    sys.mint_cash("ME", 100)
    
    # Step 2: Create promise to deliver chairs
    chair_promise_id = sys.create_delivery_obligation(
        from_agent="YOU",  # Seller promises to deliver
        to_agent="ME",     # Buyer has claim to receive
        sku="CHAIR",
        quantity=10,
        unit_price=Decimal("0"),  # Test uses zero price
        due_day=1
    )
    
    # Step 3: Buyer pays seller
    sys.transfer_cash("ME", "YOU", 100)
    
    # Verify state after payment
    seller_cash = sum(sys.state.contracts[cid].amount for cid in seller.asset_ids
                      if sys.state.contracts[cid].kind == "cash")
    buyer_cash = sum(sys.state.contracts[cid].amount for cid in buyer.asset_ids
                     if sys.state.contracts[cid].kind == "cash")
    assert seller_cash == 100
    assert buyer_cash == 0
    assert chair_promise_id in buyer.asset_ids
    assert chair_promise_id in seller.liability_ids
    
    # Step 4: Later, seller delivers chairs (represented by settling the obligation)
    sys.settle_obligation(chair_promise_id)
    
    # Verify final state - obligation is extinguished
    assert chair_promise_id not in sys.state.contracts
    assert chair_promise_id not in buyer.asset_ids
    assert chair_promise_id not in seller.liability_ids
    
    # Seller still has the cash
    seller_cash = sum(sys.state.contracts[cid].amount for cid in seller.asset_ids
                      if sys.state.contracts[cid].kind == "cash")
    assert seller_cash == 100
    
    sys.assert_invariants()


def test_settle_multiple_obligations():
    """Test settling multiple obligations in sequence."""
    sys = System()
    h1 = Household(id="H1", name="H1", kind="household")
    h2 = Household(id="H2", name="H2", kind="household")
    h3 = Household(id="H3", name="H3", kind="household")
    sys.add_agent(h1)
    sys.add_agent(h2)
    sys.add_agent(h3)
    
    # Create multiple obligations
    d1 = sys.create_delivery_obligation("H1", "H2", "ITEM1", 5, Decimal("0"), due_day=1)
    d2 = sys.create_delivery_obligation("H2", "H3", "ITEM2", 3, Decimal("0"), due_day=1)
    d3 = sys.create_delivery_obligation("H1", "H3", "ITEM3", 7, Decimal("0"), due_day=1)
    
    # Settle them one by one
    sys.settle_obligation(d1)
    assert d1 not in sys.state.contracts
    assert d2 in sys.state.contracts
    assert d3 in sys.state.contracts
    
    sys.settle_obligation(d2)
    assert d2 not in sys.state.contracts
    assert d3 in sys.state.contracts
    
    sys.settle_obligation(d3)
    assert d3 not in sys.state.contracts
    
    # All obligations should be settled
    assert len([cid for cid in h1.liability_ids if cid in sys.state.contracts]) == 0
    assert len([cid for cid in h2.asset_ids if cid in sys.state.contracts]) == 0
    assert len([cid for cid in h3.asset_ids if cid in sys.state.contracts]) == 0
    
    sys.assert_invariants()
```

---

## End of Codebase

Generated from: /home/runner/work/bilancio/bilancio
Total source files: 117
Total test files: 52
