<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Example 14: Ticket-Level Transfer</title>
  <style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;line-height:1.6;color:#333;background:#f5f5f5}
.container{max-width:1400px;margin:0 auto;padding:20px}
header{background:#fff;border-radius:8px;padding:24px;margin-bottom:24px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
h1{color:#2563eb;font-size:28px;margin-bottom:8px}
h2{color:#475569;font-size:20px;margin-bottom:16px}
h3{color:#334155;font-size:18px;margin-bottom:12px}
h4{color:#475569;font-size:16px;margin:8px 0;font-weight:600}
.description{color:#64748b;font-style:italic;margin-bottom:16px}
.meta{display:flex;gap:24px;color:#64748b;font-size:14px}
.meta span{display:inline-block}
.t-account{background:#fff;border-radius:8px;padding:20px;margin-bottom:20px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
.t-account .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.t-account table.side{width:100%;border-collapse:collapse;font-size:14px}
.t-account th,.t-account td{border-bottom:1px solid #e5e7eb;border-right:1px solid #eef2f7;padding:8px;text-align:left}
.t-account th:last-child,.t-account td:last-child{border-right:none}
.t-account tbody tr:nth-child(even){background:#fafafa}
.t-account th{background:#f9fafb;font-weight:600;color:#374151}
.t-account td.qty,.t-account td.val,.t-account td.mat{text-align:right;white-space:nowrap}
.t-account td.name{font-weight:500}
.t-account td.empty{text-align:center;color:#9ca3af}
.assets-side h4{color:#16a34a}
.liabilities-side h4{color:#dc2626}
.events-table{background:#fff;border-radius:8px;padding:20px;margin-bottom:24px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
.events-table table{width:100%;border-collapse:collapse;font-size:14px}
.events-table th,.events-table td{border-bottom:1px solid #e5e7eb;border-right:1px solid #eef2f7;padding:8px;text-align:left}
.events-table th:last-child,.events-table td:last-child{border-right:none}
.events-table tbody tr:nth-child(even){background:#f7f9fc}
.events-table th{background:#f9fafb;font-weight:600;color:#374151}
.events-table td.qty,.events-table td.amount{text-align:center;white-space:nowrap}
.events-table td.event-kind{font-weight:500;color:#3b82f6}
.events-table td.notes{font-size:13px;color:#64748b}
.agents>h2{margin-bottom:20px;padding:0 20px}
.day-section{margin-bottom:40px;padding-bottom:40px;border-bottom:2px solid #e5e7eb}
.day-section:last-child{border-bottom:none}
.day-header{color:#1f2937;font-size:24px;margin-bottom:24px;padding:12px 0;border-bottom:1px solid #e5e7eb}
.events-section{margin-bottom:24px}
.balances-section{margin-top:24px}
.balances-section>h3{margin-bottom:20px;color:#374151;font-size:20px}
footer{text-align:center;color:#9ca3af;font-size:14px;margin-top:40px;padding:20px}
@media (max-width:768px){.t-account .grid{grid-template-columns:1fr}.meta{flex-direction:column;gap:8px}}



/* Dealer card styling */
.dealer-card {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.dealer-card h3 {
  color: #1e40af;
  margin-bottom: 16px;
  border-bottom: 2px solid #dbeafe;
  padding-bottom: 8px;
}
.params-table {
  width: 100%;
  border-collapse: collapse;
}
.params-table th {
  text-align: left;
  padding: 6px 12px;
  color: #64748b;
  font-weight: 500;
  width: 40%;
}
.params-table td {
  text-align: right;
  padding: 6px 12px;
  font-family: 'SF Mono', Monaco, monospace;
  color: #1f2937;
}
.params-table tr.section-header th {
  color: #374151;
  font-weight: 600;
  padding-top: 12px;
  border-bottom: 1px solid #e5e7eb;
}
/* VBT card */
.vbt-card {
  background: linear-gradient(135deg, #f0fdf4, #fff);
  border-left: 4px solid #16a34a;
}
.vbt-card h3 {
  color: #16a34a;
  border-bottom-color: #bbf7d0;
}
/* Event type colors */
.event-trade { color: #3b82f6; }
.event-passthrough { color: #8b5cf6; }
.event-rebucket { color: #f59e0b; }
.event-settlement { color: #16a34a; }
.event-default { color: #dc2626; }
.event-quote { color: #64748b; }
.event-vbt-anchor-update { color: #14b8a6; }
/* Pin indicators */
.pin-indicator {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-left: 4px;
}
.pin-indicator.pinned { background: #f59e0b; }
.pin-indicator.not-pinned { background: #d1d5db; }
/* Grid layouts */
.dealers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-bottom: 24px;
}
.traders-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 20px;
}
/* Inventory list */
.inventory-list {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #e5e7eb;
}
.inventory-list h4 {
  color: #64748b;
  font-size: 14px;
  margin-bottom: 8px;
}
.inventory-list ul {
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 13px;
}
.inventory-list li {
  padding: 4px 0;
  color: #4b5563;
  font-family: 'SF Mono', Monaco, monospace;
}

  </style>
</head>
<body>
  <div class="container">
    
<header>
  <h1>Example 14: Ticket-Level Transfer</h1>
  <p class="description">No generic materialization - specific IDs transferred</p>
  <div class="meta">
    <span><strong>Days:</strong> 1</span>
    <span><strong>Buckets:</strong> short, mid, long</span>
    <span><strong>Traders:</strong> 3</span>
    <span><strong>Tickets:</strong> 2</span>
    <span><strong>Ticket Size (S):</strong> 1</span>
  </div>
</header>


    <main>
      
<section class="day-section">
  <h2 class="day-header"> Day 0 (Setup)</h2>

  
<div class="events-table">
  <h3>Day 0 (Setup) Events</h3>
  <p style="color: #9ca3af; font-style: italic;">No events for this day</p>
</div>


  <div class="balances-section">
    <h3>Market State</h3>
    <div class="dealers-grid">
      
<div class="dealer-card">
  <h3>Dealer: SHORT</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>0</td></tr>
      <tr><th>Face inventory (x)</th><td>0</td></tr>
      <tr><th>Cash (C)</th><td>0</td></tr>
      <tr><th>Mid-valued (V)</th><td>0</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>0</td></tr>
      <tr><th>One-sided cap (X*)</th><td>0</td></tr>
      <tr><th>Ladder rungs (N)</th><td>1</td></tr>
      <tr><th>Layoff prob (位)</th><td>1</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0</td></tr>
      <tr><th>Midline p(x)</th><td>0</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
    </tbody>
  </table>
  
</div>

<div class="dealer-card">
  <h3>Dealer: MID</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>2</td></tr>
      <tr><th>Face inventory (x)</th><td>2</td></tr>
      <tr><th>Cash (C)</th><td>2</td></tr>
      <tr><th>Mid-valued (V)</th><td>4</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>4</td></tr>
      <tr><th>One-sided cap (X*)</th><td>4</td></tr>
      <tr><th>Ladder rungs (N)</th><td>5</td></tr>
      <tr><th>Layoff prob (位)</th><td>0.2</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0.06</td></tr>
      <tr><th>Midline p(x)</th><td>1</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0.97</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>1.03</td></tr>
    </tbody>
  </table>
  
  <div class="inventory-list">
    <h4>Inventory (2 tickets)</h4>
    <ul>
      <li>k1 (issuer: I1, face: 1, : 6)</li><li>k2 (issuer: I2, face: 1, : 5)</li>
    </ul>
  </div>

</div>

<div class="dealer-card">
  <h3>Dealer: LONG</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>0</td></tr>
      <tr><th>Face inventory (x)</th><td>0</td></tr>
      <tr><th>Cash (C)</th><td>0</td></tr>
      <tr><th>Mid-valued (V)</th><td>0</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>0</td></tr>
      <tr><th>One-sided cap (X*)</th><td>0</td></tr>
      <tr><th>Ladder rungs (N)</th><td>1</td></tr>
      <tr><th>Layoff prob (位)</th><td>1</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0</td></tr>
      <tr><th>Midline p(x)</th><td>0</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
    </tbody>
  </table>
  
</div>

    </div>
    <div class="dealers-grid">
      
<div class="dealer-card vbt-card">
  <h3>VBT: SHORT</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>0</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

<div class="dealer-card vbt-card">
  <h3>VBT: MID</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>10</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

<div class="dealer-card vbt-card">
  <h3>VBT: LONG</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>0</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

    </div>
  </div>

  
  <div class="balances-section">
    <h3>Trader Balances</h3>
    <div class="traders-grid">
      
<div class="t-account">
  <h3>I1</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (100)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">100</td>
      </tr>
    
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (1)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">k1</td>
        <td class="val">1 <span style="color: #9ca3af; font-size: 12px;">(to dealer_mid_3, mat=6)</span></td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="t-account">
  <h3>I2</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (100)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">100</td>
      </tr>
    
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (1)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">k2</td>
        <td class="val">1 <span style="color: #9ca3af; font-size: 12px;">(to dealer_mid_3, mat=5)</span></td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="t-account">
  <h3>buyer_B</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (2)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">2</td>
      </tr>
    
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (0)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td colspan="2" class="empty">No obligations</td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

    </div>
  </div>

</section>

<section class="day-section">
  <h2 class="day-header"> Day 1</h2>

  
<div class="events-table">
  <h3>Day 1 Events</h3>
  <table>
    <thead>
      <tr>
        <th style="width: 120px;">Kind</th>
        <th>Details</th>
        <th style="width: 200px;">Notes</th>
      </tr>
    </thead>
    <tbody>
      
          <tr>
            <td class="event-quote">quote</td>
            <td>[mid] D: 1.02/1.08, VBT: 0.85/1.15</td>
            <td class="notes">inv=1, cap=4</td>
          </tr>
        
    </tbody>
  </table>
</div>


  <div class="balances-section">
    <h3>Market State</h3>
    <div class="dealers-grid">
      
<div class="dealer-card">
  <h3>Dealer: SHORT</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>0</td></tr>
      <tr><th>Face inventory (x)</th><td>0</td></tr>
      <tr><th>Cash (C)</th><td>0</td></tr>
      <tr><th>Mid-valued (V)</th><td>0</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>0</td></tr>
      <tr><th>One-sided cap (X*)</th><td>0</td></tr>
      <tr><th>Ladder rungs (N)</th><td>1</td></tr>
      <tr><th>Layoff prob (位)</th><td>1</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0</td></tr>
      <tr><th>Midline p(x)</th><td>0</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
    </tbody>
  </table>
  
</div>

<div class="dealer-card">
  <h3>Dealer: MID</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>1</td></tr>
      <tr><th>Face inventory (x)</th><td>1</td></tr>
      <tr><th>Cash (C)</th><td>3.03</td></tr>
      <tr><th>Mid-valued (V)</th><td>4.03</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>4</td></tr>
      <tr><th>One-sided cap (X*)</th><td>4</td></tr>
      <tr><th>Ladder rungs (N)</th><td>5</td></tr>
      <tr><th>Layoff prob (位)</th><td>0.2</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0.06</td></tr>
      <tr><th>Midline p(x)</th><td>1.05</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>1.02</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>1.08</td></tr>
    </tbody>
  </table>
  
  <div class="inventory-list">
    <h4>Inventory (1 tickets)</h4>
    <ul>
      <li>k1 (issuer: I1, face: 1, : 6)</li>
    </ul>
  </div>

</div>

<div class="dealer-card">
  <h3>Dealer: LONG</h3>
  <table class="params-table">
    <tbody>
      <tr class="section-header"><th colspan="2">Inventory</th></tr>
      <tr><th>Tickets (a)</th><td>0</td></tr>
      <tr><th>Face inventory (x)</th><td>0</td></tr>
      <tr><th>Cash (C)</th><td>0</td></tr>
      <tr><th>Mid-valued (V)</th><td>0</td></tr>
      <tr class="section-header"><th colspan="2">Capacity</th></tr>
      <tr><th>Max tickets (K*)</th><td>0</td></tr>
      <tr><th>One-sided cap (X*)</th><td>0</td></tr>
      <tr><th>Ladder rungs (N)</th><td>1</td></tr>
      <tr><th>Layoff prob (位)</th><td>1</td></tr>
      <tr class="section-header"><th colspan="2">Quotes</th></tr>
      <tr><th>Inside width (I)</th><td>0</td></tr>
      <tr><th>Midline p(x)</th><td>0</td></tr>
      <tr><th>Bid <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
      <tr><th>Ask <span class="pin-indicator not-pinned" title="Not pinned"></span></th><td>0</td></tr>
    </tbody>
  </table>
  
</div>

    </div>
    <div class="dealers-grid">
      
<div class="dealer-card vbt-card">
  <h3>VBT: SHORT</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>0</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

<div class="dealer-card vbt-card">
  <h3>VBT: MID</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>10</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

<div class="dealer-card vbt-card">
  <h3>VBT: LONG</h3>
  <table class="params-table">
    <tbody>
      <tr><th>Mid anchor (M)</th><td>1</td></tr>
      <tr><th>Spread anchor (O)</th><td>0.3</td></tr>
      <tr><th>Ask (A = M + O/2)</th><td>1.15</td></tr>
      <tr><th>Bid (B = M - O/2)</th><td>0.85</td></tr>
      <tr><th>Cash</th><td>0</td></tr>
      <tr><th>Inventory</th><td>0 tickets</td></tr>
    </tbody>
  </table>
</div>

    </div>
  </div>

  
  <div class="balances-section">
    <h3>Trader Balances</h3>
    <div class="traders-grid">
      
<div class="t-account">
  <h3>I1</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (100)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">100</td>
      </tr>
    
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (1)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">k1</td>
        <td class="val">1 <span style="color: #9ca3af; font-size: 12px;">(to dealer_mid_3, mat=6)</span></td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="t-account">
  <h3>I2</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (100)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">100</td>
      </tr>
    
      <tr>
        <td colspan="2" class="empty">No tickets owned</td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (1)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">k2</td>
        <td class="val">1 <span style="color: #9ca3af; font-size: 12px;">(to buyer_B, mat=5)</span></td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="t-account">
  <h3>buyer_B</h3>
  <div class="grid">
    <div class="assets-side">
      <h4>Assets (1.97)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td class="name">Cash</td>
        <td class="val">0.97</td>
      </tr>
    
      <tr>
        <td class="name">k2</td>
        <td class="val">1 <span style="color: #9ca3af; font-size: 12px;">(I2, =5)</span></td>
      </tr>
        
        </tbody>
      </table>
    </div>
    <div class="liabilities-side">
      <h4>Liabilities (0)</h4>
      <table class="side">
        <tbody>
          
      <tr>
        <td colspan="2" class="empty">No obligations</td>
      </tr>
        
        </tbody>
      </table>
    </div>
  </div>
</div>

    </div>
  </div>

</section>

    </main>

    <footer>
      Generated by bilancio dealer ring simulation
    </footer>
  </div>
</body>
</html>
