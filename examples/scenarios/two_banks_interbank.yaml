version: 1
name: "Two Banks with Interbank Settlement"
description: "Demonstrates interbank clearing when customers at different banks transact"

agents:
  - id: CB
    kind: central_bank
    name: Central Bank
  - id: B1
    kind: bank
    name: First Bank
  - id: B2
    kind: bank
    name: Second Bank
  - id: H1
    kind: household
    name: Alice
  - id: H2
    kind: household
    name: Bob
  - id: H3
    kind: household
    name: Charlie

initial_actions:
  # Initialize banks with reserves
  - mint_reserves: {to: B1, amount: 20000}
  - mint_reserves: {to: B2, amount: 15000}
  
  # Give households initial cash
  - mint_cash: {to: H1, amount: 5000}
  - mint_cash: {to: H2, amount: 4000}
  - mint_cash: {to: H3, amount: 3000}
  
  # Households deposit at their respective banks
  - deposit_cash: {customer: H1, bank: B1, amount: 4500}
  - deposit_cash: {customer: H2, bank: B2, amount: 3500}
  - deposit_cash: {customer: H3, bank: B1, amount: 2500}
  
  # Create payment obligations across banks
  - create_payable: {from: H1, to: H2, amount: 1000, due_day: 1}  # B1 -> B2
  - create_payable: {from: H2, to: H3, amount: 800, due_day: 1}   # B2 -> B1
  - create_payable: {from: H3, to: H1, amount: 300, due_day: 2}   # B1 -> B1 (same bank)

run:
  mode: until_stable
  max_days: 30
  quiet_days: 2
  show:
    balances: [CB, B1, B2, H1, H2, H3]
    events: detailed
  export:
    balances_csv: "out/interbank_balances.csv"
    events_jsonl: "out/interbank_events.jsonl"